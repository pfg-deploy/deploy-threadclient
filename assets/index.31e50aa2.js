const io=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}};io();window.el=(...e)=>document.createElement(...e);window.txt=e=>document.createTextNode(e);window.anychange=(e,t)=>(e.forEach(n=>n.oninput=()=>t()),t(),t);window.body=document.getElementById("maincontent")||document.body;Node.prototype.attr=function(e){return Object.entries(e).forEach(([t,n])=>n==null?this.removeAttribute(t):this.setAttribute(t,n)),this};Node.prototype.adto=function(e){return e.appendChild(this),this};Node.prototype.adch=function(...e){return e.forEach(t=>this.appendChild(t)),this};Node.prototype.atxt=function(e){return this.appendChild(txt(e)),this};Node.prototype.onev=function(...e){return this.addEventListener(...e),this};Node.prototype.clss=function(...e){return e.forEach(t=>t.split(/[. ]/g).filter(n=>n).map(n=>this.classList.add(n))),this};Node.prototype.styl=function(e){return Object.entries(e).forEach(([t,n])=>this.style.setProperty(t,n)),this};Object.defineProperty(Array.prototype,"last",{enumerable:!1,get:function(){return this[this.length-1]}});Object.defineProperty(Object.prototype,"dwth",{enumerable:!1,value:function(e){return e(this),this}});const so=(e,t)=>e===t,Pe=Symbol("solid-proxy"),bt={equals:so};let we=null,sr=fr;const je={},ke=1,yt=2,ar={owned:null,cleanups:null,context:null,owner:null};var V=null;let it=null,B=null,Ze=null,X=null,de=null,un=0;function ue(e,t){const n=B,r=V,o=e.length===0?ar:{owned:null,cleanups:null,context:null,owner:t||r};V=o,B=null;try{return mn(()=>e(()=>vn(o)),!0)}finally{B=n,V=r}}function L(e,t){t=t?Object.assign({},bt,t):bt;const n={value:e,observers:null,observerSlots:null,pending:je,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.pending!==je?n.pending:n.value)),gn(n,o));return[ur.bind(n),r]}function Kt(e,t,n){const r=st(e,t,!0,ke);Te(r)}function P(e,t,n){const r=st(e,t,!1,ke);Te(r)}function H(e,t,n){sr=mo;const r=st(e,t,!1,ke);r.user=!0,de?de.push(r):queueMicrotask(()=>Te(r))}function ao(e,t){let n;const r=st(()=>{n?n():F(e),n=void 0},void 0,!1,0);return r.user=!0,o=>{n=o,Te(r)}}function O(e,t,n){n=n?Object.assign({},bt,n):bt;const r=st(e,t,!0,0);return r.pending=je,r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Te(r),ur.bind(r)}function Yt(e,t,n){arguments.length===2?typeof t=="object"&&(n=t,t=e,e=!0):arguments.length===1&&(t=e,e=!0),n||(n={}),n.globalRefetch!==!1&&(ut||(ut=new Set),ut.add(k),V&&z(()=>ut.delete(k)));const r=new Set,[o,l]=L(n.initialValue),[i,s]=L(void 0,{equals:!1}),[c,a]=L(!1),[d,f]=L();let h,m=null,g=null,p=!1,$=typeof e=="function";function N(y,x,C,T){return m===y&&(m=null,g&&y===g&&n.onHydrated&&n.onHydrated(T,{value:x}),g=null,f(h=C),w(x)),x}function w(y){Le(()=>{l(()=>y),a(!1);for(const x of r.keys())x.decrement();r.clear()})}function S(){const y=fo,x=o();if(h)throw h;return B&&!B.user&&y&&Kt(()=>{i(),m&&(y.resolved||r.has(y)||(y.increment(),r.add(y)))}),x}function k(y=!0){if(y&&p)return;p=!1,f(h=void 0);const x=$?e():e;if(x==null||x===!1){N(m,F(o));return}const C=g||F(()=>t(x,{value:o(),refetching:y}));return typeof C!="object"||!("then"in C)?(N(m,C),C):(m=C,p=!0,queueMicrotask(()=>p=!1),Le(()=>{a(!0),s()}),C.then(T=>N(C,T,void 0,x),T=>N(C,T,T)))}return Object.defineProperties(S,{loading:{get(){return c()}},error:{get(){return d()}}}),$?Kt(()=>k(!1)):k(!1),[S,{refetch:k,mutate:l}]}let ut;function Le(e){if(Ze)return e();let t;const n=Ze=[];try{t=e()}finally{Ze=null}return mn(()=>{for(let r=0;r<n.length;r+=1){const o=n[r];if(o.pending!==je){const l=o.pending;o.pending=je,gn(o,l)}}},!1),t}function F(e){let t,n=B;return B=null,t=e(),B=n,t}function cr(e,t,n){const r=Array.isArray(e);let o,l=n&&n.defer;return i=>{let s;if(r){s=[];for(let a=0;a<e.length;a++)s.push(e[a]())}else s=e();if(l){l=!1;return}const c=F(()=>t(s,o,i));return o=s,c}}function co(e){H(()=>F(e))}function z(e){return V===null||(V.cleanups===null?V.cleanups=[e]:V.cleanups.push(e)),e}function uo(e){we||(we=Symbol("error")),V===null||(V.context===null?V.context={[we]:[e]}:V.context[we]?V.context[we].push(e):V.context[we]=[e])}function dr(){return B}function fn(e){const t=Symbol("context");return{id:t,Provider:vo(t),defaultValue:e}}function At(e){let t;return(t=pn(V,e.id))!==void 0?t:e.defaultValue}function hn(e){const t=O(e);return O(()=>Jt(t()))}let fo;function ur(){const e=it;if(this.sources&&(this.state||e)){const t=X;X=null,this.state===ke||e?Te(this):wt(this),X=t}if(B){const t=this.observers?this.observers.length:0;B.sources?(B.sources.push(this),B.sourceSlots.push(t)):(B.sources=[this],B.sourceSlots=[t]),this.observers?(this.observers.push(B),this.observerSlots.push(B.sources.length-1)):(this.observers=[B],this.observerSlots=[B.sources.length-1])}return this.value}function gn(e,t,n){if(Ze)return e.pending===je&&Ze.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let r=!1;return e.value=t,e.observers&&e.observers.length&&mn(()=>{for(let o=0;o<e.observers.length;o+=1){const l=e.observers[o];r&&it.disposed.has(l),(r&&!l.tState||!r&&!l.state)&&(l.pure?X.push(l):de.push(l),l.observers&&hr(l)),r||(l.state=ke)}if(X.length>1e6)throw X=[],new Error},!1),t}function Te(e){if(!e.fn)return;vn(e);const t=V,n=B,r=un;B=V=e,ho(e,e.value,r),B=n,V=t}function ho(e,t,n){let r;try{r=e.fn(t)}catch(o){gr(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.observers&&e.observers.length?gn(e,r):e.value=r,e.updatedAt=n)}function st(e,t,n,r=ke,o){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:V,context:null,pure:n};return V===null||V!==ar&&(V.owned?V.owned.push(l):V.owned=[l]),l}function et(e){const t=it;if(e.state===0||t)return;if(e.state===yt||t)return wt(e);if(e.suspense&&F(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<un);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===ke||t)Te(e);else if(e.state===yt||t){const o=X;X=null,wt(e,n[0]),X=o}}function mn(e,t){if(X)return e();let n=!1;t||(X=[]),de?n=!0:de=[],un++;try{return e()}catch(r){gr(r)}finally{go(n)}}function go(e){X&&(fr(X),X=null),!e&&(de.length?Le(()=>{sr(de),de=null}):de=null)}function fr(e){for(let t=0;t<e.length;t++)et(e[t])}function mo(e){let t,n=0;for(t=0;t<e.length;t++){const o=e[t];o.user?e[n++]=o:et(o)}const r=e.length;for(t=0;t<n;t++)et(e[t]);for(t=r;t<e.length;t++)et(e[t])}function wt(e,t){const n=it;e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];o.sources&&(o.state===ke||n?o!==t&&et(o):(o.state===yt||n)&&wt(o,t))}}function hr(e){const t=it;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=yt,r.pure?X.push(r):de.push(r),r.observers&&hr(r))}}function vn(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const l=o.pop(),i=n.observerSlots.pop();r<o.length&&(l.sourceSlots[i]=r,o[r]=l,n.observerSlots[r]=i)}}if(e.owned){for(t=0;t<e.owned.length;t++)vn(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function gr(e){const t=we&&pn(V,we);if(!t)throw e;t.forEach(n=>n(e))}function pn(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:pn(e.owner,t):void 0}function Jt(e){if(typeof e=="function"&&!e.length)return Jt(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=Jt(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function vo(e){return function(n){let r;return Kt(()=>r=F(()=>(V.context={[e]:n.value},hn(()=>n.children)))),r}}const Xt=Symbol("fallback");function xt(e){for(let t=0;t<e.length;t++)e[t]()}function po(e,t,n={}){let r=[],o=[],l=[],i=0,s=t.length>1?[]:null;return z(()=>xt(l)),()=>{let c=e()||[],a,d;return F(()=>{let h=c.length,m,g,p,$,N,w,S,k,y;if(h===0)i!==0&&(xt(l),l=[],r=[],o=[],i=0,s&&(s=[])),n.fallback&&(r=[Xt],o[0]=ue(x=>(l[0]=x,n.fallback())),i=1);else if(i===0){for(o=new Array(h),d=0;d<h;d++)r[d]=c[d],o[d]=ue(f);i=h}else{for(p=new Array(h),$=new Array(h),s&&(N=new Array(h)),w=0,S=Math.min(i,h);w<S&&r[w]===c[w];w++);for(S=i-1,k=h-1;S>=w&&k>=w&&r[S]===c[k];S--,k--)p[k]=o[S],$[k]=l[S],s&&(N[k]=s[S]);for(m=new Map,g=new Array(k+1),d=k;d>=w;d--)y=c[d],a=m.get(y),g[d]=a===void 0?-1:a,m.set(y,d);for(a=w;a<=S;a++)y=r[a],d=m.get(y),d!==void 0&&d!==-1?(p[d]=o[a],$[d]=l[a],s&&(N[d]=s[a]),d=g[d],m.set(y,d)):l[a]();for(d=w;d<h;d++)d in p?(o[d]=p[d],l[d]=$[d],s&&(s[d]=N[d],s[d](d))):o[d]=ue(f);o=o.slice(0,i=h),r=c.slice(0)}return o});function f(h){if(l[d]=h,s){const[m,g]=L(d);return s[d]=g,t(c[d],m)}return t(c[d])}}}function _o(e,t,n={}){let r=[],o=[],l=[],i=[],s=0,c;return z(()=>xt(l)),()=>{const a=e()||[];return F(()=>{if(a.length===0)return s!==0&&(xt(l),l=[],r=[],o=[],s=0,i=[]),n.fallback&&(r=[Xt],o[0]=ue(f=>(l[0]=f,n.fallback())),s=1),o;for(r[0]===Xt&&(l[0](),l=[],r=[],o=[],s=0),c=0;c<a.length;c++)c<r.length&&r[c]!==a[c]?i[c](()=>a[c]):c>=r.length&&(o[c]=ue(d));for(;c<r.length;c++)l[c]();return s=i.length=l.length=a.length,r=a.slice(0),o=o.slice(0,s)});function d(f){l[c]=f;const[h,m]=L(a[c]);return i[c]=m,t(h,c)}}}function u(e,t){return F(()=>e(t))}function ft(){return!0}const bo={get(e,t,n){return t===Pe?n:e.get(t)},has(e,t){return e.has(t)},set:ft,deleteProperty:ft,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:ft,deleteProperty:ft}},ownKeys(e){return e.keys()}};function Mt(e){return typeof e=="function"?e():e}function We(...e){return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){const r=Mt(e[n])[t];if(r!==void 0)return r}},has(t){for(let n=e.length-1;n>=0;n--)if(t in Mt(e[n]))return!0;return!1},keys(){const t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(Mt(e[n])));return[...new Set(t)]}},bo)}function yo(e){let t,n;const r=o=>{if(t){const i=t();if(i)return i(o)}else{const[i]=Yt(()=>(n||(n=e())).then(s=>s.default),{globalRefetch:!1});t=i}let l;return O(()=>(l=t())&&F(()=>l(o)))};return r.preload=()=>n||((n=e()).then(o=>t=()=>o.default),n),r}function q(e){const t="fallback"in e&&{fallback:()=>e.fallback};return O(po(()=>e.each,e.children,t||void 0))}function za(e){const t="fallback"in e&&{fallback:()=>e.fallback};return O(_o(()=>e.each,e.children,t||void 0))}function wo(e){let t=!1;const n=hn(()=>e.children),r=O(()=>{let o=n();Array.isArray(o)||(o=[o]);for(let l=0;l<o.length;l++){const i=o[l].when;if(i)return[l,i,o[l]]}return[-1]},void 0,{equals:(o,l)=>o[0]===l[0]&&(t?o[1]===l[1]:!o[1]==!l[1])&&o[2]===l[2]});return O(()=>{const[o,l,i]=r();if(o<0)return e.fallback;const s=i.children;return(t=typeof s=="function"&&s.length>0)?F(()=>s(l)):s})}function Vt(e){return e}let ht;function xo(e){let t;const[n,r]=L(t);ht||(ht=new Set),ht.add(r),z(()=>ht.delete(r));let o;return O(()=>{if((o=n())!=null){const l=e.fallback;return typeof l=="function"&&l.length?F(()=>l(o,()=>r(null))):l}return uo(r),e.children})}try{self["workbox:window:6.5.1"]&&_()}catch{}function Qt(e,t){return new Promise(function(n){var r=new MessageChannel;r.port1.onmessage=function(o){n(o.data)},e.postMessage(t,[r.port2])})}function ko(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $o(e,t){var n;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=function(o,l){if(o){if(typeof o=="string")return Tn(o,l);var i=Object.prototype.toString.call(o).slice(8,-1);return i==="Object"&&o.constructor&&(i=o.constructor.name),i==="Map"||i==="Set"?Array.from(o):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Tn(o,l):void 0}}(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.5.1"]&&_()}catch{}var jt=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})};function Wt(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var Ge=function(e,t){this.type=e,Object.assign(this,t)};function gt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Co(){}var No={type:"SKIP_WAITING"};function On(e,t){if(!t)return e&&e.then?e.then(Co):Promise.resolve()}var So=function(e){var t,n;function r(s,c){var a,d;return c===void 0&&(c={}),(a=e.call(this)||this).nn={},a.tn=0,a.rn=new jt,a.en=new jt,a.on=new jt,a.un=0,a.an=new Set,a.cn=function(){var f=a.fn,h=f.installing;a.tn>0||!Wt(h.scriptURL,a.sn.toString())||performance.now()>a.un+6e4?(a.vn=h,f.removeEventListener("updatefound",a.cn)):(a.hn=h,a.an.add(h),a.rn.resolve(h)),++a.tn,h.addEventListener("statechange",a.ln)},a.ln=function(f){var h=a.fn,m=f.target,g=m.state,p=m===a.vn,$={sw:m,isExternal:p,originalEvent:f};!p&&a.mn&&($.isUpdate=!0),a.dispatchEvent(new Ge(g,$)),g==="installed"?a.wn=self.setTimeout(function(){g==="installed"&&h.waiting===m&&a.dispatchEvent(new Ge("waiting",$))},200):g==="activating"&&(clearTimeout(a.wn),p||a.en.resolve(m))},a.dn=function(f){var h=a.hn,m=h!==navigator.serviceWorker.controller;a.dispatchEvent(new Ge("controlling",{isExternal:m,originalEvent:f,sw:h,isUpdate:a.mn})),m||a.on.resolve(h)},a.gn=(d=function(f){var h=f.data,m=f.ports,g=f.source;return gt(a.getSW(),function(){a.an.has(g)&&a.dispatchEvent(new Ge("message",{data:h,originalEvent:f,ports:m,sw:g}))})},function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];try{return Promise.resolve(d.apply(this,f))}catch(m){return Promise.reject(m)}}),a.sn=s,a.nn=c,navigator.serviceWorker.addEventListener("message",a.gn),a}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,l,i=r.prototype;return i.register=function(s){var c=(s===void 0?{}:s).immediate,a=c!==void 0&&c;try{var d=this;return function(f,h){var m=f();return m&&m.then?m.then(h):h(m)}(function(){if(!a&&document.readyState!=="complete")return On(new Promise(function(f){return window.addEventListener("load",f)}))},function(){return d.mn=Boolean(navigator.serviceWorker.controller),d.yn=d.pn(),gt(d.bn(),function(f){d.fn=f,d.yn&&(d.hn=d.yn,d.en.resolve(d.yn),d.on.resolve(d.yn),d.yn.addEventListener("statechange",d.ln,{once:!0}));var h=d.fn.waiting;return h&&Wt(h.scriptURL,d.sn.toString())&&(d.hn=h,Promise.resolve().then(function(){d.dispatchEvent(new Ge("waiting",{sw:h,wasWaitingBeforeRegister:!0}))}).then(function(){})),d.hn&&(d.rn.resolve(d.hn),d.an.add(d.hn)),d.fn.addEventListener("updatefound",d.cn),navigator.serviceWorker.addEventListener("controllerchange",d.dn),d.fn})})}catch(f){return Promise.reject(f)}},i.update=function(){try{return this.fn?On(this.fn.update()):void 0}catch(s){return Promise.reject(s)}},i.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(s){try{return gt(this.getSW(),function(c){return Qt(c,s)})}catch(c){return Promise.reject(c)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&Qt(this.fn.waiting,No)},i.pn=function(){var s=navigator.serviceWorker.controller;return s&&Wt(s.scriptURL,this.sn.toString())?s:void 0},i.bn=function(){try{var s=this;return function(c,a){try{var d=c()}catch(f){return a(f)}return d&&d.then?d.then(void 0,a):d}(function(){return gt(navigator.serviceWorker.register(s.sn,s.nn),function(c){return s.un=performance.now(),c})},function(c){throw c})}catch(c){return Promise.reject(c)}},o=r,(l=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&ko(o.prototype,l),r}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(n,r){this.Sn(n).add(r)},t.removeEventListener=function(n,r){this.Sn(n).delete(r)},t.dispatchEvent=function(n){n.target=this;for(var r,o=$o(this.Sn(n.type));!(r=o()).done;)(0,r.value)(n)},t.Sn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},e}());function Eo(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisterError:l}=e;let i,s;const c=async(a=!0)=>{a&&i?.addEventListener("controlling",d=>{d.isUpdate&&window.location.reload()}),s&&s.waiting&&await Qt(s.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new So("/sw.js",{scope:"/",type:"classic"}),i.addEventListener("activated",a=>{a.isUpdate||r?.()});{const a=()=>{n?.()};i.addEventListener("waiting",a),i.addEventListener("externalwaiting",a)}i.register({immediate:t}).then(a=>{s=a,o?.(a)}).catch(a=>{l?.(a)})}return c}const Po={version:`5da5cf4
`,log:[{hash:"5da5cf4",hash_full:"5da5cf479d0bbb347c56f092803a8b30810561be",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649957973000",commit_title:"fix bulid",commit_body:`fix bulid
`},{hash:"222d253",hash_full:"222d253048c4874951f5de7ddc2ebb60db3b1ae1",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649957615000",commit_title:"clarify that the new setting is about external links only",commit_body:`clarify that the new setting is about external links only
`},{hash:"0fa48d3",hash_full:"0fa48d3723a857ad53b76fd1dd734c26384fa7e9",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649957590000",commit_title:"fix #3. clicking native links is not supposed to open in a new tab.",commit_body:`fix #3. clicking native links is not supposed to open in a new tab.
`},{hash:"297059f",hash_full:"297059fafb27e44dea758f91e2024f5cff3d557e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649957494000",commit_title:"add support for /subreddits/mine. no menu yet. (#4)",commit_body:`add support for /subreddits/mine. no menu yet. (#4)
`},{hash:"32ae8e6",hash_full:"32ae8e697cd3734f0275fe5b86907146c2cd9679",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649955888000",commit_title:"add a setting for if links should open in the same tab or a new tab (#3)",commit_body:`add a setting for if links should open in the same tab or a new tab (#3)
`},{hash:"1344306",hash_full:"134430696f2d3b2198db5b89c85872de42366759",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649955427000",commit_title:"fun heropatterns",commit_body:`fun heropatterns
`},{hash:"679b082",hash_full:"679b0828cc63913f49ec641bd9b9a2e3977747fa",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649955277000",commit_title:"starting on a shell client that will be used for the homepage and settings pages",commit_body:`starting on a shell client that will be used for the homepage and settings pages
`},{hash:"98d40a7",hash_full:"98d40a7d1746bb085d4ee07139903ef957887096",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649953725000",commit_title:"TODO this won't be a fun commit",commit_body:`TODO this won't be a fun commit
`},{hash:"a0076f0",hash_full:"a0076f040e3c89910e51a7140b97499a4eacc81c",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649953604000",commit_title:"tried out designing a new landing page. we might use something like it",commit_body:`tried out designing a new landing page. we might use something like it
`},{hash:"23d0eb4",hash_full:"23d0eb470ace143027364f194e20bd5f1b9fe85a",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1649907440000",commit_title:"nope this idea was too crazy. can't do it. reasons: - heigherarchical replies really work best when there aren't that many - it's a lot easier to read many items when they're split up with nice clear boundaries. when everything has one or two levels of indentation, it's hard to read where one thing ends and the next one starts",commit_body:`nope this idea was too crazy. can't do it. reasons:
- heigherarchical replies really work best when there aren't that many
- it's a lot easier to read many items when they're split up with nice clear boundaries. when everything has one or two levels of indentation, it's hard to read where one thing ends and the next one starts
`}],build_time:1649958194898,build_mode:"production"},Lo="modulepreload",Rn={},Ao="/",J=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Ao}${r}`,r in Rn)return;Rn[r]=!0;const o=r.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Lo,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((s,c)=>{i.addEventListener("load",s),i.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},To=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Oo=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...To]),Ro=new Set(["innerHTML","textContent","innerText","children"]),Io={className:"class",htmlFor:"for"},In={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},Do=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Mo={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function M(e,t){return O(e,void 0,t?void 0:{equals:t})}function Vo(e,t,n){let r=n.length,o=t.length,l=r,i=0,s=0,c=t[o-1].nextSibling,a=null;for(;i<o||s<l;){if(t[i]===n[s]){i++,s++;continue}for(;t[o-1]===n[l-1];)o--,l--;if(o===i){const d=l<r?s?n[s-1].nextSibling:n[l-s]:c;for(;s<l;)e.insertBefore(n[s++],d)}else if(l===s)for(;i<o;)(!a||!a.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[l-1]&&n[s]===t[o-1]){const d=t[--o].nextSibling;e.insertBefore(n[s++],t[i++].nextSibling),e.insertBefore(n[--l],d),t[o]=n[l]}else{if(!a){a=new Map;let f=s;for(;f<l;)a.set(n[f],f++)}const d=a.get(t[i]);if(d!=null)if(s<d&&d<l){let f=i,h=1,m;for(;++f<o&&f<l&&!((m=a.get(t[f]))==null||m!==d+h);)h++;if(h>d-s){const g=t[i];for(;s<d;)e.insertBefore(n[s++],g)}else e.replaceChild(n[s++],t[i++])}else i++;else t[i++].remove()}}}const Dn="_$DX_DELEGATE";function Tt(e,t,n){let r;return ue(o=>{r=o,t===document?e():v(t,e(),t.firstChild?null:void 0,n)}),()=>{r(),t.textContent=""}}function b(e,t,n){const r=document.createElement("template");r.innerHTML=e;let o=r.content.firstChild;return n&&(o=o.firstChild),o}function ee(e,t=window.document){const n=t[Dn]||(t[Dn]=new Set);for(let r=0,o=e.length;r<o;r++){const l=e[r];n.has(l)||(n.add(l),t.addEventListener(l,Fo))}}function W(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function jo(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function Wo(e,t,n,r){r?Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n:Array.isArray(n)?e.addEventListener(t,o=>n[0](n[1],o)):e.addEventListener(t,n)}function Bo(e,t,n={}){const r=Object.keys(t||{}),o=Object.keys(n);let l,i;for(l=0,i=o.length;l<i;l++){const s=o[l];!s||s==="undefined"||t[s]||(Mn(e,s,!1),delete n[s])}for(l=0,i=r.length;l<i;l++){const s=r[l],c=!!t[s];!s||s==="undefined"||n[s]===c||!c||(Mn(e,s,!0),n[s]=c)}return n}function _n(e,t,n={}){const r=e.style,o=typeof n=="string";if(t==null&&o||typeof t=="string")return r.cssText=t;o&&(r.cssText=void 0,n={}),t||(t={});let l,i;for(i in n)t[i]==null&&r.removeProperty(i),delete n[i];for(i in t)l=t[i],l!==n[i]&&(r.setProperty(i,l),n[i]=l);return n}function Uo(e,t,n,r){typeof t=="function"?P(o=>jn(e,t(),o,n,r)):jn(e,t,void 0,n,r)}function v(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Be(e,t,r,n);P(o=>Be(e,t(),o,n),r)}function Ho(e,t,n,r,o={},l=!1){t||(t={});for(const i in o)if(!(i in t)){if(i==="children")continue;Vn(e,i,null,o[i],n,l)}for(const i in t){if(i==="children"){r||Be(e,t.children);continue}const s=t[i];o[i]=Vn(e,i,s,o[i],n,l)}}function qo(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function Mn(e,t,n){const r=t.trim().split(/\s+/);for(let o=0,l=r.length;o<l;o++)e.classList.toggle(r[o],n)}function Vn(e,t,n,r,o,l){let i,s,c;if(t==="style")return _n(e,n,r);if(t==="classList")return Bo(e,n,r);if(n===r)return r;if(t==="ref")l||n(e);else if(t.slice(0,3)==="on:")e.addEventListener(t.slice(3),n);else if(t.slice(0,10)==="oncapture:")e.addEventListener(t.slice(10),n,!0);else if(t.slice(0,2)==="on"){const a=t.slice(2).toLowerCase(),d=Do.has(a);Wo(e,a,n,d),d&&ee([a])}else if((c=Ro.has(t))||!o&&(In[t]||(s=Oo.has(t)))||(i=e.nodeName.includes("-")))i&&!s&&!c?e[qo(t)]=n:e[In[t]||t]=n;else{const a=o&&t.indexOf(":")>-1&&Mo[t.split(":")[0]];a?jo(e,a,t,n):W(e,Io[t]||t,n)}return n}function Fo(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n!==null;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r(o,e):r(e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function jn(e,t,n={},r,o){return t||(t={}),!o&&"children"in t&&P(()=>n.children=Be(e,t.children,n.children)),t.ref&&t.ref(e),P(()=>Ho(e,t,r,!0,n,!0)),n}function Be(e,t,n,r,o){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,l==="string"||l==="number")if(l==="number"&&(t=t.toString()),i){let s=n[0];s&&s.nodeType===3?s.data=t:s=document.createTextNode(t),n=Oe(e,n,r,s)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||l==="boolean")n=Oe(e,n,r);else{if(l==="function")return P(()=>{let s=t();for(;typeof s=="function";)s=s();n=Be(e,s,n,r)}),()=>n;if(Array.isArray(t)){const s=[];if(Zt(s,t,o))return P(()=>n=Be(e,s,n,r,!0)),()=>n;if(s.length===0){if(n=Oe(e,n,r),i)return n}else Array.isArray(n)?n.length===0?Wn(e,s,r):Vo(e,n,s):(n&&Oe(e),Wn(e,s));n=s}else if(t instanceof Node){if(Array.isArray(n)){if(i)return n=Oe(e,n,r,t);Oe(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Zt(e,t,n){let r=!1;for(let o=0,l=t.length;o<l;o++){let i=t[o],s;if(i instanceof Node)e.push(i);else if(!(i==null||i===!0||i===!1))if(Array.isArray(i))r=Zt(e,i)||r;else if((s=typeof i)=="string")e.push(document.createTextNode(i));else if(s==="function")if(n){for(;typeof i=="function";)i=i();r=Zt(e,Array.isArray(i)?i:[i])||r}else e.push(i),r=!0;else e.push(document.createTextNode(i.toString()))}return r}function Wn(e,t,n){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function Oe(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let l=!1;for(let i=t.length-1;i>=0;i--){const s=t[i];if(o!==s){const c=s.parentNode===e;!l&&!i?c?e.replaceChild(o,s):e.insertBefore(o,n):c&&s.remove()}else l=!0}}else e.insertBefore(o,n);return[o]}const zo="http://www.w3.org/2000/svg";function Go(e,t=!1){return t?document.createElementNS(zo,e):document.createElement(e)}function Ko(e){const{useShadow:t}=e,n=document.createTextNode(""),r=e.mount||document.body;function o(){return()=>e.children}if(r instanceof HTMLHeadElement){const[l,i]=L(!1),s=()=>i(!0);ue(c=>v(r,()=>l()?c():o()(),null)),z(()=>{s()})}else{const l=Go(e.isSVG?"g":"div",e.isSVG),i=t&&l.attachShadow?l.attachShadow({mode:"open"}):l;Object.defineProperty(l,"host",{get(){return n.parentNode}}),v(i,o()),r.appendChild(l),e.ref&&e.ref(l),z(()=>r.removeChild(l))}return n}function Yo(e,t){const n=e,r=n[t];return r?Object.hasOwnProperty.call(n,t)?"error"in r?{error:r.error,value:null}:{value:r.data,error:null}:{error:"[read]Link found but not in hasOwnProperty: "+t.toString(),value:null}:{error:"[read]Link not found: "+t.toString(),value:null}}function Jo(e,t,n){return{...t,kind:e,...n?{children:n}:{}}}const D={kind:Jo,p:(...e)=>D.kind("paragraph",{},e),hn:(e,...t)=>D.kind("heading",{level:e},t),h1:(...e)=>D.hn(1,...e),h2:(...e)=>D.hn(2,...e),ul:(...e)=>D.kind("list",{ordered:!1},e),ol:(...e)=>D.kind("list",{ordered:!0},e),li:(...e)=>D.kind("list_item",{},e),ili:(...e)=>D.kind("tight_list_item",{},e),blockquote:(...e)=>D.kind("blockquote",{},e),txt:(e,t={})=>D.kind("text",{text:e,styles:t}),link:(e,t,n,...r)=>D.kind("link",{url:t,client_id:e.id,...n},r),pre:(e,t)=>D.kind("code_block",{text:e,lang:t}),error:(e,t)=>D.kind("error",{text:e,value:t}),br:()=>D.kind("br",{}),flair:e=>D.kind("flair",{flair:e}),table:(e,...t)=>D.kind("table",{headings:e},t),th:(e,...t)=>({align:e,children:t}),td:(...e)=>({children:e}),timeAgo:e=>D.kind("time_ago",{start:e}),hr:()=>D.kind("horizontal_line",{}),code:e=>D.kind("code",{text:e}),spoiler:(...e)=>D.kind("spoiler",{},e)},Ga={link:(e,t,n,r)=>({selected:r,action:{kind:"link",client_id:e.id,url:n},text:t})};function Xo(e){const t="https://v.redd.it/"+e;return{kind:"video",sources:[{url:t+"/DASHPlaylist.mpd"},{url:t+"/HLSPlaylist.m3u8"}],preview:[{url:t+"/DASH_96.mp4",type:"video/mp4"},{url:t+"/DASH_96",type:"video/mp4"}]}}function Bn(e,t){const n=e.split(".");return n.pop(),n.push(t),n.join(".")}function Un(e){return{kind:"video",source:Xo(e),gifv:!1}}function Ot(e,t){let n;try{n=new URL(e)}catch{}const r=n,o=r?.pathname??e;if(r?o.endsWith(".gif")&&r.searchParams.get("format")==="mp4":!1)return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:e,quality:"Highest"}]}};if((r?.hostname??"")==="i.imgur.com"&&o.endsWith(".gif")||o.endsWith(".gifv"))return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:Bn(e,"webm"),quality:"Highest"},{url:Bn(e,"mp4"),quality:"Highest"},{url:e,quality:"Highest"}]}};if((r?.hostname??"")==="i.redd.it"||o.endsWith(".png")||o.endsWith(".jpg")||o.endsWith(".jpeg")||o.endsWith(".gif")||o.endsWith(".webp")||(r?.hostname??"")==="pbs.twimg.com")return{kind:"captioned_image",url:e,w:null,h:null};if(e.startsWith("https://v.redd.it/"))return Un(e.replace("https://v.redd.it/",""));if(r&&(r.host==="reddit.com"||r.host.endsWith(".reddit.com")&&r.pathname.startsWith("/link"))){const i=o.split("/");if(i.shift(),i[0]==="link"&&i[2]==="video"&&i[4]==="player")return Un(i[3]??"")}if(r&&(r.host==="gfycat.com"||r.host.endsWith(".gfycat.com"))&&r.pathname.split("/").length===2)return{kind:"gfycatv1",id:r.pathname.replace("/","").split("-")[0].split(".")[0].toLowerCase(),host:"gfycat.com"};if(r&&(r.host==="redgifs.com"||r.host.endsWith(".redgifs.com"))&&r.pathname.split("/").length===3&&r.pathname.startsWith("/watch/")){const i=r.pathname.replace("/watch/","").split("-")[0].split(".")[0].toLowerCase();return{kind:"gfycatv2",id:i,host:"redgifs.com"}}if(o.endsWith(".mp4")||o.endsWith(".webm"))return{kind:"video",gifv:!1,source:{kind:"video",sources:[{url:e,quality:"Highest"}]}};if(o.endsWith(".mp3"))return{kind:"audio",url:e};if(r&&(r.host==="www.youtube.com"||r.host==="youtube.com"||r.host==="m.youtube.com")&&r.pathname==="/watch"){const i=r.searchParams.get("v");if(i!=null)return{kind:"youtube",id:i,search:r.searchParams.toString()}}if(r&&r.host==="youtu.be"&&r.pathname.split("/").length===2){const i=r.pathname.split("/")[1]??"no_id";return{kind:"youtube",id:i,search:r.searchParams.toString()}}if(r&&(r.host==="vocaroo.com"||r.host==="www.vocaroo.com"||r.host==="voca.ro")){const i=r.pathname.split("/").filter(s=>s);if(i.length===1&&i[0]!=null&&i[0]!=="")return{kind:"audio",url:"https://media.vocaroo.com/mp3/"+i[0]}}if(r&&(r.host==="giphy.com"||r.host==="www.giphy.com")){const i=r.pathname.split("/").filter(s=>s);if(i.length===3&&i[0]==="gifs"&&i[2]==="fullscreen"){const s=i[1].split("-"),c=s[s.length-1];return{kind:"video",source:{kind:"video",sources:[{url:"https://media4.giphy.com/media/"+c+"/giphy.mp4",quality:"Highest"}]},gifv:!0}}}if(r&&(r.host==="www.imgur.com"||r.host==="imgur.com"||r.host==="m.imgur.com")){const i=r.pathname.split("/").filter(a=>a),s=i[1],c=i[0]==="gallery"?"gallery":i[0]==="a"?"album":void 0;if(c!==void 0&&i.length===2)return{kind:"imgur",imgur_id:s,imgur_kind:c};if(i.length===1&&(i[0]??"").length>4)return{kind:"captioned_image",url:"https://i.imgur.com/"+i[0]+".jpg",w:null,h:null}}if(r&&r.host==="clips.twitch.tv"&&r.pathname.split("/").filter(i=>i).length===1){const i=r.pathname.split("/").filter(s=>s)[0];if(i!=null)return{kind:"twitch_clip",slug:i}}if(r&&(r.host==="soundcloud.com"||r.host.endsWith(".soundcloud.com")))return{kind:"oembed",client_id:"n/a",url:"https://soundcloud.com/oembed?format=json&url="+encodeURIComponent(e)};if(r&&(r.host==="tiktok.com"||r.host.endsWith(".tiktok.com")))return{kind:"oembed",client_id:"n/a",url:"https://www.tiktok.com/oembed?url="+encodeURIComponent(e)};if(t.suggested_embed!=null)return{kind:"reddit_suggested_embed",suggested_embed:t.suggested_embed}}async function Qo(e,t){const n=await fetch("https://api."+e+"/v2/gifs/"+t).then(s=>s.json());if(console.log("gfy response",n),"errorMessage"in n)throw new Error("Gfycat error: "+n.errorMessage+"; logged="+n.logged+"; reported="+n.reported);if("message"in n)throw new Error("Gfycat error: "+n.message+"; logged="+n.logged+"; reported="+n.reported);const{gif:r,user:o}=n,l="https://www."+e,i={kind:"video",aspect:r.width/r.height,gifv:!1,source:{kind:"video",sources:[{url:r.urls.hd,quality:"HD"},{url:r.urls.sd,quality:"SD"}],thumbnail:r.urls.thumbnail}};return{kind:"post",parent:null,replies:null,url:"https://www."+e+"/watch/"+t,client_id:l,display_style:"centered",content:{kind:"post",title:null,thumbnail:{kind:"image",url:r.urls.thumbnail},flair:r.tags.map(s=>({content_warning:!1,elems:[{kind:"text",text:s}]})),info:{creation_date:r.createDate*1e3},author:o?{name:o.name,color_hash:o.username,link:o.url,client_id:l,pfp:{url:o.profileImageUrl,hover:o.profileImageUrl}}:void 0,body:i,show_replies_when_below_pivot:!1,collapsible:{default_collapsed:!1},actions:{vote:{kind:"counter",client_id:l,unique_id:"like_"+t,time:Date.now(),neutral_icon:"heart",special:void 0,increment:{icon:"heart",color:"pink",label:"Like",undo_label:"Unlike"},decrement:null,count_excl_you:r.likes,you:void 0,actions:{error:"gfycat liking is not supported"}},other:[{kind:"link",text:r.views+" Views",url:"https://www."+e+"/watch/"+t,client_id:l}]}},internal_data:n}}const Hn=Symbol("raw");function Zo(e){return(t,...n)=>{const r=[];return t.forEach((l,i)=>{if(r.push({raw:l}),i<n.length){const s=n[i];typeof s=="object"&&Hn in s?r.push({raw:s[Hn]}):r.push({val:s})}}),r.map(l=>"raw"in l?l.raw:e(l.val)).join("")}}const tl=Zo(e=>encodeURIComponent(e));function Ka(e){let t="";for(const[n,r]of Object.entries(e))r!=null&&(t&&(t+="&"),t+=tl`${n}=${r}`);return t}function nl(e){return e.replace(/[^a-zA-Z0-9. ]/giu,t=>"&#"+t.codePointAt(0)+";")}function mr(e){throw console.log("not never:",e),new Error("Expected never")}function qn(e,t,n,r){const o={...e},l=[...t];for(const i of n)if(typeof i=="string"){if(l.shift()!==i)return null}else{const s=Object.entries(i);if(!s[0]||s.length!==1)throw new Error("bad bit object");const[c,a]=s[0];if(a==="any"){const d=l.shift();if(d==null)return null;o[c]=d}else if(a==="rest")o[c]=l.splice(0);else if(a==="optional")o[c]=l.shift()??null;else if(Array.isArray(a)||"forEach"in a){const d=l.shift()??null;if(!a.includes(d))return null;o[c]=d}else if(a.kind==="starts-with"){const d=l.shift();if(d==null||!d.startsWith(a.text))return null;o[c]=d.replace(a.text,"")}}return r.assert_end&&l.length!==0?null:{opts:o,path:l}}function vr(e){const t=[],n={with(r,o){const l=vr(!1);o(l),t.push((i,s)=>{const c=qn(i,s,r,{assert_end:!1});return c?l.parseSub(c.opts,c.path):null})},route(r,o){t.push((l,i)=>{const s=qn(l,i,r,{assert_end:!0});return s?o(s.opts):null})},catchall(r){t.push((o,l)=>r(o))},parse(r){if(!e)throw new Error("not root, ParentOpts \u2260 BaseParentOpts");let o;try{o=new URL(r,new URL("https://example/"))}catch{return null}const l=o.pathname.split("/").filter(s=>s),i={query:Object.fromEntries(o.searchParams),path:o.pathname};return n.parseSub(i,l)},parseSub(r,o){for(const l of t){const i=l(r,o);if(i!=null)return i}return null}};return n}function Ya(){return vr(!0)}function pr(e,t){const n=t[e.kind]??t.unsupported??(()=>{throw new Error("condition "+e.kind+" was not handled and no unsupported branch")});return()=>n(e)}function at(e,t){return pr(e,t)()}const rl=b("<div><div></div></div>"),ol=b("<div aria-hidden></div>");function ll(e){let t;const n=(o,l,i)=>{if(l.bottom<0||l.right<0||l.left>o[0]||l.top>o[1])return;let s=l.top,c=l.left,a=l.width,d=l.height;if(a<8){const f=8-a;c-=f,a+=f*2}if(d<8){const f=8-d;s-=f,d+=f*2}ue(f=>{const h=i/10%360|0,m=1e3,g=(()=>{const p=rl.cloneNode(!0),$=p.firstChild;return(N=>{co(()=>{N.offsetWidth,N.style.opacity="0"})})(p),p.addEventListener("transitionend",N=>{N.target===N.currentTarget&&f()}),p.style.setProperty("position","fixed"),p.style.setProperty("top",s+"px"),p.style.setProperty("left",c+"px"),p.style.setProperty("width",a+"px"),p.style.setProperty("height",d+"px"),p.style.setProperty("z-index","2147483647"),p.style.setProperty("opacity","100"),p.style.setProperty("transition","1000ms opacity"),$.style.setProperty("width","100%"),$.style.setProperty("height","100%"),$.style.setProperty("box-sizing","border-box"),$.style.setProperty("border","1px solid hsl("+h+", 100%, 50%)"),p})();t.appendChild(g),z(()=>g.remove())})},r=(o,l,i)=>{if(l instanceof Element)n(o,l.getBoundingClientRect(),i);else if(l instanceof Text){const s=document.createRange();s.selectNode(l),n(o,s.getBoundingClientRect(),i)}else l instanceof Comment||console.log("EBADNODE",l)};return H(()=>{const o=new MutationObserver(l=>{const i=new Set,s=a=>{a.forEach(d=>{i.add(d),s(d.childNodes)})};for(const a of l)a.type==="attributes"?i.add(a.target):a.type==="childList"?s(a.addedNodes):a.type==="characterData"&&i.add(a.target);const c=[window.innerWidth,window.innerHeight];i.forEach(a=>r(c,a,Date.now()))});o.observe(e.observe_root,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),z(()=>o.disconnect())}),(()=>{const o=ol.cloneNode(!0),l=t;return typeof l=="function"?l(o):t=o,o.style.setProperty("pointer-events","none"),o})()}const il=b("<time></time>");function K(e){return O(()=>{const t=pr(e.item,"fallback"in e?{...e.children,unsupported:e.fallback}:e.children);return F(()=>t())})}function E(e){const t=O(()=>"if"in e?e.if??!1:!0);return O(()=>t()&&("when"in e?e.when!=null:!0)?"when"in e?(()=>{const n=e.children;return F(()=>n(e.when))})():e.children:e.fallback)}function _r(e,t){if(document.getSelection()?.isCollapsed===!1)return!1;let r=e;for(;r&&r!==t;){if(r instanceof HTMLElement&&(r.nodeName==="A"||r.nodeName==="BUTTON"||r.nodeName==="VIDEO"||r.nodeName==="AUDIO"||r.nodeName==="INPUT"||r.nodeName==="TEXTAREA"||r.nodeName==="IFRAME"||r.classList.contains("resizable-iframe")||r.classList.contains("handles-clicks")))return!1;r=r.parentNode}return!0}function Bt(e,t){if(!t.endsWith("s"))throw new Error("!s");return e===1?e+t.substring(0,t.length-1):e+t}function sl(e,t,n={}){const r=t-e;if(r<0)return[n.short??!1?"later":"in the future "+new Date(e).toISOString(),-r];if(r<60*1e3)return[n.short??!1?"now":"just now",60*1e3-r];let o=60*1e3,l=60;if(r<l*o){const s=r/o|0;return[n.short??!1?s+"m":Bt(s," minutes")+" ago",o-(r-s*o)]}if(o*=l,l=24,r<l*o){const s=r/o|0;return[n.short??!1?s+"h":Bt(s," hours")+" ago",o-(r-s*o)]}if(o*=l,l=30,r<l*o){const s=r/o|0;return[n.short??!1?s+"d":Bt(s," days")+" ago",o-(r-s*o)]}const i=new Date(e).getFullYear();return i===new Date(t).getFullYear()?[n.short??!1?new Date(e).toLocaleString(void 0,{month:"short"}):"in "+new Date(e).toLocaleString(void 0,{month:"long"}),-1]:[n.short??!1?""+i:"in "+i,-1]}function br(e,t={}){const[n,r]=L(Date.now());return O(()=>{const l=sl(e,n(),t);if(l[1]>0){const i=setTimeout(()=>r(Date.now()),Math.min(l[1]+10,2147483647));z(()=>clearTimeout(i))}return l[0]})}function yr(e){return(()=>{const t=il.cloneNode(!0);return v(t,()=>br(e.start)),P(n=>{const r=new Date(e.start).toString(),o=""+new Date(e.start);return r!==n._v$&&W(t,"datetime",n._v$=r),o!==n._v$2&&W(t,"title",n._v$2=o),n},{_v$:void 0,_v$2:void 0}),t})()}function al(e){const[t,n]=L(localStorage.getItem(e)),r=o=>{o.key===e&&n(o.newValue)};return window.addEventListener("storage",r),z(()=>window.removeEventListener("storage",r)),[t,o=>{o==null?localStorage.removeItem(e):localStorage.setItem(e,o),n(o)}]}function cl(e,t){return t==null||typeof t!="object"?!1:t.key===e.sym}function dl(e,t){const n=hn(e);return O(()=>{let r=n();return Array.isArray(r)||(r=[r]),r.filter(o=>o).map(t)})}function wr(){const e=Symbol(""+Math.random()),r=Object.assign(o=>({key:e,value:o,toString(){throw new Error("TypesafeChild not allowed in DOM")}}),{useChildren:o=>dl(o,l=>{if(!cl(r,l))throw console.log("Ebad_tsch_child",r,l),new Error("bad tsch child");return l.value}),sym:e});return r}function ul(e,t){return"status_msg"in e?{kind:"richtext",content:[D.p(D.error("Could not preview oembed",e))]}:e.url!=null?{kind:"link_preview",client_id:t,thumb:e.embed_url||e.image||void 0,click:e.embed_url?{kind:"captioned_image",url:e.embed_url,w:null,h:null}:{kind:"link",client_id:t,url:e.url,embed_html:e.html||void 0},click_enabled:!!(e.embed_url||e.html),title:e.title,description:e.description,url:e.url}:{kind:"reddit_suggested_embed",suggested_embed:e.html}}const bn=Symbol("store-raw"),kt=Symbol("store-node"),fl=Symbol("store-name");function xr(e,t){let n=e[Pe];if(!n){Object.defineProperty(e,Pe,{value:n=new Proxy(e,ml)});const r=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let l=0,i=r.length;l<i;l++){const s=r[l];if(o[s].get){const c=o[s].get.bind(n);Object.defineProperty(e,s,{get:c})}}}return n}function he(e){return e!=null&&typeof e=="object"&&(e[Pe]||!e.__proto__||e.__proto__===Object.prototype||Array.isArray(e))}function Ue(e,t=new Set){let n,r,o,l;if(n=e!=null&&e[bn])return n;if(!he(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,s=e.length;i<s;i++)o=e[i],(r=Ue(o,t))!==o&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let c=0,a=i.length;c<a;c++)l=i[c],!s[l].get&&(o=e[l],(r=Ue(o,t))!==o&&(e[l]=r))}return e}function $t(e){let t=e[kt];return t||Object.defineProperty(e,kt,{value:t={}}),t}function hl(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===Pe||t===kt||t===fl||(delete n.value,delete n.writable,n.get=()=>e[Pe][t]),n}function gl(e){if(dr()){const t=$t(e);(t._||(t._=en()))()}return Reflect.ownKeys(e)}function en(){const[e,t]=L(void 0,{equals:!1,internal:!0});return e.$=t,e}const ml={get(e,t,n){if(t===bn)return e;if(t===Pe)return n;const r=e[t];if(t===kt||t==="__proto__")return r;const o=he(r);if(dr()&&(typeof r!="function"||e.hasOwnProperty(t))){let l,i;o&&(l=$t(r))&&(i=l._||(l._=en()),i()),l=$t(e),i=l[t]||(l[t]=en()),i()}return o?xr(r):r},set(){return!0},deleteProperty(){return!0},ownKeys:gl,getOwnPropertyDescriptor:hl};function oe(e,t,n){if(e[t]===n)return;const r=Array.isArray(e),o=e.length,l=n===void 0,i=r||l===t in e;l?delete e[t]:e[t]=n;let s=$t(e),c;(c=s[t])&&c.$(),r&&e.length!==o&&(c=s.length)&&c.$(),i&&(c=s._)&&c.$()}function vl(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];oe(e,o,t[o])}}function Je(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,s=Array.isArray(e);if(Array.isArray(r)){for(let c=0;c<r.length;c++)Je(e,[r[c]].concat(t),n);return}else if(s&&i==="function"){for(let c=0;c<e.length;c++)r(e[c],c)&&Je(e,[c].concat(t),n);return}else if(s&&i==="object"){const{from:c=0,to:a=e.length-1,by:d=1}=r;for(let f=c;f<=a;f+=d)Je(e,[f].concat(t),n);return}else if(t.length>1){Je(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let l=t[0];typeof l=="function"&&(l=l(o,n),l===o)||r===void 0&&l==null||(l=Ue(l),r===void 0||he(o)&&he(l)&&!Array.isArray(l)?vl(o,l):oe(e,r,l))}function kr(e,t){const n=Ue(e||{}),r=xr(n);function o(...l){Le(()=>Je(n,l))}return[r,o]}function Re(e,t,n,r,o){const l=t[n];if(e===l)return;if(!he(e)||!he(l)||o&&e[o]!==l[o]){e!==l&&oe(t,n,e);return}if(Array.isArray(e)){if(e.length&&l.length&&(!r||o&&e[0][o]!=null)){let c,a,d,f,h,m,g,p;for(d=0,f=Math.min(l.length,e.length);d<f&&(l[d]===e[d]||o&&l[d][o]===e[d][o]);d++)Re(e[d],l,d,r,o);const $=new Array(e.length),N=new Map;for(f=l.length-1,h=e.length-1;f>=d&&h>=d&&(l[f]===e[h]||o&&l[f][o]===e[h][o]);f--,h--)$[h]=l[f];if(d>h||d>f){for(a=d;a<=h;a++)oe(l,a,e[a]);for(;a<e.length;a++)oe(l,a,$[a]),Re(e[a],l,a,r,o);l.length>e.length&&oe(l,"length",e.length);return}for(g=new Array(h+1),a=h;a>=d;a--)m=e[a],p=o?m[o]:m,c=N.get(p),g[a]=c===void 0?-1:c,N.set(p,a);for(c=d;c<=f;c++)m=l[c],p=o?m[o]:m,a=N.get(p),a!==void 0&&a!==-1&&($[a]=l[c],a=g[a],N.set(p,a));for(a=d;a<e.length;a++)a in $?(oe(l,a,$[a]),Re(e[a],l,a,r,o)):oe(l,a,e[a])}else for(let c=0,a=e.length;c<a;c++)Re(e[c],l,c,r,o);l.length>e.length&&oe(l,"length",e.length);return}const i=Object.keys(e);for(let c=0,a=i.length;c<a;c++)Re(e[i[c]],l,i[c],r,o);const s=Object.keys(l);for(let c=0,a=s.length;c<a;c++)e[s[c]]===void 0&&oe(l,s[c],void 0)}function ve(e,t={}){const{merge:n,key:r="id"}=t,o=Ue(e);return l=>!he(l)||!he(o)?o:(Re(o,{state:l},"state",n,r),l)}const $r={get(e,t){if(t===bn)return e;const n=e[t];return he(n)?new Proxy(n,$r):n},set(e,t,n){return oe(e,t,Ue(n)),!0},deleteProperty(e,t){return oe(e,t,void 0),!0}};function Ja(e){return t=>(he(t)&&e(new Proxy(t,$r)),t)}const pl=b("<style>.cfg-reddit-pfp {display: none;}</style>"),_l=b('<div class="block"><div class="w-22px h-22px flex items-center justify-center"><i></i></div></div>'),bl=b("<div><pre><code> </code></pre><button>Code</button> / <button>Retry</button></div>"),tn=fn();function xe(e){const n=At(tn)?.i??0,r=n+1;return u(tn.Provider,{value:{i:r},get children(){return e.children(n%2===0?"bg-postcolor-100":"bg-body",n)}})}const nn=fn();function Cr(e){const t=At(nn),n=O(()=>{const r=t?.visible()??!0,o=e.visible();return r?o:!1});return u(nn.Provider,{value:{visible:n},get children(){return e.children}})}function yn(){return At(nn)?.visible??(()=>!0)}const Nr=fn();function yl(e){return u(Nr.Provider,{get value(){return{pgin:()=>e.pgin,content:()=>e.pgin.page.content,addContent:e.addContent}},get children(){return e.children}})}function Sr(){return At(Nr)}function Er(){const e=Sr();if(!e)throw new Error("no page root context here.");return e}function ne(e,t,n){const r=()=>{const a=localStorage.getItem(e)??void 0;return n.deserialize?n.deserialize(a):a},[o,l]=L(r()),i=()=>{l(r())};return window.addEventListener("storage",i),Object.assign(()=>o()??t(),{base:t,override:o,setOverride:a=>{a==null?localStorage.removeItem(e):localStorage.setItem(e,n.serialize?n.serialize(a):a),i()}})}function Fn(e,t,n){const r=window.matchMedia(e),[o,l]=L(r.matches?t:n),i=()=>{l(()=>r.matches?t:n)};return r.addEventListener("change",i),z(()=>{r.removeEventListener("change",i)}),o}const wl=ue(()=>{const e={colorScheme:ne("color-scheme",Fn("(prefers-color-scheme: dark)","dark","light"),{}),authorPfp:ne("pfp-cfg",()=>"on",{}),updateNotifications:ne("update_notices",()=>"on",{}),customVideoControls:ne("custom_video_controls",()=>"browser",{}),pageVersion:ne("page_version",()=>"1",{}),linkHelpers:ne("link_helpers",()=>"show",{}),highlightRerenders:ne("cors_proxy",()=>"off",{}),galleryDisplay:ne("gallery_display",()=>"fullscreen",{}),motion:ne("motion",Fn("(prefers-reduced-motion: reduce)","reduce","full"),{}),animationTime:ne("animation_time",()=>.2,{serialize:t=>JSON.stringify(t),deserialize:t=>t!=null&&t!==""?JSON.parse(t):void 0}),animationDevMode:ne("animation_dev_mode",()=>"none",{}),signature:ne("signature",()=>"",{}),links:ne("links",()=>"new_tab",{})};return H(()=>{document.documentElement.classList.toggle("dark",e.colorScheme()==="dark")}),e});Tt(()=>u(E,{get if(){return te().authorPfp()==="off"},get children(){return pl.cloneNode(!0)}}),el("div").adto(document.head));function te(){return wl}const[zn,xl]=L(window.innerWidth);window.addEventListener("resize",()=>{xl(window.innerWidth)});const Ct=ue(e=>({sm:O(()=>zn()<640),lg:O(()=>zn()<1024)}));function j(...e){return e.flat().join(" ")}function kl(e){return(()=>{const t=_l.cloneNode(!0),n=t.firstChild,r=n.firstChild;return P(o=>{const l=e.icon.class+" "+e.size,i=e.icon.label;return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&W(r,"aria-label",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),t})()}function wn(e){const[t,n]=L(!0);return u(xo,{fallback:(r,o)=>(console.log(r),(()=>{const l=bl.cloneNode(!0),i=l.firstChild,s=i.firstChild,c=s.firstChild,a=i.nextSibling,d=a.nextSibling,f=d.nextSibling;return a.$$click=()=>console.log(r,e.data),f.$$click=()=>{n(!1),setTimeout(()=>n(!0),200),o()},P(h=>{const m=r instanceof Error?r.toString()+`

`+r.stack:"Something went wrong",g=G["outlined-button"],p=G["outlined-button"];return m!==h._v$3&&(c.data=h._v$3=m),g!==h._v$4&&(a.className=h._v$4=g),p!==h._v$5&&(f.className=h._v$5=p),h},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),l})()),get children(){return u(E,{get if(){return t()},get fallback(){return"Retrying..."},get children(){return e.children}})}})}ee(["click"]);const $l=b("<span></span>");function ge(e,t,n){const r=A(),o=Tt(()=>{const[l,i]=L(r.visible);return r.on("hide",()=>i(!1)),r.on("show",()=>i(!0)),u(Cr,{visible:l,get children(){return u(tn.Provider,{get value(){return{i:n.color_level}},get children(){return F(()=>t())}})}})},e);return r.on("cleanup",()=>o()),r}function ce(e){const t=yn();return(()=>{const n=$l.cloneNode(!0);return(r=>{H(()=>{const o=A(),l=e.getValue(o).adto(r);H(()=>{o.setVisible(t())}),z(()=>{o.cleanup(),l.remove()})})})(n),n})()}function Gn({h:e,s:t,l:n,a:r=1}){if(t===0){const[d,f,h]=[n,n,n].map(m=>Math.round(m*255));return{r:d,g:h,b:f,a:r}}const o=(1-Math.abs(2*n-1))*t,l=o*(1-Math.abs(e/60%2-1)),i=n-o/2,[s,c,a]=(e<60?[o,l,0]:e<120?[l,o,0]:e<180?[0,o,l]:e<240?[0,l,o]:e<300?[l,0,o]:[o,0,l]).map(d=>Math.round((d+i)*255));return{r:s,g:c,b:a,a:r}}function Nt(e){const{r:t,g:n,b:r,a:o}=e;return o!=null&&o<1?`rgba(${$e(t)}, ${$e(n)}, ${$e(r)}, ${$e(o,2)})`:`rgb(${$e(t)}, ${$e(n)}, ${$e(r)})`}function $e(e,t=0){const n=e.toFixed(t);if(t===0)return n;const r=n.indexOf(".");if(r>=0){const o=n.match(/0+$/);if(o)return o.index===r+1?n.substring(0,r):n.substring(0,o.index)}return n}function Cl(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}function Nl(e,t,n,r){return function(){e>>>=0,t>>>=0,n>>>=0,r>>>=0;let o=e+t|0;return e=t^t>>>9,t=n+(n<<3)|0,n=n<<21|n>>>11,r=r+1|0,o=o+r|0,n=n+o|0,(o>>>0)/4294967296}}function Pr(e){const t=Cl(e);return Nl(t(),t(),t(),t())}function Lr(e){const t=e()*360,n=e()*.5+.5,r=e(),o={h:t,s:n,l:r*.3+.2,a:1},l={...o,l:1-(r*.4+.1)};return[Gn(o),Gn(l)]}const Ut=b("<div></div>");let ct=!1;document.addEventListener("keydown",e=>{e.key==="Shift"&&(ct=!0)},{capture:!0});document.addEventListener("keyup",e=>{e.key==="Shift"&&(ct=!1)},{capture:!0});document.addEventListener("focus",e=>{ct=!1});function Ar(){const e=te();return F(()=>e.motion()==="reduce")?0:F(()=>ct&&e.animationDevMode()==="shift_slow"?3:e.animationTime())}function xn(e,t,n,r){const[o,l]=L(null);e.addEventListener("transitionend",i=>{i.target===i.currentTarget&&(l(null),r(n(),!1,!1))}),H(cr([n],()=>{const i=e.getBoundingClientRect(),s=Lt.getBoundingClientRect(),c=()=>5+Math.max(0,s.bottom,window.visualViewport.offsetTop),a=()=>window.visualViewport.offsetTop+window.visualViewport.height;console.log(i.top,i.bottom,c(),a());let d=0;if(i.top<c()&&i.bottom>c()){const g=document.documentElement.scrollTop;e.scrollIntoView(),document.documentElement.scrollTop-=c();const p=document.documentElement.scrollTop;d=g-p}const f=n();if(t.motion()==="reduce"||t.animationTime()===0){r(f,!1,!1);return}const h=Math.min(i.bottom,a())-i.top-d,m=document.documentElement.scrollTop;l(null),r(f,!1,!0),requestAnimationFrame(()=>{const g=e.getBoundingClientRect(),p=Math.min(g.bottom,a())-g.top;if(p===h){r(f,!1,!1);return}r(f,!0,!0),l(h),e.scrollTop=d,requestAnimationFrame(()=>{document.documentElement.scrollTop=m,e.scrollTop=d,l(p)})})},{defer:!0})),H(()=>{o()!=null?(console.log("ANIMATING",ct),e.style.height=o()+"px",e.style.overflow="hidden",e.style.transition=Ar()+"s height"):(e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition"))})}function Tr(e){const t=te(),[n,r]=L({main:e.when,animating:!1});return(()=>{const o=Ut.cloneNode(!0);return(l=>{xn(l,t,()=>e.when,(i,s,c)=>{r({main:i||s,animating:c})}),H(()=>{l.style.display=n().main||e.fallback!=null?"block":"none"})})(o),v(o,u(E,{get if(){return n().main||n().animating},get children(){const l=Ut.cloneNode(!0);return v(l,()=>e.children),P(()=>l.className=n().animating&&!n().main?"hidden":""),l}}),null),v(o,u(E,{get if(){return!n().main||n().animating},get children(){const l=Ut.cloneNode(!0);return v(l,()=>e.fallback),P(()=>l.className=n().animating&&n().main?"hidden":""),l}}),null),o})()}const Kn=b("<a></a>"),Or=b("<span></span>"),Sl=b("<button></button>");function El(e){const t=O(()=>{if(!e.allow_preview)return;const n=Ot(e.href,{});if(!n)return;const[r,o]=L(!1);return{visible:r,setVisible:o,body:n}});return[u(se,{get client_id(){return e.client_id},get href(){return e.href},get style(){return t()?"previewable":"normal"},get onClick(){return t()?()=>{const n=t();n.setVisible(!n.visible())}:void 0},get children(){return[M(()=>e.children),u(E,{get when(){return t()},children:n=>[" ",M(()=>n.visible()?"\u25BE":"\u25B8")]})]}}),u(E,{get when(){return t()},children:n=>u(Tr,{get when(){return n.visible()},get children(){return u(Q,{autoplay:!0,get body(){return n.body}})}})})]}function He(e){const t=O(()=>e.href==null?{kind:"none"}:It(e.client_id,e.href)),n=te();return u(K,{get item(){return t()},children:{error:r=>(()=>{const o=Kn.cloneNode(!0);return(l=>e.btnref?.(l))(o),o.$$click=l=>{l.stopPropagation(),alert(e.href)},v(o,()=>e.children),P(l=>{const i=e.class+" error",s=r.title;return i!==l._v$&&(o.className=l._v$=i),s!==l._v$2&&W(o,"title",l._v$2=s),l},{_v$:void 0,_v$2:void 0}),o})(),mailto:r=>(()=>{const o=Or.cloneNode(!0);return(l=>e.btnref?.(l))(o),v(o,()=>e.children),P(()=>W(o,"title",r.title)),o})(),link:r=>(()=>{const o=Kn.cloneNode(!0);return(l=>e.btnref?.(l))(o),o.$$click=l=>{if(!(!e.onClick&&!e.onClickNoPreventDefault)&&(e.onClickNoPreventDefault?.(l),l.stopPropagation(),!l.defaultPrevented&&l.button===0&&!Jr(l))){if(l.preventDefault(),e.onClick)return e.onClick(l);Fe({path:r.url})}},Uo(o,()=>r.external?n.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"}:{},!1,!0),v(o,()=>e.children),P(l=>{const i=e.class,s=r.url;return i!==l._v$3&&(o.className=l._v$3=i),s!==l._v$4&&W(o,"href",l._v$4=s),l},{_v$3:void 0,_v$4:void 0}),o})(),none:()=>(()=>{const r=Sl.cloneNode(!0);return(o=>e.btnref?.(o))(r),r.$$click=o=>{e.onClickNoPreventDefault?.(o),o.defaultPrevented||e.onClick?.(o)},v(r,()=>e.children),P(o=>{const l=e.class,i=e.disabled;return l!==o._v$5&&(r.className=o._v$5=l),i!==o._v$6&&(r.disabled=o._v$6=i),o},{_v$5:void 0,_v$6:void 0}),r})()}})}function se(e){return u(He,{get client_id(){return e.client_id},get class(){return G[e.style]+" outline-default"},get href(){return e.href},get onClick(){return e.onClick},get children(){return e.children}})}function Rr(e){const t=()=>{const[n,r]=Lr(Pr(e.color_hash.toLowerCase()));return{"--light-color":Nt(n),"--dark-color":Nt(r)}};return(()=>{const n=Or.cloneNode(!0);return v(n,u(se,{style:"userlink",get href(){return e.href},get client_id(){return e.client_id},get children(){return e.children}})),P(r=>_n(n,t(),r)),n})()}ee(["click"]);function Ir(e){if(typeof e.onClick!="string"&&"url"in e.onClick)return{href:e.onClick.url,client_id:e.client_id}}function Dr(e){if(typeof e.onClick!="string"&&typeof e.onClick=="function")return e.onClick}function Mr(e){return e.onClick==="disabled"}const Pl={"reddit-upvote":"text-$upvote-color","reddit-downvote":"text-$downvote-color",blue:"text-blue-600 dark:text-blue-500",green:"text-green-600 dark:text-green-500",white:"text-gray-300 dark:text-black",yellow:"text-yellow-600 dark:text-yellow-300",pink:"text-pink-500 dark:text-pink-300"};function Rt(e){return e==null?"":Pl[e]}const Ll={blue:["bg-blue-700","bg-blue-500"],green:["bg-green-700","bg-green-500"]};function Al(e,t){return e==null?"":Ll[e]?.[+t]??"bg-red-500"}function Vr(e){return u(He,{get btnref(){return e.btnref},get class(){return j("py-1 px-2 rounded-md","text-gray-600","hover:text-black","bg-gray-200 border-b-1 border-gray-500","dark:border-t-1 dark:border-b-0 dark:bg-white dark:border-gray-400",e.url!=null?"hover:underline":"","outline-default")},get onClick(){return e.onClick},get href(){return e.url?.href},get client_id(){return e.url?.client_id??"ENOCLILENTID"},get disabled(){return e.disabled},get children(){return e.children}})}const Tl=b('<div tabindex="0"></div>'),Ol=b('<div><div tabindex="0"></div><div tabindex="0"></div><div class="bg-gray-100 p-1 rounded-lg"></div><div tabindex="0"></div></div>'),[Rl,Il]=L(Symbol());function Dl(){Il(Symbol())}function Ml(e){const[t,n]=L({rect:new DOMRect(0,0,0,0),scroll:[0,0]}),[r,o]=L(!1),[l,i]=L(!1),s=a=>{o(d=>{const f=typeof a=="boolean"?a:a(d);return d!==f&&i(!0),f})};H(cr(Rl,()=>{s(!1)},{defer:!0}));let c;return[u(Vr,{btnref:a=>c=a,onClick:a=>{const d=a.target.getBoundingClientRect();n({rect:d,scroll:[window.scrollX,window.scrollY],closing:!1}),s(f=>!f)},get children(){return M(()=>typeof e.label=="function",!0)()?e.label(r):e.label}}),u(E,{get if(){return r()||l()},get children(){return(()=>{let a,d;const[f,h]=L(!1);H(()=>{const g=p=>{let $=p.target;for(;$;){if($===c||$===a)return;$=$.parentElement}s(!1)};document.addEventListener("click",g,{capture:!0,passive:!1}),z(()=>document.removeEventListener("click",g,{capture:!0}))});const m=document.createElement("div");return le.appendChild(m),z(()=>{m.remove()}),[(()=>{const g=Tl.cloneNode(!0);return g.addEventListener("focus",()=>d.focus()),g})(),u(Ko,{mount:m,get children(){const g=Ol.cloneNode(!0),p=g.firstChild,$=p.nextSibling,N=$.nextSibling,w=N.nextSibling;(k=>{a=k,k.style.transformOrigin="top right";const y=()=>{const T=Ar()/2;k.style.transition=T+"s opacity, "+T+"s transform"},x=()=>{k.style.transform="scale(0.95)",k.style.opacity="0",y(),k.style.transitionTimingFunction="ease-in"},C=()=>{k.style.transform="",k.style.opacity="",y(),k.style.transitionTimingFunction="ease-out"};x(),H(()=>{const T=r();requestAnimationFrame(()=>{requestAnimationFrame(()=>{T?C():x()})})}),H(()=>{f()?k.style.outline="1px dotted var(--outline-color)":k.style.outline=""})})(g),g.addEventListener("transitionend",k=>{k.target===k.currentTarget&&i(!1)}),g.style.setProperty("--dbtn-max-width","24rem"),g.style.setProperty("--dbtn-padding","1rem"),g.style.setProperty("--dbtn-left","max(calc(var(--dbtn-target-pos) - var(--dbtn-max-width)),calc(0px + var(--dbtn-padding)))"),g.style.setProperty("left","var(--dbtn-left)"),g.style.setProperty("right","calc(100vw - min(calc(var(--dbtn-left) + var(--dbtn-max-width)),100vw - var(--dbtn-padding)))"),g.style.setProperty("z-index","1000000000"),p.addEventListener("focus",()=>{c.focus()}),$.$$focusout=()=>{h(!1)},$.$$focusin=()=>{h(!0)};const S=d;return typeof S=="function"?S($):d=$,v(N,()=>e.children),w.addEventListener("focus",()=>{s(!1),c.focus()}),P(k=>{const y=j("absolute"),x=t().rect.bottom+t().scroll[1]+"px",C=t().rect.right+"px";return y!==k._v$&&(g.className=k._v$=y),x!==k._v$2&&g.style.setProperty("top",k._v$2=x),C!==k._v$3&&g.style.setProperty("--dbtn-target-pos",k._v$3=C),k},{_v$:void 0,_v$2:void 0,_v$3:void 0}),g}})]})()}})]}ee(["focusin","focusout"]);const Vl=b("<div></div>"),jl=b('<span class="ml-2"></span>');function Wl(e){return u(He,{onClickNoPreventDefault:t=>{Dl(),e.onClick?.(t)},get href(){return e.url?.href},get client_id(){return e.url?.client_id??"ENOCLILENTID"},get class(){return j("w-full block p-2 text-left hover:bg-gray-200","focus-visible:bg-gray-200 rounded-lg",e.url!=null?"hover:underline":"")},get disabled(){return e.disabled},get children(){const t=Vl.cloneNode(!0);return v(t,u(E,{get when(){return e.icon},children:n=>[n,jl.cloneNode(!0)]}),null),v(t,()=>e.children,null),P(()=>t.className="w-full "+e.class),t}})}const Bl=b("<i></i>");function kn(e){return(()=>{const t=Bl.cloneNode(!0);return P(n=>{const r=e.class+" "+e.tag+" "+(e.filled?"fas":"far"),o=e.label??void 0,l=e.label==null;return r!==n._v$&&(t.className=n._v$=r),o!==n._v$2&&W(t,"aria-label",n._v$2=o),l!==n._v$3&&W(t,"aria-hidden",n._v$3=l),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()}const Yn={comments:[!0,"fa-comment"],creation_time:[!0,"fa-clock"],edit_time:[!0,"fa-edit","fa-pencil"],up_arrow:[!1,"fa-arrow-up"],down_arrow:[!1,"fa-arrow-down"],controversiality:[!0,"fa-smile"],pinned:[!1,"fa-thumbtack"],bookmark:[!0,"fa-bookmark"],envelope:[!0,"fa-envelope"],envelope_open:[!0,"fa-envelope-open"],star:[!0,"fa-star"],join:[!0,"fa-plus-square"],heart:[!0,"fa-heart"],code:[!1,"fa-code"],link:[!1,"fa-link"],eye:[!0,"fa-eye"],reply:[!1,"fa-reply"],chevron_up:[!1,"fa-chevron-up"],chevron_down:[!1,"fa-chevron-down"]};function dt(e){return u(kn,{get tag(){return Yn[e.icon][1]},get filled(){return Yn[e.icon][0]?e.bold:!0},get label(){return e.label}})}function Ul(e){return u(Wl,{get icon(){return u(dt,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}})},get class(){return j(e.action.color==null?"":"font-bold",Rt(e.action.color))},get url(){return Ir(e.action)},get onClick(){return Dr(e.action)},get disabled(){return Mr(e.action)},get children(){return e.action.text}})}const Hl=b("<span> </span>");function ql(e){return u(Vr,{get url(){return Ir(e.action)},get onClick(){return Dr(e.action)},get disabled(){return Mr(e.action)},get children(){const t=Hl.cloneNode(!0),n=t.firstChild;return v(t,u(dt,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}}),n),v(t,()=>e.action.text,null),P(()=>t.className=e.action.color==null?void 0:"font-bold "+Rt(e.action.color)),t}})}const jr="@@!!ARRAY_KEY";//! flattens higherarchical page2 structure to a flat array
const ot={todo:(e,t)=>({kind:"todo",note:e,data:t}),err:(e,t)=>({kind:"error",note:e,data:t})};function Wr(e,t,n,r){const o=Ae(n,e);if(o.error!=null)return ot.err(o.error,e);const l=o.value,i=l.kind==="post"&&l.content.kind==="post"&&l.content.collapsible!==!1,s=l.kind==="post"&&l.content.kind==="post"&&l.content.collapsible!==!1?l.content.collapsible.default_collapsed:!1,c=_e(n.collapse_data,e,{default:s}).collapsed(),a=i?{id:e,threaded:!1,collapsed:c}:null;return{kind:"post",content:l,indent:r.threaded?t.map((d,f,h)=>f===h.length-1?{...d,threaded:!0}:d):t,collapse:a,first_in_wrapper:r.first_in_wrapper,is_pivot:r.is_pivot,at_or_above_pivot:r.at_or_above_pivot,threaded:r.threaded,depth:r.depth,id:e}}function Br(e,t){const n=[];function r(o){for(const l of o){const i=Ae(t,l);if(i.error!=null)n.push(Symbol("error; "+i.error));else{const s=i.value;s.kind==="loaded"?r(s.replies?.items??[]):n.push(l)}}}return r(e?.items??[]),n}function Ur(e,t,n,r){const o=[],l=Ae(n,e);if(l.error!=null)return o.push(ot.err(l.error,e)),o;const i=l.value,s=Wr(e,t,n,r);if(o.push(s),s.kind!=="post")return o;const c=s.indent.map(f=>f.threaded?{...f,threaded:!1}:f),a=[...c,...s.collapse?[s.collapse]:[]];if(i.kind==="post"&&i.content.kind==="post"?i.content.show_replies_when_below_pivot:!0){const f=Br(i.replies,n),h=f.length===1&&(r.threaded?!0:Ae(n,f[0]).value?.replies?.items.length===1);if(h&&r.threaded||!(s.collapse?.collapsed??!1))for(const m of f)o.push(...Ur(m,r.threaded&&h?c:a,n,{...r,first_in_wrapper:!1,threaded:h,depth:r.depth+1}))}return o}function _e(e,t,n){return F(()=>{const r=e.map.get(t);if(r==null){if(!n)throw new Error("accessing cstate before it has been created");const[o,l]=L(0),[i,s]=L(n.default),c={hovering:o,setHovering:l,collapsed:i,setCollapsed:s};return e.map.set(t,c),c}return r})}function Ae(e,t){const n=e.content;return Yo(n,t)}function Fl(e,t){const n=Ae(e,t);if(n.error!=null)throw console.log("Failed to read link. Link:",t,"Result:",n,"Searching in",e.content),new Error("Could not read link; "+n.error);return n.value}function zl(e,t){const n=[];function r(i){const s=Ae(t,i);if(s.error!=null)return n.push({error:s.error}),null;const c=s.value;if(c.kind==="loaded")for(const a of[...c.replies?.items??[]].reverse())r(a);else n.push({value:i});return c.parent}let o=e;for(;o;)o=r(o);const l=n[0];return l&&(l.pivot=!0),[...n].reverse()}function Jn(e,t){const n=[];e?.reply&&n.push(ot.todo("(add reply)",e));const r=Br(e,t);for(const o of r)n.push({kind:"wrapper_start"}),n.push(...Ur(o,[],t,{first_in_wrapper:!0,is_pivot:!1,at_or_above_pivot:!1,threaded:!1,depth:0})),n.push({kind:"wrapper_end"});return e!=null&&r.length===0&&n.push(ot.todo("*There are no replies*",e)),n}function Gl(e,t){const n=[];let r=null,o=null;const l=Fl(t,e),i=zl(e,t);for(const a of i){if(!("error"in a)){const d=Ae(t,a.value);if(d.value!=null&&d.value.kind==="post"&&d.value.content.kind==="page"){const f=d.value.content;if(r==null&&(r=Jn(f.wrap_page.sidebar,t)),o==null&&(a.pivot??!1)){o=f.wrap_page.header;continue}}}n.push({kind:"wrapper_start"}),"error"in a?n.push(ot.err(a.error,i)):n.push(Wr(a.value,[],t,{first_in_wrapper:!0,at_or_above_pivot:!0,is_pivot:a.pivot??!1,threaded:!1,depth:0})),n.push({kind:"wrapper_end"})}l.replies&&(n.push({kind:"horizontal_line"}),n.push(...Jn(l.replies,t))),console.log("FLATTEN RESULT",n,t,Object.entries(t.content).length);const s=a=>{const d=(()=>a.kind==="post"?{v:a.id}:(c+=1,{v:c}))();return{...a,[jr]:d.v}};let c=0;return{header:o??void 0,sidebar:r?.map(s),body:n.map(s)}}const Kl=b("<div></div>"),Yl=b('<button aria-label="Collapse"></button>');function Hr(e){let t=!1;return z(()=>{if(!e.id||!e.cstates)return;const n=_e(e.cstates,e.id);t&&n.setHovering(r=>r-1),t=!1}),(()=>{const n=Yl.cloneNode(!0);return n.addEventListener("mouseleave",()=>{if(!e.id||!e.cstates)return;const r=_e(e.cstates,e.id);t&&r.setHovering(o=>o-1),t=!1}),n.$$mouseover=()=>{if(!e.id||!e.cstates)return;const r=_e(e.cstates,e.id);t||r.setHovering(o=>o+1),t=!0},n.$$click=()=>e.onClick(),W(n,"draggable",!0),v(n,u(E,{get if(){return!e.collapsed_anim},get fallback(){return u(kn,{class:"mx-auto text-xs text-gray-600 dark:text-blue-400",tag:"fa-circle-plus",filled:!0,label:null})},get children(){const r=Kl.cloneNode(!0);return P(()=>r.className=j("w-3px mx-auto h-full",e.cstates&&e.id&&_e(e.cstates,e.id).hovering()>0?"bg-$collapse-line-color-hover":"bg-$collapse-line-color")),r}})),P(r=>{const o=j("w-15px box-border cursor-pointer min-h-13px","z-1 static outline-default",e.class??"",e.threaded??!1?"threaded-new":""),l=e.collapsed_raw,i=e.real?void 0:"-1",s=e.real?void 0:!0;return o!==r._v$&&(n.className=r._v$=o),l!==r._v$2&&W(n,"aria-pressed",r._v$2=l),i!==r._v$3&&W(n,"tabindex",r._v$3=i),s!==r._v$4&&W(n,"aria-hidden",r._v$4=s),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),n})()}ee(["click","mouseover"]);b("<span> points</span>");const Jl=b("<button></button>"),Xl=b('<div class="flex flex-col items-center gap-2px"></div>');function $n(e){const[t,n]=L(null);let r;return O(()=>{const o=Zr(e().client_id+"_"+e().unique_id,{count:e().count_excl_you,you:e().you,time:e().time});z(()=>{o.cleanup()});const{state:l,onupdate:i}=o.associated_data;return r=o.associated_data,n({...l}),i(()=>n({...l})),0})(),[t,o=>{Object.assign(r.state,o),r.emit()}]}async function Ql(e,t,n){if("error"in n.actions)throw await new Promise(o=>setTimeout(o,500)),new Error("counter is error: "+n.actions.error);const r=n.actions[e??"reset"];if(r==null)throw new Error("action "+e+" requested when it is not available.");await t.act(r)}async function qr(e,t,n,r){n({...t,loading:!0,your_vote:e});try{const o=await An(r.client_id);if(!o)throw new Error("missing client");await Ql(e,o,r),n({...t,loading:!1,your_vote:e})}catch(o){n({...t}),console.log(o),alert("Error while voting: "+o)}}function Xn(e){const[t,n]=$n(()=>e.counter),r=()=>t().your_vote===e.mode;return(()=>{const o=Jl.cloneNode(!0);return o.$$click=()=>{qr(r()?void 0:e.mode,t(),n,e.counter)},o.style.setProperty("font-size","15px"),o.style.setProperty("width","15px"),o.style.setProperty("height","15px"),v(o,u(dt,{get icon(){return r()?e.counter[e.mode].icon:e.counter.neutral_icon??e.counter[e.mode].icon},get label(){return e.counter[e.mode][r()?"undo_label":"label"]},get bold(){return r()}})),P(l=>{const i=Rt(r()?e.counter[e.mode].color:null),s=t().loading,c=r();return i!==l._v$&&(o.className=l._v$=i),s!==l._v$2&&(o.disabled=l._v$2=s),c!==l._v$3&&W(o,"aria-pressed",l._v$3=c),l},{_v$:void 0,_v$2:void 0,_v$3:void 0}),o})()}function Zl(e){return(()=>{const t=Xl.cloneNode(!0);return v(t,u(Xn,{get counter(){return e.counter},mode:"increment"}),null),v(t,u(E,{get if(){return e.counter.decrement!=null},get children(){return u(Xn,{get counter(){return e.counter},mode:"decrement"})}}),null),t})()}ee(["click"]);const Qn=b("<span></span>"),ei=b('<img class="inline-block w-4 h-4 align-middle object-contain">');function tt(e){return(()=>{const t=Qn.cloneNode(!0);return v(t,u(q,{get each(){return e.flairs},children:n=>[" ",(()=>{const r=Qn.cloneNode(!0);return v(r,u(q,{get each(){return n.elems},children:o=>u(K,{item:o,children:{text:l=>M(()=>l.text),emoji:l=>(()=>{const i=ei.cloneNode(!0);return P(s=>{const c=l.name,a=l.url,d=l.w,f=l.h;return c!==s._v$4&&W(i,"title",s._v$4=c),a!==s._v$5&&W(i,"src",s._v$5=a),d!==s._v$6&&W(i,"width",s._v$6=d),f!==s._v$7&&W(i,"height",s._v$7=f),s},{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),i})()}})})),P(o=>{const l=n.system!=null?{none:"",op:"text-blue-500",cake:"text-gray-500",admin:"text-red-500",moderator:"text-green-500",approved:"text-green-500",error:"text-red-500"}[n.system]:"rounded-full px-2"+(n.color!=null?" bg-flair-light dark:bg-flair-dark":" bg-gray-300")+(n.fg_color!=null?" flair-text-"+n.fg_color:""),i=n.color,s=n.color;return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&r.style.setProperty("--flair-color",o._v$2=i),s!==o._v$3&&r.style.setProperty("--flair-color-dark",o._v$3=s),o},{_v$:void 0,_v$2:void 0,_v$3:void 0}),r})()]})),t})()}function ti(e){return[u(E,{get if(){return e.post.info?.pinned===!0},get children(){return u(Ce,{icon:"pinned",value:["none",-1e3],color:"green",text:"Pinned"})}}),u(E,{get when(){return e.post.actions?.vote},children:t=>{const[n]=$n(()=>t),r=()=>n().pt_count;return[u(Ce,We(()=>{const o=r(),l=n();return{value:o==="hidden"?["hidden",-1e3]:o==="none"?["none",-1e3]:["number",o+{increment:1,decrement:-1,none:0}[l.your_vote??"none"]],icon:{none:t.neutral_icon??t.increment.icon,increment:t.increment.icon,decrement:t.decrement?.icon??t.increment.icon}[l.your_vote??"none"],color:{none:null,increment:t.increment.color,decrement:t.decrement?.color??t.increment.color}[l.your_vote??"none"],text:"Points",disabled:l.loading}})),u(E,{get when(){return t.percent},children:o=>u(Ce,{icon:"controversiality",value:["percent",o],color:null,text:"Controversiality"})})]}}),u(E,{get when(){return e.post.info?.comments},children:t=>u(Ce,{icon:"comments",value:["number",t],color:null,text:"Comments"})}),u(E,{get when(){return e.post.info?.creation_date},children:t=>u(Ce,{icon:"creation_time",value:["timeago",t],color:null,text:"Posted"})}),u(E,{get when(){return e.post.info?.edited},children:t=>u(Ce,{icon:"edit_time",get value(){return t.date==null?["none",-1e3]:["timeago",t.date]},color:null,text:"Edited"})})]}const Ce=wr();function ni(e){return Ce.useChildren(()=>u(ti,{get post(){return e()}}))}function Zn(e){return u(Se,We(()=>{const{action:t,state:n,setState:r,direction:o,client_id:l}=e,i=n.your_vote;return{icon:t[o].icon,color:i===o?t[o].color:null,text:i===o?t[o].undo_label:t[o].label,onClick:n.loading?"disabled":()=>{qr(i===o?void 0:o,n,r,t)},client_id:l}}))}function Ht(e){return u(K,{get item(){return e.action},fallback:t=>u(Se,{icon:"code",color:null,get text(){return"TODO "+t.kind},onClick:"disabled",client_id:"*UNUSED*"}),children:{counter:t=>{const[n,r]=$n(()=>t);return[u(Zn,We(()=>({action:t,state:n(),setState:r,direction:"increment",client_id:e.opts.client_id}))),u(E,{get if(){return t.decrement!=null},get children(){return u(Zn,We(()=>({action:t,state:n(),setState:r,direction:"decrement",client_id:e.opts.client_id})))}})]}}})}function ri(e){return[M((()=>{const t=M(()=>!!(e.opts.collapse_data&&e.opts.id&&e.post.collapsible!==!1&&!e.opts.is_pivot),!0);return()=>t()?u(Se,We(()=>{const n=_e(e.opts.collapse_data,e.opts.id),r=n.collapsed();return{icon:r?"chevron_down":"chevron_up",color:null,text:r?"Uncollapse":"Collapse",onClick:()=>n.setCollapsed(o=>!o),client_id:e.opts.client_id}})):null})()),M((()=>{const t=M(()=>e.opts.frame?.url!=null,!0);return()=>t()?u(Se,{icon:"link",color:null,get text(){return M(()=>e.post.info?.comments!=null,!0)()?e.post.info.comments.toLocaleString()+" comment"+(e.post.info.comments===1?"":"s"):"Comments"},get onClick(){return{url:e.opts.frame.url}},get client_id(){return e.opts.client_id}}):null})()),u(E,{get when(){return e.post.actions?.vote},children:t=>u(Ht,{action:t,get opts(){return e.opts}})}),u(E,{get when(){return e.opts.frame?.replies?.reply},children:t=>u(Se,{icon:"reply",color:null,text:"Reply",onClick:()=>alert("TODO"),get client_id(){return e.opts.client_id}})}),u(q,{get each(){return e.post.actions?.other??[]},children:t=>u(Ht,{action:t,get opts(){return e.opts}})}),u(E,{get when(){return e.post.actions?.code},get fallback(){return u(Se,{icon:"code",color:null,text:"Code",onClick:()=>{console.log(e.post,e.opts)},get client_id(){return e.opts.client_id}})},children:t=>u(Ht,{action:t,get opts(){return e.opts}})})]}const Se=wr();function oi(e,t){return Se.useChildren(()=>u(ri,{get post(){return e()},get opts(){return t()}}))}function Fr(e){if(e.kind==="array"){const n=e.body.filter(r=>r&&r.kind!=="none")[0];return n!=null?Fr(n):null}return e.kind==="text"||e.kind==="richtext"?{kind:"icon",icon:"text"}:e.kind==="captioned_image"||e.kind==="none"?null:e.kind==="video"?{kind:"icon",icon:"video"}:e.kind==="gallery"?{kind:"gallery",count:e.images.length}:e.kind==="link"?{kind:"icon",icon:"link"}:{kind:"icon",icon:"other"}}const er=b("<div></div>"),Ke={Container(e){return(()=>{const t=er.cloneNode(!0);return v(t,()=>e.children),P(()=>t.className=j("flex flex-wrap",{top:"items-start",center:"items-center",bottom:"items-end",baseline:"items-baseline"}[e.vertical],e.dir==="right"?"justify-end":"",e.gap==="2"?"gap-2":"")),t})()},Child(e){return(()=>{const t=er.cloneNode(!0);return v(t,()=>e.children),P(()=>t.className=j({top:"self-start",center:"self-center",bottom:"self-end",none:""}[e.vertical??"none"],e.fullwidth??!1?"flex-1":"")),t})()}},li=b("<span></span>"),ii=b('<div class="text-gray-500 flex flex-wrap gap-2 <sm:text-xs"></div>');function si(e){return e<1e4?""+e:e<1e5?(e/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"k":e<1e6?(e/1e3|0)+"k":e<1e8?(e/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"m":(e/1e6|0)+"m"}function ai({value:e}){if(e[0]==="none")return["",""];if(e[0]==="percent")return[" "+e[1].toLocaleString(void 0,{style:"percent"})," "+e[1].toLocaleString(void 0,{style:"percent"})];if(e[0]==="timeago")return[" "+br(e[1],{short:!0})()," "+new Date(e[1]).toLocaleString()];if(e[0]==="number")return[" "+si(e[1])," "+e[1].toLocaleString()];if(e[0]==="hidden")return[" \u2014"," Hidden"];mr(e[0])}function ci(e){const t=O(()=>ai(e.item)),n=()=>e.item.text+(e.item.value[0]==="none"?"":":");return(()=>{const r=li.cloneNode(!0);return v(r,u(dt,{get icon(){return e.item.icon},get bold(){return e.item.color!=null},get label(){return n()}}),null),v(r,()=>t()[0],null),P(o=>{const l=j(Rt(e.item.color),e.item.disabled??!1?"opacity-50":""),i=n()+t()[1];return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&W(r,"title",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),r})()}function tr(e){const t=ni(()=>e.post);return(()=>{const n=ii.cloneNode(!0);return v(n,u(q,{get each(){return t()},children:r=>u(ci,{item:r})})),n})()}const di=b('<img alt="" class="w-8 h-8 object-center inline-block rounded-full">'),rn=b("<div></div>"),ui=b('<div class="flex flex-col items-center mr-1 gap-2 sm:pr-1"></div>'),fi=b('<div role="heading"></div>'),hi=b("<div><div><div><div></div></div></div></div>"),gi=b('<div class="pl-2"></div>'),mi=b('<div class="mt-2"></div>'),vi=b("<section></section>"),pi=b('<div class="text-sm"><div class="mt-2"></div><div class="flex flex-wrap gap-2"></div></div>'),_i=b('<article><div class="flex-1"><div></div></div></article>'),bi=b("<button></button>"),yi=b('<img alt="">'),wi=b('<div><div class="whitespace-normal max-lines max-lines-1"></div></div>'),xi=b("<button>Show Anyway</button>");function ki(e){return(()=>{const t=di.cloneNode(!0);return P(()=>W(t,"src",e.src_url)),t})()}function $i(e){const t=O(()=>Fr(e.body));return M((()=>{const n=M(()=>t()!=null,!0);return()=>n()?(()=>{const r=rn.cloneNode(!0);return v(r,u(K,{get item(){return t()},children:{icon:o=>u(kn,{get tag(){return{text:"fa-file-lines",video:"fa-circle-play",link:"fa-arrow-up-right-from-square",other:"fa-asterisk"}[o.icon]},get filled(){return o.icon==="other"||o.icon==="link"},get label(){return{text:"Text",video:"Video",link:"Link",other:""}[o.icon]}}),gallery:o=>[M(()=>o.count),"."]}})),P(()=>r.className=j("absolute bottom-1 right-1","text-xs sm:text-base w-6 h-6 sm:w-8 sm:h-8 p-1 bg-gray-300","rounded-md")),r})():null})())}function zr(e){const[t,n]=e.opts.collapse_data&&e.opts.id?(()=>{if(e.opts.is_pivot)return L(!0);const p=_e(e.opts.collapse_data,e.opts.id);return[()=>!p.collapsed(),N=>!p.setCollapsed(w=>!(typeof N=="boolean"?N:N(!w)))]})():L(e.opts.is_pivot?!0:!(e.content.collapsible!==!1&&(e.opts.is_pivot?!1:e.content.collapsible.default_collapsed))),[r,o]=L(t()),[l,i]=L(!!(e.content.flair??[]).find(p=>p.content_warning)),s=()=>!!e.content.thumbnail||!!e.content.title,c=()=>!!e.content.thumbnail&&!r(),a=te(),[d,f]=L({visible:r(),animating:!1}),h=()=>!t()||e.opts.frame?.url!=null&&!e.opts.is_pivot,m=Sr(),g=oi(()=>e.content,()=>e.opts);return(()=>{const p=_i.cloneNode(!0),$=p.firstChild,N=$.firstChild;return(w=>xn(w,a,t,(S,k,y)=>{f({visible:k||S,animating:y}),o(S||k)}))(p),p.style.setProperty("--left-v","8px"),v(p,u(E,{get if(){return M(()=>e.content.collapsible!==!1&&(e.content.thumbnail!=null?!!r():!0),!0)()&&!Ct.sm()},get children(){const w=ui.cloneNode(!0);return v(w,u(E,{get when(){return e.content.actions?.vote},children:S=>(()=>{const k=rn.cloneNode(!0);return v(k,u(Zl,{counter:S})),P(()=>k.className=r()||c()?"":" hidden"),k})()}),null),v(w,u(Hr,{class:"flex-1",get collapsed_raw(){return!t()},get collapsed_anim(){return!r()},onClick:()=>{n(S=>!S)},real:!0,get cstates(){return e.opts.collapse_data},get id(){return e.opts.id}}),null),w}}),$),v($,u(Ke.Container,{dir:"right",vertical:"center",get children(){return[u(E,{get if(){return!r()},get when(){return e.content.thumbnail},children:w=>u(xe,{children:S=>u(Ke.Child,{get children(){const k=bi.cloneNode(!0);return k.$$click=()=>n(y=>!y),v(k,u(K,{item:w,children:{image:y=>(()=>{const x=yi.cloneNode(!0);return P(C=>{const T=y.url,R=j("w-full h-full object-cover rounded-md");return T!==C._v$6&&W(x,"src",C._v$6=T),R!==C._v$7&&(x.className=C._v$7=R),C},{_v$6:void 0,_v$7:void 0}),x})(),default:y=>["TODO ",M(()=>y.kind)]}}),null),v(k,u($i,{get body(){return e.content.body}}),null),P(()=>k.className=j("w-12 h-12 sm:w-16 sm:h-16 mr-4 rounded-md "+S,l()&&w.kind==="image"?"thumbnail-content-warning":"","block","relative")),k}})})}),u(Ke.Child,{fullwidth:!0,get children(){const w=hi.cloneNode(!0),S=w.firstChild,k=S.firstChild,y=k.firstChild;return w.$$click=x=>{if(!h()||!_r(x.target,x.currentTarget))return;x.stopPropagation();const C="/"+e.opts.client_id+e.opts.frame?.url;if(x.ctrlKey||x.metaKey||x.altKey){if(e.opts.frame?.url==null)return;window.open(C)}else{if(!t()){n(!0);return}if(e.opts.frame?.url==null)return;Fe({path:C,page:e.opts.id&&m?{pivot:e.opts.id,content:m.content()}:void 0})}},v(k,u(E,{get if(){return e.content.title!=null||e.content.flair!=null},get children(){const x=fi.cloneNode(!0);return v(x,u(E,{get when(){return e.content.title},children:C=>u(E,{get if(){return!e.opts.is_pivot},get when(){return e.opts.frame?.url},get fallback(){return C.text},children:T=>u(He,{get client_id(){return e.opts.client_id},href:T,class:"hover:underline",get children(){return C.text}})})}),null),v(x,u(tt,{get flairs(){return e.content.flair??[]}}),null),P(()=>x.className=j("text-black",e.opts.is_pivot&&r()?"text-3xl sm:text-2xl":"text-base")),x}}),y),v(y,u(E,{get when(){return e.content.author},children:x=>[u(E,{get if(){return M(()=>!!r(),!0)()&&a.authorPfp()==="on"},get when(){return x.pfp},fallback:"By ",children:C=>[u(ki,{get src_url(){return C.url}})," "]}),u(Rr,{get client_id(){return x.client_id},get href(){return x.link},get color_hash(){return x.color_hash},get children(){return x.name}})," "]}),null),v(y,u(E,{get if(){return r()||s()},get children(){return[u(E,{get when(){return e.content.author},children:x=>u(E,{get when(){return x.flair},children:C=>[u(tt,{flairs:C})," "]})}),u(E,{get when(){return e.content.info?.in},children:x=>[" in ",u(se,{get href(){return x.link},style:"previewable",get client_id(){return x.client_id},get children(){return x.name}})," "]})]}}),null),v(k,u(E,{get if(){return!e.opts.is_pivot||!r()},get children(){const x=rn.cloneNode(!0);return v(x,u(tr,{get post(){return e.content}})),x}}),null),v(k,u(Ke.Child,{fullwidth:!0,get children(){return u(E,{get if(){return!(r()||c())},get children(){return u(E,{get if(){return e.content.collapsible!==!1&&e.content.collapsible.default_collapsed===!0},get fallback(){return(()=>{const x=wi.cloneNode(!0),C=x.firstChild;return v(C,()=>"\u201C"+(()=>{const T=Et(e.content.body);return T.length>500?T.substring(0,500)+"\u2026":T})()+"\u201D"),x})()},get children(){return[]}})}})}}),null),P(x=>{const C="flex-1"+(h()?" hover-outline":""),T=j("text-gray-500","text-sm",r()||c()?"":"filter grayscale text-$collapsed-header-color italic"),R=j(["flex",e.content.thumbnail?"flex-col":["flex-row flex-wrap gap-2 items-baseline"]]);return C!==x._v$&&(w.className=x._v$=C),T!==x._v$2&&(S.className=x._v$2=T),R!==x._v$3&&(k.className=x._v$3=R),x},{_v$:void 0,_v$2:void 0,_v$3:void 0}),w}}),u(E,{get if(){return M(()=>!e.opts.is_pivot,!0)()&&(r()||c())},get children(){return u(Ke.Child,{vertical:"top",get children(){return[gi.cloneNode(!0),u(Ml,{label:"\u2026",get children(){return u(q,{get each(){return g()},children:w=>u(Ul,{action:w})})}})]}})}})]}}),N),v(N,u(Cr,{visible:()=>d().visible||d().animating,get children(){return[(()=>{const w=vi.cloneNode(!0);return v(w,u(E,{get if(){return d().visible||d().animating},get children(){return[u(E,{get if(){return M(()=>!!r(),!0)()&&c()},get children(){return mi.cloneNode(!0)}}),u(Tr,{get when(){return!l()},get fallback(){return["Content Warning:"," ",u(tt,{get flairs(){return(e.content.flair??[]).filter(S=>S.content_warning)}})," ",(()=>{const S=xi.cloneNode(!0);return S.$$click=()=>i(!1),P(()=>S.className=G["pill-filled"]),S})()]},get children(){return u(Q,{get body(){return e.content.body},autoplay:!1})}})]}})),P(()=>w.className=e.opts.is_pivot?"py-4":""),w})(),u(E,{get if(){return e.opts.is_pivot},get children(){const w=pi.cloneNode(!0),S=w.firstChild,k=S.nextSibling;return v(w,u(tr,{get post(){return e.content}}),S),v(k,u(q,{get each(){return g()},children:y=>u(ql,{action:y})})),w}})]}})),P(w=>{const S=j(e.opts.is_pivot?["text-base m-2"]:"text-sm","flex flex-row"),k=r()?"block":"none";return S!==w._v$4&&(p.className=w._v$4=S),k!==w._v$5&&N.style.setProperty("display",w._v$5=k),w},{_v$4:void 0,_v$5:void 0}),p})()}ee(["click"]);const Ci=b("<button>code</button>"),Gr=b("<div></div>");function Kr(e){return u(K,{get item(){return e.content},children:{post:t=>u(zr,{content:t,get opts(){return e.opts}}),page:()=>"TODO page",legacy:t=>u(ce,{getValue:n=>{const r=el("div").clss("-mt-10px -ml-10px"),o=el("div").clss("post text-sm").adto(r),l=ae(t.client_id);return Pn(l,t.thread,o,{clickable:!0}).defer(n),r}}),client:()=>"TODO client"}})}function Cn(e){const t=n=>["TODO support. also in the parent list these should probably"," ","be one of those navbars with bits like ClientName ",">"," PageName ",">"," \u2026"," ",(()=>{const r=Ci.cloneNode(!0);return r.$$click=()=>console.log(n),r})()];return(()=>{const n=Gr.cloneNode(!0);return v(n,u(wn,{get data(){return[e.listing,e.opts]},get children(){return u(K,{get item(){return e.listing},children:{page:r=>t(r),client:r=>t(r),post:r=>u(zr,{content:r,get opts(){return e.opts}}),legacy:r=>u(ce,{getValue:o=>{const l=ae(r.client_id);return Ne(l,r.thread,{clickable:e.opts.clickable}).defer(o)}})}})}})),n})()}function Nn(e){return u(xe,{children:(t,n)=>(()=>{const r=Gr.cloneNode(!0);return v(r,()=>e.children),P(()=>r.className=(n===0?"object-wrapper top-level-wrapper":"p-10px mt-10px rounded-xl")+" "+t+" "+(e.restrict_w??!1?"max-w-xl":"")),r})()})}ee(["click"]);const Ni=b("<span></span>"),Si=b('<span class="whitespace-pre-wrap"></span>'),Ei=b("<br>"),Pi=b('<button class="absolute top-0 left-0 bottom-0 right-0 w-full h-full rounded bg-spoiler-color hover:bg-spoiler-color-hover cursor-pointer" title="Click to reveal spoiler"></button>'),Li=b('<span class="relative bg-spoiler-color-hover rounded"><span></span></span>'),Ai=b('<img class="w-4 h-4 object-contain inline-block">'),Ti=b('<code class="bg-gray-200 p-1 rounded text-gray-800"></code>'),Oi=b("<p></p>"),Ri=b('<h1 class="text-3xl text-gray-900 font-black"></h1>'),Ii=b('<h2 class="text-2xl text-gray-900 font-bold"></h2>'),Di=b('<h3 class="text-xl text-gray-900 font-semibold"></h3>'),Mi=b('<h4 class="text-lg text-gray-900 font-medium"></h4>'),Vi=b('<h5 class="text-base text-gray-600 font-normal"></h5>'),ji=b('<h6 class="text-sm text-gray-600 font-normal underline"></h6>'),Wi=b('<div class="py-2"><div class="w-full h-2px bg-gray-400 rounded"></div></div>'),Bi=b('<blockquote class="border-l-2 border-gray-600 text-gray-600 pl-3"></blockquote>'),Ui=b('<li class="flex flex-row gap-2 items-baseline"><div></div><div class="flex-1"></div></li>'),Ee=b("<div></div>"),Hi=b('<ol class="list-none"></ol>'),qi=b('<ul class="list-none"></ul>'),Fi=b("<table><thead><tr></tr></thead><tbody></tbody></table>"),zi=b("<th></th>"),Gi=b("<tr></tr>"),Ki=b("<td></td>"),Yi=b('<select class="block"><option value="null">None</option></select>'),Ji=b('<pre tabindex="0"></pre>'),Xi=b("<button> </button>"),Qi=b("<option></option>"),Zi=b('<code class="!whitespace-pre-wrap"></code>'),es=b('<div class="my-2"></div>'),ts=b('<div class="max-lines max-lines-1 select-none"></div>'),ns=b('<div><div class="max-lines max-lines-1 break-all font-light text-gray-800 dark:text-gray-400 select-none"></div></div>'),rs=b('<div class="max-1-line break-all font-light text-gray-800 dark:text-gray-400 select-none"></div>'),os=b('<div class="inline-block"></div>'),ls={link:"normal","pill-empty":"pill-empty"};function is(e){const t=()=>(e.rts.style??"link")==="link",n=te();return(()=>{const r=Ni.cloneNode(!0);return v(r,u(wo,{get children(){return[u(Vt,{get when(){return e.rts.is_user_link!=null&&e.rts.is_user_link},children:o=>u(Rr,{get client_id(){return e.rts.client_id},color_hash:o,get href(){return e.rts.url},get children(){return u(pe,{get spans(){return e.rts.children}})}})}),u(Vt,{get when(){return M(()=>e.rts.is_user_link==null,!0)()&&t()},get children(){return u(El,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get allow_preview(){return n.linkHelpers()==="hide"},get children(){return u(pe,{get spans(){return e.rts.children}})}})}}),u(Vt,{get when(){return M(()=>e.rts.is_user_link==null,!0)()&&!t()},get children(){return u(se,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get style(){return ls[e.rts.style??"link"]},get children(){return u(pe,{get spans(){return e.rts.children}})}})}})]}})),P(()=>W(r,"title",e.rts.title)),r})()}function ss(e){return u(K,{get item(){return e.span},children:{text:t=>(()=>{const n=Si.cloneNode(!0);return v(n,()=>t.text),P(r=>{const o=t.styles.strong,l=t.styles.emphasis,i=t.styles.strikethrough,s=t.styles.superscript,c=t.styles.superscript;return o!==r._v$&&n.classList.toggle("font-bold",r._v$=o),l!==r._v$2&&n.classList.toggle("italic",r._v$2=l),i!==r._v$3&&n.classList.toggle("line-through",r._v$3=i),s!==r._v$4&&n.classList.toggle("align-top",r._v$4=s),c!==r._v$5&&n.classList.toggle("text-xs",r._v$5=c),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),n})(),link:t=>u(is,{rts:t}),br:()=>Ei.cloneNode(!0),spoiler:t=>{const[n,r]=L(!1);return(()=>{const o=Li.cloneNode(!0),l=o.firstChild;return v(o,u(E,{get if(){return!n()},get children(){const i=Pi.cloneNode(!0);return i.$$click=()=>r(!0),i}}),l),v(l,u(pe,{get spans(){return t.children}})),P(()=>l.className=j("rounded","transition-opacity","bg-spoiler-color-revealed",n()?"":"opacity-0 invisible")),o})()},emoji:t=>(()=>{const n=Ai.cloneNode(!0);return P(r=>{const o=t.url,l=t.name;return o!==r._v$6&&W(n,"src",r._v$6=o),l!==r._v$7&&W(n,"title",r._v$7=l),r},{_v$6:void 0,_v$7:void 0}),n})(),flair:t=>u(tt,{get flairs(){return[t.flair]}}),time_ago:t=>u(yr,{get start(){return t.start}}),error:t=>u(ce,{getValue:n=>I("error").atxt(t.text).onev("click",r=>{console.log(t.value)})}),code:t=>(()=>{const n=Ti.cloneNode(!0);return v(n,()=>t.text),n})()}})}function pe(e){return u(q,{get each(){return e.spans},children:t=>u(ss,{span:t})})}function as(e){return u(K,{get item(){return e.paragraph},children:{paragraph:t=>(()=>{const n=Oi.cloneNode(!0);return v(n,u(pe,{get spans(){return t.children}})),n})(),body:t=>u(Q,{get body(){return t.body},autoplay:!1}),heading:t=>{const n=()=>u(pe,{get spans(){return t.children}});return t.level===1?(()=>{const r=Ri.cloneNode(!0);return v(r,n),r})():t.level===2?(()=>{const r=Ii.cloneNode(!0);return v(r,n),r})():t.level===3?(()=>{const r=Di.cloneNode(!0);return v(r,n),r})():t.level===4?(()=>{const r=Mi.cloneNode(!0);return v(r,n),r})():t.level===5?(()=>{const r=Vi.cloneNode(!0);return v(r,n),r})():(()=>{const r=ji.cloneNode(!0);return v(r,n),r})()},horizontal_line:()=>Wi.cloneNode(!0),blockquote:t=>(()=>{const n=Bi.cloneNode(!0);return v(n,u(St,{get content(){return t.children}})),n})(),list:t=>{const n=O(()=>t.children.every(o=>o.kind==="tight_list_item"||o.children.length===1)),r=()=>u(q,{get each(){return t.children},children:(o,l)=>(()=>{const i=Ui.cloneNode(!0),s=i.firstChild,c=s.nextSibling;return v(s,(()=>{const a=M(()=>!!t.ordered,!0);return()=>a()?`${l()+1}. `:"- "})()),v(c,u(K,{item:o,children:{list_item:a=>u(St,{get content(){return a.children},get tight(){return n()}}),tight_list_item:a=>(()=>{const d=Ee.cloneNode(!0);return v(d,u(pe,{get spans(){return a.children}})),P(()=>d.classList.toggle("my-2",!n())),d})()}})),i})()});return t.ordered?(()=>{const o=Hi.cloneNode(!0);return v(o,r),o})():(()=>{const o=qi.cloneNode(!0);return v(o,r),o})()},code_block:t=>u(us,{get text(){return t.text},get default_language(){return t.lang??null}}),table:t=>(()=>{const n=Fi.cloneNode(!0),r=n.firstChild,o=r.firstChild,l=r.nextSibling;return v(o,u(q,{get each(){return t.headings},children:i=>(()=>{const s=zi.cloneNode(!0);return v(s,u(pe,{get spans(){return i.children}})),P(()=>s.className=nr[i.align??"none"]),s})()})),v(l,u(q,{get each(){return t.children},children:i=>(()=>{const s=Gi.cloneNode(!0);return v(s,u(q,{each:i,children:(c,a)=>(()=>{const d=Ki.cloneNode(!0);return v(d,u(pe,{get spans(){return c.children}})),P(()=>d.className=nr[t.headings[a()]?.align??"none"]),d})()})),s})()})),n})()}})}const nr={left:"text-left",center:"text-center",right:"text-right",none:""},[Xe,cs]=L(void 0);let qt=!1;function ds(){(!Xe()||qt)&&(qt=!0,J(()=>import("./prismjs.a7ea4413.js").then(function(e){return e.p}),["assets/prismjs.a7ea4413.js","assets/_commonjsHelpers.2cf1d77b.js"]).then(e=>cs(e)).catch(e=>{alert("error loading syntax highlighter"),qt=!1,console.log(e)}))}function us(e){const[t,n]=L(e.default_language);H(()=>n(e.default_language));const[r,o]=L(null),l=()=>e.text.length<1e4,[i,s]=L(!1);return H(()=>{(t()!=null||i())&&ds()}),H(()=>{if(!l())return;let c=!0;z(()=>c=!1),o(null),Xe()&&t()!=null&&Xe().highlight(e.text,t()??"plaintext").then(a=>{c&&(o(a),a==null&&console.log("syn hl language not supported",t()))}).catch(a=>{console.log(a),alert("error highlighting")})}),(()=>{const c=Ji.cloneNode(!0);return v(c,u(E,{get if(){return l()},get children(){const a=Ee.cloneNode(!0);return v(a,u(E,{get if(){return M(()=>!!Xe(),!0)()&&i()},get fallback(){return(()=>{const d=Xi.cloneNode(!0),f=d.firstChild;return d.$$click=()=>{s(h=>!h)},v(d,()=>t()??"None",f),v(d,()=>i()?"\u25B4":"\u25BE",null),P(()=>d.className=j(["font-sans"])),d})()},get children(){const d=Yi.cloneNode(!0);return d.firstChild,d.$$input=f=>{const h=f.currentTarget.value;n(h==="null"?null:h)},v(d,u(q,{get each(){return Xe().listLanguages().sort((f,h)=>f.localeCompare(h))},children:f=>(()=>{const h=Qi.cloneNode(!0);return h.value=f,v(h,f),h})()}),null),d}})),P(()=>a.className=j(["absolute","top-0 right-0","transition-opacity","opacity-0","group-hover:opacity-100","group-focus:opacity-100","focus:opacity-100","bg-gray-100 rounded","p-2 px-3"])),a}}),null),v(c,u(E,{get when(){return r()},get fallback(){return(()=>{const a=Zi.cloneNode(!0);return v(a,()=>e.text),a})()},children:a=>(()=>{const d=Ee.cloneNode(!0);return d.innerHTML=a,d})()}),null),P(()=>c.className=j(["bg-gray-200 p-2 rounded text-gray-800","relative","group","outline-default","language-"+(t()??"none"),"!whitespace-pre-wrap"])),c})()}function fs(e){const t=te(),n=O(()=>{const i=Ot(e.link.url,{});if(!i)return;const[s,c]=L(!1);return{visible:s,toggleVisible:()=>c(a=>!a),body:i}}),r=O(()=>{const i=It(e.link.client_id,e.link.url);return i.kind==="link"?{link:i.url,external:i.external}:{link:"error",external:!0}}),[o,l]=L({open:!1,temporary:!1});return u(E,{get if(){return r().link!=="error"},get children(){const i=es.cloneNode(!0);return v(i,u(xe,{children:s=>u(He,{get client_id(){return e.link.client_id},get class(){return j("p-2 px-4","block",s,"rounded-xl",o().open?"rounded-b-none":"")},get href(){return e.link.url},get onClick(){return n()?()=>{n().toggleVisible()}:void 0},get children(){return[(()=>{const c=ts.cloneNode(!0);return v(c,u(E,{get when(){return n()},children:a=>M(()=>a.visible()?"\u25BE ":"\u25B8 ")}),null),v(c,()=>e.link.title,null),c})(),u(E,{get if(){return!o().open||o().temporary},get children(){const c=ns.cloneNode(!0),a=c.firstChild;return v(a,u(E,{get if(){return M(()=>!n(),!0)()&&r().external},get children(){return[u(rr,{})," "]}}),null),v(a,()=>r().link,null),P(()=>c.style.setProperty("display",o().open?"none":"block")),c}})]}})}),null),v(i,u(E,{get when(){return n()},children:s=>[(()=>{const c=Ee.cloneNode(!0);return(a=>xn(a,t,s.visible,(d,f,h)=>{l({open:d||f,temporary:h})}))(c),v(c,u(E,{get if(){return o().open||o().temporary},get children(){const a=Ee.cloneNode(!0);return v(a,u(Q,{get body(){return s.body},autoplay:!0})),P(()=>a.style.setProperty("display",o().open?"block":"none")),a}})),c})(),u(E,{get if(){return o().open||o().temporary},get children(){const c=Ee.cloneNode(!0);return v(c,u(xe,{children:a=>u(He,{get client_id(){return e.link.client_id},get class(){return j("p-2 px-4","block",a,"rounded-xl rounded-t-none")},get href(){return e.link.url},get children(){const d=rs.cloneNode(!0);return v(d,u(E,{get if(){return r().external},get children(){return[u(rr,{})," "]}}),null),v(d,()=>r().link,null),d}})})),P(()=>c.style.setProperty("display",o().open?"block":"none")),c}})]}),null),i}})}function St(e){const t=te();return u(q,{get each(){return e.content},children:n=>[(()=>{const r=Ee.cloneNode(!0);return v(r,u(as,{paragraph:n})),P(()=>r.classList.toggle("my-2",!(e.tight??!1))),r})(),u(E,{get if(){return t.linkHelpers()==="show"},get children(){return u(q,{get each(){return gs(n)},children:r=>u(fs,{link:r})})}})]})}function hs(e){return u(St,{get content(){return e.content}})}function rr(){return(()=>{const e=os.cloneNode(!0);return v(e,u(kl,{size:"icon-sm",icon:{class:"icon-external",label:"External"}})),e})()}function gs(e){return at(e,{paragraph:t=>Ie(t.children),body:()=>[],heading:t=>Ie(t.children),horizontal_line:()=>[],blockquote:()=>[],list:t=>t.children.flatMap(n=>n.kind==="tight_list_item"?Ie(n.children):[]),code_block:()=>[],table:t=>[...t.headings.flatMap(n=>Ie(n.children)),...t.children.flatMap(n=>n.flatMap(r=>Ie(r.children)))]})}function Ie(e){return e.flatMap(t=>at(t,{link:n=>[{title:nt(n.children),url:n.url,client_id:n.client_id}],error:()=>[],text:()=>[],br:()=>[],spoiler:n=>Ie(n.children),emoji:()=>[],flair:()=>[],time_ago:()=>[],code:()=>[]}))}function on(e){return e.map(t=>at(t,{paragraph:n=>nt(n.children),body:n=>Et(n.body),heading:n=>nt(n.children),horizontal_line:n=>"---",blockquote:n=>on(n.children),list:n=>n.children.map((r,o)=>{const l=n.ordered?""+o+". ":"\u2022 ";if(r.kind==="tight_list_item")return l+nt(r.children);if(r.kind==="list_item")return l+on(r.children);mr(r)}).join(`
`),code_block:n=>n.text,table:()=>"[table]"})).join(`
`)}function nt(e){return e.map(t=>at(t,{link:n=>nt(n.children),error:n=>"[error]",text:n=>n.text,br:()=>`
`,spoiler:n=>"[spoiler]",emoji:n=>":"+n.name+":",flair:()=>"[flair]",time_ago:()=>"[time ago]",code:n=>n.text})).join("")}ee(["click","input"]);const De=b("<div></div>"),ms=b("<div><div></div></div>"),vs=b('<div><div class="border p-2"><div class="font-bold"></div><div></div></div></div>'),ps=b("<button></button>"),_s=b("<div>Loading...</div>"),bs=b("<div><div>TODO polls are currently not supported</div><ul></ul></div>"),ys=b("<li> (<!>)</li>"),ws=b("<div>Caption: </div>"),xs=b("<audio></audio>"),ks=b('<div><h1 class="text-base font-light"><svg aria-label="Mastodon" class="preview-image" viewBox="0 0 713.35878 175.8678" style="fill: currentColor;"><use href="/images/mastodon/Logotype (Full).svg#base" width="713.35878" height="175.8678"></use></svg></h1><h2 class="text-2xl font-black py-1">Select your instance</h2><div class="py-1"><label>Instance Name: <input class="border rounded-md p-1" placeholder="mastodon.social"></label><button>Go \u2192</button></div><p class="py-2">Not on mastodon? Join at </p><p class="py-2">Note that some instances may require logging in before they let you view timelines.</p></div>'),$s=b('<div><button>Retry</button><span class="text-red-500"></span></div>'),Cs=b("<button><img></button>"),Ns=b("<button>Prev</button>"),Ss=b("<button>Next</button>"),Es=b("<button>Gallery</button>"),Ps=yo(()=>J(()=>import("./preview_video.f2c9727a.js"),[]));function Q(e){return u(wn,{get data(){return e.body},get children(){return u(Ls,{get body(){return e.body},get autoplay(){return e.autoplay}})}})}function Ls(e){return u(K,{get item(){return e.body},children:{text:t=>{const[n]=Yt(()=>JSON.parse(JSON.stringify(t)),o=>va(o)),r=O(o=>n()??o,void 0);return(()=>{const o=De.cloneNode(!0);return v(o,u(E,{get when(){return r()},get fallback(){return"Loading\u2026"},children:l=>u(Q,{body:l,autoplay:!1})})),P(()=>o.className=n.loading?"opacity-50":"opacity-100"),o})()},link:t=>{const n=O(()=>{const r=Ot(t.url,{suggested_embed:t.embed_html});if(!!r)return{body:r}});return(()=>{const r=ms.cloneNode(!0),o=r.firstChild;return v(o,u(se,{get client_id(){return t.client_id},get href(){return t.url},style:"normal",get children(){return t.url}})),v(r,u(E,{get when(){return n()},children:l=>u(Q,{get body(){return l.body},get autoplay(){return e.autoplay}})}),null),r})()},none:()=>[],gallery:t=>u(Os,{get images(){return t.images}}),removed:t=>{const[n,r]=L({kind:"none"});return(()=>{const o=vs.cloneNode(!0),l=o.firstChild,i=l.firstChild,s=i.nextSibling;return v(i,()=>t.removal_message.title),v(s,()=>t.removal_message.body),v(l,u(E,{get when(){return(n().kind!=="loaded"?!0:void 0)&&t.fetch_path},children:c=>{const a=async()=>{const d=await An(t.client_id);let f,h=!1;if(r({kind:"loading"}),!d)throw new Error("invalid client");if(!d.fetchRemoved)throw new Error("client provided a removal fetch path but has no fetchRemoved");try{f=await d.fetchRemoved(c)}catch(m){const g=m;h=!0,console.log(g),f={kind:"text",client_id:"n/a",content:"Error! "+g.toString(),markdown_format:"none"}}console.log("Got new body:",f),r({kind:h?"error":"loaded",body:f})};return(()=>{const d=ps.cloneNode(!0);return d.$$click=()=>{a().catch(console.log)},v(d,()=>({none:"View",loading:"...",error:"Retry",loaded:"never"})[n().kind]),P(f=>{const h=G["outlined-button"],m=n().kind==="loading"||n().kind==="loaded";return h!==f._v$&&(d.className=f._v$=h),m!==f._v$2&&(d.disabled=f._v$2=m),f},{_v$:void 0,_v$2:void 0}),d})()}}),null),v(o,u(Q,{get body(){return t.body},get autoplay(){return e.autoplay}}),null),v(o,u(K,{get item(){return n()},children:{none:()=>[],loading:()=>_s.cloneNode(!0),error:c=>(()=>{const a=De.cloneNode(!0);return v(a,u(Q,{get body(){return c.body},autoplay:!1})),a})(),loaded:c=>(()=>{const a=De.cloneNode(!0);return v(a,u(Q,{get body(){return c.body},autoplay:!1})),a})()}}),null),o})()},crosspost:t=>u(Nn,{restrict_w:!0,get children(){return u(Cn,{get listing(){return{kind:"legacy",thread:t.source,client_id:t.client_id}},get opts(){return{clickable:!0,client_id:t.client_id,frame:null,replies:null,at_or_above_pivot:!1,is_pivot:!1}}})}}),richtext:t=>(()=>{const n=De.cloneNode(!0);return v(n,u(hs,{get content(){return t.content}})),n})(),poll:t=>(()=>{const n=bs.cloneNode(!0),r=n.firstChild,o=r.nextSibling;return v(o,u(q,{get each(){return t.choices},children:l=>(()=>{const i=ys.cloneNode(!0),s=i.firstChild,c=s.nextSibling;return c.nextSibling,v(i,()=>l.name,s),v(i,()=>l.votes==="hidden"?"hidden":"Vote(s)",c),i})()})),n})(),captioned_image:t=>(()=>{const n=De.cloneNode(!0);return v(n,u(ce,{getValue:()=>{const r=el("div");return $a(t.url,{w:t.w??void 0,h:t.h??void 0,alt:t.alt}).adto(r),r}}),null),v(n,u(E,{get when(){return t.caption},children:r=>(()=>{const o=ws.cloneNode(!0);return o.firstChild,v(o,r,null),o})()}),null),n})(),video:t=>u(Ps,{video:t,get autoplay(){return e.autoplay}}),audio:t=>(()=>{const n=xs.cloneNode(!0);return(r=>{const o=yn();H(()=>{o()||r.pause()})})(n),n.controls=!0,v(n,()=>t.alt??"Audio is not supported and alt text was not provided"),P(r=>{const o=t.url,l=e.autoplay;return o!==r._v$3&&W(n,"src",r._v$3=o),l!==r._v$4&&(n.autoplay=r._v$4=l),r},{_v$3:void 0,_v$4:void 0}),n})(),array:t=>u(q,{get each(){return t.body},children:n=>n?u(Q,{body:n,autoplay:!1}):null}),gfycatv1:t=>u(ce,{getValue:n=>{const r=el("div");return ha(t.host,t.id,{autoplay:e.autoplay}).defer(n).adto(r),r}}),gfycatv2:t=>u(As,{data:t}),imgur:t=>u(ce,{getValue:n=>{const r=el("div");return ka(t.imgur_kind,t.imgur_id).defer(n).adto(r),r}}),youtube:t=>u(ce,{getValue:n=>{const r=el("div");return xa(t.id,t.search,{autoplay:e.autoplay}).defer(n).adto(r),r}}),twitch_clip:t=>{const[n]=Yt(t.slug,wa);return u(E,{get when(){return n()},children:r=>u(Q,{body:r,autoplay:!1})})},reddit_suggested_embed:t=>u(ce,{getValue:n=>{const r=el("div");return ya(t.suggested_embed).defer(n).adto(r),r}}),link_preview:t=>u(ce,{getValue:n=>{const r=el("div");return _a(t.client_id,t).defer(n).adto(r),r}}),oembed:t=>u(ce,{getValue:n=>{const r=el("div");return ba(t).defer(n).adto(r),r}}),mastodon_instance_selector:t=>{const[n,r]=L(""),o=O(()=>{const i=n();return i.trim()?i.indexOf("/")>-1?!1:i.indexOf(".")!==-1:!1}),l=()=>{!o()||Fe({path:"/"+t.client_id+"/"+n().replaceAll("/","-")})};return(()=>{const i=ks.cloneNode(!0),s=i.firstChild,c=s.nextSibling,a=c.nextSibling,d=a.firstChild,f=d.firstChild,h=f.nextSibling,m=d.nextSibling,g=a.nextSibling;return g.firstChild,s.style.setProperty("max-width","6rem"),h.$$keydown=p=>{p.key==="Enter"&&l()},h.$$input=p=>r(p.currentTarget.value),m.$$click=()=>{l()},v(g,u(se,{client_id:"",style:"normal",href:"https://joinmastodon.org",children:"joinmastodon.org"}),null),P(p=>{const $=n(),N=!o(),w=G[o()?"pill-filled":"pill-empty"];return $!==p._v$5&&(h.value=p._v$5=$),N!==p._v$6&&(m.disabled=p._v$6=N),w!==p._v$7&&(m.className=p._v$7=w),p},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),i})()}}})}function Et(e){return at(e,{text:()=>"[text]",richtext:t=>on(t.content),link:t=>t.url,captioned_image:()=>"[image]",video:()=>"[video]",gfycatv1:()=>"[gif]",gfycatv2:()=>"[gif]",youtube:()=>"[video]",imgur:()=>"[images]",twitch_clip:()=>"[video]",oembed:()=>"[link]",reddit_suggested_embed:()=>"[content]",audio:()=>"[audio]",gallery:()=>"[gallery]",poll:()=>"[poll]",none:()=>"",removed:t=>Et(t.body),crosspost:()=>"[crosspost]",array:t=>t.body.map(n=>n?Et(n):"").join(`
`),link_preview:t=>t.url,mastodon_instance_selector:()=>"[mastodon instance selector]"})}function As(e){const[t,n]=L({kind:"loading"}),[r,o]=L(Symbol());return H(()=>{r();let l=!0;z(()=>l=!1);const i=e.data;Qo(i.host,i.id).then(s=>{!l||n({kind:"loaded",frame:s})}).catch(s=>{!l||(console.log("got error",s,s.stack),n({kind:"error",message:s.toString()}))})}),u(Nn,{restrict_w:!0,get children(){return u(K,{get item(){return t()},children:{loading:()=>"loading...",loaded:({frame:l})=>u(Cn,{get listing(){return l.content},get opts(){return{clickable:!0,client_id:l.client_id,frame:l,replies:null,at_or_above_pivot:!1,is_pivot:!1}}}),error:l=>(()=>{const i=$s.cloneNode(!0),s=i.firstChild,c=s.nextSibling;return s.$$click=()=>{n({kind:"loading"}),o(Symbol())},v(c,()=>l.message),i})()}})}})}function Ts(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top+(window.pageYOffset??document.documentElement.scrollTop),w:t.width,h:t.height}}function Os(e){const[t,n]=kr({kind:"overview"}),[r,o]=L({enabled:!1,index:0,loading:!1}),l=te(),i=O(()=>e.images.every(h=>h.body.kind==="captioned_image")),s=()=>i()&&l.galleryDisplay()==="fullscreen";let c;const a=h=>{n(ve({kind:"overview",fullscreen_index:h},{merge:!0}));const m=c.querySelector(".img-"+h);if(!m)return{x:0,y:0,w:0};const g=Ts(m),p=e.images[h];if(p&&p.aspect!=null)if(p.aspect>1){const $=g.h;g.h=g.w*(1/p.aspect),g.y+=($-g.h)/2}else{const $=g.w;g.w=g.h*p.aspect,g.x+=($-g.w)/2}return g};let d;z(()=>{d&&d()});const f=yn();return H(()=>{f()||d&&d()}),(()=>{const h=De.cloneNode(!0),m=c;return typeof m=="function"?m(h):c=h,v(h,u(K,{item:t,children:{overview:g=>u(xe,{children:p=>u(q,{get each(){return e.images},children:($,N)=>(()=>{const w=Cs.cloneNode(!0),S=w.firstChild;return w.$$click=()=>{s()?(o({enabled:!0,index:N(),loading:!0}),J(()=>import("./gallery.1dc7e4ca.js"),["assets/gallery.1dc7e4ca.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(k=>{o({enabled:!0,index:N(),loading:!1}),d&&d();const y=k.showGallery(e.images,N(),a,{onclose:()=>{console.log("gallery closed"),o(x=>({...x,enabled:!1}))},setIndex:x=>{o({enabled:!0,index:x,loading:!1})}});d=()=>{y.cleanup(),n(ve({kind:"overview",fullscreen_index:void 0},{merge:!0}))}}).catch(k=>{console.log("Error loading gallery component",k),n(ve({kind:"image",index:N()},{merge:!0}))})):n(ve({kind:"image",index:N()},{merge:!0}))},P(k=>{const y=j("m-1 inline-block rounded-md",p),x=$.thumb??"error",C=j("w-24 h-24 object-contain img-"+N(),r().enabled&&r().index===N()?r().loading?"opacity-50":"opacity-0":"");return y!==k._v$8&&(w.className=k._v$8=y),x!==k._v$9&&W(S,"src",k._v$9=x),C!==k._v$10&&(S.className=k._v$10=C),k},{_v$8:void 0,_v$9:void 0,_v$10:void 0}),w})()})}),image:g=>[(()=>{const p=Ns.cloneNode(!0);return p.$$click=()=>n(ve({kind:"image",index:g.index-1},{merge:!0})),P($=>{const N=G["outlined-button"],w=g.index<=0;return N!==$._v$11&&(p.className=$._v$11=N),w!==$._v$12&&(p.disabled=$._v$12=w),$},{_v$11:void 0,_v$12:void 0}),p})(),M(()=>g.index+1),"/",M(()=>e.images.length),(()=>{const p=Ss.cloneNode(!0);return p.$$click=()=>n(ve({kind:"image",index:g.index+1},{merge:!0})),P($=>{const N=G["outlined-button"],w=g.index>=e.images.length-1;return N!==$._v$13&&(p.className=$._v$13=N),w!==$._v$14&&(p.disabled=$._v$14=w),$},{_v$13:void 0,_v$14:void 0}),p})(),(()=>{const p=Es.cloneNode(!0);return p.$$click=()=>n(ve({kind:"overview"},{merge:!0})),P(()=>p.className=G["outlined-button"]),p})(),u(Q,{get body(){return e.images[g.index].body},autoplay:!0})]}})),h})()}ee(["click","input","keydown"]);const Rs=b('<div class="flex justify-center flex-row"><div class="w-full max-w-prose"><div class="bg-white p-5 sm:m-5 sm:p-10 shadow sm:rounded-xl"><header><h1 class="text-3xl sm:text-5xl font-black">ThreadClient</h1><h2 class="text-base font-light text-gray-800 dark:text-gray-400">A client for Reddit and Mastodon</h2></header><div class="mt-10"></div><main><p>Try for </p><p>Try for </p></main><div class="mt-10"></div><footer><p class="text-gray-800 dark:text-gray-400"> \xB7 <!> \xB7 </p></footer><div class="mt-2"></div></div></div></div>');function Is(e){return(()=>{const t=Rs.cloneNode(!0),n=t.firstChild,r=n.firstChild,o=r.firstChild,l=o.nextSibling,i=l.nextSibling,s=i.firstChild;s.firstChild;const c=s.nextSibling;c.firstChild;const a=i.nextSibling,d=a.nextSibling,f=d.firstChild,h=f.firstChild,m=h.nextSibling;return m.nextSibling,v(s,u(se,{client_id:"",href:"/reddit",style:"normal",children:"Reddit"}),null),v(c,u(se,{client_id:"",href:"/mastodon",style:"normal",children:"Mastodon"}),null),v(f,u(se,{client_id:"",href:"/settings",style:"action-button",children:"Settings"}),h),v(f,u(se,{client_id:"",href:"https://github.com/pfgithub/threadclient",style:"action-button",children:"Github"}),m),v(f,u(se,{client_id:"",href:"https://github.com/pfgithub/threadclient/blob/main/privacy.md",style:"action-button",children:"Privacy"}),null),t})()}function Yr(e,t){const[n,r]=kr({data:null}),o=ao(()=>{o(()=>r("data",ve(e(),{merge:t.merge,key:t.key})))});return o(()=>{r("data",ve(e()))}),n}const Ds=b('<div class="absolute top-0 left-0 w-full h-full"></div>'),Ms=b("<div><div></div></div>");function Vs(e){const[t,n]=L(null),r=O(()=>t()!=null),[o,l]=L(!1),i=O(()=>r()||o());let s=0;H(()=>{const d=t();d!=null&&(s=d)});let c,a=[];return z(()=>{a.forEach(d=>d())}),(()=>{const d=Ms.cloneNode(!0),f=d.firstChild;d.$$pointerdown=m=>{const g=m.pointerId;if(m.pointerType==="mouse"||(a.forEach(C=>C()),document.getSelection()?.isCollapsed===!1))return;if(CSS.supports("-webkit-touch-callout: none")){const C=window.innerWidth,T=m.clientX;if(Math.min(Math.abs(T),Math.abs(C-T))<50)return}let $=!1;m.preventDefault(),c.style.transition="";const N=()=>{const C=t()!==0&&t()!=null;c.style.transition="0.1s transform",C&&c.offsetWidth,Le(()=>{C&&l(!0),n(null)}),x()},w=C=>{if(C.pointerId!==g)return;const T=C.clientX-m.clientX,R=C.clientY-m.clientY;($||Math.abs(T)>10&&Math.abs(R)<Math.abs(T))&&($=!0,n(T))},S=C=>{C.pointerId===g&&(e.onRelease(t()??0),N())},k=C=>{C.pointerId===g&&N()},y=()=>{x()};document.addEventListener("pointermove",w),document.addEventListener("pointerup",S),document.addEventListener("pointercancel",k),document.addEventListener("selectionchange",y);const x=()=>{a=a.filter(C=>C!==x),document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",S),document.removeEventListener("pointercancel",k),document.removeEventListener("selectionchange",y)};a.push(x)},d.style.setProperty("width","100%"),d.style.setProperty("touch-action","pan-y pinch-zoom"),d.style.setProperty("position","relative"),v(d,u(E,{get if(){return i()},get children(){const m=Ds.cloneNode(!0);return v(m,()=>F(()=>e.background(()=>t()??s))),m}}),f),f.addEventListener("transitionend",m=>{m.target===m.currentTarget&&l(!1)});const h=c;return typeof h=="function"?h(f):c=f,v(f,()=>e.children),P(m=>{const g=i()?"hidden":"unset",p=(()=>{const $=t();return $!=null?"translateX("+$+"px)":""})();return g!==m._v$&&d.style.setProperty("overflow-x",m._v$=g),p!==m._v$2&&f.style.setProperty("transform",m._v$2=p),m},{_v$:void 0,_v$2:void 0}),d})()}ee(["pointerdown"]);const js=b('<div><div class="absolute w-100px h-full flex items-center justify-center"><div></div></div></div>');function Ws(e){return{background:t=>{const n=O(()=>t()<0?e.right_stop:e.left_stop),r=O(()=>t()<0),o=O(()=>Math.abs(t())>100);return(()=>{const l=js.cloneNode(!0),i=l.firstChild,s=i.firstChild;return v(s,u(dt,{get icon(){return n().icon},get bold(){return o()},label:null})),P(c=>{const a=Al(n().color,o())+" w-full h-full relative",d={...r()?{right:"-100px"}:{left:"-100px"},transform:"translateX("+t()+"px)"},f=o()?"bounceanim":"";return a!==c._v$&&(l.className=c._v$=a),c._v$2=_n(i,d,c._v$2),f!==c._v$3&&(s.className=c._v$3=f),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),l})()},onRelease:t=>{t<-100&&e.right_stop.onActivate(),t>100&&e.left_stop.onActivate()}}}const Bs=b('<div style="border-bottom-left-radius: 0; border-bottom-right-radius: 0"></div>'),Us=b('<div style="border-top-left-radius: 0; border-top-right-radius: 0"></div>'),Hs=b('<div class="pt-2"></div>'),qs=b('<div><div class="flex flex-row gap-1"><div></div></div></div>'),Fs=b("<div><div></div></div>"),zs=b('<div class="py-1"><button class="text-blue-500 hover:underline"></button></div>'),Gs=b('<p class="text-red-600 dark:text-red-500">Error loading; </p>'),Ks=b('<hr class="my-2 border-t-2">'),Ys=b("<div>TODO: <!> <button>code</button></div>"),Js=b('<div class="text-red-500">Error: <!> <button>code</button></div>'),or=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-purple-500"];function Xs(e){return or[e%or.length]}function lr(e){return u(wn,{get data(){return e.item},get children(){return u(Qs,{get item(){return e.item},get collapse_data(){return e.collapse_data}})}})}function Qs(e){return u(K,{get item(){return e.item},children:{wrapper_start:()=>u(xe,{children:t=>(()=>{const n=Bs.cloneNode(!0);return n.className=" "+t+" h-2 sm:rounded-xl mt-4",n})()}),wrapper_end:()=>u(xe,{children:t=>(()=>{const n=Us.cloneNode(!0);return n.className=" "+t+" h-2 sm:rounded-xl mb-4",n})()}),post:t=>u(Vs,We(()=>Ws({left_stop:{icon:"bookmark",color:"green",onActivate:()=>{alert("TODO")}},right_stop:{icon:"chevron_up",color:"blue",onActivate:()=>{if(!t.collapse)return alert("TODO e;not-collapsible");_e(e.collapse_data,t.collapse.id).setCollapsed(r=>!r)}}}),{get children(){return u(xe,{children:n=>(()=>{const r=qs.cloneNode(!0),o=r.firstChild,l=o.firstChild;return r.className="px-2 "+n,v(o,u(E,{get if(){return!Ct.sm()},get fallback(){return u(E,{get if(){return t.indent.length>0},get children(){const i=Fs.cloneNode(!0),s=i.firstChild;return P(c=>{const a=(t.indent.length-3)*.25+"rem",d=j("w-1","mr-1","pl-0.5",t.first_in_wrapper?"":"pt-2"),f=j("w-full h-full",Xs(t.depth-1),"rounded-md");return a!==c._v$&&i.style.setProperty("margin-left",c._v$=a),d!==c._v$2&&(i.className=c._v$2=d),f!==c._v$3&&(s.className=c._v$3=f),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),i}})},get children(){return u(q,{get each(){return t.indent},children:i=>u(Hr,{collapsed_raw:!1,collapsed_anim:!1,onClick:()=>{_e(e.collapse_data,i.id).setCollapsed(c=>!c)},real:!1,get cstates(){return e.collapse_data},get threaded(){return i.threaded},get id(){return i.id}})})}}),l),v(l,u(E,{get if(){return!t.first_in_wrapper},get children(){return Hs.cloneNode(!0)}}),null),v(l,u(K,{get item(){return t.content},children:{post:i=>u(Kr,{get content(){return i.content},get opts(){return{clickable:!1,frame:i,client_id:i.client_id,replies:i.replies,at_or_above_pivot:t.at_or_above_pivot,is_pivot:t.is_pivot,collapse_data:e.collapse_data,id:t.id}}}),loader:i=>{const[s,c]=L(!1),[a,d]=L(null),f=Er(),h=()=>{if(s())return;c(!0);const m=f.pgin();(async()=>(a()!=null&&await new Promise(g=>setTimeout(g,200)),await ae(i.client_id).loader(t.id,i)))().then(g=>{Le(()=>{c(!1),d(null),console.log("adding content",g.content,t),f.addContent(m,g.content)})}).catch(g=>{console.log("Error loading; ",g),Le(()=>{c(!1),d(g.toString())})})};return(()=>{const m=zs.cloneNode(!0),g=m.firstChild;return(p=>{if(i.autoload){const $=new IntersectionObserver(h,{root:document.body,rootMargin:"0px",threshold:1});$.observe(p),H(()=>{s()&&$.unobserve(p)})}})(g),g.$$click=h,v(g,(()=>{const p=M(()=>!!s(),!0);return()=>p()?"Loading\u2026":(a()!=null?"Retry Load":"Load More")+(i.load_count!=null?" ("+i.load_count+")":"")})()),v(m,u(E,{get when(){return a()},children:p=>(()=>{const $=Gs.cloneNode(!0);return $.firstChild,v($,p,null),$})()}),null),P(()=>g.disabled=s()),m})()}}}),null),P(()=>l.className="flex-1 "+(Ct.sm()&&t.threaded?"threaded-new threaded-new-ltsm":"")),r})()})}})),horizontal_line:()=>(()=>{const t=Ks.cloneNode(!0);return t.style.setProperty("border-top-color","var(--collapse-line-color)"),t})(),todo:t=>(()=>{const n=Ys.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return v(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})(),error:t=>(()=>{const n=Js.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return v(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})()}})}ee(["click"]);const Zs=b('<div class="flex-1">TODO show header</div>'),ea=b('<div><button class="bg-gray-200 rounded-md p-2 px-3"></button></div>'),ta=b('<div class="max-w-4xl w-full"></div>'),na=b('<div class="max-w-320px w-full"></div>'),ra=b('<div class="flex flex-col gap-4 max-w-6xl mx-auto p-4 <sm:px-0"><div class="flex flex-row gap-4 justify-center"></div></div>');function oa(e){const t={map:new Map},n=Er(),r=Yr(()=>(console.log("Reloading data!"),Gl(e.pivot,{collapse_data:t,content:n.content()})),{key:jr,merge:!0}),o=O(()=>Ct.lg()&&r.data.sidebar!=null),[l,i]=L("content");return(()=>{const s=ra.cloneNode(!0),c=s.firstChild;return v(s,u(E,{get if(){return r.data.header!=null},get children(){return Zs.cloneNode(!0)}}),c),v(s,u(E,{get if(){return o()},get children(){const a=ea.cloneNode(!0),d=a.firstChild;return d.$$click=()=>i(f=>f==="content"?"sidebar":"content"),v(d,()=>l()==="content"?"Sidebar":"Content"),a}}),c),v(c,u(E,{get if(){return M(()=>!!o(),!0)()?l()==="content":!0},get children(){const a=ta.cloneNode(!0);return v(a,u(q,{get each(){return r.data.body},children:d=>u(lr,{item:d,collapse_data:t})})),a}}),null),v(c,u(E,{get if(){return M(()=>r.data.sidebar!=null,!0)()&&(o()?l()==="sidebar":!0)},get children(){const a=na.cloneNode(!0);return v(a,u(q,{get each(){return r.data.sidebar},children:d=>u(lr,{item:d,collapse_data:t})})),a}}),null),s})()}ee(["click"]);const la=b('<label class="my-3"><input type="checkbox"> Show my signature on this post</label>'),ia=b('<div><textarea class="border my-3 w-full resize-y"></textarea><div class="flex space-x-1 my-3"><button></button><button>Cancel<div></div></button></div></div>'),sa=b('<pre class="error"><code>There was an error! </code></pre>'),aa=b("<button>Hide error</button>");function ca(e){const t=te(),[n,r]=al("comment-draft-"+e.action.client_id+"-"+e.action.key),[o,l]=L(!0),i=()=>{const m=n()??"",g=t.signature();return o()&&g.trim()?m+(m.trim()?`

`:"")+g:m},s=()=>i().trim()==="",[c,a]=L(!1),[d,f]=L(void 0),h=Yr(()=>ae(e.action.client_id).previewReply(i(),e.action.reply_info),{key:null,merge:!0});return(()=>{const m=ia.cloneNode(!0),g=m.firstChild,p=g.nextSibling,$=p.firstChild,N=$.nextSibling;return g.$$input=w=>{r(w.currentTarget.value)},v(m,u(E,{get if(){return!!t.signature().trim()},get children(){const w=la.cloneNode(!0),S=w.firstChild;return S.$$input=k=>{l(k.currentTarget.checked)},P(()=>S.checked=o()),w}}),p),$.$$click=w=>{a(!0),ae(e.action.client_id).sendReply(i(),e.action.reply_info,e.action.mode).then(k=>{console.log("Got response",k),r(null),e.onAddReply({kind:"post",internal_data:k.raw_value,content:k.kind==="thread"?{kind:"legacy",thread:k,client_id:e.action.client_id}:{kind:"post",title:{text:"Error"},body:{kind:"richtext",content:[D.p(D.error("Unsupported 'load more'",k))]},show_replies_when_below_pivot:!1,collapsible:!1},display_style:"centered",parent:null,replies:null,url:null,client_id:e.action.client_id})}).catch(k=>{a(!1);const y=k;console.log("Got error",y),f(y.toString()+`
`+y.stack)})},v($,()=>c()?"\u2026":e.action.text),N.$$click=w=>{e.onCancel()},v(m,u(E,{get when(){return d()},children:w=>[(()=>{const S=sa.cloneNode(!0),k=S.firstChild;return k.firstChild,v(k,w,null),S})(),(()=>{const S=aa.cloneNode(!0);return S.$$click=()=>f(void 0),S})()]}),null),v(m,u(E,{get if(){return!s()},get when(){return h.data},children:w=>(console.log("Value changed",w),u(Nn,{restrict_w:!0,get children(){return u(Cn,{listing:w,get opts(){return{clickable:!1,replies:null,at_or_above_pivot:!0,is_pivot:!0,frame:null,client_id:e.action.client_id}}})}}))}),null),P(w=>{const S=c(),k=n()??"",y=s()||c(),x=G[s()?"pill-empty":"pill-filled"],C=c(),T=G["pill-empty"];return S!==w._v$&&(g.disabled=w._v$=S),k!==w._v$2&&(g.value=w._v$2=k),y!==w._v$3&&($.disabled=w._v$3=y),x!==w._v$4&&($.className=w._v$4=x),C!==w._v$5&&(N.disabled=w._v$5=C),T!==w._v$6&&(N.className=w._v$6=T),w},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),m})()}ee(["input","click"]);const da=b('<ul class="ml-10"></ul>'),ua=b('<main class="client-wrapper"><div class="display-comments-view"></div></main>');function re(e){throw console.log("not never:",e),new Error("is not never")}function Jr(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function It(e,t){if(t.startsWith("/")&&e&&(t="/"+e+t),t.startsWith("mailto:"))return{kind:"mailto",title:t.replace("mailto:","")};let n=!1;if(t.startsWith("raw!")&&(t=t.replace("raw!",""),n=!0),!t.startsWith("http")&&!t.startsWith("/"))return{kind:"error",title:t};let r;try{r=new URL(t)}catch{r=void 0}return r&&!n&&(r.host==="reddit.com"||r.host.endsWith(".reddit.com"))&&(r.host==="mod.reddit.com"?t="/reddit/mod"+r.pathname+r.search+r.hash:t="/reddit"+r.pathname+r.search+r.hash),r&&!n&&r.host==="redd.it"&&(t="/reddit/comments"+r.pathname+r.search+r.hash),t.startsWith("/")?{kind:"link",url:t.replace("/","#"),external:!1}:{kind:"link",url:t,external:!0}}function U(e,t,n,r={}){const o=It(e,t);if(o.kind==="error")return el("a").clss(...ln(n),"error").attr({title:o.title}).clss("error").onev("click",l=>{l.stopPropagation(),alert(t)});if(o.kind==="mailto")return el("span").attr({title:o.title});if(o.kind==="link"){const l=o.url,i=te(),s=el("a").clss(...ln(n)).attr({href:l}).attr(i.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"});return(l.startsWith("/")||l.startsWith("#")||r.onclick)&&(s.onclick=c=>{if(c.stopPropagation(),!c.defaultPrevented&&c.button===0&&!Jr(c)){if(c.preventDefault(),r.onclick)return r.onclick();Fe({path:l})}}),s}else re(o)}function fa(e,t,n){const r=n.get("t")??n.get("start")??void 0,o=el("iframe").attr({allow:"fullscreen",src:"https://www.youtube.com/embed/"+e+"?version=3&enablejsapi=1&playerapiid=ytplayer"+(t.autoplay?"&autoplay=1":"")+(r!=null?"&start="+r.replace("s",""):"")});return{node:el("div").clss("resizable-iframe").styl({width:"640px",height:"360px"}).adch(o),onhide:()=>{o.contentWindow?.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}}}function Ft(e){return["inline-block mx-1 px-1 text-base border-b-2 transition-colors",e?"border-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900"].join(" ")}function ha(e,t,n){const r=el("div"),o=A(r),l=qe().adto(r);return fetch("https://api."+e+"/v1/gfycats/"+t).then(i=>i.json()).then(i=>{if(console.log("gfylike response:",i),l.remove(),r.adch(el("div").adch(I("code-button").atxt("code").onev("click",f=>{f.stopPropagation(),console.log(i)}))),"message"in i){el("div").clss("error").adto(r).atxt("Error: "+i.message);return}if("errorMessage"in i){el("div").clss("error").adto(r).atxt("Error: "+i.errorMessage);return}const{gfyItem:s}=i;s.title!=null&&r.adch(el("div").atxt("Title: "+s.title)),s.description!=null&&r.adch(el("div").atxt("Description: "+s.description));const c=[...s.mp4Url!=null?[{url:s.mp4Url,type:"video/mp4",quality:"Highest"}]:[],...s.webmUrl!=null?[{url:s.webmUrl,type:"video/webm",quality:"Highest"}]:[],...s.content_urls.webm?[{url:s.content_urls.webm.url,quality:"Highest"}]:[],...s.content_urls.mp4?[{url:s.content_urls.mp4.url,quality:"Highest"},{url:s.content_urls.mp4.url.replace(".mp4","-mobile.mp4"),quality:"Mobile"}]:[],...s.content_urls.mobile?[{url:s.content_urls.mobile.url,quality:"Mobile"}]:[],...s.mobileUrl!=null?[{url:s.mobileUrl,quality:"Mobile"}]:[]],a=s.content_urls,d=a.max5mbGif??a.max2mbGif??a.max1mbGif;Z({kind:"video",aspect:s.width/s.height,gifv:!1,source:c.length>0?{kind:"video",sources:c}:d!=null?{kind:"img",url:d.url}:{kind:"img",url:(()=>{throw console.log("Bad gfy image in",s),new Error("Bad gfy image")})()}},{autoplay:n.autoplay}).defer(o).adto(r)}).catch(i=>{const s=i;console.log(s),l.parentNode&&l.remove(),r.adch(el("div").clss("error").atxt("Error loading gfycat : "+s.toString()))}),o}function Me(e){const t=el("span");return Tt(()=>u(tt,{flairs:e}),t),t}function Ye(e){const t=el("span"),n=A(t);return ge(t,()=>u(yr,{start:e}),{color_level:1}).defer(n),n}function ga(e){let t;return async()=>{if(!t){t=[];let r;try{r=await e()}catch(l){throw console.log("failed to load",l),alert("failed to load dynamic load object. check console."),l}const o=t;t={loaded:r},o.forEach(l=>l())}if("loaded"in t)return t.loaded;const n=t;return await new Promise(r=>n.push(r)),t.loaded}}const ma=ga(async()=>{const e=new TextEncoder,t=new TextDecoder,n=await(await J(()=>import("./snudown.69d6942c.js"),[])).default({env:{__assert_fail:(r,o,l,i)=>{throw console.log(r,o,l,i),new Error("assert failed")},__stack_chk_fail:()=>{throw new Error("stack overflow")},debugprints:(r,o)=>{console.log("print text:",t.decode(new Uint8Array(n.memory.buffer,r,o)))},debugprinti:r=>{console.log("print int:",r)},debugprintc:r=>{console.log("print char:",String.fromCodePoint(r))},debugpanic:(r,o)=>{throw new Error("Panic: "+t.decode(new Uint8Array(n.memory.buffer,r,o)))}}});return{renderMd(r){try{const o=e.encode(r),l=n.allocString(o.byteLength);new Uint8Array(n.memory.buffer,l,o.byteLength).set(o);const s=n.markdownToHTML(l,o.byteLength),c=n.strlen(s),a=new Uint8Array(n.memory.buffer,s,c),d=t.decode(a);return n.freeText(l,o.byteLength),n.freeText(s,c),d}catch(o){const l=o;return console.log(l.toString()+`
`+l.stack),nl("Error "+l.toString()+`
`+l.stack)}}}});async function va(e){const t=e.content;if(e.markdown_format==="reddit"){const[n,r]=await Promise.all([ma(),J(()=>import("./html_to_richtext.87a44672.js"),[])]),o=n.renderMd(t);return{kind:"richtext",content:r.parseContentHTML(o,e.client_id)}}else{if(e.markdown_format==="none")return{kind:"richtext",content:[D.p(D.txt(t))]};if(e.markdown_format==="reddit_html"){const n=await J(()=>import("./html_to_richtext.87a44672.js"),[]);return console.log(t),{kind:"richtext",content:n.parseContentHTML(t,e.client_id)}}else re(e.markdown_format)}}function Z(e,t){try{return pa(e,t)}catch(n){const r=n;console.log(r);const o=el("div");return el("div").clss("error").adto(o).atxt("Got error: "+r.toString()),el("code").adto(el("pre").adto(o)).atxt(r.stack??"no stack"),A(o)}}function pa(e,t){const n=el("div"),r=A(n),o=el("div").adto(n);return ge(o,()=>u(Q,{body:e,get autoplay(){return t.autoplay}}),{color_level:1}).defer(r),r}function _a(e,t){const n=el("div"),r=A(n);let o;t.click_enabled?o=el("div").clss("bg-body rounded-lg block").adto(n):o=U(e,t.url,"none",{onclick:t.click_enabled?()=>{o.remove(),Z(t.click,{autoplay:!0}).defer(r).adto(n)}:void 0}).clss("bg-body rounded-lg hover:shadow-md hover:bg-gray-100 block").adto(n);const l=el("article").clss("flex",t.click_enabled?"flex-col":"flex-row").adto(o),i=el("div").clss(t.click_enabled?"w-full h-auto min-h-10 relative":"w-24 h-full flex items-center justify-center bg-gray-100","rounded-lg overflow-hidden").adto(el("div").adto(l));if(t.thumb!=null?t.click_enabled?i.adch(el("img").clss(t.click_enabled?"w-full h-full":"").attr({src:t.thumb})):el("div").styl({"background-image":`url(${JSON.stringify(t.thumb)})`,"background-size":"contain","background-position":"center","background-repeat":"no-repeat"}).clss("w-full h-full").adto(i):i.adch(el("div").atxt("\u{1F517}")),t.click_enabled){const c=el("div").adto(i);c.clss("flex items-center justify-center absolute top-0 left-0 bottom-0 right-0");const a=el("div").clss("rounded-lg bg-gray-200 p-2 flex shadow-md gap-3").adto(c);el("button").clss("hover:underline").adto(a).atxt("Play").onev("click",d=>{d.stopPropagation(),i.innerHTML="",Z(t.click,{autoplay:!0}).defer(r).adto(i)}),a.atxt(" "),U(e,t.url,"none").clss("hover:underline").atxt("Open").adto(a)}const s=el("div").clss("flex flex-col p-3 text-sm").adto(l);return s.adch(el("h1").clss("max-lines max-lines-1 font-black").atxt(t.title)),s.adch(el("p").clss("max-lines max-lines-2").atxt(t.description)),s.adch(el("div").clss("max-lines max-lines-1 font-light break-all").atxt(t.url)),r}function ba(e){const t=el("div"),n=A(t);return Dt(fetch(e.url,{headers:{Accept:"application/json"}}).then(r=>r.json()),r=>{console.log("oembed resp",r);const o=el("div"),l=A(o);return Z(ul(r,e.client_id),{autoplay:!1}).defer(n).adto(o),l}).defer(n).adto(t),n}function ya(e){try{const t=el("template");t.innerHTML=e;const n=t.content.childNodes[0];if(!n)throw new Error("missing iframe");const r=n instanceof HTMLIFrameElement?{src:n.src,allow:n.allow,allowfullsreen:""}:{srcdoc:e},o=el("div").clss("resizable-iframe");let l;const i=()=>{l||(l=el("iframe").attr(r).adto(o))};i();const s=A(o);return s.on("hide",()=>{l&&(l.remove(),l=void 0)}),s.on("show",()=>i()),s}catch(t){const n=t;console.log(n);const r=el("div");return r.adch(el("p").atxt("Error adding suggestedembed: "+n.toString()).clss("error")),r.adch(el("pre").adch(el("code").atxt(e))),A(r)}}async function wa(e){function t(a,d,f){return{extensions:{persistedQuery:{sha256Hash:d,version:1}},operationName:a,variables:f}}const n=await fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Client-Id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify([t("VideoAccessToken_Clip","36b89d2507fce29e5ca551df756d27c1cfe079e2609642b4390aa4c35796eb11",{slug:e}),t("ClipsChatCard","94c1c7d97d860722a5b7ef3c3b3de3783b37fc32d69bcccc8ea0cda372cf1f01",{slug:e}),t("ClipsBroadcasterInfo","ce258d9536360736605b42db697b3636e750fdb14ff0a7da8c7225bdc2c07e8a",{slug:e}),t("ClipsTitle","f6cca7f2fdfbfc2cecea0c88452500dae569191e58a265f97711f8f2a838f5b4",{slug:e}),t("ClipsCurator","769e99d9ac3f68e53c63dd902807cc9fbea63dace36c81643d776bcb120902e2",{slug:e}),t("ClipsFullVideoButton","d519a5a70419d97a3523be18fe6be81eeb93429e0a41c3baa9441fc3b1dffebf",{slug:e})])}).then(a=>a.json());console.log(n);const[r,o,l,i,s,c]=n;return r.data.clip?{kind:"video",source:{kind:"video",sources:r.data.clip.videoQualities.map(a=>({url:a.sourceURL+"?sig="+encodeURIComponent(r.data.clip.playbackAccessToken.signature)+"&token="+encodeURIComponent(r.data.clip.playbackAccessToken.value),quality:a.quality+"p"}))},caption:i.data.clip.title,gifv:!1}:{kind:"richtext",content:[D.p(D.txt("The clip could not be found."))]}}function xa(e,t,n){const r=new URLSearchParams(t),o=el("div"),l=fa(e,{autoplay:n.autoplay},r);l.node.adto(o);const i=A(o);return i.on("hide",()=>l.onhide?.()),i.on("show",()=>l.onshow?.()),i}function ka(e,t){const n=el("div"),r=A(n),o=qe().adto(n);return fetch("https://api.imgur.com/3/"+e+"/"+t,{headers:{Authorization:"Client-ID 6ccf617dc7a8830",Accept:"application/json"}}).then(l=>l.json()).then(l=>{const i=l;if(console.log("imgur result",i),i.success){const s={kind:"gallery",images:("images"in i.data?i.data.images:[i.data]).map(c=>{const a=c.animated&&c.mp4!=null?{kind:"video",source:{kind:"video",sources:[{url:c.mp4,quality:c.width+"\xD7"+c.height}]},aspect:c.width/c.height,gifv:c.looping,caption:c.description}:{kind:"captioned_image",caption:c.description,url:c.link,w:c.width,h:c.height};return{thumb:"https://i.imgur.com/"+c.id+"t.jpg",aspect:c.width/c.height,body:a}})};Z(s,{autoplay:!1}).defer(r).adto(n),o.remove()}else console.log(i),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur: "+(location.hostname==="localhost"?"Imgur does not work on localhost. Follow the instructions in CONTRIBUTING.md to fix. Imgur said: "+i.data.error:i.data.error)))}).catch(l=>{console.log(l),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur : "+l.toString()))}),r}function Sn(e){const t=el("button").clss("block").adch(e);return t.onclick=n=>{n.preventDefault(),n.stopPropagation(),t.disabled=!0,J(()=>import("./gallery.1dc7e4ca.js"),["assets/gallery.1dc7e4ca.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(r=>{const o=e.naturalWidth/e.naturalHeight,l=A();t.style.opacity="0",r.showGallery([{thumb:e.src,aspect:o,body:{kind:"captioned_image",w:e.naturalWidth,h:e.naturalHeight,url:e.src}}],0,()=>{const i=t.getBoundingClientRect();return{x:i.left,y:i.top+(window.pageYOffset??document.documentElement.scrollTop),w:i.height*o}},{onclose:()=>{t.disabled=!1,t.style.opacity="1"},setIndex:()=>{}}).defer(l)}).catch(r=>{console.log(r),t.disabled=!1,alert(r.toString())})},t}function Xr(e,t){const n=el("img").clss("image-loading").attr({src:e,width:t.w!=null?`${t.w}`:void 0,height:t.h!=null?`${t.h}`:void 0,alt:t.alt,title:t.alt});return n.onload=()=>n.classList.remove("image-loading"),n.onerror=()=>n.classList.remove("image-loading"),n}function $a(e,t){return Sn(Xr(e,t).clss("preview-image"))}function Ca(e,t){const n=A();Z(e.bio,{autoplay:!1}).defer(n).adto(t);const r=el("div").adto(t);for(const o of e.actions)r.atxt(" "),fe(o,r,{value_for_code_btn:e}).defer(n);return r.atxt(" "),I("code-button").adto(r).atxt("Code").onev("click",o=>{o.stopPropagation(),console.log(e)}),n}function Na(e){return e<1e4?""+e:e<1e5?(e/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"k":e<1e6?(e/1e3|0)+"k":e<1e8?(e/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"m":(e/1e6|0)+"m"}function Sa(e,t,n){{let r="none";const o=I("action-button").atxt(e.text).adto(t),l=A();let i;l.on("cleanup",()=>{i&&i.cleanup()}),l.on("hide",()=>{i&&i.setParentVisible(!1)}),l.on("show",()=>{i&&i.setParentVisible(!0)});const s=()=>{if(r==="none"){if(i){const c=i.associated_data;i.cleanup(),c.remove(),i=void 0}o.disabled=!1}else if(!i){const c=el("div").adto(t);i=A(c),ge(c,()=>u(ca,{action:e,onCancel:()=>{r="none",s()},onAddReply:a=>{console.log("Got response",a),r="none",s();const d=el("div").adto(t);ge(d,()=>(()=>{const f=da.cloneNode(!0);return v(f,u(Kr,{get content(){return a.content},get opts(){return{clickable:!1,at_or_above_pivot:!1,is_pivot:!1,frame:a,client_id:a.client_id,replies:a.replies}}})),f})(),{color_level:1}).defer(l)}}),{color_level:1}).defer(i)}};return o.onev("click",c=>{c.stopPropagation(),r==="none"&&(r="some"),s()}),s(),l}}function fe(e,t,n){if(e.kind==="link")return U(e.client_id,e.url,"action-button").atxt(e.text).adto(t),A();if(e.kind==="reply"){const r=A();return Sa(e,t).defer(r),r}else if(e.kind==="counter"){const r=A();return eo(e,t,{parens:!0}).defer(r),r}else if(e.kind==="delete"){const r=el("span").adto(t),o=el("span").adto(t),l=el("span").adto(t),i=el("span").adto(t),s=el("span").adto(t),c=I("action-button").atxt("Delete").adto(r);o.atxt("Are you sure? ");const a=I("unsafe-action-button").atxt("Delete").adto(o);o.atxt(" / ");const d=I("safe-action-button").atxt("Cancel").adto(o);s.atxt("Deleting\u2026"),l.atxt("Deleted!");const f=h=>{r.style.display=h==="none"?"":"none",o.style.display=h==="confirm"?"":"none",l.style.display=h==="deleted"?"":"none",s.style.display=h==="load"?"":"none",i.style.display=typeof h!="string"?"":"none",typeof h!="string"&&(r.style.display="",i.innerHTML="",i.adch(el("span").clss("error").atxt(h.error)))};return f("none"),c.onev("click",h=>{h.stopPropagation(),f("confirm")}),a.onev("click",h=>{h.stopPropagation(),f("load"),ae(e.client_id).act(e.data).then(m=>{f("deleted")}).catch(m=>{console.log("Got error:",m),f({error:m.toString()})})}),d.onev("click",h=>{h.stopPropagation(),f("none")}),A()}else if(e.kind==="report"){const r=ae(e.client_id),o=A();let l;const i=I("action-button").atxt("Report").adto(t).onev("click",s=>{if(s.stopPropagation(),!l)i.setAttribute("class",G["action-button-active"]),l=Ea(r,e.data),l.associated_data.adto(t);else{i.setAttribute("class",G["action-button"]);const c=l.associated_data;l.cleanup(),c.remove(),l=void 0}});return o}else if(e.kind==="login"){const r=ae(e.client_id),o=el("span").adto(t),l=A(),i=e.data,s=I("action-button").atxt("Log In").adto(o).onev("click",c=>{c.stopPropagation(),s.textContent="\u2026",s.disabled=!0,r.getLoginURL(i).then(a=>{o.innerHTML="",U(r.id,a,"pill-filled").atxt("Log In").adto(o)}).catch(a=>{s.textContent="Retry",o.atxt("Error:"+a),console.log(a),s.disabled=!1})});return l}else if(e.kind==="act"){const r=ae(e.client_id),o=el("span").adto(t),l=I("action-button").atxt(e.text).adto(o).onev("click",i=>{i.stopPropagation(),l.disabled=!0,l.textContent="\u2026",r.act(e.action).then(()=>{l.remove(),txt("\u2713").adto(o)}).catch(s=>{console.log("got error: "+s),l.disabled=!1,o.adch(el("span").clss("error").atxt(s.toString()))})});return A()}else{if(e.kind==="flair")return A();if(e.kind==="code"){const r=A();let o;const l=I("action-button").atxt("Code").adto(t).onev("click",i=>{if(i.stopPropagation(),console.log(n.value_for_code_btn),!o)l.setAttribute("class",G["action-button-active"]),o=Z(e.body,{autoplay:!0}),o.associated_data.adto(t);else{l.setAttribute("class",G["action-button"]);const s=o.associated_data;o.cleanup(),s.remove(),o=void 0}});return r}else re(e)}}function Qr(e,t,n){const r=el("details").clss("report-item"),o=A(r);r.adch(el("summary").attr({draggable:"true"}).atxt(t.title));const l=el("div").clss("report-content").adto(r);switch(t.description&&Z(t.description,{autoplay:!1}).defer(o).adto(l),t.report.kind){case"submit":case"textarea":{const i=t.report.kind==="textarea"?el("textarea").adto(el("div").adto(l)):void 0;let s="none";const c=I("pill-filled").adto(l),a=txt("\u2026").adto(c),d=el("div").adto(l),f=()=>{s==="none"?(a.nodeValue="Send Report",c.disabled=!1):s==="load"?(a.nodeValue="\u2026",c.disabled=!0):(a.nodeValue="Retry",c.disabled=!1,d.adch(el("div").clss("error").atxt("Error: "+s.error)))};f();const h=t.report.data;c.onev("click",m=>{m.stopPropagation(),s="load",f(),e.sendReport(h,i?.value).then(g=>{n(g)}).catch(g=>{console.log(g),s={error:g.toString()},f()})})}break;case"link":U(e.id,t.report.url,"normal").atxt(t.report.text).adto(l);break;case"more":{const i=el("div").adto(l);for(const s of t.report.screens)Qr(e,s,n).defer(o).adto(i)}break;default:re(t.report)}return o}function Ea(e,t){const n=el("div").clss("report-screen text-sm"),r=A(n);if(!e.fetchReportScreen)return n.atxt("Missing fetchreportscreen?"),n.clss("error"),console.log(e),r;const o=qe().adto(n);return e.fetchReportScreen(t).then(l=>{o.remove();const i=A(),s=r.addChild(i);for(const c of l)Qr(e,c,a=>{s.cleanup(),n.innerHTML="",n.atxt("Report sent!"),console.log("Completed report",a);const d=En().adto(n);d.adch(el("div").atxt(a.title)),Z(a.body,{autoplay:!1}).defer(r).adto(d),console.log(d,n,n.childNodes)}).defer(i).adto(n)}).catch(l=>{console.log("error loading report screen",l),n.adch(el("div").clss("error").atxt("Error loading: "+l.toString())),o.remove()}),r}function Zr(e,t){const n=e??`${Math.random()}`,r=Qe.get(n)??{state:{loading:!1,pt_count:t.count,your_vote:t.you},handlers:new Set,users:0,update_time:t.time};Qe.has(n)||Qe.set(n,r),r.update_time<t.time&&(r.state.pt_count=t.count,r.state.your_vote=t.you);const o={state:r.state,emit(){[...r.handlers].forEach(i=>{i()})},onupdate(i){const s=()=>{i()};r.handlers.add(s),l.on("cleanup",()=>{r.handlers.delete(s)})}},l=A(o);return r.users++,l.on("cleanup",()=>{r.users--,r.users===0&&Qe.delete(n)}),l}function Pa(e){if(e.pt_count==="hidden"||e.pt_count==="none")return{text:"\u2014",raw:"[score hidden]"};const t=e.pt_count+(e.your_vote==="increment"?1:e.your_vote==="decrement"?-1:0);return{text:Na(t),raw:t.toLocaleString()}}function eo(e,t,n){const r=e.count_excl_you!=="none",o=el("span").clss("counter").adto(t),l=I("action-button").adto(o).clss("counter-increment-btn").attr({"aria-label":"Up"}),i=el("span").adto(l),s=txt("").adto(i),c=txt("\u2026").adto(i),a=el("span").adto(o.atxt(" ")).clss("counter-count"),d=txt("\u2026").adto(a),f=e.percent==null?txt("\u2014% upvoted"):txt(e.percent.toLocaleString(void 0,{style:"percent"})+" upvoted");let h;const m=A({percent_voted_txt:f,votecount:a}),{state:g,emit:p,onupdate:$}=Zr(e.unique_id,{count:e.count_excl_you,you:e.you,time:e.time}).defer(m);$(()=>{const{text:w,raw:S}=Pa(g);c.nodeValue={increment:e.increment.undo_label,decrement:e.decrement?.undo_label??"ERR",none:e.increment.label}[g.your_vote??"none"],d.nodeValue=n.parens?"("+w+")":w,r||(d.nodeValue=""),a.title=S,o.classList.remove("counted-increment","counted-decrement","counted-reset"),o.classList.add("counted-"+(g.your_vote??"reset")),o.classList.toggle("counted-loading",g.loading),l.disabled=g.loading,h&&(h.disabled=g.loading),l.setAttribute("class","counter-increment-btn "+G[g.your_vote==="increment"?e.incremented_style??"action-button":e.style??"action-button"]),h&&h.setAttribute("class","counter-decrement-btn "+G[g.your_vote==="decrement"?e.decremented_style??"action-button":e.style??"action-button"]),l.setAttribute("aria-pressed",g.your_vote==="increment"?"true":"false"),h&&h.setAttribute("aria-pressed",g.your_vote==="decrement"?"true":"false")}),p();const N=w=>{if("error"in e.actions)return alert("Error: "+e.actions.error);const S=ae(e.client_id),k=g.your_vote;g.your_vote=w,g.loading=!0,p();const y=e.actions[w??"reset"];if(y==null)throw new Error("downvote label available but downvote action not provided");S.act(y).then(()=>{g.your_vote=w,g.loading=!1,p()}).catch(x=>{g.your_vote=k,g.loading=!1,p(),console.log(x),alert("Got error: "+x)})};return e.decrement!=null&&(s.nodeValue="\u2BC5 ",o.atxt(" "),h=I("action-button").adch(el("span").atxt("\u2BC6")).attr({"aria-label":"Down"}).adto(o).onev("click",w=>{w.stopPropagation(),g.your_vote==="decrement"?N(void 0):N("decrement")}).clss("counter-decrement-btn")),l.onev("click",w=>{w.stopPropagation(),g.your_vote==="increment"?N(void 0):N("increment")}),m}function mt(e,t,n){const[r,o]=Lr(Pr(n.toLowerCase()));return U(e,t,"userlink").styl({"--light-color":Nt(r),"--dark-color":Nt(o)})}function La(e){let t=e;const n=[];return{get value(){return t},set value(r){t=r,n.forEach(o=>o())},watch(r){const o=A(),l=()=>{r()};return n.push(l),o.on("cleanup",()=>n.splice(n.indexOf(l),1)),o}}}function zt(e,t,n){const r=A(t);for(const o of e)o.watch(()=>n(t)).defer(r);return n(t),r}function Pt(e){const t=el("div"),n=A(t),r=el("div").adto(t),o=s=>{const c=el("div");for(const a of s)a.action.kind==="link"?U(a.action.client_id,a.action.url,"none").clss("text-gray-600 dark:text-gray-400 hover:text-gray-900").adto(c).atxt(a.text):a.action.kind==="menu"?I("none").adto(c).atxt(a.text+" \u25B8").onev("click",d=>{d.stopPropagation(),d.preventDefault(),alert("TODO submenus")}).adto(c):a.action.kind==="show-line-two"?I("none").adto(c).atxt(a.text).onev("click",d=>{d.stopPropagation(),d.preventDefault(),alert("TODO submenu show-line-two")}).adto(c):re(a.action);return c};let l;n.on("cleanup",()=>{l&&(l.cleanup(),l=void 0)});const i=La(e.find(s=>s.selected));i.watch(()=>{l&&(l.cleanup(),l.associated_data.remove(),l=void 0)});for(const s of e){if(s.action.kind==="menu"){const c=txt("\u2026");let a=!1,d;const f=s.action.children;n.on("hide",()=>{console.log("open menu was asked to be hidden"),a=!1,h()});const h=()=>{if(c.nodeValue=a?"\u25B4":"\u25BE",p.attr({"aria-expanded":a?"true":"false"}),a){if(!d){d=o(f).clss("absolute z-10 flex flex-col shadow bg-gray-100 p-3 rounded w-max max-w-7xl").adto(le);const $=m.getBoundingClientRect();d.styl({left:$.left+"px",top:$.bottom+(window.pageYOffset??document.documentElement.scrollTop)+"px"})}}else d&&(d.remove(),d=void 0)},m=el("span").adto(r),g=$=>{if(a){console.log("Got event: ",$.target);let N=$.target;for(;N;){if(N===m||d&&N===d)return;N=N.parentElement}a=!1,h()}};document.addEventListener("click",g,{capture:!0}),n.on("cleanup",()=>document.removeEventListener("click",g,{capture:!0}));const p=I("none").attr({"aria-haspopup":"true"}).atxt(s.text).atxt(" ").adch(c).adto(m).onev("click",$=>{$.preventDefault(),$.stopPropagation(),a=!a,h()});zt([i],0,()=>{p.setAttribute("class",Ft(s===i.value))}).defer(n),h()}else if(s.action.kind==="link"){const c=U(s.action.client_id,s.action.url,"none").atxt(s.text).adto(r);zt([i],0,()=>{c.setAttribute("class",Ft(s===i.value))}).defer(n)}else if(s.action.kind==="show-line-two"){const c=s.action,a=I("none").atxt(s.text).adto(r);zt([i],0,()=>{if(a.setAttribute("class",Ft(s===i.value)),s===i.value){if(l)throw new Error("already existing menu_l2");l=Pt(c.children),l.defer(n),l.associated_data.clss("mt-2").adto(t)}}).defer(n),a.onev("click",d=>{d.stopPropagation(),i.value=s})}else re(s.action);txt(" ").adto(r)}return n}function Aa(e,t){const n=A();if(t.clss("subreddit-banner"),e.banner){const c="absolute top-0 left-0 right-0 w-full max-h-full",a="w-full min-h-270px object-cover object-center sm:object-top",d="absolute left-0 right-0 bottom-0 header-gradient";e.banner.kind==="image"?(Sn(el("img").clss(a).attr({src:e.banner.desktop})).clss(c).adto(t).adch(el("div").clss(d+"top-150px")),el("div").clss("h-150px").adto(t)):e.banner.kind==="color"?el("div").adch(el("div").clss(a+" h-full").styl({"background-color":e.banner.color})).clss(c).adto(t).adch(el("div").clss(d+" top-0")):re(e.banner)}const r=el("div").clss("subreddit-banner-content").adto(t);e.icon&&el("img").clss("sub-icon-img drop-shadow").attr({alt:"",src:e.icon.url}).adto(r);const o=el("div").clss("subreddit-title-area").adto(r);e.name.display!=null&&el("h1").atxt(e.name.display).clss("text-lg").adto(o),el("h2").atxt(e.name.link_name).clss("text-gray-500").adto(o);const l=el("div").clss("sub-subscribe-area").adto(r);if(e.subscribe){const c=el("div").adto(l);fe(e.subscribe,c,{value_for_code_btn:e}).defer(n)}e.body&&Z(e.body,{autoplay:!1}).defer(n).adto(l);const i=el("div").clss("relative").adto(t);e.menu&&Pt(e.menu).defer(n).adto(el("div").clss("my-3").adto(i));const s=el("div").adto(i);if(e.more_actions)for(const c of e.more_actions)fe(c,s,{value_for_code_btn:e}).defer(n);return I("action-button").atxt("Code").adto(s).onev("click",c=>{c.stopPropagation(),console.log(e)}),n}function Ta(e,t,n){const r=A();n.clss("widget");const o=el("div").adto(n);txt(t.title).adto(el("div").adto(o).clss("widget-header font-bold text-base mb-2 text-gray-500"));const l=el("div").clss("widget-content").adto(o);if(t.actions_top){const s=el("div").clss("widget-actions-top").adto(l);for(const c of t.actions_top)fe(c,s,{value_for_code_btn:t}).defer(r)}const i=t.widget_content;if(i.kind==="list"){const s=el("ul").clss("widget-list list-disc").adto(l);for(const c of i.items){const a=el("li").adto(s);let d;if(c.click.kind==="body"){a.clss("list-none");const h=el("details").adto(a);d=el("summary").attr({draggable:"true"}).adto(h),Z(c.click.body,{autoplay:!1}).defer(r).adto(h)}else a.clss("ml-4"),d=a;c.icon!=null&&el("div").adto(d).clss("widget-list-icon").styl({"--background-image-url":"url("+c.icon+")"});let f;if(c.name.kind==="text"?f=txt(c.name.text):c.name.kind==="flair"?(f=el("span"),Me([c.name.flair]).adto(f)):c.name.kind==="username"?f=txt(c.name.username):c.name.kind==="image"?f=el("img").clss("w-fill h-auto").attr({src:c.name.src,alt:c.name.alt,width:`${c.name.w}`,height:`${c.name.h}`}):re(c.name),c.click.kind==="link"?c.name.kind==="username"?mt(e.id,c.click.url,c.name.username).atxt(c.name.username).adto(d):U(e.id,c.click.url,"normal").adch(f).adto(d):el("span").adch(f).adto(d),c.action){const h=el("span").adto(d).atxt(" ");fe(c.action,h,{value_for_code_btn:c}).defer(r)}}}else if(i.kind==="community-details")el("p").atxt(i.description).adto(l);else if(i.kind==="body")Z(i.body,{autoplay:!1}).defer(r).adto(l);else if(i.kind==="iframe"){const s=el("div");n.replaceChild(s,o),n.clss("widget-fullscreen-content");const c=el("iframe").adto(s).styl({width:"312px"}).attr({width:"312",height:i.height,srcdoc:i.srcdoc});c.onload=()=>{if(!c.contentWindow)return console.log("no content window");c.style.height=c.contentWindow.document.body.scrollHeight+20+"px"}}else if(i.kind==="image"){const s=el("div");n.clss("widget-fullscreen-content"),n.replaceChild(s,o);const c=Xr(i.src,{w:i.width,h:i.height}).clss("w-full h-auto");i.link_url!=null?U(e.id,i.link_url,"none").adch(c).adto(s):Sn(c).adto(s)}else re(i);if(t.actions_bottom){const s=el("div").clss("widget-actions-bottom").adto(l);for(const c of t.actions_bottom)fe(c,s,{value_for_code_btn:t}).defer(r)}return el("div").adto(l).adch(I("code-button").atxt("Code").onev("click",s=>{s.stopPropagation(),console.log(t)})),r}function Ne(e,t,n){const r=En(),o=A(r);try{if(t.kind==="user-profile")return Ca(t,r).defer(o),o;if(t.kind==="bio")return Aa(t,r).defer(o),o;if(t.kind==="widget")return Ta(e,t,r).defer(o),o;if(t.kind==="thread")return Pn(e,t,r,n).defer(o),o;re(t)}catch(l){return o.cleanup(),console.log("Got error",l),r.innerHTML="",r.adch(el("pre").adch(el("code").atxt(l.toString()+`

`+l.stack))),r.adch(I("code-button").atxt("Code").onev("click",i=>{i.stopPropagation(),console.log(t)})),A(r)}}function En(){return el("div").clss("post text-sm")}function Pn(e,t,n,r){let o,l,i,s,c,a,d;r.clickable&&t.link.startsWith("/")&&n.clss("hover-outline").attr({tabindex:"0"}).onev("click",y=>{if(!_r(y.target,n))return;y.stopPropagation();const x="/"+e.id+t.link;y.ctrlKey||y.metaKey||y.altKey?window.open(x):Fe({path:x})});const h=A({addChildren:void 0});if(t.layout==="reddit-post"){o=el("div").adto(n).clss("post-voting"),l=el("button").adto(n).clss("post-thumbnail");const y=el("div").adto(n).clss("post-titles");i=el("div").adto(n).clss("post-preview"),s=el("div").adto(n).clss("post-replies"),c=el("div").adto(y).clss("post-content-title text-base"),a=el("div").adto(y).clss("post-content-subminfo"),d=el("div").adto(y).clss("post-content-buttons")}else t.layout==="reddit-comment"||t.layout==="mastodon-post"?(o=el("div").adto(n).clss("post-voting"),c=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),a=el("div").adto(n).clss("post-content-subminfo text-xs"),i=el("div").adto(n).clss("post-preview"),d=el("div").adto(n).clss("post-content-buttons text-xs"),s=el("div").adto(n).clss("post-replies")):t.layout==="error"?(o=el("div").adto(n).clss("post-voting"),c=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),a=el("div").adto(n).clss("post-content-subminfo"),i=el("div").adto(n).clss("post-preview"),d=el("div").adto(n).clss("post-content-buttons"),s=el("div").adto(n).clss("post-replies")):re(t.layout);if(t.thumbnail||l.clss("no-thumbnail"),t.layout==="reddit-comment"||t.layout==="mastodon-post"){let y=t.default_collapsed;const x=()=>{h.setVisible(!y),y?(n.classList.add("comment-collapsed"),C.setAttribute("aria-label","Uncollapse"),C.setAttribute("aria-pressed","true")):(n.classList.remove("comment-collapsed"),C.setAttribute("aria-label","Collapse"),C.setAttribute("aria-pressed","false"))},C=el("button").clss("collapse-btn outline-default").attr({draggable:"true","aria-label":"Collapse"}).adch(el("div").clss("collapse-btn-inner")).onev("click",T=>{T.stopPropagation();const R=n.getBoundingClientRect(),Y=Lt.getBoundingClientRect(),me=()=>5+Math.max(0,Y.bottom,window.visualViewport.offsetTop),ie=window.visualViewport.offsetTop+window.visualViewport.height;console.log(me(),ie,R.top),R.top<me()&&R.bottom>me()&&(n.scrollIntoView(),document.documentElement.scrollTop-=me()),y=!y,x()});n.insertBefore(C,n.childNodes[0]??null),x()}n.clss("layout-"+t.layout),(t.layout==="reddit-comment"||t.layout==="mastodon-post")&&n.clss("layout-commentlike"),t.flair&&(c.adch(Me(t.flair.filter(y=>y.content_warning))),c.atxt(" ")),t.title&&(r.clickable?c.adch(U(e.id,t.link,"none").clss("hover:underline").atxt(t.title.text)):c.adch(txt(t.title.text))),t.flair&&(c.atxt(" "),c.adch(Me(t.flair.filter(y=>!y.content_warning))));let m=(t.flair??[]).filter(y=>y.content_warning),g=null;if(t.layout==="reddit-post"&&t.info)t.info.time!==!1&&(a.adch(Ye(t.info.time).defer(h)),a.atxt(" ")),t.info.author&&a.atxt("by ").adch(mt(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&a.adch(Me(t.info.author.flair)),t.info.in&&a.atxt(" in ").adch(U(e.id,t.info.in.link,"normal").atxt(t.info.in.name)),t.info.edited!==!1&&(a.hasChildNodes()&&a.atxt(", "),a.atxt("Edited ").adch(Ye(t.info.edited).defer(h))),t.info.pinned&&(a.hasChildNodes()&&a.atxt(", "),a.adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")));else if((t.layout==="reddit-comment"||t.layout==="mastodon-post")&&t.info){if(t.layout==="reddit-comment"&&t.info.author?.pfp){const y=el("img").attr({src:t.info.author.pfp.url}).adto(a).clss("w-8 h-8 object-center inline-block rounded-full cfg-reddit-pfp");y.title="Disable in settings (thread.pfg.pw/settings)",a.atxt(" ")}if(t.info.author&&a.adch(mt(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&a.adch(Me(t.info.author.flair)),t.layout==="mastodon-post"&&t.info.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp").styl({"--url":"url("+JSON.stringify(t.info.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.author.pfp.hover)+")"}).adto(o)),g=document.createComment("").adto(a),t.info.time!==!1){const y=el("span").adch(Ye(t.info.time).defer(h));a.atxt(" ").adch(y)}t.info.edited!==!1&&a.atxt(", Edited ").adch(Ye(t.info.edited).defer(h)),t.info.pinned&&a.atxt(", ").adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")),t.info.reblogged_by&&(a.atxt(" \u2190 Boosted by "),t.info.reblogged_by.author&&a.adch(mt(e.id,t.info.reblogged_by.author.link,t.info.reblogged_by.author.color_hash).atxt(t.info.reblogged_by.author.name)),t.info.reblogged_by.time!==!1&&a.atxt(" at ").adch(Ye(t.info.reblogged_by.time).defer(h)),t.layout==="mastodon-post"&&t.info.reblogged_by.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp","pfp-reblog").styl({"--url":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.hover)+")"}).adto(o)))}{if(t.thumbnail)if(t.thumbnail.kind==="image")l.adch(el("img").attr({src:t.thumbnail.url,alt:""})),m.length&&l.clss("thumbnail-content-warning");else if(t.thumbnail.kind==="default"){const C={self:"self",default:"default",image:"image",spoiler:"spoiler",nsfw:"nsfw",account:"account",error:"error"}[t.thumbnail.thumb];l.adch(el("div").clss("thumbnail-builtin","thumbnail-"+C))}else re(t.thumbnail);const y=(C,T)=>{const R=el("div").clss("post-body"),Y=A(R);if(m.length){const me=m,ie=el("div").adto(R);return ie.atxt("Content Warning"+(me.length===1?"":"s")+": "),ie.adch(Me(me)),ie.atxt(" "),I("pill-filled").adto(ie).atxt("Show Content").onev("click",ze=>{ze.stopPropagation(),ie.remove(),m=[],l.classList.remove("thumbnail-content-warning"),Z(C,{...T}).defer(Y).adto(R)}),Y}return Z(C,{...T}).defer(Y).adto(R),Y},x=C=>C.kind==="none"?!0:C.kind==="array"?C.body.every(T=>T==null?!0:x(T)):!1;if(x(t.body))i.remove();else if(t.display_mode.body==="collapsed"){const C=I("outlined-button").adto(d),T=txt("\u2026").adto(C);let R;h.on("cleanup",()=>{R&&R.cleanup()}),h.on("hide",()=>{R&&R.setVisible(!1)}),h.on("show",()=>{R&&R.setVisible(!0)});let Y=t.display_mode.body_default==="open";const me=!Y,ie=()=>{Y&&!R?(R=y(t.body,{autoplay:me}),R.associated_data.adto(i)):!Y&&R&&(R.cleanup(),R.associated_data.remove(),R=void 0),T.nodeValue=Y?"Hide":"Show"};ie(),C.onev("click",ze=>{ze.stopPropagation(),Y=!Y,ie()}),l.onev("click",ze=>{ze.stopPropagation(),Y=!Y,ie()})}else y(t.body,{autoplay:!1}).defer(h).adto(i)}let p=!1;for(const y of t.actions)if(y.kind==="counter"&&y.special==="reddit-points"){n.clss("spacefiller-redditpoints");const x=eo(y,o,{parens:!1}).defer(h);if(t.layout==="reddit-comment")a.insertBefore(txt(" "),g),a.insertBefore(x.votecount,g),a.insertBefore(txt(" points"),g);else if(t.layout==="reddit-post"){a.atxt(", "),x.percent_voted_txt.adto(a),o.clss("desktop-only"),d.atxt(" ");const C=el("div").clss("mobile-only").adto(d);fe(y,C,{value_for_code_btn:t}).defer(h)}}else y.kind==="code"&&(p=!0),d.atxt(" "),fe(y,d,{value_for_code_btn:t}).defer(h);o.childNodes.length===0&&o.remove(),t.actions.length===0&&(d.atxt(" "),U(e.id,t.link,"action-button").atxt("View").adto(d)),p||(d.atxt(" "),I("code-button").onev("click",y=>{y.stopPropagation(),console.log(t)}).atxt("Code").adto(d));const $=el("ul").clss("replies").styl({margin:"0"}).adto(s),N=t.replies?.length===1&&t.replies[0].replies?.length===1;let w;const S=y=>{if(N&&y.length>1){if(!w)throw new Error("threaded comment has no lastElemAddChildren");w(y);return}y.forEach(x=>k(x))},k=y=>{const x=el("li").adto($);if(N&&x.clss("relative threaded"),y.kind==="load_more"){sn(e,y,S,()=>x.remove()).adto(x);return}let C;N&&y.replies?.length===1&&(C=y.replies[0],y.replies=[]),x.clss("comment");const T=En();w=Pn(e,y,T,{clickable:r.clickable}).defer(h).addChildren,T.adto(x),C&&k(C)};return t.replies&&(t.display_mode.comments==="collapsed"||S(t.replies)),h.associated_data.addChildren=S,h}const G={none:"",normal:"text-blue-600 dark:text-blue-500 underline",previewable:"text-blue-600 dark:text-blue-500 hover:underline","action-button":"p-1 rounded hover:bg-gray-200","action-button-active":"p-1 rounded bg-gray-200 hover:bg-gray-300","save-button-saved":"text-green-600 dark:text-green-500 hover:underline","safe-action-button":"text-blue-600 dark:text-blue-500 hover:underline","unsafe-action-button":"text-red-600 dark:text-red-500 hover:underline","code-button":"text-gray-600 dark:text-gray-500 hover:underline","load-more":"text-blue-600 dark:text-blue-500 hover:underline text-base",userlink:"text-$light-color dark:text-$dark-color hover:underline","pill-empty":"text-sm border-2 border-black text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-transparent":"text-sm border-2 border-transparent text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-filled":"text-sm border-2 border-black bg-black text-white hover:text-black hover:bg-transparent p-1 px-3 rounded-full transition-colors","outlined-button":"border border-gray-600 dark:border-gray-500 px-2",error:"text-red-600 dark:text-red-500 hover:underline"},ln=e=>[G[e]];function I(e){return el("button").clss(...ln(e)).attr({draggable:"true"})}function qe(){return el("div").clss("lds-ripple").adch(el("div")).adch(el("div"))}function sn(e,t,n,r){const o=el("div"),l=()=>U(e.id,t.url,"load-more",{onclick:()=>{const s=el("div").adto(o);s.adch(el("span").atxt("Loading\u2026")),s.adch(qe()),i.remove(),i=s;const c=i;e.loadMore(t.load_more).then(a=>{c.remove(),n(a),r()}).catch(a=>{console.log("error loading more:",a),c.parentNode&&c.remove(),i=el("span").atxt("Error. ").adch(l().atxt("\u{1F5D8} Retry")).adto(o)})}});let i=l().atxt(t.count!=null?"Load "+t.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more");return o.atxt(" "),I("code-button").onev("click",s=>{s.stopPropagation(),console.log(t)}).atxt("Code").adto(o),o}function Oa(e,t,n,r){const o=el("div"),l=c=>U(e.id,c.url,"load-more",{onclick:()=>{const a=el("div").adto(o);a.adch(el("span").atxt("Loading\u2026")),a.adch(qe()),s&&s.remove(),s=a,e.loadMoreUnmounted(c.load_more_unmounted).then(d=>{s&&s.remove(),n(d.children),d.next?i(d.next):r()}).catch(d=>{console.log("error loading more:",d),s&&s.parentNode!=null&&s.remove(),s=el("span").atxt("Error. ").adch(l(c).atxt("\u{1F5D8} Retry")).adto(o)})}}),i=c=>{s=el("div").adch(l(c).atxt(c.count!=null?"Load "+c.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more")).atxt(" ").adch(I("code-button").onev("click",a=>{a.stopPropagation(),console.log(c)}).atxt("Code")).adto(o)};let s;return i(t),o}function to(e,t){let n=e.visible;e.on("hide",()=>n=!1),e.on("show",()=>{n=!0,document.title=r(o)});const r=i=>i+" | "+t+" | ThreadClient";let o="\u2026";const l={setTitle(i){o=i,n&&(document.title=r(i))}};return l.setTitle("\u2026"),l}function Ra(e,t){const n=U(e.id,t.url,"action-button"),r=A(n),o=el("span").adto(n),l=txt("\u2026 ").adto(o);return o.atxt(t.name),e.hydrateInbox(t.hydrate).then(i=>{i.messages.kind==="zero"?l.nodeValue="":i.messages.kind==="exact"?l.nodeValue=i.messages.value+" ":i.messages.kind==="minimum"&&(l.nodeValue=i.messages.min+"+ "),i.messages.kind!=="zero"&&o.classList.add({green:"text-green-500",orange:"text-orange-500"}[t.active_color])}).catch(i=>{l.nodeValue="\uFFFD "}),r}const be=()=>el("div").clss("top-level-wrapper","object-wrapper","bg-postcolor-100");function no(e,t,n,r){const o=A();r.setTitle(t.title),n.classList.add("display-"+t.display_style);const l=el("div").adto(n).clss("navbar-area");for(const a of t.navbar.actions)fe(a,l,{value_for_code_btn:t}).defer(o),txt(" ").adto(l);const i=[{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Report Issue"},{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Feature Request"}];for(const a of i)fe(a,l,{value_for_code_btn:t}).defer(o),l.atxt(" ");I("code-button").atxt("Code").adto(l).onev("click",()=>console.log(t)),txt(" ").adto(l);for(const a of t.navbar.inboxes)Ra(e,a).defer(o).adto(l),txt(" ").adto(l);const s=el("div").adto(n).clss("header-area"),c=el("div").adto(n).clss("content-area");if(t.sidebar){I("pill-filled").adto(n).clss("sidebar-toggle-mobile","my-1").atxt("Toggle Sidebar").onev("click",d=>{d.stopPropagation(),a.classList.toggle("sidebar-visible-mobile")});const a=el("div").adto(n).clss("sidebar-area");for(const d of t.sidebar)Ne(e,d,{clickable:!1}).defer(o).adto(be().adto(a))}if(t.body.kind==="listing"){Ne(e,t.body.header,{clickable:!1}).defer(o).adto(be().adto(s)),t.body.menu&&Pt(t.body.menu).defer(o).adto(be().adto(c));const a=el("div").adto(c),d=h=>{for(const m of h)f(m)},f=h=>{if(h.parents.length===0){el("div").clss("error").atxt("unmounted.parents.length === 0").adto(be().adto(a));return}const m=be().adto(a);for(const g of h.parents)if(g.kind==="load_more"){const p=el("div").adto(m);U(e.id,g.url,"load-more").atxt("Load More").adto(p),p.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"))}else Ne(e,g,{clickable:!0}).defer(o).adto(m);if(h.replies.length>0){let g;const p=I("previewable").adto(m).atxt("Replies \u25B8").onev("click",$=>{if($.stopPropagation(),g)g.cleanup(),g.associated_data.remove(),g=void 0,p.textContent="Replies \u25B8";else{p.textContent="Replies \u25BE";const N=el("div").adto(m),w=A(N);g=w;const S=y=>{for(const x of y)k(x)},k=y=>{if(y.kind==="load_more"){const x=sn(e,y,S,()=>x.remove());x.adto(N);return}Ne(e,y,{clickable:!1}).defer(w).adto(N)};S(h.replies)}})}};if(d(t.body.items),t.body.next){const h=Oa(e,t.body.next,d,()=>h.remove());h.adto(c)}}else if(t.body.kind==="one"){const a=be().adto(s);for(const h of t.body.item.parents){if(h.kind==="load_more"){const g=a;U(e.id,h.url,"load-more").atxt("Load More").adto(g),g.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"));continue}const m=h===t.body.item.parents[t.body.item.parents.length-1];Ne(e,h,{clickable:!m}).defer(o).adto(a)}t.body.item.menu&&Pt(t.body.item.menu).defer(o).adto(be().adto(c));const d=h=>{for(const m of h)f(m)},f=h=>{if(h.kind==="load_more"){const m=sn(e,h,d,()=>m.remove());m.adto(c).clss("top-level-load-more");return}Ne(e,h,{clickable:!1}).defer(o).adto(be().adto(c))};d(t.body.item.replies),t.body.item.replies.length===0&&el("div").atxt("*There are no replies*").adto(c)}else re(t.body);return o}function Ia(e,t){const n=el("div").clss("client-wrapper"),r=A(n),o=el("div").adto(n);o.classList.add("client-main-frame");const l=el("div").adto(o);l.classList.add("display-loading"),l.adch(qe());const i=to(r,e.id);return i.setTitle("Loading "+e.id+"\u2026"),(async()=>{if(!e.getThread||e.getPage&&te().pageVersion()==="2"){const c={page:await e.getPage(t)};l.remove(),r.visible&&lt(c),r.on("hide",()=>Ln()),r.on("show",()=>lt(c))}else{const s=await e.getThread(t);l.remove(),no(e,s,o,i).defer(r)}})().catch(s=>{console.log(s,s.stack??"*no stack*"),l.parentNode&&l.remove(),el("div").atxt("Error! "+s+", check console.").clss("error").adto(o)}),r}let lt,Ln;{const[e,t]=L(null,{equals:(o,l)=>!1});let n=!1;const r=()=>{n||(n=!0,ge(_t,()=>u(yl,{get pgin(){return e()},addContent:(o,l)=>{o.page={...o.page,content:{...o.page.content,...l}},e()===o&&t(e())},get children(){return u(oa,{get pivot(){return e().page.pivot}})}}),{color_level:0}))};lt=o=>{console.log("showing page2",o.page),_t.style.display="",t(o),console.log("SHOWPAGE2 CALLED ON",o),r()},Ln=()=>{_t.style.display="none"}}function an(e){const t=document.createElement("div"),n=A(t);return t.appendChild(document.createTextNode(e)),n}function Da(e,t,n){const r=document.createElement("div"),o=A(r);return r.atxt("\u2026"),(async()=>{r.innerHTML="",r.atxt("Logging In\u2026");try{await e.login(t,n)}catch(l){console.log(l),r.innerHTML="",r.adch(el("div").clss("error").atxt("Login error! "+l.toString()));return}r.innerHTML="",r.atxt("Logged In! You may now close this page.")})().catch(l=>{console.log(l),alert("Unexpected error "+l.toString())}),o}const Ma={reddit:()=>J(()=>import("./reddit.52af0705.js"),["assets/reddit.52af0705.js","assets/base.50b98d34.js"]).then(e=>e.client),mastodon:()=>J(()=>import("./mastodon.6649cec4.js"),["assets/mastodon.6649cec4.js","assets/base.50b98d34.js"]).then(e=>e.client),hackernews:()=>J(()=>import("./hackernews.a0da1e19.js"),[]).then(e=>e.client),test:()=>J(()=>import("./test.1762bc1e.js"),["assets/test.1762bc1e.js","assets/_commonjsHelpers.2cf1d77b.js","assets/base.50b98d34.js"]).then(e=>e.client)};async function An(e){const t=e.toLowerCase(),n=Ma[t];if(!!n){if(Ve[t]||(Ve[t]=await n()),Ve[t].id!==t)throw new Error("client has incorrect id");return Ve[t]}}function ae(e){return Ve[e]??void 0}function Fe({path:e,page:t}){e.startsWith("/")&&(e=e.replace("/","#")||"#/"),console.log("Appending history state index",rt+1,e),history.pushState({index:rt+1,session_name:pt},"ThreadClient",e),vt(rt+1,location,t)}function Va(){const e=el("div"),t=A(e);return ge(e,()=>u(Is,{}),{color_level:0}).defer(t),t}function ja(){return Dt(J(()=>import("./settings.3717bc61.js"),[]),({default:e})=>{const t=el("div"),n=A(t);return ge(t,()=>u(e,{}),{color_level:0}).defer(n),n})}function Wa(){return Dt(J(()=>import("./ui_testing.c59ef127.js"),["assets/ui_testing.c59ef127.js","assets/index.d9a19671.js","assets/settings.3717bc61.js"]),({default:e})=>{const t=el("div"),n=A(t);return ge(t,()=>u(e,{}),{color_level:0}).defer(n),n})}function Ba(){const e=el("div"),t=A(e);return U("","/reddit","normal").atxt("Reddit").adto(e),e.atxt(" \xB7 "),U("","/mastodon","normal").atxt("Mastodon").adto(e),e.atxt(" \xB7 "),U("","/settings","normal").atxt("Settings").adto(e),e.atxt(" \xB7 "),U("","/","normal").atxt("Home").adto(e),t}function A(e){const t=e,n={};let r=!0,o=!0,l=!0;const i=()=>{const f=r&&o;f!==l&&(l=f,a(f?"show":"hide"),c.forEach(h=>h.setParentVisible(f)))};let s=!0;const c=new Set,a=f=>{const h=n[f];!h||h.forEach(m=>m())},d={on(f,h){n[f]??=[],n[f].push(h)},setVisible(f){if(!s)return console.log("hideshow called on a deleted object");r!==f&&(r=f,i())},setParentVisible(f){if(!s)return console.log("hideshow called on a deleted object");o!==f&&(o=f,i())},get visible(){return r},cleanup(){s=!1,c.forEach(f=>f.cleanup()),a("cleanup")},emit:a,addChild(f){return c.add(f),{cleanup:()=>{f.cleanup(),c.delete(f)}}},get associated_data(){return t},defer(f){return f.addChild(d),t}};return d}function Gt(e,t){const n=ae(e);return n?t(n):Dt(An(e),r=>r?t(r):an("404. Client "+e+" not found."))}function Dt(e,t){const n=el("div").adto(le),r=A(n),o=el("div").adto(n);return el("span").atxt("Fetching client\u2026").adto(o),e.then(l=>{t(l).defer(r).adto(n),o.remove()}).catch(l=>{console.log("error rendering",l),n.adch(el("span").clss("error").atxt("Got error! Check console! "+l.toString()))}),r}function cn(e,t){console.log("RENDERPATH",e,t);const n=(e+t).substring(1);if(n.toLowerCase().startsWith("http://")||n.toLowerCase().startsWith("https://")){let i;try{i=new URL(n)}catch{return an("Invalid URL: "+n)}if(i.hostname==="thread.pfg.pw")return cn(i.pathname,i.search);const s=It("null",i.toString());if(s.kind==="link"&&!s.external){const[a,...d]=s.url.split("?");return cn(a.replace("#",""),"?"+d.join("?"))}const c=Ot(n,{});if(c){const a=el("div"),d=A(a);return ge(a,()=>u(Q,{body:c,autoplay:!1}),{color_level:0}).defer(d),d}return an("Unsupported Link: "+n)}const r=e.split("/").filter(i=>i),o=r.shift();if(console.log(r),o==null)return Va();if(o==="pwa_start")return Ba();if(o==="settings")return ja();if(o==="ui_testing")return Wa();function l(){const[i,s]=L("loading\u2026");return(async()=>{const{client:c}=await J(()=>import("./reddit.52af0705.js"),["assets/reddit.52af0705.js","assets/base.50b98d34.js"]),{stringify:a}=await J(()=>import("./main.724a0124.js").then(function(f){return f.m}),["assets/main.724a0124.js","assets/_commonjsHelpers.2cf1d77b.js"]),d=await c.getPage("/"+r.join("/")+t);s(a(d))})().catch(c=>{console.log("err;",c),s(c.toString()+`
`+c.stack)}),(()=>{const c=ua.cloneNode(!0),a=c.firstChild;return v(a,u(St,{get content(){return[D.pre(i(),"json")]}})),c})()}if(o==="temp0"){const i=el("div"),s=A(i);return ge(i,()=>u(l,{}),{color_level:0}).defer(s),s}return o==="login"?Gt(r[0]??"ENOCLIENT",i=>Da(i,r,new URLSearchParams(t))):o==="saved"?Gt("reddit",i=>{const s=el("div").clss("client-wrapper"),c=A(s),a=el("div").adto(s);a.classList.add("client-main-frame");const d=to(c,i.id);return d.setTitle("Loading "+i.id+"\u2026"),no(i,JSON.parse(localStorage.getItem("saved-post")??"{}"),a,d),c}):Gt(o,i=>Ia(i,"/"+r.join("/")+t))}function vt(e,t,n){const r=t.pathname==="/"&&t.search===""&&t.hash.length>2?(()=>{try{return new URL("https://thread.pfg.pw/"+t.hash.substring(1))}catch{return t}})():t;console.log("Navigating",e,r,ye,n),document.title="ThreadClient",dn.forEach(a=>a(r));const o=r.pathname+r.search;Ha(e),Ln(),ye.forEach(a=>{a.node.kind==="t1"&&a.node.hide()});const l=ye[e];if(l)if(l.url!==o){console.log("URLS differ. \xAB",l.url,"\xBB \xAB",o,"\xBB");for(let a=ye.length-1;a>=e;a--){const d=ye.pop();if(!d)throw new Error("bad logic");d.node.kind==="t1"&&d.node.removeSelf()}}else{l.node.kind==="t1"?l.node.show():lt(l.node.page2);return}if(n){const d={page:n};lt(d),ye[e]={node:{kind:"t2",page2:d},url:o};return}const i=A(),s=cn(r.pathname,r.search).defer(i).adto(le);i.on("cleanup",()=>s.remove()),i.on("hide",()=>s.style.display="none"),i.on("show",()=>s.style.display="");const c={kind:"t1",removeSelf:()=>i.cleanup(),hide:()=>i.setVisible(!1),show:()=>i.setVisible(!0)};ye[e]={node:c,url:o}}function Ua(e){const t=document.createElement("div");document.body.appendChild(t);const n=te();Tt(()=>u(E,{get if(){return n.highlightRerenders()==="on"},get children(){return u(ll,{observe_root:e})}}),t)}console.log("APP.TSX WAS RELOADED.");localStorage.setItem("seen-page1","true");let le,Qe,ro,Lt,ye,pt,Ve,dn,rt,_t;function Ha(e){rt=e}function ir(){if(location.hash===""){const e=new URL(location.origin+"/#"+(location.pathname.replace("/","")+location.search+location.hash||"/"));history.replaceState(history.state,"",e)}}function qa(){if(le=document.createElement("threadclient"),document.body.appendChild(le),Qe=new Map,ir(),window.onpopstate=n=>{ir(),console.log("onpopstate. ev:",n.state);const r=n.state;if(r?.session_name!==pt){console.log("Going to history item from different session"),vt(0,location,void 0);return}vt(r?.index??0,location,void 0)},Ve={},ye=[],pt=""+Math.random(),dn=[],rt=0,el("div").adto(le),navigator.standalone||window.matchMedia("(display-mode: standalone)").matches){const n=el("nav").clss("navbar","bg-postcolor-100","transition-opacity").adto(le);Lt=n;const r=["px-2"];el("button").adto(n).attr({"aria-label":"Back"}).atxt("\u2190").clss(...r).onev("click",d=>{d.stopPropagation(),history.back()}),el("button").adto(n).attr({"aria-label":"Forward"}).atxt("\u2192").clss(...r).onev("click",d=>{d.stopPropagation(),history.forward()});const o=el("input").attr({"aria-label":"URL"}).adto(n).clss("bg-transparent text-center border border-gray-600 dark:border-gray-500"),l=el("button").attr({"aria-label":"Go"}).clss(...r).atxt("\u23CE").adto(n),i=el("button").attr({"aria-label":"Reload"}).clss(...r).atxt("\u{1F5D8}").adto(n),s=()=>Fe({path:"/"+o.value.replace(/^\//,"")});l.onclick=()=>s(),o.onkeydown=d=>d.key==="Enter"?s():0,i.onclick=()=>alert("TODO refresh"),dn.push(d=>{d.pathname.toLowerCase().startsWith("/http://")||d.pathname.toLowerCase().startsWith("/https://")?o.value=(d.pathname+d.search).substr(1):o.value=d.pathname+d.search});let c=window.scrollY,a=0;document.addEventListener("scroll",d=>{const f=window.scrollY,h=f-c;c=f;const m=Math.max(0,Math.min(100,f));a+=h,a>m&&(a=m),a<0&&(a=0);let g=a;f<0&&(g=-f),n.style.setProperty("--mobile-transform","translateY("+-g+"px)")},{passive:!1})}else Lt=el("nav").adto(le);console.log("ThreadClient built on "+Po.build_time),_t=el("div").adto(le),history.replaceState({index:0,session_name:pt},"ThreadClient",location.pathname+location.search+location.hash),vt(0,location,void 0);let e=100;const t=()=>{document.head.querySelector(".darkreader")?.remove(),e*=2,setTimeout(()=>t(),e)};setTimeout(()=>t(),0),ro=el("div").adto(le).clss("alert-area"),Ua(le)}const[Xa,oo]=L(!1),[Qa,Fa]=L(!1),lo=Eo({onNeedRefresh(){if(console.log("An update to ThreadClient is available"),Fa(!0),te().updateNotifications()==="on"){const t=el("div").clss("alert").adto(ro);el("div").clss("alert-body").adto(t).atxt("An update to ThreadClient is available."),I("pill-empty").atxt("Ignore").adto(t).onev("click",n=>{n.stopPropagation(),t.remove()}),t.atxt(" "),I("pill-empty").atxt("Update (Refresh)").adto(t).onev("click",n=>{n.stopPropagation(),lo(!0)})}},onOfflineReady(){console.log("Ready for offline use."),oo(!0)}});console.log("updateSW",lo);navigator.serviceWorker!=null&&navigator.serviceWorker.getRegistrations().then(e=>{e.every(t=>t.active)&&e.length!==0&&oo(!0)}).catch(e=>console.log("Error checking sw registrations",e));console.log("ROUTER.TS WAS RELOADED.",!1);qa();export{cr as $,ee as A,ge as B,Cn as C,ce as D,Ml as E,q as F,Vr as G,j as H,Wl as I,_n as J,Nt as K,se as L,Lr as M,Pr as N,$a as O,K as P,kr as Q,St as R,Tr as S,Nn as T,O as U,yn as V,H as W,kl as X,za as Y,co as Z,J as _,le as a,z as a0,Ja as a1,mr as b,Ya as c,tl as d,Ka as e,L as f,Xo as g,A as h,v as i,u as j,E as k,M as l,Ga as m,P as n,ul as o,Ft as p,G as q,D as r,at as s,b as t,Xa as u,Po as v,Qa as w,lo as x,W as y,te as z};
