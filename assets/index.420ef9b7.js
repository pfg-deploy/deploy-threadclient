import{v as e,n as t,t as n,c as o,u as r,a as l,o as i,i as a,b as s,s as c,d,r as u,e as h,f as p,g,h as f,j as v,E as m,k as b,l as _,m as y,p as x,q as k,w,F as $,M as N,S as C,x as E,y as L,z as S}from"./vendor.f1632930.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();window.el=(...e)=>document.createElement(...e),window.txt=e=>document.createTextNode(e),window.anychange=(e,t)=>(e.forEach((e=>e.oninput=()=>t())),t(),t),window.body=document.getElementById("maincontent")||document.body,Node.prototype.attr=function(e){return Object.entries(e).forEach((([e,t])=>null==t?this.removeAttribute(e):this.setAttribute(e,t))),this},Node.prototype.adto=function(e){return e.appendChild(this),this},Node.prototype.adch=function(...e){return e.forEach((e=>this.appendChild(e))),this},Node.prototype.atxt=function(e){return this.appendChild(txt(e)),this},Node.prototype.onev=function(...e){return this.addEventListener(...e),this},Node.prototype.clss=function(...e){return e.forEach((e=>e.split(/[. ]/g).filter((e=>e)).map((e=>this.classList.add(e))))),this},Node.prototype.styl=function(e){return Object.entries(e).forEach((([e,t])=>this.style.setProperty(e,t))),this},Object.defineProperty(Array.prototype,"last",{enumerable:!1,get:function(){return this[this.length-1]}}),Object.defineProperty(Object.prototype,"dwth",{enumerable:!1,value:function(e){return e(this),this}});const T={version:"3c5624e\n",log:[{hash:"3c5624e",hash_full:"3c5624ec74495e72fdd34219cd231761dcca59e9",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639724480000",commit_title:"broke morechildren oops",commit_body:"broke morechildren oops\n"},{hash:"8fc9d94",hash_full:"8fc9d94d086ec70b47b6b1233cc0bf69249cf430",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639720043000",commit_title:"fix lint",commit_body:"fix lint\n"},{hash:"4452091",hash_full:"4452091a04e0a66242a17f80da5a314841c1ed7c",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639719682000",commit_title:"ok excuse me reddit? why are you telling me to hide the score but also giving me the score?",commit_body:"ok excuse me reddit? why are you telling me to hide the score but also giving me the score?\n"},{hash:"90819a6",hash_full:"90819a67bc06f0945f528abbfac9f77c33eb638c",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639540794000",commit_title:"fix the close button on the redirect notice",commit_body:"fix the close button on the redirect notice\n"},{hash:"a51551d",hash_full:"a51551d141ce543e7b1c62b845f71cbcaddfd0ac",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639539756000",commit_title:"notes on how to do the thing i need in the extension",commit_body:"notes on how to do the thing i need in the extension\n"},{hash:"d5f5cc1",hash_full:"d5f5cc1fbf75aaa651f57bb414a730f8158df665",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639535344000",commit_title:"fix this error. also not sure why hmr broke still",commit_body:"fix this error. also not sure why hmr broke still\n"},{hash:"4024543",hash_full:"40245434ceda6de96cf39772fad19d173c9314ed",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639535293000",commit_title:"note on how to do the thing",commit_body:"note on how to do the thing\n"},{hash:"2831076",hash_full:"2831076961314cd2308a662ec2fe53aef145fee6",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639512544000",commit_title:"what did I change?",commit_body:"what did I change?\n"},{hash:"7b3a738",hash_full:"7b3a738d7a1898ba37130a3c29fb6688546f0ef0",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639104902000",commit_title:"note",commit_body:"note\n"},{hash:"8ed27e8",hash_full:"8ed27e8d0de909169d2026a93f7508b4277e9e76",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1639077603000",commit_title:"fix this bug finally it's been months",commit_body:"fix this bug finally it's been months\n"}],build_time:1639724668701,build_mode:"production"},P={},R=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in P)return;P[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};const O={kind:function(e,t,n){return{...t,kind:e,...n?{children:n}:{}}},p:(...e)=>O.kind("paragraph",{},e),hn:(e,...t)=>O.kind("heading",{level:e},t),h1:(...e)=>O.hn(1,...e),h2:(...e)=>O.hn(2,...e),ul:(...e)=>O.kind("list",{ordered:!1},e),ol:(...e)=>O.kind("list",{ordered:!0},e),li:(...e)=>O.kind("list_item",{},e),ili:(...e)=>O.kind("tight_list_item",{},e),blockquote:(...e)=>O.kind("blockquote",{},e),txt:(e,t={})=>O.kind("text",{text:e,styles:t}),link:(e,t,n,...o)=>O.kind("link",{url:t,client_id:e.id,...n},o),pre:(e,t)=>O.kind("code_block",{text:e,lang:t}),error:(e,t)=>O.kind("error",{text:e,value:t}),br:()=>O.kind("br",{}),flair:e=>O.kind("flair",{flair:e}),table:(e,...t)=>O.kind("table",{headings:e},t),th:(e,...t)=>({align:e,children:t}),td:(...e)=>({children:e}),timeAgo:e=>O.kind("time_ago",{start:e}),hr:()=>O.kind("horizontal_line",{}),code:e=>O.kind("code",{text:e}),spoiler:(...e)=>O.kind("spoiler",{},e)},A={link:(e,t,n,o)=>({selected:o,action:{kind:"link",client_id:e.id,url:n},text:t})};function j(e){const t="https://v.redd.it/"+e;return{kind:"video",sources:[{url:t+"/DASHPlaylist.mpd"},{url:t+"/HLSPlaylist.m3u8"}],preview:[{url:t+"/DASH_96.mp4",type:"video/mp4"},{url:t+"/DASH_96",type:"video/mp4"}]}}function V(e,t){const n=e.split(".");return n.pop(),n.push(t),n.join(".")}function M(e){return{kind:"video",source:j(e),gifv:!1}}function I(e,t){var n,o,r,l,i,a,s;let c;try{c=new URL(e)}catch(h){}const d=c,u=null!=(n=null==d?void 0:d.pathname)?n:e;if(!!d&&(u.endsWith(".gif")&&"mp4"===d.searchParams.get("format")))return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:e,quality:"Highest"}]}};if("i.imgur.com"===(null!=(o=null==d?void 0:d.hostname)?o:"")&&u.endsWith(".gif")||u.endsWith(".gifv"))return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:V(e,"webm"),quality:"Highest"},{url:V(e,"mp4"),quality:"Highest"},{url:e,quality:"Highest"}]}};if("i.redd.it"===(null!=(r=null==d?void 0:d.hostname)?r:"")||u.endsWith(".png")||u.endsWith(".jpg")||u.endsWith(".jpeg")||u.endsWith(".gif")||u.endsWith(".webp")||"pbs.twimg.com"===(null!=(l=null==d?void 0:d.hostname)?l:""))return{kind:"captioned_image",url:e,w:null,h:null};if(e.startsWith("https://v.redd.it/"))return M(e.replace("https://v.redd.it/",""));if(d&&("reddit.com"===d.host||d.host.endsWith(".reddit.com")&&d.pathname.startsWith("/link"))){const e=u.split("/");if(e.shift(),"link"===e[0]&&"video"===e[2]&&"player"===e[4])return M(null!=(i=e[3])?i:"")}if(d&&("gfycat.com"===d.host||d.host.endsWith(".gfycat.com"))&&2===d.pathname.split("/").length)return{kind:"gfycatv1",id:d.pathname.replace("/","").split("-")[0].split(".")[0].toLowerCase(),host:"gfycat.com"};if(d&&("redgifs.com"===d.host||d.host.endsWith(".redgifs.com"))&&3===d.pathname.split("/").length&&d.pathname.startsWith("/watch/")){return{kind:"gfycatv2",id:d.pathname.replace("/watch/","").split("-")[0].split(".")[0].toLowerCase(),host:"redgifs.com"}}if(u.endsWith(".mp4")||u.endsWith(".webm"))return{kind:"video",gifv:!1,source:{kind:"video",sources:[{url:e,quality:"Highest"}]}};if(u.endsWith(".mp3"))return{kind:"audio",url:e};if(d&&("www.youtube.com"===d.host||"youtube.com"===d.host||"m.youtube.com"===d.host)&&"/watch"===d.pathname){const e=d.searchParams.get("v");if(null!=e)return{kind:"youtube",id:e,search:d.searchParams.toString()}}if(d&&"youtu.be"===d.host&&2===d.pathname.split("/").length){return{kind:"youtube",id:null!=(a=d.pathname.split("/")[1])?a:"no_id",search:d.searchParams.toString()}}if(d&&("vocaroo.com"===d.host||"www.vocaroo.com"===d.host||"voca.ro"===d.host)){const e=d.pathname.split("/").filter((e=>e));if(1===e.length&&null!=e[0]&&""!==e[0])return{kind:"audio",url:"https://media.vocaroo.com/mp3/"+e[0]}}if(d&&("giphy.com"===d.host||"www.giphy.com"===d.host)){const e=d.pathname.split("/").filter((e=>e));if(3===e.length&&"gifs"===e[0]&&"fullscreen"===e[2]){const t=e[1].split("-");return{kind:"video",source:{kind:"video",sources:[{url:"https://media4.giphy.com/media/"+t[t.length-1]+"/giphy.mp4",quality:"Highest"}]},gifv:!0}}}if(d&&("www.imgur.com"===d.host||"imgur.com"===d.host||"m.imgur.com"===d.host)){const e=d.pathname.split("/").filter((e=>e)),t=e[1],n="gallery"===e[0]?"gallery":"a"===e[0]?"album":void 0;if(void 0!==n&&2===e.length)return{kind:"imgur",imgur_id:t,imgur_kind:n};if(1===e.length&&(null!=(s=e[0])?s:"").length>4)return{kind:"captioned_image",url:"https://i.imgur.com/"+e[0]+".jpg",w:null,h:null}}if(d&&"clips.twitch.tv"===d.host&&1===d.pathname.split("/").filter((e=>e)).length){const e=d.pathname.split("/").filter((e=>e))[0];if(null!=e)return{kind:"twitch_clip",slug:e}}return d&&("soundcloud.com"===d.host||d.host.endsWith(".soundcloud.com"))?{kind:"oembed",client_id:"n/a",url:"https://soundcloud.com/oembed?format=json&url="+encodeURIComponent(e)}:d&&("tiktok.com"===d.host||d.host.endsWith(".tiktok.com"))?{kind:"oembed",client_id:"n/a",url:"https://www.tiktok.com/oembed?url="+encodeURIComponent(e)}:null!=t.suggested_embed?{kind:"reddit_suggested_embed",suggested_embed:t.suggested_embed}:void 0}const D=Symbol("raw");const W=(q=e=>encodeURIComponent(e),(e,...t)=>{const n=[];return e.forEach(((e,o)=>{if(n.push({raw:e}),o<t.length){const e=t[o];"object"==typeof e&&D in e?n.push({raw:e[D]}):n.push({val:e})}})),n.map((e=>"raw"in e?e.raw:q(e.val))).join("")});var q;function U(e){let t="";for(const[n,o]of Object.entries(e))null!=o&&(t&&(t+="&"),t+=W`${n}=${o}`);return t}function H(e){throw console.log("not never:",e),new Error("Expected never")}function z(e,t,n,o){var r,l;const i={...e},a=[...t];for(const s of n)if("string"==typeof s){if(a.shift()!==s)return null}else{const e=Object.entries(s);if(!e[0]||1!==e.length)throw new Error("bad bit object");const[t,n]=e[0];if("any"===n){const e=a.shift();if(null==e)return null;i[t]=e}else if("rest"===n)i[t]=a.splice(0);else if("optional"===n)i[t]=null!=(r=a.shift())?r:null;else if(Array.isArray(n)||"forEach"in n){const e=null!=(l=a.shift())?l:null;if(!n.includes(e))return null;i[t]=e}else if("starts-with"===n.kind){const e=a.shift();if(null==e)return null;if(!e.startsWith(n.text))return null;i[t]=e.replace(n.text,"")}}return o.assert_end&&0!==a.length?null:{opts:i,path:a}}function G(e){const t=[],n={with(e,n){const o=G(!1);n(o),t.push(((t,n)=>{const r=z(t,n,e,{assert_end:!1});return r?o.parseSub(r.opts,r.path):null}))},route(e,n){t.push(((t,o)=>{const r=z(t,o,e,{assert_end:!0});return r?n(r.opts):null}))},catchall(e){t.push(((t,n)=>e(t)))},parse(t){if(!e)throw new Error("not root, ParentOpts ≠ BaseParentOpts");let o;try{o=new URL(t,new URL("https://example/"))}catch(i){return null}const r=o.pathname.split("/").filter((e=>e)),l={query:Object.fromEntries(o.searchParams),path:o.pathname};return n.parseSub(l,r)},parseSub(e,n){for(const o of t){const t=o(e,n);if(t)return t}return null}};return n}function B(){return G(!0)}function F(e,t){var n,o;const r=null!=(o=null!=(n=t[e.kind])?n:t.unsupported)?o:()=>{throw new Error("condition "+e.kind+" was not handled and no unsupported branch")};return()=>r(e)}function J(e,t){return F(e,t)()}const K=n("<time></time>");function Y(e){return o((()=>F(e.item,e.children)()))}function Q(e){const t=o((()=>e.when),void 0,{equals:(e,t)=>!e==!t});return o((()=>t()?e.children:e.fallback))}function X(e){return o((()=>{var t,n;if((null==(n=null==(t=e.if)?void 0:t[0])||n)&&null!=e.when){const t=e.children;return r((()=>t(e.when)))}return e.fallback}))}function Z(e,t){const n=document.getSelection();if(!1===(null==n?void 0:n.isCollapsed))return!1;let o=e;for(;o&&o!==t;){if(o instanceof HTMLElement&&("A"===o.nodeName||"BUTTON"===o.nodeName||"VIDEO"===o.nodeName||"AUDIO"===o.nodeName||"INPUT"===o.nodeName||"TEXTAREA"===o.nodeName||"IFRAME"===o.nodeName||o.classList.contains("resizable-iframe")||o.classList.contains("handles-clicks")))return!1;o=o.parentNode}return!0}function ee(e,t){if(!t.endsWith("s"))throw new Error("!s");return 1===e?e+t.substring(0,t.length-1):e+t}function te(e){const[t,n]=l(Date.now()),r=o((()=>{const o=function(e,t){const n=t-e;if(n<0)return["in the future "+new Date(e).toISOString(),-n];if(n<6e4)return["just now",6e4-n];let o=6e4,r=60;if(n<r*o){const e=n/o|0;return[ee(e," minutes")+" ago",o-(n-e*o)]}if(o*=r,r=24,n<r*o){const e=n/o|0;return[ee(e," hours")+" ago",o-(n-e*o)]}if(o*=r,r=30,n<r*o){const e=n/o|0;return[ee(e," days")+" ago",o-(n-e*o)]}return[new Date(e).toISOString(),-1]}(e.start,t());if(o[1]>0){const e=setTimeout((()=>n(Date.now())),Math.min(o[1]+10,2147483647));i((()=>clearTimeout(e)))}return o[0]}));return(()=>{const t=K.cloneNode(!0);return a(t,r),s((n=>{const o=new Date(e.start).toString(),r=""+new Date(e.start);return o!==n._v$&&c(t,"datetime",n._v$=o),r!==n._v$2&&c(t,"title",n._v$2=r),n}),{_v$:void 0,_v$2:void 0}),t})()}function ne(e,t){return"status_msg"in e?{kind:"richtext",content:[O.p(O.error("Could not preview oembed",e))]}:null!=e.url?{kind:"link_preview",client_id:t,thumb:e.embed_url||e.image||void 0,click:e.embed_url?{kind:"captioned_image",url:e.embed_url,w:null,h:null}:{kind:"link",client_id:t,url:e.url,embed_html:e.html||void 0},click_enabled:!(!e.embed_url&&!e.html),title:e.title,description:e.description,url:e.url}:{kind:"reddit_suggested_embed",suggested_embed:e.html}}const oe=n("<style>.cfg-reddit-pfp {display: none;}</style>"),re=n('<div class="block"><div class="w-22px h-22px flex items-center justify-center"><i></i></div></div>'),le=n("<div><pre><code> </code></pre><button>Code</button> / <button>Retry</button></div>"),ie=f();function ae(e){var t;const n=v(ie),o=null!=(t=null==n?void 0:n.i)?t:0,r=o+1;return h(ie.Provider,{value:{i:r},get children(){return e.children(o%2==0?"bg-postcolor-100":"bg-body",o)}})}const se=f();function ce(e){const t=v(se),n=o((()=>{var n;const o=null==(n=null==t?void 0:t.visible())||n,r=e.visible();return!!o&&r}));return h(se.Provider,{value:{visible:n},get children(){return e.children}})}function de(){var e;const t=v(se);return null!=(e=null==t?void 0:t.visible)?e:()=>!0}function ue(e,t,n){const o=()=>{var t;const o=null!=(t=localStorage.getItem(e))?t:void 0;return n.deserialize?n.deserialize(o):o},[r,i]=l(o()),a=()=>{i(o())};return window.addEventListener("storage",a),{value:()=>{var e;return null!=(e=r())?e:t()},compute:{base:t,override:r,setOverride:t=>{null==t?localStorage.removeItem(e):localStorage.setItem(e,n.serialize?n.serialize(t):t),a()}}}}function he(e,t,n){const o=window.matchMedia(e),[r,a]=l(o.matches?t:n),s=()=>{a((()=>o.matches?t:n))};return o.addEventListener("change",s),i((()=>{o.removeEventListener("change",s)})),r}const pe=d((()=>{const e={color_scheme:ue("color-scheme",he("(prefers-color-scheme: dark)","dark","light"),{}),author_pfp:ue("pfp-cfg",(()=>"on"),{}),update_notifications:ue("update_notices",(()=>"on"),{}),custom_video_controls:ue("custom_video_controls",(()=>"browser"),{}),page_version:ue("page_version",(()=>"1"),{}),link_helpers:ue("link_helpers",(()=>"show"),{}),cors_proxy:ue("cors_proxy",(()=>"off"),{}),gallery_display:ue("gallery_display",(()=>"fullscreen"),{}),motion:ue("motion",he("(prefers-reduced-motion: reduce)","reduce","full"),{}),animation_time:ue("animation_time",(()=>.2),{serialize:e=>JSON.stringify(e),deserialize:e=>null!=e&&""!==e?JSON.parse(e):void 0}),animation_dev_mode:ue("animation_dev_mode",(()=>"none"),{})};return g((()=>{document.documentElement.classList.toggle("dark","dark"===e.color_scheme.value())})),e}));function ge(){return pe}u((()=>h(Q,{get when(){return"off"===ge().author_pfp.value()},get children(){return oe.cloneNode(!0)}})),el("div").adto(document.head));const[fe,ve]=l(window.innerWidth);window.addEventListener("resize",(()=>{ve(window.innerWidth)}));const me=640;function be(...e){return e.flat().join(" ")}function _e(e){return(()=>{const t=re.cloneNode(!0),n=t.firstChild.firstChild;return s((t=>{const o=e.icon.class+" "+e.size,r=e.icon.label;return o!==t._v$&&(n.className=t._v$=o),r!==t._v$2&&c(n,"aria-label",t._v$2=r),t}),{_v$:void 0,_v$2:void 0}),t})()}function ye(e){const[t,n]=l(!0);return h(m,{fallback:(t,o)=>(console.log(t),(()=>{const r=le.cloneNode(!0),l=r.firstChild,i=l.firstChild.firstChild,a=l.nextSibling,c=a.nextSibling.nextSibling;return a.$$click=()=>console.log(t,e.data),c.$$click=()=>{n(!1),setTimeout((()=>n(!0)),200),o()},s((e=>{const n=t instanceof Error?t.toString()+"\n\n"+t.stack:"Something went wrong",o=Do["outlined-button"],r=Do["outlined-button"];return n!==e._v$3&&(i.data=e._v$3=n),o!==e._v$4&&(a.className=e._v$4=o),r!==e._v$5&&(c.className=e._v$5=r),e}),{_v$3:void 0,_v$4:void 0,_v$5:void 0}),r})()),get children(){return h(Q,{get when(){return t()},get fallback(){return"Retrying..."},get children(){return e.children}})}})}p(["click"]);const xe=n("<span></span>");function ke(e,t,n){const o=tr(),r=u((()=>{const[e,r]=l(o.visible);return o.on("hide",(()=>r(!1))),o.on("show",(()=>r(!0))),h(ce,{visible:e,get children(){return h(ie.Provider,{get value(){return{i:n.color_level}},get children(){return t()}})}})}),e);return o.on("cleanup",(()=>r())),o}function we(e){const t=de();return(()=>{const n=xe.cloneNode(!0);var o;return o=n,g((()=>{const n=tr(),r=e.getValue(n).adto(o);g((()=>{n.setVisible(t())})),i((()=>{n.cleanup(),r.remove()}))})),n})()}function $e({h:e,s:t,l:n,a:o=1}){if(0===t){const[e,t,r]=[n,n,n].map((e=>Math.round(255*e)));return{r:e,g:r,b:t,a:o}}const r=(1-Math.abs(2*n-1))*t,l=r*(1-Math.abs(e/60%2-1)),i=n-r/2,[a,s,c]=(e<60?[r,l,0]:e<120?[l,r,0]:e<180?[0,r,l]:e<240?[0,l,r]:e<300?[l,0,r]:[r,0,l]).map((e=>Math.round(255*(e+i))));return{r:a,g:s,b:c,a:o}}function Ne(e){const{r:t,g:n,b:o,a:r}=e;return null!=r&&r<1?`rgba(${Ce(t)}, ${Ce(n)}, ${Ce(o)}, ${Ce(r,2)})`:`rgb(${Ce(t)}, ${Ce(n)}, ${Ce(o)})`}function Ce(e,t=0){const n=e.toFixed(t);if(0===t)return n;const o=n.indexOf(".");if(o>=0){const e=n.match(/0+$/);if(e)return e.index===o+1?n.substring(0,o):n.substring(0,e.index)}return n}function Ee(e){const t=function(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}(e);return n=t(),o=t(),r=t(),l=t(),function(){let e=(n>>>=0)+(o>>>=0)|0;return n=o^o>>>9,o=(r>>>=0)+(r<<3)|0,e=e+(l=1+(l>>>=0)|0)|0,r=(r=r<<21|r>>>11)+e|0,(e>>>0)/4294967296};var n,o,r,l}function Le(e){const t={h:360*e(),s:.5*e()+.5,l:.4*e()+.1,a:1},n={...t,l:1-t.l};return[$e(t),$e(n)]}const Se=n("<div></div>");let Te=!1;function Pe(e,t,n,o){const[i,a]=l(null);e.addEventListener("transitionend",(()=>{a(null),o(n(),!1,!1)})),g(b([n],(()=>{const r=e.getBoundingClientRect(),l=sr.getBoundingClientRect(),i=()=>5+Math.max(0,l.bottom,window.visualViewport.offsetTop),s=()=>window.visualViewport.offsetTop+window.visualViewport.height;console.log(r.top,r.bottom,i(),s());let c=0;if(r.top<i()&&r.bottom>i()){const t=document.documentElement.scrollTop;e.scrollIntoView(),document.documentElement.scrollTop-=i();const n=document.documentElement.scrollTop;c=t-n}const d=n();if("reduce"===t.motion.value()||0===t.animation_time.value())return void o(d,!1,!1);const u=Math.min(r.bottom,s())-r.top-c,h=document.documentElement.scrollTop;a(null),o(d,!1,!0),requestAnimationFrame((()=>{const t=e.getBoundingClientRect(),n=Math.min(t.bottom,s())-t.top;n!==u?(o(d,!0,!0),a(u),e.scrollTop=c,requestAnimationFrame((()=>{document.documentElement.scrollTop=h,e.scrollTop=c,a(n)}))):o(d,!1,!1)}))}),{defer:!0})),g((()=>{null!=i()?(console.log("ANIMATING",Te),e.style.height=i()+"px",e.style.overflow="hidden",e.style.transition=r((()=>Te&&"shift_slow"===t.animation_dev_mode.value()?3:t.animation_time.value()))+"s height"):(e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition"))}))}function Re(e){const t=ge(),[n,o]=l({main:e.when,animating:!1});return(()=>{const r=Se.cloneNode(!0);var l;return Pe(l=r,t,(()=>e.when),((e,t,n)=>{o({main:e||t,animating:n})})),g((()=>{l.style.display=n().main||null!=e.fallback?"block":"none"})),a(r,h(Q,{get when(){return n().main||n().animating},get children(){const t=Se.cloneNode(!0);return a(t,(()=>e.children)),s((()=>t.className=n().animating&&!n().main?"hidden":"")),t}}),null),a(r,h(Q,{get when(){return!n().main||n().animating},get children(){const t=Se.cloneNode(!0);return a(t,(()=>e.fallback)),s((()=>t.className=n().animating&&n().main?"hidden":"")),t}}),null),r})()}document.addEventListener("keydown",(e=>{"Shift"===e.key&&(Te=!0)}),{capture:!0}),document.addEventListener("keyup",(e=>{"Shift"===e.key&&(Te=!1)}),{capture:!0}),document.addEventListener("focus",(e=>{Te=!1}));const Oe=n("<a></a>"),Ae=n("<span></span>"),je=n('<a target="_blank" rel="noopener noreferrer"></a>');function Ve(e){const t=o((()=>{const t=I(e.href,{});if(!t)return;const[n,o]=l(!1);return{visible:n,setVisible:o,body:t}}));return[h(Ie,{get client_id(){return e.client_id},get href(){return e.href},get style(){return t()?"previewable":"normal"},get onClick(){return t()?()=>{const e=t();e.setVisible(!e.visible())}:void 0},get children(){return[x((()=>e.children)),h(X,{get when(){return t()},children:e=>[" ",x((()=>e.visible()?"▾":"▸"))]})]}}),h(X,{get when(){return t()},children:e=>h(Re,{get when(){return e.visible()},get children(){return h(ro,{autoplay:!0,get body(){return e.body}})}})})]}function Me(e){const t=o((()=>vo(e.client_id,e.href)));return h(Y,{get item(){return t()},children:{error:t=>(()=>{const n=Oe.cloneNode(!0);return n.$$click=t=>{t.stopPropagation(),alert(e.href)},a(n,(()=>e.children)),s((o=>{const r=e.class+" error",l=t.title;return r!==o._v$&&(n.className=o._v$=r),l!==o._v$2&&c(n,"title",o._v$2=l),o}),{_v$:void 0,_v$2:void 0}),n})(),mailto:t=>(()=>{const n=Ae.cloneNode(!0);return a(n,(()=>e.children)),s((()=>c(n,"title",t.title))),n})(),link:t=>(()=>{const n=je.cloneNode(!0);return _(n,"click",!t.external||e.onClick?n=>{if(n.stopPropagation(),!n.defaultPrevented&&0===n.button&&!fo(n)){if(n.preventDefault(),e.onClick)return e.onClick();er({path:t.url})}}:void 0,!0),a(n,(()=>e.children)),s((o=>{const r=e.class,l=t.url;return r!==o._v$3&&(n.className=o._v$3=r),l!==o._v$4&&c(n,"href",o._v$4=l),o}),{_v$3:void 0,_v$4:void 0}),n})()}})}function Ie(e){return h(Me,{get client_id(){return e.client_id},get class(){return Do[e.style]},get href(){return e.href},get onClick(){return e.onClick},get children(){return e.children}})}function De(e){return(()=>{const t=Ae.cloneNode(!0);return a(t,h(Ie,{style:"userlink",get href(){return e.href},get client_id(){return e.client_id},get children(){return e.children}})),s((n=>y(t,(()=>{const[t,n]=Le(Ee(e.color_hash.toLowerCase()));return{"--light-color":Ne(t),"--dark-color":Ne(n)}})(),n))),t})()}p(["click"]);
//! flattens higherarchical page2 structure to a flat array
const We=(e,t)=>({kind:"todo",note:e,data:t}),qe=(e,t)=>({kind:"error",note:e,data:t});function Ue(e,t,n){var o;const r="TODO unique id "+e.url+Math.random();return{kind:"post",content:e,indent:t,collapse:{id:r,threaded:!1,collapsed:null!=(o=n.collapse_states.get(r))?o:"post"===e.kind&&("post"===e.content.kind&&(!1!==e.content.collapsible&&e.content.collapsible.default_collapsed))}}}function He(e,t,n){const o=[],r=Ue(e,t,n);o.push(r);const l=[...r.indent,r.collapse];if(!r.collapse.collapsed&&e.replies)for(const i of e.replies.items)void 0!==i.err?o.push(qe(i.err,i)):o.push(...He(i.ref,l,n));return o}const ze=n("<span> points</span>"),Ge=n("<button>⯆</button>"),Be=n("<span><button>⯅ </button></span>"),Fe=n('<button class="reddit-vote-button reddit-downvote-button" aria-label="Vote Down"><span>⯆</span></button>'),Je=n('<div class="flex flex-col items-center gap-2px"><button class="reddit-vote-button reddit-upvote-button" aria-label="Vote Up"><span>⯅ Vote</span></button></div>');function Ke(e){const[t,n]=l(null);let r;return o((()=>{const t=To(e().client_id+"_"+e().unique_id,{count:e().count_excl_you,you:e().you,time:e().time});i((()=>{t.cleanup()}));const{state:o,onupdate:l}=t.associated_data;return r=t.associated_data,n({...o}),l((()=>n({...o}))),0}))(),[t,e=>{Object.assign(r.state,e),r.emit()}]}function Ye(e){const[t]=Ke((()=>e.counter)),n=()=>Po(t());return[(()=>{const e=ze.cloneNode(!0),t=e.firstChild;return a(e,(()=>n().text),t),s((()=>c(e,"title",n().raw))),e})(),h(X,{get when(){return e.counter.percent},children:e=>" "+e.toLocaleString(void 0,{style:"percent"})+" upvoted"})]}async function Qe(e,t,n,o){n({...t,loading:!0,your_vote:e});try{const r=await Xo(o.client_id);if(!r)throw new Error("missing client");await async function(e,t,n){if("error"in n.actions)throw new Error("counter is error: "+n.actions.error);const o=n.actions[null!=e?e:"reset"];if(null==o)throw new Error("action "+e+" requested when it is not available.");await t.act(o)}(e,r,o),n({...t,loading:!1,your_vote:e})}catch(r){n({...t}),console.log(r),alert("Error while voting: "+r)}}function Xe(e){const[t,n]=Ke((()=>e.counter));return(()=>{const o=Be.cloneNode(!0),r=o.firstChild;return r.firstChild,r.$$click=()=>{Qe("increment"===t().your_vote?void 0:"increment",t(),n,e.counter)},a(r,h(Ye,{get counter(){return e.counter}}),null),a(o,h(Q,{get when(){return null!=e.counter.decremented_label},get children(){const o=Ge.cloneNode(!0);return o.$$click=()=>{Qe("decrement"===t().your_vote?void 0:"decrement",t(),n,e.counter)},s((e=>{const n=t().loading,r=Do["decrement"===t().your_vote?"action-button-active":"action-button"];return n!==e._v$&&(o.disabled=e._v$=n),r!==e._v$2&&(o.className=e._v$2=r),e}),{_v$:void 0,_v$2:void 0}),o}}),null),s((e=>{const n=t().loading,o=Do["increment"===t().your_vote?"action-button-active":"action-button"];return n!==e._v$3&&(r.disabled=e._v$3=n),o!==e._v$4&&(r.className=e._v$4=o),e}),{_v$3:void 0,_v$4:void 0}),o})()}function Ze(e){const[t,n]=Ke((()=>e.counter));return(()=>{const o=Je.cloneNode(!0),r=o.firstChild;return r.$$click=()=>{Qe("increment"===t().your_vote?void 0:"increment",t(),n,e.counter)},a(o,h(Q,{get when(){return null!=e.counter.decremented_label},get children(){const o=Fe.cloneNode(!0);return o.$$click=()=>{Qe("decrement"===t().your_vote?void 0:"decrement",t(),n,e.counter)},s((e=>{const n="decrement"===t().your_vote,r=t().loading,l="decrement"===t().your_vote;return n!==e._v$5&&o.classList.toggle("vote-icon-voted",e._v$5=n),r!==e._v$6&&(o.disabled=e._v$6=r),l!==e._v$7&&c(o,"aria-pressed",e._v$7=l),e}),{_v$5:void 0,_v$6:void 0,_v$7:void 0}),o}}),null),s((e=>{const n="increment"===t().your_vote,o=t().loading,l="increment"===t().your_vote;return n!==e._v$8&&r.classList.toggle("vote-icon-voted",e._v$8=n),o!==e._v$9&&(r.disabled=e._v$9=o),l!==e._v$10&&c(r,"aria-pressed",e._v$10=l),e}),{_v$8:void 0,_v$9:void 0,_v$10:void 0}),o})()}p(["click"]);const et=n('<div><textarea class="border my-3 w-full resize-y"></textarea><div class="flex space-x-1"><button></button><button>Cancel<div></div></button></div></div>'),tt=n('<pre class="error"><code>There was an error! </code></pre>'),nt=n("<button>Hide error</button>");function ot(e){const[t,n]=function(e){const[t,n]=l(localStorage.getItem(e)),o=t=>{t.key===e&&n(t.newValue)};return window.addEventListener("storage",o),i((()=>window.removeEventListener("storage",o))),[t,t=>{null==t?localStorage.removeItem(e):localStorage.setItem(e,t),n(t)}]}("comment-draft-"+e.action.client_id+"-"+e.action.key),o=()=>{var e;return null!=(e=t())?e:""},r=()=>""===o().trim(),[c,d]=l(!1),[u,p]=l(void 0),[f,v]=k({value:null});return g((()=>{const t=Zo(e.action.client_id).previewReply(o(),e.action.reply_info);v(w({value:t},{merge:!0}))})),(()=>{const t=et.cloneNode(!0),l=t.firstChild,i=l.nextSibling.firstChild,g=i.nextSibling;return l.$$input=e=>{n(e.currentTarget.value)},i.$$click=t=>{d(!0);Zo(e.action.client_id).sendReply(o(),e.action.reply_info,e.action.mode).then((t=>{console.log("Got response",t),n(null),e.onAddReply({ref:{kind:"post",internal_data:t.raw_value,content:"thread"===t.kind?{kind:"legacy",thread:t,client_id:e.action.client_id}:{kind:"post",title:{text:"Error"},body:{kind:"richtext",content:[O.p(O.error("Unsupported 'load more'",t))]},show_replies_when_below_pivot:!1,collapsible:!1},display_style:"centered",parent:null,replies:null,url:null,client_id:e.action.client_id}})})).catch((e=>{d(!1);const t=e;console.log("Got error",t),p(t.toString()+"\n"+t.stack)}))},a(i,(()=>c()?"…":e.action.text)),g.$$click=t=>{e.onCancel()},a(t,h(X,{get when(){return u()},children:e=>[(()=>{const t=tt.cloneNode(!0),n=t.firstChild;return n.firstChild,a(n,e,null),t})(),(()=>{const e=nt.cloneNode(!0);return e.$$click=()=>p(void 0),e})()]}),null),a(t,h(X,{get if(){return[!r()]},get when(){return f.value},children:t=>(console.log("Value changed",t),h(zt,{restrict_w:!0,get children(){return h(Ut,{listing:t,get opts(){return{clickable:!1,replies:null,at_or_above_pivot:!0,is_pivot:!0,top_level:!0,frame:null,client_id:e.action.client_id}}})}}))}),null),s((e=>{const t=c(),n=o(),a=r()||c(),s=Do[r()?"pill-empty":"pill-filled"],d=c(),u=Do["pill-empty"];return t!==e._v$&&(l.disabled=e._v$=t),n!==e._v$2&&(l.value=e._v$2=n),a!==e._v$3&&(i.disabled=e._v$3=a),s!==e._v$4&&(i.className=e._v$4=s),d!==e._v$5&&(g.disabled=e._v$5=d),u!==e._v$6&&(g.className=e._v$6=u),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),t})()}p(["input","click"]);const rt=n("<section></section>"),lt=n("<button></button>"),it=n("<button>Code</button>");function at(e){const[t,n]=l(null);return[(()=>{const o=rt.cloneNode(!0);return a(o,(()=>e.children),null),a(o,h(X,{get when(){var t;return null==(t=e.opts.frame)?void 0:t.url},children:t=>h(Ie,{get client_id(){return e.opts.client_id},href:t,style:"action-button",get children(){return h(X,{get when(){var t;return null==(t=e.content.info)?void 0:t.comments},fallback:"Focus",children:e=>e.toLocaleString()+" comment"+(1===e?"":"s")})}})}),null),a(o,h(X,{get if(){return[!1===e.content.collapsible]},get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>h(Xe,{counter:e})}),null),a(o,h(X,{get if(){return[e.content.show_replies_when_below_pivot&&!e.opts.at_or_above_pivot]},get when(){var t,n;return null==(n=null==(t=e.opts.frame)?void 0:t.replies)?void 0:n.reply},children:o=>{const r=()=>h(ot,{get action(){return o.action},onCancel:()=>n(null),onAddReply:t=>{e.onAddReply(t),n(null)}});return(()=>{const e=lt.cloneNode(!0);return e.$$click=()=>{t()===r?n(null):n((()=>r))},a(e,(()=>o.action.text+(o.locked?" (Locked)":""))),s((n=>{const l=Do[t()===r?"action-button-active":"action-button"],i=o.locked;return l!==n._v$&&(e.className=n._v$=l),i!==n._v$2&&(e.disabled=n._v$2=i),n}),{_v$:void 0,_v$2:void 0}),e})()}}),null),a(o,h(X,{get when(){var t;return null==(t=e.content.actions)?void 0:t.other},children:e=>h($,{each:e,children:(e,t)=>h(st,{action:e})})}),null),a(o,h(X,{get when(){var t,n,o;return null==(o=null==(n=null==(t=e.content)?void 0:t.actions)?void 0:n.code)?void 0:o.body},get fallback(){return(()=>{const t=it.cloneNode(!0);return t.$$click=()=>{console.log(e.opts.frame)},s((()=>t.className=Do["code-button"])),t})()},children:o=>{const r=()=>h(ro,{body:o,autoplay:!0});return(()=>{const o=it.cloneNode(!0);return o.$$click=()=>{console.log(e.opts.frame),t()===r?n(null):n((()=>r))},s((()=>o.className=Do[t()===r?"action-button-active":"action-button"])),o})()}}),null),s((()=>o.className="flex flex-wrap gap-2 "+(fe()<me?"flex-col":"items-center"))),o})(),h(X,{get when(){return t()},children:e=>e()})]}function st(e){return h(we,{getValue:t=>{const n=el("span");return Lo(e.action,n,{value_for_code_btn:0}).defer(t),n}})}p(["click"]);const ct=n('<img class="w-8 h-8 object-center inline-block rounded-full">'),dt=n("<span></span>"),ut=n('<img class="inline-block w-4 h-4 align-middle object-contain">'),ht=n("<div>Error! </div>"),pt=n("<li></li>"),gt=n('<button aria-label="Collapse"><div class="collapse-btn-inner rounded-none"></div></button>'),ft=n("<div></div>"),vt=n("<button></button>"),mt=n("<div><button></button></div>"),bt=n('<div class="mt-2"></div>'),_t=n("<section></section>"),yt=n('<article><div class="flex-1"><div class="flex flex-row"><div><div></div><div></div></div></div><div></div></div></article>'),xt=n('<img alt="">'),kt=n('<span role="heading"></span>'),wt=n('<span class="whitespace-normal"></span>'),$t=n('<span class="text-green-600 dark:text-green-500">Pinned</span>'),Nt=n("<button>Show Anyway</button>"),Ct=n("<button>code</button>"),Et=n('<div class="m-4"></div>'),Lt=n('<div style="border-bottom-left-radius: 0; border-bottom-right-radius: 0"></div>'),St=n('<div style="border-top-left-radius: 0; border-top-right-radius: 0"></div>'),Tt=n('<div><div class="flex flex-row"><div class="flex-1"></div></div></div>'),Pt=n('<button class="text-blue-500 hover:underline">Load More (<!>)</button>'),Rt=n('<hr class="my-2 border-t-2">'),Ot=n("<div>TODO: <!> <button>code</button></div>"),At=n('<div class="text-red-500">Error: <!> <button>code</button></div>');function jt(e){return(()=>{const t=ct.cloneNode(!0);return c(t,"alt",""),s((()=>c(t,"src",e.src_url))),t})()}function Vt(e){return(()=>{const t=dt.cloneNode(!0);return a(t,h($,{get each(){return e.flairs},children:e=>[" ",(()=>{const t=dt.cloneNode(!0);return a(t,h($,{get each(){return e.elems},children:e=>h(Y,{item:e,children:{text:e=>()=>e.text,emoji:e=>(()=>{const t=ut.cloneNode(!0);return s((n=>{const o=e.name,r=e.url,l=e.w,i=e.h;return o!==n._v$4&&c(t,"title",n._v$4=o),r!==n._v$5&&c(t,"src",n._v$5=r),l!==n._v$6&&c(t,"width",n._v$6=l),i!==n._v$7&&c(t,"height",n._v$7=i),n}),{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),t})()}})})),s((n=>{const o=null!=e.system?{none:"",op:"text-blue-500",cake:"text-gray-500",admin:"text-red-500",moderator:"text-green-500",approved:"text-green-500",error:"text-red-500"}[e.system]:"rounded-full px-2"+(null!=e.color?" bg-flair-light dark:bg-flair-dark":" bg-gray-300")+(null!=e.fg_color?" flair-text-"+e.fg_color:""),r=e.color,l=e.color;return o!==n._v$&&(t.className=n._v$=o),r!==n._v$2&&t.style.setProperty("--flair-color",n._v$2=r),l!==n._v$3&&t.style.setProperty("--flair-color-dark",n._v$3=l),n}),{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()]})),t})()}function Mt(e){return(()=>{const t=x((()=>!!e.fallback),!0);return h(Q,{get when(){return null==e.link.err},get fallback(){return t()?r((()=>e.fallback(e.link.err))):(()=>{const t=ht.cloneNode(!0);return t.firstChild,a(t,(()=>e.link.err),null),t})()},get children(){return r((()=>e.children(e.link.ref)))}})})()}function It(e){const t=o((()=>{var t,n;if(!e.is_threaded)return;const o=null==(n=null==(t=e.reply.ref)?void 0:t.replies)?void 0:n.items;return o&&1===o.length?o[0]:void 0}));return[(()=>{const n=pt.cloneNode(!0);return a(n,h(Mt,{get link(){return e.reply},children:e=>h(Y,{item:e,children:{post:n=>h(Dt,{get content(){return n.content},get opts(){return{clickable:!1,at_or_above_pivot:!1,is_pivot:!1,frame:n,client_id:n.client_id,replies:null!=t()?null:e.replies,top_level:!1}}}),loader:()=>"TODO load more TODO load more may have replies"}})})),s((()=>{var o;return n.className=be(e.is_threaded&&(null!=t()||null!=(o=e.parent_is_threaded)&&o)?["relative","threaded"]:[])})),n})(),h(X,{get when(){return t()},children:e=>h(It,{reply:e,is_threaded:!0,parent_is_threaded:!0})})]}function Dt(e){return h(Y,{get item(){return e.content},children:{post:t=>h(qt,{content:t,get opts(){return e.opts}}),page:()=>"TODO page",legacy:e=>h(we,{getValue:t=>{const n=el("div").clss("-mt-10px -ml-10px"),o=el("div").clss("post text-sm").adto(n);return Io(Zo(e.client_id),e.thread,o,{clickable:!0}).defer(t),n}}),client:()=>"TODO client"}})}function Wt(e){return(()=>{const t=gt.cloneNode(!0);return t.$$click=()=>e.onClick(),c(t,"draggable",!0),s((n=>{const o="collapse-btn z-1 static outline-default "+e.class,r=e.collapsed_anim,l=e.collapsed_raw;return o!==n._v$8&&(t.className=n._v$8=o),r!==n._v$9&&t.classList.toggle("collapsed",n._v$9=r),l!==n._v$10&&c(t,"aria-pressed",n._v$10=l),n}),{_v$8:void 0,_v$9:void 0,_v$10:void 0}),t})()}function qt(e){var t;const n=!1!==e.content.collapsible&&e.content.collapsible.default_collapsed,[o,r]=l(!!e.opts.is_pivot||!n),[i,d]=l(!!(null!=(t=e.content.flair)?t:[]).find((e=>e.content_warning))),u=()=>!!e.content.thumbnail||!!e.content.title,p=()=>!!e.content.thumbnail,f=ge(),[v,m]=l(o()),[b,_]=l({visible:o(),animating:!1}),[y,k]=l(!1),w=()=>fe()<me;g((()=>{w()||k(!1)}));const $=()=>{var t;return null!=(null==(t=e.opts.frame)?void 0:t.url)&&!e.opts.is_pivot},[N,C]=l([]),E=e=>{C((t=>[e,...t]))};return(()=>{const t=yt.cloneNode(!0),l=t.firstChild,g=l.firstChild,N=g.firstChild,C=N.firstChild,L=C.nextSibling,S=g.nextSibling;return Pe(t,f,v,((e,t,n)=>{_({visible:t||e,animating:n}),r(e||t)})),t.style.setProperty("--left-v","8px"),a(t,h(Q,{get when(){return!1!==e.content.collapsible},get children(){const t=ft.cloneNode(!0);return a(t,h(X,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>(()=>{const t=ft.cloneNode(!0);return a(t,h(Ze,{counter:e})),s((()=>t.className=o()||p()?"":" hidden")),t})()}),null),a(t,h(Wt,{class:"flex-1",get collapsed_raw(){return!v()},get collapsed_anim(){return!o()},onClick:()=>{m((e=>!e))}}),null),s((()=>t.className="flex flex-col items-center mr-1 gap-2 "+(e.opts.top_level?"sm:px-1":"sm:pr-1"))),t}}),l),a(g,h(X,{get when(){return e.content.thumbnail},children:e=>h(ae,{children:t=>(()=>{const n=vt.cloneNode(!0);return n.$$click=()=>m((e=>!e)),a(n,h(Y,{item:e,children:{image:e=>(()=>{const t=xt.cloneNode(!0);return s((n=>{const o=e.url,r=be("w-full h-full object-contain");return o!==n._v$16&&c(t,"src",n._v$16=o),r!==n._v$17&&(t.className=n._v$17=r),n}),{_v$16:void 0,_v$17:void 0}),t})(),default:e=>["TODO ",x((()=>e.kind))]}})),s((()=>n.className=be("w-50px h-50px sm:w-70px sm:h-70px mr-4 rounded-md "+t,i()&&"image"===e.kind?"thumbnail-content-warning":""))),n})()})}),N),N.$$click=t=>{var n;if(!$())return;if(!Z(t.target,t.currentTarget))return;t.stopPropagation();const o="/"+e.opts.client_id+(null==(n=e.opts.frame)?void 0:n.url);t.ctrlKey||t.metaKey||t.altKey?window.open(o):er({path:o,page:e.opts.frame?{pivot:{ref:e.opts.frame}}:void 0})},a(C,h(X,{get when(){return e.content.title},children:t=>(()=>{const n=kt.cloneNode(!0);return a(n,h(X,{get when(){var t;return null==(t=e.opts.frame)?void 0:t.url},get fallback(){return t.text},children:n=>h(Me,{get client_id(){return e.opts.client_id},href:n,class:"hover:underline",get children(){return t.text}})})),n})()}),null),a(C,h(Vt,{get flairs(){var t;return null!=(t=e.content.flair)?t:[]}}),null),a(L,h(X,{get when(){return e.content.author},children:e=>[h(X,{get if(){return[o()&&"on"===f.author_pfp.value()]},get when(){return e.pfp},fallback:"By ",children:e=>[h(jt,{get src_url(){return e.url}})," "]}),h(De,{get client_id(){return e.client_id},get href(){return e.link},get color_hash(){return e.color_hash},get children(){return e.name}})," "]}),null),a(L,h(Q,{get when(){return o()||u()},get fallback(){return h(Q,{when:n,get fallback(){return(()=>{const t=wt.cloneNode(!0);return a(t,(()=>"“"+(()=>{const t=io(e.content.body);return t.length>500?t.substring(0,500)+"…":t})()+"”")),t})()},get children(){return h(X,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},fallback:"[Collapsed by default]",children:e=>[h(Ye,{counter:e})," "]})}})},get children(){return[h(X,{get when(){return e.content.author},children:e=>h(X,{get when(){return e.flair},children:e=>[h(Vt,{flairs:e})," "]})}),h(X,{get when(){var t;return null==(t=e.content.info)?void 0:t.in},children:e=>[" in ",h(Ie,{get href(){return e.link},style:"normal",get client_id(){return e.client_id},get children(){return e.name}})," "]}),h(X,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>[h(Ye,{counter:e})," "]}),h(X,{get when(){return e.content.info},children:e=>[h(X,{get when(){return e.creation_date},children:e=>[h(te,{start:e})," "]}),h(X,{get when(){return e.edited},children:e=>["Edited",h(X,{get when(){return e.date},children:e=>[" ",h(te,{start:e})]})," "]}),h(Q,{get when(){var t;return null!=(t=e.pinned)&&t},get children(){return[$t.cloneNode(!0)," "]}})]}),h(Q,{get when(){return w()},get children(){const e=vt.cloneNode(!0);return e.$$click=()=>k((e=>!e)),a(e,(()=>y()?"▾":"▸")),s((()=>e.className=Do["outlined-button"])),e}})]}}),null),a(N,(()=>{const t=x((()=>!!p()),!0);return h(Q,{get when(){return t()&&!w()},get children(){const t=ft.cloneNode(!0);return a(t,h(at,{get content(){return e.content},get opts(){return e.opts},onAddReply:E,get children(){const e=mt.cloneNode(!0),t=e.firstChild;return t.$$click=()=>m((e=>!e)),a(t,(()=>v()?"Hide":"Show")),s((()=>t.className=Do["outlined-button"])),e}})),s((()=>t.className=u()?"":"text-xs")),t}})})(),null),a(l,(()=>{const t=x((()=>!!w()),!0);return h(Re,{get when(){return t()&&y()},get children(){return h(at,{get content(){return e.content},get opts(){return e.opts},onAddReply:E})}})})(),S),a(S,h(ce,{visible:()=>b().visible||b().animating,get children(){return[(()=>{const t=_t.cloneNode(!0);return a(t,h(Q,{get when(){return b().visible||b().animating},get children(){return[(()=>{const e=x((()=>!!o()),!0);return h(Q,{get when(){return e()&&p()},get children(){return bt.cloneNode(!0)}})})(),h(Re,{get when(){return!i()},get fallback(){return["Content Warning:"," ",h(Vt,{get flairs(){var t;return(null!=(t=e.content.flair)?t:[]).filter((e=>e.content_warning))}})," ",(()=>{const e=Nt.cloneNode(!0);return e.$$click=()=>d(!1),s((()=>e.className=Do["pill-filled"])),e})()]},get children(){return h(ro,{get body(){return e.content.body},autoplay:!1})}})]}})),t})(),(()=>{const t=x((()=>!p()),!0);return h(Q,{get when(){return t()&&!w()},get children(){const t=ft.cloneNode(!0);return a(t,h(at,{get content(){return e.content},get opts(){return e.opts},onAddReply:E})),s((()=>t.className=u()?"":"text-xs")),t}})})()]}})),s((n=>{const r=be("text-sm","pt-10px",!1!==e.content.collapsible?e.opts.top_level?"pl-1":"":"pl-15px","flex flex-row",e.opts.top_level?"-mt-10px -ml-10px":[]),l="flex-1"+($()?" hover-outline":""),i=be(u()?"text-base":"text-xs"),a=be(u()?"":"text-xs",o()||p()?"":"filter grayscale text-$collapsed-header-color italic max-lines max-lines-1"),s=o()?"block":"none";return r!==n._v$11&&(t.className=n._v$11=r),l!==n._v$12&&(N.className=n._v$12=l),i!==n._v$13&&(C.className=n._v$13=i),a!==n._v$14&&(L.className=n._v$14=a),s!==n._v$15&&S.style.setProperty("display",n._v$15=s),n}),{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),t})()}function Ut(e){const t=e=>["TODO support. also in the parent list these should probably"," ","be one of those navbars with bits like ClientName ",">"," PageName ",">"," …"," ",(()=>{const t=Ct.cloneNode(!0);return t.$$click=()=>console.log(e),t})()];return(()=>{const n=ft.cloneNode(!0);return a(n,h(ye,{get data(){return[e.listing,e.opts]},get children(){return h(Y,{get item(){return e.listing},children:{page:e=>t(e),client:e=>t(e),post:t=>h(qt,{content:t,get opts(){return e.opts}}),legacy:t=>h(we,{getValue:n=>Vo(Zo(t.client_id),t.thread,{clickable:e.opts.clickable}).defer(n)})}})}})),n})()}function Ht(e){const t=o((()=>function(e,t){var n;const o=[];if(void 0!==e.pivot.err)throw new Error("no pivot; "+e.pivot.err);const r=e.pivot.ref;let l=r;const i=[];for(;i.unshift({kind:"wrapper_end"}),i.unshift(Ue(l,[],t)),i.unshift({kind:"wrapper_start"}),l.parent;){if(void 0!==l.parent.err){i.unshift(qe(l.parent.err,l));break}l=l.parent.ref}if(o.push(...i),r.replies){o.push({kind:"horizontal_line"}),(null==(n=r.replies)?void 0:n.reply)&&o.push(We("(add reply)",r));for(const e of r.replies.items)o.push({kind:"wrapper_start"}),void 0!==e.err?o.push(qe(e.err,e)):o.push(...He(e.ref,[],t)),o.push({kind:"wrapper_end"});0===r.replies.items.length&&o.push(We("*There are no replies*",r))}return{body:o}}(e.page,{collapse_states:new Map})));return(()=>{const e=Et.cloneNode(!0);return a(e,h($,{get each(){return t().body},children:e=>h(Y,{item:e,children:{wrapper_start:()=>h(ae,{children:e=>(()=>{const t=Lt.cloneNode(!0);return t.className=" "+e+" h-2 rounded-xl mt-4",t})()}),wrapper_end:()=>h(ae,{children:e=>(()=>{const t=St.cloneNode(!0);return t.className=" "+e+" h-2 rounded-xl mb-4",t})()}),post:e=>h(ae,{children:t=>(()=>{const n=Tt.cloneNode(!0),o=n.firstChild,r=o.firstChild;return n.className="px-2 "+t,a(o,h($,{get each(){return e.indent},children:e=>h(Wt,{collapsed_raw:!1,collapsed_anim:!1,onClick:()=>{alert("todo!")}})}),r),a(r,h(Y,{get item(){return e.content},children:{post:e=>h(Dt,{get content(){return e.content},get opts(){return{clickable:!1,frame:e,client_id:e.client_id,replies:e.replies,at_or_above_pivot:!1,top_level:!1,is_pivot:!1}}}),loader:e=>(()=>{const t=Pt.cloneNode(!0),n=t.firstChild.nextSibling;return n.nextSibling,a(t,(()=>{var t;return null!=(t=e.load_count)?t:"????"}),n),t})()}})),n})()}),horizontal_line:()=>(()=>{const e=Rt.cloneNode(!0);return e.style.setProperty("border-top-color","var(--collapse-line-color)"),e})(),todo:e=>(()=>{const t=Ot.cloneNode(!0),n=t.firstChild.nextSibling,o=n.nextSibling.nextSibling;return a(t,(()=>e.note),n),o.$$click=()=>console.log(e.data),t})(),error:e=>(()=>{const t=At.cloneNode(!0),n=t.firstChild.nextSibling,o=n.nextSibling.nextSibling;return a(t,(()=>e.note),n),o.$$click=()=>console.log(e.data),t})()}})})),e})()}function zt(e){return h(ae,{children:(t,n)=>(()=>{const o=ft.cloneNode(!0);return a(o,(()=>e.children)),s((()=>{var r;return o.className=(0===n?"object-wrapper top-level-wrapper":"p-10px mt-10px rounded-xl")+" "+t+" "+(null!=(r=e.restrict_w)&&r?"max-w-xl":"")})),o})()})}p(["click"]);const Gt=n("<span></span>"),Bt=n("<br>"),Ft=n('<button title="Click to reveal spoiler"></button>'),Jt=n('<span class="relative bg-spoiler-color-hover rounded"><span></span></span>'),Kt=n('<img class="w-4 h-4 object-contain inline-block">'),Yt=n('<code class="bg-gray-200 p-1 rounded text-gray-800"></code>'),Qt=n("<p></p>"),Xt=n('<h1 class="text-3xl text-gray-900 font-black"></h1>'),Zt=n('<h2 class="text-2xl text-gray-900 font-bold"></h2>'),en=n('<h3 class="text-xl text-gray-900 font-semibold"></h3>'),tn=n('<h4 class="text-lg text-gray-900 font-medium"></h4>'),nn=n('<h5 class="text-base text-gray-600 font-normal"></h5>'),on=n('<h6 class="text-sm text-gray-600 font-normal underline"></h6>'),rn=n('<div class="py-2"><div class="w-full h-2px bg-gray-400 rounded"></div></div>'),ln=n('<blockquote class="border-l-2 border-gray-600 text-gray-600 pl-3"></blockquote>'),an=n("<li></li>"),sn=n("<div></div>"),cn=n('<ol class="list-decimal pl-4"></ol>'),dn=n('<ul class="list-disc pl-4"></ul>'),un=n("<table><thead><tr></tr></thead><tbody></tbody></table>"),hn=n("<th></th>"),pn=n("<tr></tr>"),gn=n("<td></td>"),fn=n('<select class="block"><option value="null">None</option></select>'),vn=n('<pre tabindex="0"></pre>'),mn=n("<button> </button>"),bn=n("<option></option>"),_n=n('<code class="!whitespace-pre-wrap"></code>'),yn=n('<div class="my-2"></div>'),xn=n('<div class="max-lines max-lines-1"></div>'),kn=n('<div><div class="max-lines max-lines-1 break-all font-light text-gray-800 dark:text-gray-400"></div></div>'),wn=n('<div class="max-1-line break-all font-light text-gray-800 dark:text-gray-400"></div>'),$n=n('<div class="inline-block"></div>'),Nn={link:"normal","pill-empty":"pill-empty"};function Cn(e){const t=()=>{var t;return"link"===(null!=(t=e.rts.style)?t:"link")};return(()=>{const n=Gt.cloneNode(!0);return a(n,h(C,{get children(){return[h(N,{get when(){return null!=e.rts.is_user_link&&e.rts.is_user_link},children:t=>h(De,{get client_id(){return e.rts.client_id},color_hash:t,get href(){return e.rts.url},get children(){return h(Ln,{get spans(){return e.rts.children}})}})}),(()=>{const n=x((()=>null==e.rts.is_user_link),!0);return h(N,{get when(){return n()&&t()},get children(){return h(Ve,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get children(){return h(Ln,{get spans(){return e.rts.children}})}})}})})(),(()=>{const n=x((()=>null==e.rts.is_user_link),!0);return h(N,{get when(){return n()&&!t()},get children(){return h(Ie,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get style(){var t;return Nn[null!=(t=e.rts.style)?t:"link"]},get children(){return h(Ln,{get spans(){return e.rts.children}})}})}})})()]}})),s((()=>c(n,"title",e.rts.title))),n})()}function En(e){return h(Y,{get item(){return e.span},children:{text:e=>(()=>{const t=Gt.cloneNode(!0);return t.classList.toggle("whitespace-pre-wrap",!0),a(t,(()=>e.text)),s((n=>{const o=e.styles.strong,r=e.styles.emphasis,l=e.styles.strikethrough,i=e.styles.superscript,a=e.styles.superscript;return o!==n._v$&&t.classList.toggle("font-bold",n._v$=o),r!==n._v$2&&t.classList.toggle("italic",n._v$2=r),l!==n._v$3&&t.classList.toggle("line-through",n._v$3=l),i!==n._v$4&&t.classList.toggle("align-top",n._v$4=i),a!==n._v$5&&t.classList.toggle("text-xs",n._v$5=a),n}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})(),link:e=>h(Cn,{rts:e}),br:()=>Bt.cloneNode(!0),spoiler:e=>{const[t,n]=l(!1);return(()=>{const o=Jt.cloneNode(!0),r=o.firstChild;return a(o,h(Q,{get when(){return!t()},get children(){const e=Ft.cloneNode(!0);return e.$$click=()=>n(!0),e.className="absolute top-0 left-0 bottom-0 right-0 w-full h-full rounded bg-spoiler-color hover:bg-spoiler-color-hover cursor-pointer",e}}),r),a(r,h(Ln,{get spans(){return e.children}})),s((()=>r.className=be("rounded","transition-opacity","bg-spoiler-color-revealed",t()?"":"opacity-0 invisible"))),o})()},emoji:e=>(()=>{const t=Kt.cloneNode(!0);return s((n=>{const o=e.url,r=e.name;return o!==n._v$6&&c(t,"src",n._v$6=o),r!==n._v$7&&c(t,"title",n._v$7=r),n}),{_v$6:void 0,_v$7:void 0}),t})(),flair:e=>h(Vt,{get flairs(){return[e.flair]}}),time_ago:e=>h(te,{get start(){return e.start}}),error:e=>h(we,{getValue:t=>qo("error").atxt(e.text).onev("click",(t=>{console.log(e.value)}))}),code:e=>(()=>{const t=Yt.cloneNode(!0);return a(t,(()=>e.text)),t})()}})}function Ln(e){return h($,{get each(){return e.spans},children:e=>h(En,{span:e})})}function Sn(e){return h(Y,{get item(){return e.paragraph},children:{paragraph:e=>(()=>{const t=Qt.cloneNode(!0);return a(t,h(Ln,{get spans(){return e.children}})),t})(),body:e=>h(ro,{get body(){return e.body},autoplay:!1}),heading:e=>{const t=()=>h(Ln,{get spans(){return e.children}});return 1===e.level?(()=>{const e=Xt.cloneNode(!0);return a(e,t),e})():2===e.level?(()=>{const e=Zt.cloneNode(!0);return a(e,t),e})():3===e.level?(()=>{const e=en.cloneNode(!0);return a(e,t),e})():4===e.level?(()=>{const e=tn.cloneNode(!0);return a(e,t),e})():5===e.level?(()=>{const e=nn.cloneNode(!0);return a(e,t),e})():(()=>{const e=on.cloneNode(!0);return a(e,t),e})()},horizontal_line:()=>rn.cloneNode(!0),blockquote:e=>(()=>{const t=ln.cloneNode(!0);return a(t,h(Vn,{get content(){return e.children}})),t})(),list:e=>{const t=o((()=>e.children.every((e=>"tight_list_item"===e.kind||1===e.children.length)))),n=()=>h($,{get each(){return e.children},children:e=>(()=>{const n=an.cloneNode(!0);return a(n,h(Y,{item:e,children:{list_item:e=>h(Vn,{get content(){return e.children},get tight(){return t()}}),tight_list_item:e=>(()=>{const n=sn.cloneNode(!0);return a(n,h(Ln,{get spans(){return e.children}})),s((()=>n.classList.toggle("my-2",!t()))),n})()}})),s((()=>n.classList.toggle("tight",t()))),n})()});return e.ordered?(()=>{const e=cn.cloneNode(!0);return a(e,n),e})():(()=>{const e=dn.cloneNode(!0);return a(e,n),e})()},code_block:e=>h(An,{get text(){return e.text},get default_language(){var t;return null!=(t=e.lang)?t:null}}),table:e=>(()=>{const t=un.cloneNode(!0),n=t.firstChild,o=n.firstChild,r=n.nextSibling;return a(o,h($,{get each(){return e.headings},children:e=>(()=>{const t=hn.cloneNode(!0);return a(t,h(Ln,{get spans(){return e.children}})),s((()=>{var n;return t.className=Tn[null!=(n=e.align)?n:"none"]})),t})()})),a(r,h($,{get each(){return e.children},children:t=>(()=>{const n=pn.cloneNode(!0);return a(n,h($,{each:t,children:(t,n)=>(()=>{const o=gn.cloneNode(!0);return a(o,h(Ln,{get spans(){return t.children}})),s((()=>{var t,r;return o.className=Tn[null!=(r=null==(t=e.headings[n()])?void 0:t.align)?r:"none"]})),o})()})),n})()})),t})()}})}const Tn={left:"text-left",center:"text-center",right:"text-right",none:""},[Pn,Rn]=l(void 0);let On=!1;function An(e){const[t,n]=l(e.default_language);g((()=>n(e.default_language)));const[o,r]=l(null),c=()=>e.text.length<1e4,[d,u]=l(!1);return g((()=>{(null!=t()||d())&&(Pn()&&!On||(On=!0,R((()=>import("./prismjs.224c7f54.js").then((function(e){return e.p}))),["assets/prismjs.224c7f54.js","assets/_commonjsHelpers.4e997714.js"]).then((e=>Rn(e))).catch((e=>{alert("error loading syntax highlighter"),On=!1,console.log(e)}))))})),g((()=>{var n;if(!c())return;let o=!0;i((()=>o=!1)),r(null),Pn()&&null!=t()&&Pn().highlight(e.text,null!=(n=t())?n:"plaintext").then((e=>{o&&(r(e),null==e&&console.log("syn hl language not supported",t()))})).catch((e=>{console.log(e),alert("error highlighting")}))})),(()=>{const r=vn.cloneNode(!0);return a(r,h(Q,{get when(){return c()},get children(){const e=sn.cloneNode(!0);return a(e,(()=>{const e=x((()=>!!Pn()),!0);return h(Q,{get when(){return e()&&d()},get fallback(){return(()=>{const e=mn.cloneNode(!0),n=e.firstChild;return e.$$click=()=>{u((e=>!e))},a(e,(()=>{var e;return null!=(e=t())?e:"None"}),n),a(e,(()=>d()?"▴":"▾"),null),s((()=>e.className=be(["font-sans"]))),e})()},get children(){const e=fn.cloneNode(!0);return e.firstChild,e.$$input=e=>{const t=e.currentTarget.value;n("null"===t?null:t)},a(e,h($,{get each(){return Pn().listLanguages().sort(((e,t)=>e.localeCompare(t)))},children:e=>(()=>{const t=bn.cloneNode(!0);return t.value=e,a(t,e),t})()}),null),e}})})()),s((()=>e.className=be(["absolute","top-0 right-0","transition-opacity","opacity-0","group-hover:opacity-100","group-focus:opacity-100","focus:opacity-100","bg-gray-100 rounded","p-2 px-3"]))),e}}),null),a(r,h(X,{get when(){return o()},get fallback(){return(()=>{const t=_n.cloneNode(!0);return a(t,(()=>e.text)),t})()},children:e=>(()=>{const t=sn.cloneNode(!0);return t.innerHTML=e,t})()}),null),s((()=>{var e;return r.className=be(["bg-gray-200 p-2 rounded text-gray-800","relative","group","outline-default","language-"+(null!=(e=t())?e:"none"),"!whitespace-pre-wrap"])})),r})()}function jn(e){const t=ge(),n=o((()=>{const t=I(e.link.url,{});if(!t)return;const[n,o]=l(!1);return{visible:n,toggleVisible:()=>o((e=>!e)),body:t}})),r=o((()=>{const t=vo(e.link.client_id,e.link.url);return"link"===t.kind?{link:t.url,external:t.external}:{link:"error",external:!0}})),[i,c]=l({open:!1,temporary:!1});return h(Q,{get when(){return"error"!==r().link},get children(){const o=yn.cloneNode(!0);return a(o,h(ae,{children:t=>h(Me,{get client_id(){return e.link.client_id},get class(){return be("p-2 px-4","block",t,"rounded-xl",i().open?"rounded-b-none":"")},get href(){return e.link.url},get onClick(){return n()?()=>{n().toggleVisible()}:void 0},get children(){return[(()=>{const t=xn.cloneNode(!0);return a(t,h(X,{get when(){return n()},children:e=>()=>e.visible()?"▾ ":"▸ "}),null),a(t,(()=>e.link.title),null),t})(),h(Q,{get when(){return!i().open||i().temporary},get children(){const e=kn.cloneNode(!0),t=e.firstChild;return a(t,(()=>{const e=x((()=>!n()),!0);return h(Q,{get when(){return e()&&r().external},get children(){return[h(In,{})," "]}})})(),null),a(t,(()=>r().link),null),s((()=>e.style.setProperty("display",i().open?"none":"block"))),e}})]}})}),null),a(o,h(X,{get when(){return n()},children:n=>[(()=>{const e=sn.cloneNode(!0);return Pe(e,t,n.visible,((e,t,n)=>{c({open:e||t,temporary:n})})),a(e,h(Q,{get when(){return i().open||i().temporary},get children(){const e=sn.cloneNode(!0);return a(e,h(ro,{get body(){return n.body},autoplay:!0})),s((()=>e.style.setProperty("display",i().open?"block":"none"))),e}})),e})(),h(Q,{get when(){return i().open||i().temporary},get children(){const t=sn.cloneNode(!0);return a(t,h(ae,{children:t=>h(Me,{get client_id(){return e.link.client_id},get class(){return be("p-2 px-4","block",t,"rounded-xl rounded-t-none")},get href(){return e.link.url},get children(){const e=wn.cloneNode(!0);return a(e,h(Q,{get when(){return r().external},get children(){return[h(In,{})," "]}}),null),a(e,(()=>r().link),null),e}})})),s((()=>t.style.setProperty("display",i().open?"block":"none"))),t}})]}),null),o}})}function Vn(e){const t=ge();return h($,{get each(){return e.content},children:n=>[(()=>{const t=sn.cloneNode(!0);return a(t,h(Sn,{paragraph:n})),s((()=>{var n;return t.classList.toggle("my-2",!(null!=(n=e.tight)&&n))})),t})(),h(Q,{get when(){return"show"===t.link_helpers.value()},get children(){return h($,{get each(){return function(e){return J(e,{paragraph:e=>Dn(e.children),body:()=>[],heading:e=>Dn(e.children),horizontal_line:()=>[],blockquote:()=>[],list:e=>e.children.flatMap((e=>"tight_list_item"===e.kind?Dn(e.children):[])),code_block:()=>[],table:e=>[...e.headings.flatMap((e=>Dn(e.children))),...e.children.flatMap((e=>e.flatMap((e=>Dn(e.children)))))]})}(n)},children:e=>h(jn,{link:e})})}})]})}function Mn(e){return h(Vn,{get content(){return e.content}})}function In(){return(()=>{const e=$n.cloneNode(!0);return a(e,h(_e,{size:"icon-sm",icon:{class:"icon-external",label:"External"}})),e})()}function Dn(e){return e.flatMap((e=>J(e,{link:e=>[{title:qn(e.children),url:e.url,client_id:e.client_id}],error:()=>[],text:()=>[],br:()=>[],spoiler:e=>Dn(e.children),emoji:()=>[],flair:()=>[],time_ago:()=>[],code:()=>[]})))}function Wn(e){return e.map((e=>J(e,{paragraph:e=>qn(e.children),body:e=>io(e.body),heading:e=>qn(e.children),horizontal_line:e=>"---",blockquote:e=>Wn(e.children),list:e=>e.children.map(((t,n)=>{const o=e.ordered?n+". ":"• ";return"tight_list_item"===t.kind?o+qn(t.children):"list_item"===t.kind?o+Wn(t.children):void H(t)})).join("\n"),code_block:e=>e.text,table:()=>"[table]"}))).join("\n")}function qn(e){return e.map((e=>J(e,{link:e=>qn(e.children),error:e=>"[error]",text:e=>e.text,br:()=>"\n",spoiler:e=>"[spoiler]",emoji:e=>":"+e.name+":",flair:()=>"[flair]",time_ago:()=>"[time ago]",code:e=>e.text}))).join("")}p(["click","input"]);const Un=n("<div>Loading...</div>"),Hn=n("<div><div></div></div>"),zn=n('<div><div class="border p-2"><div class="font-bold"></div><div></div></div></div>'),Gn=n("<button></button>"),Bn=n("<div></div>"),Fn=n("<div><div>TODO polls are currently not supported</div><ul></ul></div>"),Jn=n("<li> (<!>)</li>"),Kn=n("<div>Caption: </div>"),Yn=n("<audio></audio>"),Qn=n('<div><h1 class="text-base font-light"><svg aria-label="Mastodon" class="preview-image" viewBox="0 0 713.35878 175.8678" style="fill: currentColor;"><use href="/images/mastodon/Logotype (Full).svg#base" width="713.35878" height="175.8678"></use></svg></h1><h2 class="text-2xl font-black py-1">Select your instance</h2><div class="py-1"><label>Instance Name: <input class="border rounded-md p-1" placeholder="mastodon.social"></label><button>Go →</button></div><p class="py-2">Not on mastodon? Join at </p><p class="py-2">Note that some instances may require logging in before they let you view timelines.</p></div>'),Xn=n('<div><button>Retry</button><span class="text-red-500"></span></div>'),Zn=n("<button><img></button>"),eo=n("<button>Prev</button>"),to=n("<button>Next</button>"),no=n("<button>Gallery</button>"),oo=S((()=>R((()=>import("./preview_video.09d40d26.js")),["assets/preview_video.09d40d26.js","assets/vendor.f1632930.js"])));function ro(e){return h(ye,{get data(){return e.body},get children(){return h(E,{get fallback(){return Un.cloneNode(!0)},get children(){return h(lo,{get body(){return e.body},get autoplay(){return e.autoplay}})}})}})}function lo(e){return h(Y,{get item(){return e.body},children:{text:e=>{const[t]=L(e,ko);return h(X,{get when(){return t()},children:e=>h(ro,{body:e,autoplay:!1})})},link:t=>{const n=o((()=>{const e=I(t.url,{suggested_embed:t.embed_html});if(e)return{body:e}}));return(()=>{const o=Hn.cloneNode(!0),r=o.firstChild;return a(r,h(Ie,{get client_id(){return t.client_id},get href(){return t.url},style:"normal",get children(){return t.url}})),a(o,h(X,{get when(){return n()},children:t=>h(ro,{get body(){return t.body},get autoplay(){return e.autoplay}})}),null),o})()},none:()=>[],gallery:e=>h(so,{get images(){return e.images}}),removed:t=>{const[n,o]=l({kind:"none"});return(()=>{const r=zn.cloneNode(!0),l=r.firstChild,i=l.firstChild,c=i.nextSibling;return a(i,(()=>t.removal_message.title)),a(c,(()=>t.removal_message.body)),a(l,h(X,{get when(){return"loaded"!==n().kind?t.fetch_path:void 0},children:e=>(()=>{const r=Gn.cloneNode(!0);return r.$$click=()=>{(async()=>{const n=await Xo(t.client_id);let r,l=!1;if(o({kind:"loading"}),!n)throw new Error("invalid client");if(!n.fetchRemoved)throw new Error("client provided a removal fetch path but has no fetchRemoved");try{r=await n.fetchRemoved(e)}catch(i){const e=i;l=!0,console.log(e),r={kind:"text",client_id:"n/a",content:"Error! "+e.toString(),markdown_format:"none"}}console.log("Got new body:",r),o({kind:l?"error":"loaded",body:r})})().catch(console.log)},a(r,(()=>({none:"View",loading:"...",error:"Retry",loaded:"never"}[n().kind]))),s((e=>{const t=Do["outlined-button"],o="loading"===n().kind||"loaded"===n().kind;return t!==e._v$&&(r.className=e._v$=t),o!==e._v$2&&(r.disabled=e._v$2=o),e}),{_v$:void 0,_v$2:void 0}),r})()}),null),a(r,h(ro,{get body(){return t.body},get autoplay(){return e.autoplay}}),null),a(r,h(Y,{get item(){return n()},children:{none:()=>[],loading:()=>Un.cloneNode(!0),error:e=>(()=>{const t=Bn.cloneNode(!0);return a(t,h(ro,{get body(){return e.body},autoplay:!1})),t})(),loaded:e=>(()=>{const t=Bn.cloneNode(!0);return a(t,h(ro,{get body(){return e.body},autoplay:!1})),t})()}}),null),r})()},crosspost:e=>h(zt,{restrict_w:!0,get children(){return h(Ut,{get listing(){return{kind:"legacy",thread:e.source,client_id:e.client_id}},get opts(){return{clickable:!0,client_id:e.client_id,frame:null,replies:null,at_or_above_pivot:!1,is_pivot:!1,top_level:!1}}})}}),richtext:e=>(()=>{const t=Bn.cloneNode(!0);return a(t,h(Mn,{get content(){return e.content}})),t})(),poll:e=>(()=>{const t=Fn.cloneNode(!0),n=t.firstChild.nextSibling;return a(n,h($,{get each(){return e.choices},children:e=>(()=>{const t=Jn.cloneNode(!0),n=t.firstChild,o=n.nextSibling;return o.nextSibling,a(t,(()=>e.name),n),a(t,(()=>"hidden"===e.votes?"hidden":"Vote(s)"),o),t})()})),t})(),captioned_image:e=>(()=>{const t=Bn.cloneNode(!0);return a(t,h(we,{getValue:()=>{var t,n;const o=el("div");return Eo(e.url,{w:null!=(t=e.w)?t:void 0,h:null!=(n=e.h)?n:void 0,alt:e.alt}).adto(o),o}}),null),a(t,h(X,{get when(){return e.caption},children:e=>(()=>{const t=Kn.cloneNode(!0);return t.firstChild,a(t,e,null),t})()}),null),t})(),video:t=>h(oo,{video:t,get autoplay(){return e.autoplay}}),audio:t=>(()=>{const n=Yn.cloneNode(!0);return(e=>{const t=de();g((()=>{t()||e.pause()}))})(n),n.controls=!0,a(n,(()=>{var e;return null!=(e=t.alt)?e:"Audio is not supported and alt text was not provided"})),s((o=>{const r=t.url,l=e.autoplay;return r!==o._v$3&&c(n,"src",o._v$3=r),l!==o._v$4&&(n.autoplay=o._v$4=l),o}),{_v$3:void 0,_v$4:void 0}),n})(),array:e=>h($,{get each(){return e.body},children:e=>e?h(ro,{body:e,autoplay:!1}):null}),gfycatv1:t=>h(we,{getValue:n=>{const o=el("div");return function(e,t,n){const o=el("div"),r=tr(o),l=Uo().adto(o);return fetch("https://api."+e+"/v1/gfycats/"+t).then((e=>e.json())).then((e=>{var t,i;if(console.log("gfylike response:",e),l.remove(),o.adch(el("div").adch(qo("code-button").atxt("code").onev("click",(t=>{t.stopPropagation(),console.log(e)})))),"message"in e)return void el("div").clss("error").adto(o).atxt("Error: "+e.message);if("errorMessage"in e)return void el("div").clss("error").adto(o).atxt("Error: "+e.errorMessage);const{gfyItem:a}=e;null!=a.title&&o.adch(el("div").atxt("Title: "+a.title)),null!=a.description&&o.adch(el("div").atxt("Description: "+a.description));const s=[...null!=a.mp4Url?[{url:a.mp4Url,type:"video/mp4",quality:"Highest"}]:[],...null!=a.webmUrl?[{url:a.webmUrl,type:"video/webm",quality:"Highest"}]:[],...a.content_urls.webm?[{url:a.content_urls.webm.url,quality:"Highest"}]:[],...a.content_urls.mp4?[{url:a.content_urls.mp4.url,quality:"Highest"},{url:a.content_urls.mp4.url.replace(".mp4","-mobile.mp4"),quality:"Mobile"}]:[],...a.content_urls.mobile?[{url:a.content_urls.mobile.url,quality:"Mobile"}]:[],...null!=a.mobileUrl?[{url:a.mobileUrl,quality:"Mobile"}]:[]],c=a.content_urls,d=null!=(i=null!=(t=c.max5mbGif)?t:c.max2mbGif)?i:c.max1mbGif;wo({kind:"video",aspect:a.width/a.height,gifv:!1,source:s.length>0?{kind:"video",sources:s}:null!=d?{kind:"img",url:d.url}:{kind:"img",url:(()=>{throw console.log("Bad gfy image in",a),new Error("Bad gfy image")})()}},{autoplay:n.autoplay}).defer(r).adto(o)})).catch((e=>{const t=e;console.log(t),l.parentNode&&l.remove(),o.adch(el("div").clss("error").atxt("Error loading gfycat : "+t.toString()))})),r}(t.host,t.id,{autoplay:e.autoplay}).defer(n).adto(o),o}}),gfycatv2:e=>h(ao,{data:e}),imgur:e=>h(we,{getValue:t=>{const n=el("div");return function(e,t){const n=el("div"),o=tr(n),r=Uo().adto(n);return fetch("https://api.imgur.com/3/"+e+"/"+t,{headers:{Authorization:"Client-ID 6ccf617dc7a8830",Accept:"application/json"}}).then((e=>e.json())).then((e=>{const t=e;if(console.log("imgur result",t),t.success){wo({kind:"gallery",images:("images"in t.data?t.data.images:[t.data]).map((e=>{const t=e.animated&&null!=e.mp4?{kind:"video",source:{kind:"video",sources:[{url:e.mp4,quality:e.width+"×"+e.height}]},aspect:e.width/e.height,gifv:e.looping,caption:e.description}:{kind:"captioned_image",caption:e.description,url:e.link,w:e.width,h:e.height};return{thumb:"https://i.imgur.com/"+e.id+"t.jpg",aspect:e.width/e.height,body:t}}))},{autoplay:!1}).defer(o).adto(n),r.remove()}else console.log(t),r.parentNode&&r.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur: "+("localhost"===location.hostname?"Imgur does not work on localhost. Follow the instructions in CONTRIBUTING.md to fix. Imgur said: "+t.data.error:t.data.error)))})).catch((e=>{console.log(e),r.parentNode&&r.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur : "+e.toString()))})),o}(e.imgur_kind,e.imgur_id).defer(t).adto(n),n}}),youtube:t=>h(we,{getValue:n=>{const o=el("div");return function(e,t,n){const o=new URLSearchParams(t),r=el("div"),l=function(e,t,n){var o,r;const l=null!=(r=null!=(o=n.get("t"))?o:n.get("start"))?r:void 0,i=el("iframe").attr({allow:"fullscreen",src:"https://www.youtube.com/embed/"+e+"?version=3&enablejsapi=1&playerapiid=ytplayer"+(t.autoplay?"&autoplay=1":"")+(null!=l?"&start="+l.replace("s",""):"")});return{node:el("div").clss("resizable-iframe").styl({width:"640px",height:"360px"}).adch(i),onhide:()=>{var e;null==(e=i.contentWindow)||e.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}}}(e,{autoplay:n.autoplay},o);l.node.adto(r);const i=tr(r);return i.on("hide",(()=>{var e;return null==(e=l.onhide)?void 0:e.call(l)})),i.on("show",(()=>{var e;return null==(e=l.onshow)?void 0:e.call(l)})),i}(t.id,t.search,{autoplay:e.autoplay}).defer(n).adto(o),o}}),twitch_clip:e=>{const[t]=L(e.slug,$o);return h(X,{get when(){return t()},children:e=>h(ro,{body:e,autoplay:!1})})},reddit_suggested_embed:e=>h(we,{getValue:t=>{const n=el("div");return function(e){try{const t=el("template");t.innerHTML=e;const n=t.content.childNodes[0];if(!n)throw new Error("missing iframe");const o=n instanceof HTMLIFrameElement?{src:n.src,allow:n.allow,allowfullsreen:""}:{srcdoc:e},r=el("div").clss("resizable-iframe");let l;const i=()=>{l||(l=el("iframe").attr(o).adto(r))};i();const a=tr(r);return a.on("hide",(()=>{l&&(l.remove(),l=void 0)})),a.on("show",(()=>i())),a}catch(t){const n=t;console.log(n);const o=el("div");return o.adch(el("p").atxt("Error adding suggestedembed: "+n.toString()).clss("error")),o.adch(el("pre").adch(el("code").atxt(e))),tr(o)}}(e.suggested_embed).defer(t).adto(n),n}}),link_preview:e=>h(we,{getValue:t=>{const n=el("div");return function(e,t){const n=el("div"),o=tr(n);let r;r=t.click_enabled?el("div").clss("bg-body rounded-lg block").adto(n):mo(e,t.url,"none",{onclick:t.click_enabled?()=>{r.remove(),wo(t.click,{autoplay:!0}).defer(o).adto(n)}:void 0}).clss("bg-body rounded-lg hover:shadow-md hover:bg-gray-100 block").adto(n);const l=el("article").clss("flex",t.click_enabled?"flex-col":"flex-row").adto(r),i=el("div").clss(t.click_enabled?"w-full h-auto min-h-10 relative":"w-24 h-full flex items-center justify-center bg-gray-100","rounded-lg overflow-hidden").adto(el("div").adto(l));null!=t.thumb?t.click_enabled?i.adch(el("img").clss(t.click_enabled?"w-full h-full":"").attr({src:t.thumb})):el("div").styl({"background-image":`url(${JSON.stringify(t.thumb)})`,"background-size":"contain","background-position":"center","background-repeat":"no-repeat"}).clss("w-full h-full").adto(i):i.adch(el("div").atxt("🔗"));if(t.click_enabled){const n=el("div").adto(i);n.clss("flex items-center justify-center absolute top-0 left-0 bottom-0 right-0");const r=el("div").clss("rounded-lg bg-gray-200 p-2 flex shadow-md gap-3").adto(n);el("button").clss("hover:underline").adto(r).atxt("Play").onev("click",(e=>{e.stopPropagation(),i.innerHTML="",wo(t.click,{autoplay:!0}).defer(o).adto(i)})),r.atxt(" "),mo(e,t.url,"none").clss("hover:underline").atxt("Open").adto(r)}const a=el("div").clss("flex flex-col p-3 text-sm").adto(l);return a.adch(el("h1").clss("max-lines max-lines-1 font-black").atxt(t.title)),a.adch(el("p").clss("max-lines max-lines-2").atxt(t.description)),a.adch(el("div").clss("max-lines max-lines-1 font-light break-all").atxt(t.url)),o}(e.client_id,e).defer(t).adto(n),n}}),oembed:e=>h(we,{getValue:t=>{const n=el("div");return function(e){const t=el("div"),n=tr(t);return or(fetch(e.url,{headers:{Accept:"application/json"}}).then((e=>e.json())),(t=>{console.log("oembed resp",t);const o=el("div"),r=tr(o);return wo(ne(t,e.client_id),{autoplay:!1}).defer(n).adto(o),r})).defer(n).adto(t),n}(e).defer(t).adto(n),n}}),mastodon_instance_selector:e=>{const[t,n]=l(""),r=o((()=>{const e=t();return!!e.trim()&&(!(e.indexOf("/")>-1)&&-1!==e.indexOf("."))})),i=()=>{r()&&er({path:"/"+e.client_id+"/"+t().replaceAll("/","-")})};return(()=>{const e=Qn.cloneNode(!0),o=e.firstChild,l=o.nextSibling.nextSibling,c=l.firstChild,d=c.firstChild.nextSibling,u=c.nextSibling,p=l.nextSibling;return p.firstChild,o.style.setProperty("max-width","6rem"),d.$$keydown=e=>{"Enter"===e.key&&i()},d.$$input=e=>n(e.currentTarget.value),u.$$click=()=>{i()},a(p,h(Ie,{client_id:"",style:"normal",href:"https://joinmastodon.org",children:"joinmastodon.org"}),null),s((e=>{const n=t(),o=!r(),l=Do[r()?"pill-filled":"pill-empty"];return n!==e._v$5&&(d.value=e._v$5=n),o!==e._v$6&&(u.disabled=e._v$6=o),l!==e._v$7&&(u.className=e._v$7=l),e}),{_v$5:void 0,_v$6:void 0,_v$7:void 0}),e})()}}})}function io(e){return J(e,{text:()=>"[text]",richtext:e=>Wn(e.content),link:e=>e.url,captioned_image:()=>"[image]",video:()=>"[video]",gfycatv1:()=>"[gif]",gfycatv2:()=>"[gif]",youtube:()=>"[video]",imgur:()=>"[images]",twitch_clip:()=>"[video]",oembed:()=>"[link]",reddit_suggested_embed:()=>"[content]",audio:()=>"[audio]",gallery:()=>"[gallery]",poll:()=>"[poll]",none:()=>"",removed:e=>io(e.body),crosspost:()=>"[crosspost]",array:e=>e.body.map((e=>e?io(e):"")).join("\n"),link_preview:e=>e.url,mastodon_instance_selector:()=>"[mastodon instance selector]"})}function ao(e){const[t,n]=l({kind:"loading"}),[o,r]=l(Symbol());return g((()=>{o();let t=!0;i((()=>t=!1));const r=e.data;(async function(e,t){const n=await fetch("https://api."+e+"/v2/gifs/"+t).then((e=>e.json()));if(console.log("gfy response",n),"errorMessage"in n)throw new Error("Gfycat error: "+n.errorMessage+"; logged="+n.logged+"; reported="+n.reported);if("message"in n)throw new Error("Gfycat error: "+n.message+"; logged="+n.logged+"; reported="+n.reported);const{gif:o,user:r}=n,l="https://www."+e,i={kind:"video",aspect:o.width/o.height,gifv:!1,source:{kind:"video",sources:[{url:o.urls.hd,quality:"HD"},{url:o.urls.sd,quality:"SD"}],thumbnail:o.urls.thumbnail}};return{kind:"post",parent:null,replies:null,url:"https://www."+e+"/watch/"+t,client_id:l,display_style:"centered",content:{kind:"post",title:null,thumbnail:{kind:"image",url:o.urls.thumbnail},flair:o.tags.map((e=>({content_warning:!1,elems:[{kind:"text",text:e}]}))),info:{creation_date:1e3*o.createDate},author:r?{name:r.name,color_hash:r.username,link:r.url,client_id:l,pfp:{url:r.profileImageUrl,hover:r.profileImageUrl}}:void 0,body:i,show_replies_when_below_pivot:!1,collapsible:{default_collapsed:!1},actions:{vote:{kind:"counter",client_id:l,unique_id:"like_"+t,time:Date.now(),icon_style:"heart",special:void 0,label:"likes",incremented_label:"likes",count_excl_you:o.likes,you:void 0,actions:{error:"gfycat liking is not supported"}},other:[{kind:"link",text:o.views+" Views",url:"https://www."+e+"/watch/"+t,client_id:l}]}},internal_data:n}})(r.host,r.id).then((e=>{t&&n({kind:"loaded",frame:e})})).catch((e=>{t&&(console.log("got error",e,e.stack),n({kind:"error",message:e.toString()}))}))})),h(zt,{restrict_w:!0,get children(){return h(Y,{get item(){return t()},children:{loading:()=>"loading...",loaded:({frame:e})=>h(Ut,{get listing(){return e.content},get opts(){return{clickable:!0,client_id:e.client_id,frame:e,replies:null,at_or_above_pivot:!1,is_pivot:!1,top_level:!1}}}),error:e=>(()=>{const t=Xn.cloneNode(!0),o=t.firstChild,l=o.nextSibling;return o.$$click=()=>{n({kind:"loading"}),r(Symbol())},a(l,(()=>e.message)),t})()}})}})}function so(e){const[t,n]=k({kind:"overview"}),[r,d]=l({enabled:!1,index:0,loading:!1}),u=ge(),p=o((()=>e.images.every((e=>"captioned_image"===e.body.kind))));let f;const v=t=>{n({kind:"overview",fullscreen_index:t});const o=f.querySelector(".img-"+t);if(!o)return{x:0,y:0,w:0};const r=function(e){var t;const n=e.getBoundingClientRect();return{x:n.left,y:n.top+(null!=(t=window.pageYOffset)?t:document.documentElement.scrollTop),w:n.width,h:n.height}}(o),l=e.images[t];if(l&&null!=l.aspect)if(l.aspect>1){const e=r.h;r.h=r.w*(1/l.aspect),r.y+=(e-r.h)/2}else{const e=r.w;r.w=r.h*l.aspect,r.x+=(e-r.w)/2}return r};let m;i((()=>{m&&m()}));const b=de();return g((()=>{b()||m&&m()})),(()=>{const o=Bn.cloneNode(!0);return"function"==typeof f?f(o):f=o,a(o,h(Y,{item:t,children:{overview:t=>h(ae,{children:t=>h($,{get each(){return e.images},children:(o,l)=>(()=>{const i=Zn.cloneNode(!0),a=i.firstChild;return i.$$click=()=>{p()&&"fullscreen"===u.gallery_display.value()?(d({enabled:!0,index:l(),loading:!0}),R((()=>import("./gallery.d3c3740f.js")),["assets/gallery.d3c3740f.js","assets/gallery.1f1f3f72.css","assets/_commonjsHelpers.4e997714.js","assets/vendor.f1632930.js"]).then((t=>{d({enabled:!0,index:l(),loading:!1}),m&&m();const o=t.showGallery(e.images,l(),v,{onclose:()=>{console.log("gallery closed"),d((e=>({...e,enabled:!1})))},setIndex:e=>{d({enabled:!0,index:e,loading:!1})}});m=()=>{o.cleanup(),n({kind:"overview",fullscreen_index:void 0})}})).catch((e=>{console.log("Error loading gallery component",e),n({kind:"image",index:l()})}))):n({kind:"image",index:l()})},s((e=>{var n;const s=be("m-1 inline-block rounded-md",t),d=null!=(n=o.thumb)?n:"error",u=be("w-24 h-24 object-contain img-"+l(),r().enabled&&r().index===l()?r().loading?"opacity-50":"opacity-0":"");return s!==e._v$8&&(i.className=e._v$8=s),d!==e._v$9&&c(a,"src",e._v$9=d),u!==e._v$10&&(a.className=e._v$10=u),e}),{_v$8:void 0,_v$9:void 0,_v$10:void 0}),i})()})}),image:t=>[(()=>{const e=eo.cloneNode(!0);return e.$$click=()=>n({kind:"image",index:t.index-1}),s((n=>{const o=Do["outlined-button"],r=t.index<=0;return o!==n._v$11&&(e.className=n._v$11=o),r!==n._v$12&&(e.disabled=n._v$12=r),n}),{_v$11:void 0,_v$12:void 0}),e})(),x((()=>t.index+1)),"/",x((()=>e.images.length)),(()=>{const o=to.cloneNode(!0);return o.$$click=()=>n({kind:"image",index:t.index+1}),s((n=>{const r=Do["outlined-button"],l=t.index>=e.images.length-1;return r!==n._v$13&&(o.className=n._v$13=r),l!==n._v$14&&(o.disabled=n._v$14=l),n}),{_v$13:void 0,_v$14:void 0}),o})(),(()=>{const e=no.cloneNode(!0);return e.$$click=()=>n({kind:"overview"}),s((()=>e.className=Do["outlined-button"])),e})(),h(ro,{get body(){return e.images[t.index].body},autoplay:!0})]}})),o})()}p(["click","input","keydown"]);const co=n('<div class="flex justify-center flex-row"><div class="w-full max-w-prose"><div class="bg-white p-5 sm:m-5 sm:p-10 shadow sm:rounded-xl"><header><h1 class="text-3xl sm:text-5xl font-black">ThreadClient</h1><h2 class="text-base font-light text-gray-800 dark:text-gray-400">A client for Reddit and Mastodon</h2></header><div class="mt-10"></div><main><p>Try for </p><p>Try for </p></main><div class="mt-10"></div><footer><p class="text-gray-800 dark:text-gray-400"> · <!> · </p></footer><div class="mt-2"></div></div></div></div>');function uo(e){return(()=>{const e=co.cloneNode(!0),t=e.firstChild.firstChild.firstChild.nextSibling.nextSibling,n=t.firstChild;n.firstChild;const o=n.nextSibling;o.firstChild;const r=t.nextSibling.nextSibling.firstChild,l=r.firstChild,i=l.nextSibling;return i.nextSibling,a(n,h(Ie,{client_id:"",href:"/reddit",style:"normal",children:"Reddit"}),null),a(o,h(Ie,{client_id:"",href:"/mastodon",style:"normal",children:"Mastodon"}),null),a(r,h(Ie,{client_id:"",href:"/settings",style:"action-button",children:"Settings"}),l),a(r,h(Ie,{client_id:"",href:"https://github.com/pfgithub/threadclient",style:"action-button",children:"Github"}),i),a(r,h(Ie,{client_id:"",href:"https://github.com/pfgithub/threadclient/blob/main/privacy.md",style:"action-button",children:"Privacy"}),null),e})()}const ho=n('<ul class="ml-10"></ul>'),po=n('<main class="client-wrapper"><div class="display-comments-view"></div></main>');function go(e){throw console.log("not never:",e),new Error("is not never")}function fo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function vo(e,t){if(t.startsWith("/")&&e&&(t="/"+e+t),t.startsWith("mailto:"))return{kind:"mailto",title:t.replace("mailto:","")};let n,o=!1;if(t.startsWith("raw!")&&(t=t.replace("raw!",""),o=!0),!t.startsWith("http")&&!t.startsWith("/"))return{kind:"error",title:t};try{n=new URL(t)}catch(r){n=void 0}return!n||o||"reddit.com"!==n.host&&!n.host.endsWith(".reddit.com")||(t="mod.reddit.com"===n.host?"/reddit/mod"+n.pathname+n.search+n.hash:"/reddit"+n.pathname+n.search+n.hash),n&&!o&&"redd.it"===n.host&&(t="/reddit/comments"+n.pathname+n.search+n.hash),{kind:"link",url:t,external:!t.startsWith("/")}}function mo(e,t,n,o={}){const r=vo(e,t);if("error"===r.kind)return el("a").clss(...Wo(n),"error").attr({title:r.title}).clss("error").onev("click",(e=>{e.stopPropagation(),alert(t)}));if("mailto"===r.kind)return el("span").attr({title:r.title});if("link"===r.kind){const e=r.url,t=el("a").clss(...Wo(n)).attr({href:e,target:"_blank",rel:"noopener noreferrer"});return(e.startsWith("/")||o.onclick)&&(t.onclick=t=>{if(t.stopPropagation(),!t.defaultPrevented&&0===t.button&&!fo(t)){if(t.preventDefault(),o.onclick)return o.onclick();er({path:e})}}),t}go(r)}function bo(e){return["inline-block mx-1 px-1 text-base border-b-2 transition-colors",e?"border-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900"].join(" ")}function _o(e){const t=el("span");return u((()=>h(Vt,{flairs:e})),t),t}function yo(e){const t=el("span"),n=tr(t);return ke(t,(()=>h(te,{start:e})),{color_level:1}).defer(n),n}const xo=function(e){let t;return async()=>{if(!t){let n;t=[];try{n=await e()}catch(o){throw console.log("failed to load",o),alert("failed to load dynamic load object. check console."),o}const r=t;t={loaded:n},r.forEach((e=>e()))}if("loaded"in t)return t.loaded;const n=t;return await new Promise((e=>n.push(e))),t.loaded}}((async()=>{const e=new TextEncoder,t=new TextDecoder,n=await(await R((()=>import("./snudown.69d6942c.js")),[])).default({env:{__assert_fail:(e,t,n,o)=>{throw console.log(e,t,n,o),new Error("assert failed")},__stack_chk_fail:()=>{throw new Error("stack overflow")},debugprints:(e,o)=>{console.log("print text:",t.decode(new Uint8Array(n.memory.buffer,e,o)))},debugprinti:e=>{console.log("print int:",e)},debugprintc:e=>{console.log("print char:",String.fromCodePoint(e))},debugpanic:(e,o)=>{throw new Error("Panic: "+t.decode(new Uint8Array(n.memory.buffer,e,o)))}}});return{renderMd(o){try{const r=e.encode(o),l=n.allocString(r.byteLength);new Uint8Array(n.memory.buffer,l,r.byteLength).set(r);const i=n.markdownToHTML(l,r.byteLength),a=n.strlen(i),s=new Uint8Array(n.memory.buffer,i,a),c=t.decode(s);return n.freeText(l,r.byteLength),n.freeText(i,a),c}catch(r){const e=r;return console.log(e.toString()+"\n"+e.stack),("Error "+e.toString()+"\n"+e.stack).replace(/[^a-zA-Z0-9. ]/giu,(e=>"&#"+e.codePointAt(0)+";"))}}}}));async function ko(e){if("reddit"===e.markdown_format){const[t,n]=await Promise.all([xo(),R((()=>import("./html_to_richtext.b8c52692.js")),["assets/html_to_richtext.b8c52692.js","assets/vendor.f1632930.js"])]),o=t.renderMd(e.content);return{kind:"richtext",content:n.parseContentHTML(o,e.client_id)}}if("none"===e.markdown_format)return{kind:"richtext",content:[O.p(O.txt(e.content))]};if("reddit_html"===e.markdown_format){const t=await R((()=>import("./html_to_richtext.b8c52692.js")),["assets/html_to_richtext.b8c52692.js","assets/vendor.f1632930.js"]);return console.log(e.content),{kind:"richtext",content:t.parseContentHTML(e.content,e.client_id)}}go(e.markdown_format)}function wo(e,t){var n;try{return function(e,t){const n=el("div"),o=tr(n);return ke(el("div").adto(n),(()=>h(ro,{body:e,get autoplay(){return t.autoplay}})),{color_level:1}).defer(o),o}(e,t)}catch(o){const e=o;console.log(e);const t=el("div");return el("div").clss("error").adto(t).atxt("Got error: "+e.toString()),el("code").adto(el("pre").adto(t)).atxt(null!=(n=e.stack)?n:"no stack"),tr(t)}}async function $o(e){function t(e,t,n){return{extensions:{persistedQuery:{sha256Hash:t,version:1}},operationName:e,variables:n}}const n=await fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Client-Id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify([t("VideoAccessToken_Clip","36b89d2507fce29e5ca551df756d27c1cfe079e2609642b4390aa4c35796eb11",{slug:e}),t("ClipsChatCard","94c1c7d97d860722a5b7ef3c3b3de3783b37fc32d69bcccc8ea0cda372cf1f01",{slug:e}),t("ClipsBroadcasterInfo","ce258d9536360736605b42db697b3636e750fdb14ff0a7da8c7225bdc2c07e8a",{slug:e}),t("ClipsTitle","f6cca7f2fdfbfc2cecea0c88452500dae569191e58a265f97711f8f2a838f5b4",{slug:e}),t("ClipsCurator","769e99d9ac3f68e53c63dd902807cc9fbea63dace36c81643d776bcb120902e2",{slug:e}),t("ClipsFullVideoButton","d519a5a70419d97a3523be18fe6be81eeb93429e0a41c3baa9441fc3b1dffebf",{slug:e})])}).then((e=>e.json()));console.log(n);const[o,r,l,i,a,s]=n;return o.data.clip?{kind:"video",source:{kind:"video",sources:o.data.clip.videoQualities.map((e=>({url:e.sourceURL+"?sig="+encodeURIComponent(o.data.clip.playbackAccessToken.signature)+"&token="+encodeURIComponent(o.data.clip.playbackAccessToken.value),quality:e.quality+"p"})))},caption:i.data.clip.title,gifv:!1}:{kind:"richtext",content:[O.p(O.txt("The clip could not be found."))]}}function No(e){const t=el("button").clss("block").adch(e);return t.onclick=n=>{n.preventDefault(),n.stopPropagation(),t.disabled=!0,R((()=>import("./gallery.d3c3740f.js")),["assets/gallery.d3c3740f.js","assets/gallery.1f1f3f72.css","assets/_commonjsHelpers.4e997714.js","assets/vendor.f1632930.js"]).then((n=>{const o=e.naturalWidth/e.naturalHeight,r=tr();t.style.opacity="0",n.showGallery([{thumb:e.src,aspect:o,body:{kind:"captioned_image",w:e.naturalWidth,h:e.naturalHeight,url:e.src}}],0,(()=>{var e;const n=t.getBoundingClientRect();return{x:n.left,y:n.top+(null!=(e=window.pageYOffset)?e:document.documentElement.scrollTop),w:n.height*o}}),{onclose:()=>{t.disabled=!1,t.style.opacity="1"},setIndex:()=>{}}).defer(r)})).catch((e=>{console.log(e),t.disabled=!1,alert(e.toString())}))},t}function Co(e,t){const n=el("img").clss("image-loading").attr({src:e,width:null!=t.w?`${t.w}`:void 0,height:null!=t.h?`${t.h}`:void 0,alt:t.alt,title:t.alt});return n.onload=()=>n.classList.remove("image-loading"),n.onerror=()=>n.classList.remove("image-loading"),n}function Eo(e,t){return No(Co(e,t).clss("preview-image"))}function Lo(e,t,n){if("link"===e.kind)return mo(e.client_id,e.url,"action-button").atxt(e.text).adto(t),tr();if("reply"===e.kind){const n=tr();return function(e,t,n){{let n="none";const o=qo("action-button").atxt(e.text).adto(t),r=tr();let l;r.on("cleanup",(()=>{l&&l.cleanup()})),r.on("hide",(()=>{l&&l.setParentVisible(!1)})),r.on("show",(()=>{l&&l.setParentVisible(!0)}));const i=()=>{if("none"===n){if(l){const e=l.associated_data;l.cleanup(),e.remove(),l=void 0}o.disabled=!1}else if(!l){const o=el("div").adto(t);l=tr(o),ke(o,(()=>h(ot,{action:e,onCancel:()=>{n="none",i()},onAddReply:e=>{console.log("Got response",e),n="none",i(),ke(el("div").adto(t),(()=>(()=>{const t=ho.cloneNode(!0);return a(t,h(It,{reply:e,is_threaded:!1,parent_is_threaded:!1})),t})()),{color_level:1}).defer(r)}})),{color_level:1}).defer(l)}};return o.onev("click",(e=>{e.stopPropagation(),"none"===n&&(n="some"),i()})),i(),r}}(e,t).defer(n),n}if("counter"===e.kind){const n=tr();return Ro(e,t,{parens:!0}).defer(n),n}if("delete"===e.kind){const n=el("span").adto(t),o=el("span").adto(t),r=el("span").adto(t),l=el("span").adto(t),i=el("span").adto(t),a=qo("action-button").atxt("Delete").adto(n);o.atxt("Are you sure? ");const s=qo("unsafe-action-button").atxt("Delete").adto(o);o.atxt(" / ");const c=qo("safe-action-button").atxt("Cancel").adto(o);i.atxt("Deleting…"),r.atxt("Deleted!");const d=e=>{n.style.display="none"===e?"":"none",o.style.display="confirm"===e?"":"none",r.style.display="deleted"===e?"":"none",i.style.display="load"===e?"":"none",l.style.display="string"!=typeof e?"":"none","string"!=typeof e&&(n.style.display="",l.innerHTML="",l.adch(el("span").clss("error").atxt(e.error)))};return d("none"),a.onev("click",(e=>{e.stopPropagation(),d("confirm")})),s.onev("click",(t=>{t.stopPropagation(),d("load"),Zo(e.client_id).act(e.data).then((e=>{d("deleted")})).catch((e=>{console.log("Got error:",e),d({error:e.toString()})}))})),c.onev("click",(e=>{e.stopPropagation(),d("none")})),tr()}if("report"===e.kind){const n=Zo(e.client_id),o=tr();let r;const l=qo("action-button").atxt("Report").adto(t).onev("click",(o=>{if(o.stopPropagation(),r){l.setAttribute("class",Do["action-button"]);const e=r.associated_data;r.cleanup(),e.remove(),r=void 0}else l.setAttribute("class",Do["action-button-active"]),r=function(e,t){const n=el("div").clss("report-screen text-sm"),o=tr(n);if(!e.fetchReportScreen)return n.atxt("Missing fetchreportscreen?"),n.clss("error"),console.log(e),o;const r=Uo().adto(n);return e.fetchReportScreen(t).then((t=>{r.remove();const l=tr(),i=o.addChild(l);for(const r of t)So(e,r,(e=>{i.cleanup(),n.innerHTML="",n.atxt("Report sent!"),console.log("Completed report",e);const t=Mo().adto(n);t.adch(el("div").atxt(e.title)),wo(e.body,{autoplay:!1}).defer(o).adto(t),console.log(t,n,n.childNodes)})).defer(l).adto(n)})).catch((e=>{console.log("error loading report screen",e),n.adch(el("div").clss("error").atxt("Error loading: "+e.toString())),r.remove()})),o}(n,e.data),r.associated_data.adto(t)}));return o}if("login"===e.kind){const n=Zo(e.client_id),o=el("span").adto(t),r=tr(),l=e.data,i=qo("action-button").atxt("Log In").adto(o).onev("click",(e=>{e.stopPropagation(),i.textContent="…",i.disabled=!0,n.getLoginURL(l).then((e=>{o.innerHTML="",mo(n.id,e,"pill-filled").atxt("Log In").adto(o)})).catch((e=>{i.textContent="Retry",o.atxt("Error:"+e),console.log(e),i.disabled=!1}))}));return r}if("act"===e.kind){const n=Zo(e.client_id),o=el("span").adto(t),r=qo("action-button").atxt(e.text).adto(o).onev("click",(t=>{t.stopPropagation(),r.disabled=!0,r.textContent="…",n.act(e.action).then((()=>{r.remove(),txt("✓").adto(o)})).catch((e=>{console.log("got error: "+e),r.disabled=!1,o.adch(el("span").clss("error").atxt(e.toString()))}))}));return tr()}if("flair"===e.kind)return tr();if("code"===e.kind){const o=tr();let r;const l=qo("action-button").atxt("Code").adto(t).onev("click",(o=>{if(o.stopPropagation(),console.log(n.value_for_code_btn),r){l.setAttribute("class",Do["action-button"]);const e=r.associated_data;r.cleanup(),e.remove(),r=void 0}else l.setAttribute("class",Do["action-button-active"]),r=wo(e.body,{autoplay:!0}),r.associated_data.adto(t)}));return o}go(e)}function So(e,t,n){const o=el("details").clss("report-item"),r=tr(o);o.adch(el("summary").attr({draggable:"true"}).atxt(t.title));const l=el("div").clss("report-content").adto(o);switch(t.description&&wo(t.description,{autoplay:!1}).defer(r).adto(l),t.report.kind){case"submit":case"textarea":{const o="textarea"===t.report.kind?el("textarea").adto(el("div").adto(l)):void 0;let r="none";const i=qo("pill-filled").adto(l),a=txt("…").adto(i),s=el("div").adto(l),c=()=>{"none"===r?(a.nodeValue="Send Report",i.disabled=!1):"load"===r?(a.nodeValue="…",i.disabled=!0):(a.nodeValue="Retry",i.disabled=!1,s.adch(el("div").clss("error").atxt("Error: "+r.error)))};c();const d=t.report.data;i.onev("click",(t=>{t.stopPropagation(),r="load",c(),e.sendReport(d,null==o?void 0:o.value).then((e=>{n(e)})).catch((e=>{console.log(e),r={error:e.toString()},c()}))}))}break;case"link":mo(e.id,t.report.url,"normal").atxt(t.report.text).adto(l);break;case"more":{const o=el("div").adto(l);for(const l of t.report.screens)So(e,l,n).defer(r).adto(o)}break;default:go(t.report)}return r}function To(e,t){var n;const o=null!=e?e:`${Math.random()}`,r=null!=(n=ir.get(o))?n:{state:{loading:!1,pt_count:t.count,your_vote:t.you},handlers:new Set,users:0,update_time:t.time};ir.has(o)||ir.set(o,r),r.update_time<t.time&&(r.state.pt_count=t.count,r.state.your_vote=t.you);const l=tr({state:r.state,emit(){r.handlers.forEach((e=>e()))},onupdate(e){const t=()=>{e()};r.handlers.add(t),l.on("cleanup",(()=>{r.handlers.delete(t)}))}});return r.users++,l.on("cleanup",(()=>{r.users--,0===r.users&&ir.delete(o)})),l}function Po(e){if("hidden"===e.pt_count||"none"===e.pt_count)return{text:"—",raw:"[score hidden]"};const t=e.pt_count+("increment"===e.your_vote?1:"decrement"===e.your_vote?-1:0);return{text:(n=t,n<1e4?""+n:n<1e5?(null==(o=(n/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/))?void 0:o[0])+"k":n<1e6?(n/1e3|0)+"k":n<1e8?(null==(r=(n/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/))?void 0:r[0])+"m":(n/1e6|0)+"m"),raw:t.toLocaleString()};var n,o,r}function Ro(e,t,n){const o="none"!==e.count_excl_you,r=el("span").clss("counter").adto(t),l=qo("action-button").adto(r).clss("counter-increment-btn").attr({"aria-label":"Up"}),i=el("span").adto(l),a=txt("").adto(i),s=txt("…").adto(i),c=el("span").adto(r.atxt(" ")).clss("counter-count"),d=txt("…").adto(c);let u;const h=tr({percent_voted_txt:null==e.percent?txt("—% upvoted"):txt(e.percent.toLocaleString(void 0,{style:"percent"})+" upvoted"),votecount:c}),{state:p,emit:g,onupdate:f}=To(e.unique_id,{count:e.count_excl_you,you:e.you,time:e.time}).defer(h);f((()=>{var t,i,a,h,g,f,v;const{text:m,raw:b}=Po(p);s.nodeValue={increment:e.incremented_label,decrement:null!=(t=e.decremented_label)?t:"ERR",none:e.label}[null!=(i=p.your_vote)?i:"none"],d.nodeValue=n.parens?"("+m+")":m,o||(d.nodeValue=""),c.title=b,r.classList.remove("counted-increment","counted-decrement","counted-reset"),r.classList.add("counted-"+(null!=(a=p.your_vote)?a:"reset")),r.classList.toggle("counted-loading",p.loading),l.disabled=p.loading,u&&(u.disabled=p.loading),l.setAttribute("class","counter-increment-btn "+Do["increment"===p.your_vote?null!=(h=e.incremented_style)?h:"action-button":null!=(g=e.style)?g:"action-button"]),u&&u.setAttribute("class","counter-decrement-btn "+Do["decrement"===p.your_vote?null!=(f=e.decremented_style)?f:"action-button":null!=(v=e.style)?v:"action-button"]),l.setAttribute("aria-pressed","increment"===p.your_vote?"true":"false"),u&&u.setAttribute("aria-pressed","decrement"===p.your_vote?"true":"false")})),g();const v=t=>{if("error"in e.actions)return alert("Error: "+e.actions.error);const n=Zo(e.client_id),o=p.your_vote;p.your_vote=t,p.loading=!0,g();const r=e.actions[null!=t?t:"reset"];if(null==r)throw new Error("downvote label available but downvote action not provided");n.act(r).then((()=>{p.your_vote=t,p.loading=!1,g()})).catch((e=>{p.your_vote=o,p.loading=!1,g(),console.log(e),alert("Got error: "+e)}))};return null!=e.decremented_label&&(a.nodeValue="⯅ ",r.atxt(" "),u=qo("action-button").adch(el("span").atxt("⯆")).attr({"aria-label":"Down"}).adto(r).onev("click",(e=>{e.stopPropagation(),"decrement"===p.your_vote?v(void 0):v("decrement")})).clss("counter-decrement-btn")),l.onev("click",(e=>{e.stopPropagation(),"increment"===p.your_vote?v(void 0):v("increment")})),h}function Oo(e,t,n){const[o,r]=Le(Ee(n.toLowerCase()));return mo(e,t,"userlink").styl({"--light-color":Ne(o),"--dark-color":Ne(r)})}function Ao(e,t,n){const o=tr(t);for(const r of e)r.watch((()=>n(t))).defer(o);return n(t),o}function jo(e){const t=el("div"),n=tr(t),o=el("div").adto(t),r=e=>{const t=el("div");for(const n of e)"link"===n.action.kind?mo(n.action.client_id,n.action.url,"none").clss("text-gray-600 dark:text-gray-400 hover:text-gray-900").adto(t).atxt(n.text):"menu"===n.action.kind?qo("none").adto(t).atxt(n.text+" ▸").onev("click",(e=>{e.stopPropagation(),e.preventDefault(),alert("TODO submenus")})).adto(t):"show-line-two"===n.action.kind?qo("none").adto(t).atxt(n.text).onev("click",(e=>{e.stopPropagation(),e.preventDefault(),alert("TODO submenu show-line-two")})).adto(t):go(n.action);return t};let l;n.on("cleanup",(()=>{l&&(l.cleanup(),l=void 0)}));const i=function(e){let t=e;const n=[];return{get value(){return t},set value(e){t=e,n.forEach((e=>e()))},watch(e){const t=tr(),o=()=>{e()};return n.push(o),t.on("cleanup",(()=>n.splice(n.indexOf(o),1))),t}}}(e.find((e=>e.selected)));i.watch((()=>{l&&(l.cleanup(),l.associated_data.remove(),l=void 0)}));for(const a of e){if("menu"===a.action.kind){const e=txt("…");let t,l=!1;const s=a.action.children;n.on("hide",(()=>{console.log("open menu was asked to be hidden"),l=!1,c()}));const c=()=>{var n;if(e.nodeValue=l?"▴":"▾",h.attr({"aria-expanded":l?"true":"false"}),l){if(!t){t=r(s).clss("absolute z-10 flex flex-col shadow bg-gray-100 p-3 rounded w-max max-w-7xl").adto(document.body);const e=d.getBoundingClientRect();t.styl({left:e.left+"px",top:e.bottom+(null!=(n=window.pageYOffset)?n:document.documentElement.scrollTop)+"px"})}}else t&&(t.remove(),t=void 0)},d=el("span").adto(o),u=e=>{if(l){console.log("Got event: ",e.target);let n=e.target;for(;n;){if(n===d)return;if(t&&n===t)return;n=n.parentElement}l=!1,c()}};document.addEventListener("click",u,{capture:!0}),n.on("cleanup",(()=>document.removeEventListener("click",u,{capture:!0})));const h=qo("none").attr({"aria-haspopup":"true"}).atxt(a.text).atxt(" ").adch(e).adto(d).onev("click",(e=>{e.preventDefault(),e.stopPropagation(),l=!l,c()}));Ao([i],0,(()=>{h.setAttribute("class",bo(a===i.value))})).defer(n),c()}else if("link"===a.action.kind){const e=mo(a.action.client_id,a.action.url,"none").atxt(a.text).adto(o);Ao([i],0,(()=>{e.setAttribute("class",bo(a===i.value))})).defer(n)}else if("show-line-two"===a.action.kind){const e=a.action,r=qo("none").atxt(a.text).adto(o);Ao([i],0,(()=>{if(r.setAttribute("class",bo(a===i.value)),a===i.value){if(l)throw new Error("already existing menu_l2");l=jo(e.children),l.defer(n),l.associated_data.clss("mt-2").adto(t)}})).defer(n),r.onev("click",(e=>{e.stopPropagation(),i.value=a}))}else go(a.action);txt(" ").adto(o)}return n}function Vo(e,t,n){const o=Mo(),r=tr(o);try{if("user-profile"===t.kind)return function(e,t){const n=tr();wo(e.bio,{autoplay:!1}).defer(n).adto(t);const o=el("div").adto(t);for(const r of e.actions)o.atxt(" "),Lo(r,o,{value_for_code_btn:e}).defer(n);return o.atxt(" "),qo("code-button").adto(o).atxt("Code").onev("click",(t=>{t.stopPropagation(),console.log(e)})),n}(t,o).defer(r),r;if("bio"===t.kind)return function(e,t){const n=tr();t.clss("subreddit-banner"),e.banner&&(No(el("img").clss("w-full min-h-270px object-cover object-center sm:object-top").attr({src:e.banner.desktop})).clss("absolute top-0 left-0 right-0 w-full max-h-full").adto(t).adch(el("div").clss("absolute top-150px left-0 right-0 bottom-0 header-gradient")),el("div").clss("h-150px").adto(t));const o=el("div").clss("subreddit-banner-content").adto(t);e.icon&&el("img").clss("sub-icon-img drop-shadow").attr({alt:"",src:e.icon.url}).adto(o);const r=el("div").clss("subreddit-title-area").adto(o);null!=e.name.display&&el("h1").atxt(e.name.display).clss("text-lg").adto(r),el("h2").atxt(e.name.link_name).clss("text-gray-500").adto(r);const l=el("div").clss("sub-subscribe-area").adto(o);if(e.subscribe){const t=el("div").adto(l);Lo(e.subscribe,t,{value_for_code_btn:e}).defer(n)}e.body&&wo(e.body,{autoplay:!1}).defer(n).adto(l);const i=el("div").clss("relative").adto(t);e.menu&&jo(e.menu).defer(n).adto(el("div").clss("my-3").adto(i));const a=el("div").adto(i);if(e.more_actions)for(const s of e.more_actions)Lo(s,a,{value_for_code_btn:e}).defer(n);return qo("action-button").atxt("Code").adto(a).onev("click",(t=>{t.stopPropagation(),console.log(e)})),n}(t,o).defer(r),r;if("widget"===t.kind)return function(e,t,n){const o=tr();n.clss("widget");const r=el("div").adto(n);txt(t.title).adto(el("div").adto(r).clss("widget-header font-bold text-base mb-2 text-gray-500"));const l=el("div").clss("widget-content").adto(r);if(t.actions_top){const e=el("div").clss("widget-actions-top").adto(l);for(const n of t.actions_top)Lo(n,e,{value_for_code_btn:t}).defer(o)}const i=t.widget_content;if("list"===i.kind){const t=el("ul").clss("widget-list list-disc").adto(l);for(const n of i.items){const r=el("li").adto(t);let l,i;if("body"===n.click.kind){r.clss("list-none");const e=el("details").adto(r);l=el("summary").attr({draggable:"true"}).adto(e),wo(n.click.body,{autoplay:!1}).defer(o).adto(e)}else r.clss("ml-4"),l=r;if(null!=n.icon&&el("div").adto(l).clss("widget-list-icon").styl({"--background-image-url":"url("+n.icon+")"}),"text"===n.name.kind?i=txt(n.name.text):"flair"===n.name.kind?(i=el("span"),_o([n.name.flair]).adto(i)):"username"===n.name.kind?i=txt(n.name.username):"image"===n.name.kind?i=el("img").clss("w-fill h-auto").attr({src:n.name.src,alt:n.name.alt,width:`${n.name.w}`,height:`${n.name.h}`}):go(n.name),"link"===n.click.kind?"username"===n.name.kind?Oo(e.id,n.click.url,n.name.username).atxt(n.name.username).adto(l):mo(e.id,n.click.url,"normal").adch(i).adto(l):el("span").adch(i).adto(l),n.action){const e=el("span").adto(l).atxt(" ");Lo(n.action,e,{value_for_code_btn:n}).defer(o)}}}else if("community-details"===i.kind)el("p").atxt(i.description).adto(l);else if("body"===i.kind)wo(i.body,{autoplay:!1}).defer(o).adto(l);else if("iframe"===i.kind){const e=el("div");n.replaceChild(e,r),n.clss("widget-fullscreen-content");const t=el("iframe").adto(e).styl({width:"312px"}).attr({width:"312",height:i.height,srcdoc:i.srcdoc});t.onload=()=>{if(!t.contentWindow)return console.log("no content window");t.style.height=t.contentWindow.document.body.scrollHeight+20+"px"}}else if("image"===i.kind){const t=el("div");n.clss("widget-fullscreen-content"),n.replaceChild(t,r);const o=Co(i.src,{w:i.width,h:i.height}).clss("w-full h-auto");null!=i.link_url?mo(e.id,i.link_url,"none").adch(o).adto(t):No(o).adto(t)}else go(i);if(t.actions_bottom){const e=el("div").clss("widget-actions-bottom").adto(l);for(const n of t.actions_bottom)Lo(n,e,{value_for_code_btn:t}).defer(o)}return el("div").adto(l).adch(qo("code-button").atxt("Code").onev("click",(e=>{e.stopPropagation(),console.log(t)}))),o}(e,t,o).defer(r),r;if("thread"===t.kind)return Io(e,t,o,n).defer(r),r;go(t)}catch(l){return r.cleanup(),console.log("Got error",l),o.innerHTML="",o.adch(el("pre").adch(el("code").atxt(l.toString()+"\n\n"+l.stack))),o.adch(qo("code-button").atxt("Code").onev("click",(e=>{e.stopPropagation(),console.log(t)}))),tr(o)}}function Mo(){return el("div").clss("post text-sm")}function Io(e,t,n,o){var r,l,i,a,s,c,d,u,h;let p,g,f,v,m,b,_;o.clickable&&t.link.startsWith("/")&&n.clss("hover-outline").attr({tabindex:"0"}).onev("click",(o=>{if(!Z(o.target,n))return;o.stopPropagation();const r="/"+e.id+t.link;o.ctrlKey||o.metaKey||o.altKey?window.open(r):er({path:r})}));const y=tr({addChildren:void 0});if("reddit-post"===t.layout){p=el("div").adto(n).clss("post-voting"),g=el("button").adto(n).clss("post-thumbnail");const e=el("div").adto(n).clss("post-titles");f=el("div").adto(n).clss("post-preview"),v=el("div").adto(n).clss("post-replies"),m=el("div").adto(e).clss("post-content-title text-base"),b=el("div").adto(e).clss("post-content-subminfo"),_=el("div").adto(e).clss("post-content-buttons")}else"reddit-comment"===t.layout||"mastodon-post"===t.layout?(p=el("div").adto(n).clss("post-voting"),m=el("div").adto(n).clss("post-content-title"),g=el("button").adto(n).clss("post-thumbnail"),b=el("div").adto(n).clss("post-content-subminfo text-xs"),f=el("div").adto(n).clss("post-preview"),_=el("div").adto(n).clss("post-content-buttons text-xs"),v=el("div").adto(n).clss("post-replies")):"error"===t.layout?(p=el("div").adto(n).clss("post-voting"),m=el("div").adto(n).clss("post-content-title"),g=el("button").adto(n).clss("post-thumbnail"),b=el("div").adto(n).clss("post-content-subminfo"),f=el("div").adto(n).clss("post-preview"),_=el("div").adto(n).clss("post-content-buttons"),v=el("div").adto(n).clss("post-replies")):go(t.layout);if(t.thumbnail||g.clss("no-thumbnail"),"reddit-comment"===t.layout||"mastodon-post"===t.layout){let e=t.default_collapsed;const o=()=>{y.setVisible(!e),e?(n.classList.add("comment-collapsed"),l.setAttribute("aria-label","Uncollapse"),l.setAttribute("aria-pressed","true")):(n.classList.remove("comment-collapsed"),l.setAttribute("aria-label","Collapse"),l.setAttribute("aria-pressed","false"))},l=el("button").clss("collapse-btn outline-default").attr({draggable:"true","aria-label":"Collapse"}).adch(el("div").clss("collapse-btn-inner")).onev("click",(t=>{t.stopPropagation();const r=n.getBoundingClientRect(),l=sr.getBoundingClientRect(),i=()=>5+Math.max(0,l.bottom,window.visualViewport.offsetTop),a=window.visualViewport.offsetTop+window.visualViewport.height;console.log(i(),a,r.top),r.top<i()&&r.bottom>i()&&(n.scrollIntoView(),document.documentElement.scrollTop-=i()),e=!e,o()}));n.insertBefore(l,null!=(r=n.childNodes[0])?r:null),o()}n.clss("layout-"+t.layout),"reddit-comment"!==t.layout&&"mastodon-post"!==t.layout||n.clss("layout-commentlike"),t.flair&&(m.adch(_o(t.flair.filter((e=>e.content_warning)))),m.atxt(" ")),t.title&&(o.clickable?m.adch(mo(e.id,t.link,"none").clss("hover:underline").atxt(t.title.text)):m.adch(txt(t.title.text))),t.flair&&(m.atxt(" "),m.adch(_o(t.flair.filter((e=>!e.content_warning)))));let x=(null!=(l=t.flair)?l:[]).filter((e=>e.content_warning)),k=null;if("reddit-post"===t.layout&&t.info)!1!==t.info.time&&(b.adch(yo(t.info.time).defer(y)),b.atxt(" ")),t.info.author&&b.atxt("by ").adch(Oo(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),(null==(i=t.info.author)?void 0:i.flair)&&b.adch(_o(t.info.author.flair)),t.info.in&&b.atxt(" in ").adch(mo(e.id,t.info.in.link,"normal").atxt(t.info.in.name)),!1!==t.info.edited&&(b.hasChildNodes()&&b.atxt(", "),b.atxt("Edited ").adch(yo(t.info.edited).defer(y))),t.info.pinned&&(b.hasChildNodes()&&b.atxt(", "),b.adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")));else if(("reddit-comment"===t.layout||"mastodon-post"===t.layout)&&t.info){if("reddit-comment"===t.layout&&(null==(a=t.info.author)?void 0:a.pfp)){el("img").attr({src:t.info.author.pfp.url}).adto(b).clss("w-8 h-8 object-center inline-block rounded-full cfg-reddit-pfp").title="Disable in settings (thread.pfg.pw/settings)",b.atxt(" ")}if(t.info.author&&b.adch(Oo(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),(null==(s=t.info.author)?void 0:s.flair)&&b.adch(_o(t.info.author.flair)),"mastodon-post"===t.layout&&(null==(c=t.info.author)?void 0:c.pfp)){n.clss("spacefiller-pfp");el("div").clss("pfp").styl({"--url":"url("+JSON.stringify(t.info.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.author.pfp.hover)+")"}).adto(p)}if(k=document.createComment("").adto(b),!1!==t.info.time){const e=el("span").adch(yo(t.info.time).defer(y));b.atxt(" ").adch(e)}if(!1!==t.info.edited&&b.atxt(", Edited ").adch(yo(t.info.edited).defer(y)),t.info.pinned&&b.atxt(", ").adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")),t.info.reblogged_by&&(b.atxt(" ← Boosted by "),t.info.reblogged_by.author&&b.adch(Oo(e.id,t.info.reblogged_by.author.link,t.info.reblogged_by.author.color_hash).atxt(t.info.reblogged_by.author.name)),!1!==t.info.reblogged_by.time&&b.atxt(" at ").adch(yo(t.info.reblogged_by.time).defer(y)),"mastodon-post"===t.layout&&(null==(d=t.info.reblogged_by.author)?void 0:d.pfp))){n.clss("spacefiller-pfp");el("div").clss("pfp","pfp-reblog").styl({"--url":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.hover)+")"}).adto(p)}}{if(t.thumbnail)if("image"===t.thumbnail.kind)g.adch(el("img").attr({src:t.thumbnail.url,alt:""})),x.length&&g.clss("thumbnail-content-warning");else if("default"===t.thumbnail.kind){const e={self:"self",default:"default",image:"image",spoiler:"spoiler",nsfw:"nsfw",account:"account",error:"error"}[t.thumbnail.thumb];g.adch(el("div").clss("thumbnail-builtin","thumbnail-"+e))}else go(t.thumbnail);const e=(e,t)=>{const n=el("div").clss("post-body"),o=tr(n);if(x.length){const r=x,l=el("div").adto(n);return l.atxt("Content Warning"+(1===r.length?"":"s")+": "),l.adch(_o(r)),l.atxt(" "),qo("pill-filled").adto(l).atxt("Show Content").onev("click",(r=>{r.stopPropagation(),l.remove(),x=[],g.classList.remove("thumbnail-content-warning"),wo(e,{...t}).defer(o).adto(n)})),o}return wo(e,{...t}).defer(o).adto(n),o},n=e=>"none"===e.kind||"array"===e.kind&&e.body.every((e=>null==e||n(e)));if(n(t.body))f.remove();else if("collapsed"===t.display_mode.body){const n=qo("outlined-button").adto(_),o=txt("…").adto(n);let r;y.on("cleanup",(()=>{r&&r.cleanup()})),y.on("hide",(()=>{r&&r.setVisible(!1)})),y.on("show",(()=>{r&&r.setVisible(!0)}));let l="open"===t.display_mode.body_default;const i=!l,a=()=>{l&&!r?(r=e(t.body,{autoplay:i}),r.associated_data.adto(f)):!l&&r&&(r.cleanup(),r.associated_data.remove(),r=void 0),o.nodeValue=l?"Hide":"Show"};a(),n.onev("click",(e=>{e.stopPropagation(),l=!l,a()})),g.onev("click",(e=>{e.stopPropagation(),l=!l,a()}))}else e(t.body,{autoplay:!1}).defer(y).adto(f)}let w=!1;for(const S of t.actions)if("counter"===S.kind&&"reddit-points"===S.special){n.clss("spacefiller-redditpoints");const e=Ro(S,p,{parens:!1}).defer(y);if("reddit-comment"===t.layout)b.insertBefore(txt(" "),k),b.insertBefore(e.votecount,k),b.insertBefore(txt(" points"),k);else if("reddit-post"===t.layout){b.atxt(", "),e.percent_voted_txt.adto(b),p.clss("desktop-only"),_.atxt(" ");Lo(S,el("div").clss("mobile-only").adto(_),{value_for_code_btn:t}).defer(y)}}else"code"===S.kind&&(w=!0),_.atxt(" "),Lo(S,_,{value_for_code_btn:t}).defer(y);0===p.childNodes.length&&p.remove(),0===t.actions.length&&(_.atxt(" "),mo(e.id,t.link,"action-button").atxt("View").adto(_)),w||(_.atxt(" "),qo("code-button").onev("click",(e=>{e.stopPropagation(),console.log(t)})).atxt("Code").adto(_));const $=el("ul").clss("replies").styl({margin:"0"}).adto(v),N=1===(null==(u=t.replies)?void 0:u.length)&&1===(null==(h=t.replies[0].replies)?void 0:h.length);let C;const E=e=>{if(N&&e.length>1){if(!C)throw new Error("threaded comment has no lastElemAddChildren");C(e)}else e.forEach((e=>L(e)))},L=t=>{var n;const r=el("li").adto($);if(N&&r.clss("relative threaded"),"load_more"===t.kind)return void Ho(e,t,E,(()=>r.remove())).adto(r);let l;N&&1===(null==(n=t.replies)?void 0:n.length)&&(l=t.replies[0],t.replies=[]),r.clss("comment");const i=Mo();C=Io(e,t,i,{clickable:o.clickable}).defer(y).addChildren,i.adto(r),l&&L(l)};return t.replies&&("collapsed"===t.display_mode.comments||E(t.replies)),y.associated_data.addChildren=E,y}const Do={none:"",normal:"text-blue-600 dark:text-blue-500 underline",previewable:"text-blue-600 dark:text-blue-500 hover:underline","action-button":"p-1 rounded hover:bg-gray-200","action-button-active":"p-1 rounded bg-gray-200 hover:bg-gray-300","save-button-saved":"text-green-600 dark:text-green-500 hover:underline","safe-action-button":"text-blue-600 dark:text-blue-500 hover:underline","unsafe-action-button":"text-red-600 dark:text-red-500 hover:underline","code-button":"text-gray-600 dark:text-gray-500 hover:underline","load-more":"text-blue-600 dark:text-blue-500 hover:underline text-base",userlink:"text-$light-color dark:text-$dark-color hover:underline","pill-empty":"text-sm border-2 border-black text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-transparent":"text-sm border-2 border-transparent text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-filled":"text-sm border-2 border-black bg-black text-white hover:text-black hover:bg-transparent p-1 px-3 rounded-full transition-colors","outlined-button":"border border-gray-600 dark:border-gray-500 px-2",error:"text-red-600 dark:text-red-500 hover:underline"},Wo=e=>[Do[e]];function qo(e){return el("button").clss(...Wo(e)).attr({draggable:"true"})}function Uo(){return el("div").clss("lds-ripple").adch(el("div")).adch(el("div"))}function Ho(e,t,n,o){const r=el("div"),l=()=>mo(e.id,t.url,"load-more",{onclick:()=>{const a=el("div").adto(r);a.adch(el("span").atxt("Loading…")),a.adch(Uo()),i.remove(),i=a;const s=i;e.loadMore(t.load_more).then((e=>{s.remove(),n(e),o()})).catch((e=>{console.log("error loading more:",e),s.parentNode&&s.remove(),i=el("span").atxt("Error. ").adch(l().atxt("🗘 Retry")).adto(r)}))}});let i=l().atxt(null!=t.count?"Load "+t.count+" More…":"Load More…").adto(r).clss("load-more");return r.atxt(" "),qo("code-button").onev("click",(e=>{e.stopPropagation(),console.log(t)})).atxt("Code").adto(r),r}function zo(e,t){let n=e.visible;e.on("hide",(()=>n=!1)),e.on("show",(()=>{n=!0,document.title=o(r)}));const o=e=>e+" | "+t+" | ThreadClient";let r="…";const l={setTitle(e){r=e,n&&(document.title=o(e))}};return l.setTitle("…"),l}function Go(e,t){const n=mo(e.id,t.url,"action-button"),o=tr(n),r=el("span").adto(n),l=txt("… ").adto(r);return r.atxt(t.name),e.hydrateInbox(t.hydrate).then((e=>{"zero"===e.messages.kind?l.nodeValue="":"exact"===e.messages.kind?l.nodeValue=e.messages.value+" ":"minimum"===e.messages.kind&&(l.nodeValue=e.messages.min+"+ "),"zero"!==e.messages.kind&&r.classList.add({green:"text-green-500",orange:"text-orange-500"}[t.active_color])})).catch((e=>{l.nodeValue="� "})),o}const Bo=()=>el("div").clss("top-level-wrapper","object-wrapper","bg-postcolor-100");function Fo(e,t,n,o){const r=tr();o.setTitle(t.title),n.classList.add("display-"+t.display_style);const l=el("div").adto(n).clss("navbar-area");for(const c of t.navbar.actions)Lo(c,l,{value_for_code_btn:t}).defer(r),txt(" ").adto(l);const i=[{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Report Issue"},{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Feature Request"}];for(const c of i)Lo(c,l,{value_for_code_btn:t}).defer(r),l.atxt(" ");qo("code-button").atxt("Code").adto(l).onev("click",(()=>console.log(t))),txt(" ").adto(l);for(const c of t.navbar.inboxes)Go(e,c).defer(r).adto(l),txt(" ").adto(l);const a=el("div").adto(n).clss("header-area"),s=el("div").adto(n).clss("content-area");if(t.sidebar){qo("pill-filled").adto(n).clss("sidebar-toggle-mobile","my-1").atxt("Toggle Sidebar").onev("click",(e=>{e.stopPropagation(),o.classList.toggle("sidebar-visible-mobile")}));const o=el("div").adto(n).clss("sidebar-area");for(const n of t.sidebar)Vo(e,n,{clickable:!1}).defer(r).adto(Bo().adto(o))}if("listing"===t.body.kind){Vo(e,t.body.header,{clickable:!1}).defer(r).adto(Bo().adto(a)),t.body.menu&&jo(t.body.menu).defer(r).adto(Bo().adto(s));const n=el("div").adto(s),o=e=>{for(const t of e)l(t)},l=t=>{if(0===t.parents.length){return void el("div").clss("error").atxt("unmounted.parents.length === 0").adto(Bo().adto(n))}const o=Bo().adto(n);for(const n of t.parents)if("load_more"===n.kind){const t=el("div").adto(o);mo(e.id,n.url,"load-more").atxt("Load More").adto(t),t.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"))}else Vo(e,n,{clickable:!0}).defer(r).adto(o);if(t.replies.length>0){let n;const r=qo("previewable").adto(o).atxt("Replies ▸").onev("click",(l=>{if(l.stopPropagation(),n)n.cleanup(),n.associated_data.remove(),n=void 0,r.textContent="Replies ▸";else{r.textContent="Replies ▾";const l=el("div").adto(o),i=tr(l);n=i;const a=e=>{for(const t of e)s(t)},s=t=>{if("load_more"!==t.kind)Vo(e,t,{clickable:!1}).defer(i).adto(l);else{const n=Ho(e,t,a,(()=>n.remove()));n.adto(l)}};a(t.replies)}}))}};if(o(t.body.items),t.body.next){const n=function(e,t,n,o){const r=el("div"),l=t=>mo(e.id,t.url,"load-more",{onclick:()=>{const s=el("div").adto(r);s.adch(el("span").atxt("Loading…")),s.adch(Uo()),a&&a.remove(),a=s,e.loadMoreUnmounted(t.load_more_unmounted).then((e=>{a&&a.remove(),n(e.children),e.next?i(e.next):o()})).catch((e=>{console.log("error loading more:",e),a&&null!=a.parentNode&&a.remove(),a=el("span").atxt("Error. ").adch(l(t).atxt("🗘 Retry")).adto(r)}))}}),i=e=>{a=el("div").adch(l(e).atxt(null!=e.count?"Load "+e.count+" More…":"Load More…").adto(r).clss("load-more")).atxt(" ").adch(qo("code-button").onev("click",(t=>{t.stopPropagation(),console.log(e)})).atxt("Code")).adto(r)};let a;return i(t),r}(e,t.body.next,o,(()=>n.remove()));n.adto(s)}}else if("one"===t.body.kind){const n=Bo().adto(a);for(const i of t.body.item.parents){if("load_more"===i.kind){const t=n;mo(e.id,i.url,"load-more").atxt("Load More").adto(t),t.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"));continue}const o=i===t.body.item.parents[t.body.item.parents.length-1];Vo(e,i,{clickable:!o}).defer(r).adto(n)}t.body.item.menu&&jo(t.body.item.menu).defer(r).adto(Bo().adto(s));const o=e=>{for(const t of e)l(t)},l=t=>{if("load_more"!==t.kind)Vo(e,t,{clickable:!1}).defer(r).adto(Bo().adto(s));else{const n=Ho(e,t,o,(()=>n.remove()));n.adto(s).clss("top-level-load-more")}};o(t.body.item.replies),0===t.body.item.replies.length&&el("div").atxt("*There are no replies*").adto(s)}else go(t.body);return r}let Jo,Ko;{const[e,t]=l(null);let n=!1;Jo=o=>{var r;let l;console.log("showing page2",o),gr.style.display="";let i=o.pivot.ref;for(;i;)"post"===i.kind&&"post"===i.content.kind&&i.content.title&&null==l&&(l=i.content.title.text),i=null==(r=i.parent)?void 0:r.ref;document.title=null!=l?l:"«err no title»",t(o),n||(n=!0,ke(gr,(()=>h(Ht,{get page(){return e()}})),{color_level:0}))},Ko=()=>{gr.style.display="none"}}function Yo(e){const t=document.createElement("div"),n=tr(t);return t.appendChild(document.createTextNode(e)),n}const Qo={reddit:()=>R((()=>import("./reddit.9a71f032.js")),["assets/reddit.9a71f032.js","assets/base.50b98d34.js","assets/vendor.f1632930.js"]).then((e=>e.client)),mastodon:()=>R((()=>import("./mastodon.3abcbe0e.js")),["assets/mastodon.3abcbe0e.js","assets/base.50b98d34.js","assets/vendor.f1632930.js"]).then((e=>e.client)),hackernews:()=>R((()=>import("./hackernews.fd159df4.js")),["assets/hackernews.fd159df4.js","assets/vendor.f1632930.js"]).then((e=>e.client)),test:()=>R((()=>import("./test.749d986c.js")),["assets/test.749d986c.js","assets/_commonjsHelpers.4e997714.js","assets/base.50b98d34.js","assets/vendor.f1632930.js"]).then((e=>e.client))};async function Xo(e){const t=e.toLowerCase(),n=Qo[t];if(n){if(ur[t]||(ur[t]=await n()),ur[t].id!==t)throw new Error("client has incorrect id");return ur[t]}}function Zo(e){var t;return null!=(t=ur[e])?t:void 0}function er({path:e,page:t}){console.log("Appending history state index",pr+1,e),history.pushState({index:pr+1,session_name:dr},"ThreadClient",e),lr(pr+1,location,t)}function tr(e){const t=e,n={};let o=!0,r=!0,l=!0;const i=()=>{const e=o&&r;e!==l&&(l=e,c(e?"show":"hide"),s.forEach((t=>t.setParentVisible(e))))};let a=!0;const s=new Set,c=e=>{const t=n[e];t&&t.forEach((e=>e()))},d={on(e,t){null!=n[e]||(n[e]=[]),n[e].push(t)},setVisible(e){if(!a)return console.log("hideshow called on a deleted object");o!==e&&(o=e,i())},setParentVisible(e){if(!a)return console.log("hideshow called on a deleted object");r!==e&&(r=e,i())},get visible(){return o},cleanup(){a=!1,s.forEach((e=>e.cleanup())),c("cleanup")},emit:c,addChild:e=>(s.add(e),{cleanup:()=>{e.cleanup(),s.delete(e)}}),get associated_data(){return t},defer:e=>(e.addChild(d),t)};return d}function nr(e,t){const n=Zo(e);return n?t(n):or(Xo(e),(n=>n?t(n):Yo("404. Client "+e+" not found.")))}function or(e,t){const n=el("div").adto(document.body),o=tr(n),r=el("div").adto(n);return el("span").atxt("Fetching client…").adto(r),e.then((e=>{t(e).defer(o).adto(n),r.remove()})).catch((e=>{console.log("error rendering",e),n.adch(el("span").clss("error").atxt("Got error! Check console! "+e.toString()))})),o}function rr(e,t){var n;const o=(e+t).substring(1);if(o.toLowerCase().startsWith("http://")||o.toLowerCase().startsWith("https://")){let e;try{e=new URL(o)}catch(c){return Yo("Invalid URL: "+o)}if("thread.pfg.pw"===e.hostname)return rr(e.pathname,e.search);const t=vo("null",e.toString());if("link"===t.kind&&!t.external){const[e,...n]=t.url.split("?");return rr(e,n.join("?"))}const n=I(o,{});if(n){const e=el("div"),t=tr(e);return ke(e,(()=>h(ro,{body:n,autoplay:!1})),{color_level:0}).defer(t),t}return Yo("Unsupported Link: "+o)}const r=e.split("/").filter((e=>e)),i=r.shift();if(console.log(r),null==i)return function(){const e=el("div"),t=tr(e);return ke(e,(()=>h(uo,{})),{color_level:0}).defer(t),t}();if("pwa_start"===i)return function(){const e=el("div"),t=tr(e);return mo("","/reddit","normal").atxt("Reddit").adto(e),e.atxt(" · "),mo("","/mastodon","normal").atxt("Mastodon").adto(e),e.atxt(" · "),mo("","/settings","normal").atxt("Settings").adto(e),e.atxt(" · "),mo("","/","normal").atxt("Home").adto(e),t}();if("settings"===i)return or(R((()=>import("./settings.cb2300b3.js")),["assets/settings.cb2300b3.js","assets/vendor.f1632930.js"]),(({SettingsPage:e})=>{const t=el("div"),n=tr(t);return ke(t,(()=>h(e,{})),{color_level:0}).defer(n),n}));function s(){const[e,n]=l("loading…");return(async()=>{const{client:e}=await R((()=>import("./reddit.9a71f032.js")),["assets/reddit.9a71f032.js","assets/base.50b98d34.js","assets/vendor.f1632930.js"]),{stringify:o}=await R((()=>import("./stringify.469ba405.js")),[]),l=await e.getPage("/"+r.join("/")+t);n(JSON.stringify(o(l)))})().catch((e=>{n(e.toString()+"\n"+e.stack)})),(()=>{const t=po.cloneNode(!0),n=t.firstChild;return a(n,h(Vn,{get content(){return[O.pre(e(),"json")]}})),t})()}if("temp0"===i){const e=el("div"),t=tr(e);return ke(e,(()=>h(s,{})),{color_level:0}).defer(t),t}return"login"===i?nr(null!=(n=r[0])?n:"ENOCLIENT",(e=>function(e,t,n){const o=document.createElement("div"),r=tr(o);return o.atxt("…"),(async()=>{o.innerHTML="",o.atxt("Logging In…");try{await e.login(t,n)}catch(c){return console.log(c),o.innerHTML="",void o.adch(el("div").clss("error").atxt("Login error! "+c.toString()))}o.innerHTML="",o.atxt("Logged In! You may now close this page.")})().catch((e=>{console.log(e),alert("Unexpected error "+e.toString())})),r}(e,r,new URLSearchParams(t)))):"saved"===i?nr("reddit",(e=>{var t;const n=el("div").clss("client-wrapper"),o=tr(n),r=el("div").adto(n);r.classList.add("client-main-frame");const l=zo(o,e.id);return l.setTitle("Loading "+e.id+"…"),Fo(e,JSON.parse(null!=(t=localStorage.getItem("saved-post"))?t:"{}"),r,l),o})):nr(i,(e=>function(e,t){const n=el("div").clss("client-wrapper"),o=tr(n),r=el("div").adto(n);r.classList.add("client-main-frame");const l=el("div").adto(r);l.classList.add("display-loading"),l.adch(Uo());const i=zo(o,e.id);return i.setTitle("Loading "+e.id+"…"),(async()=>{if(!e.getThread||e.getPage&&"2"===ge().page_version.value()){const n=await e.getPage(t);l.remove(),o.visible&&Jo(n),o.on("hide",(()=>Ko())),o.on("show",(()=>Jo(n)))}else{const n=await e.getThread(t);l.remove(),Fo(e,n,r,i).defer(o)}})().catch((e=>{var t;console.log(e,null!=(t=e.stack)?t:"*no stack*"),l.parentNode&&l.remove(),el("div").atxt("Error! "+e+", check console.").clss("error").adto(r)})),o}(e,"/"+r.join("/")+t)))}function lr(e,t,n){console.log("Navigating",e,t,cr,n),document.title="ThreadClient",hr.forEach((e=>e(t)));const o=t.pathname+t.search;pr=e,Ko(),cr.forEach((e=>{"t1"===e.node.kind&&e.node.hide()}));const r=cr[e];if(r){if(r.url===o)return void("t1"===r.node.kind?r.node.show():Jo(r.node.page2));console.log("URLS differ. «",r.url,"» «",o,"»");for(let t=cr.length-1;t>=e;t--){const e=cr.pop();if(!e)throw new Error("bad logic");"t1"===e.node.kind&&e.node.removeSelf()}}if(n){const t=n;return Jo(t),void(cr[e]={node:{kind:"t2",page2:t},url:o})}const l=tr(),i=rr(t.pathname,t.search).defer(l).adto(document.body);l.on("cleanup",(()=>i.remove())),l.on("hide",(()=>i.style.display="none")),l.on("show",(()=>i.style.display=""));const a={kind:"t1",removeSelf:()=>l.cleanup(),hide:()=>l.setVisible(!1),show:()=>l.setVisible(!0)};cr[e]={node:a,url:o}}let ir,ar,sr,cr,dr,ur,hr,pr,gr;console.log("APP.TSX WAS RELOADED.");const[fr,vr]=l(!1),[mr,br]=l(!1),_r=function(n={}){const{immediate:o=!1,onNeedRefresh:r,onOfflineReady:l,onRegistered:i,onRegisterError:a}=n;let s,c;if("serviceWorker"in navigator){s=new e("/sw.js",{scope:"/"}),s.addEventListener("activated",(e=>{e.isUpdate||null==l||l()}));{const e=()=>{null==r||r()};s.addEventListener("waiting",e),s.addEventListener("externalwaiting",e)}s.register({immediate:o}).then((e=>{c=e,null==i||i(e)})).catch((e=>{null==a||a(e)}))}return async(e=!0)=>{e&&(null==s||s.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),c&&c.waiting&&await t(c.waiting,{type:"SKIP_WAITING"})}}({onNeedRefresh(){console.log("An update to ThreadClient is available"),br(!0);if("on"===ge().update_notifications.value()){const e=el("div").clss("alert").adto(ar);el("div").clss("alert-body").adto(e).atxt("An update to ThreadClient is available."),qo("pill-empty").atxt("Ignore").adto(e).onev("click",(t=>{t.stopPropagation(),e.remove()})),e.atxt(" "),qo("pill-empty").atxt("Update (Refresh)").adto(e).onev("click",(e=>{e.stopPropagation(),_r(!0)}))}},onOfflineReady(){console.log("Ready for offline use."),vr(!0)}});console.log("updateSW",_r),null!=navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((e=>{e.every((e=>e.active))&&0!==e.length&&vr(!0)})).catch((e=>console.log("Error checking sw registrations",e))),console.log("ROUTER.TS WAS RELOADED.",!1),function(){ir=new Map,window.onpopstate=e=>{var t;console.log("onpopstate. ev:",e.state);const n=e.state;if((null==n?void 0:n.session_name)!==dr)return console.log("Going to history item from different session"),void lr(0,location,void 0);lr(null!=(t=null==n?void 0:n.index)?t:0,location,void 0)},ur={},cr=[],dr=""+Math.random(),hr=[],pr=0,el("div").adto(document.body);const e=ge().page_version.value();if("1"===e||"2"===e){const e=el("nav").clss("navbar","bg-postcolor-100","transition-opacity").adto(document.body);sr=e;const t=["px-2"];el("button").adto(e).attr({"aria-label":"Back"}).atxt("←").clss(...t).onev("click",(e=>{e.stopPropagation(),history.back()})),el("button").adto(e).attr({"aria-label":"Forward"}).atxt("→").clss(...t).onev("click",(e=>{e.stopPropagation(),history.forward()}));const n=el("input").attr({"aria-label":"URL"}).adto(e).clss("bg-transparent text-center border border-gray-600 dark:border-gray-500"),o=el("button").attr({"aria-label":"Go"}).clss(...t).atxt("⏎").adto(e),r=el("button").attr({"aria-label":"Reload"}).clss(...t).atxt("🗘").adto(e),l=()=>er({path:"/"+n.value.replace(/^\//,"")});o.onclick=()=>l(),n.onkeydown=e=>"Enter"===e.key?l():0,r.onclick=()=>alert("TODO refresh"),hr.push((e=>{e.pathname.toLowerCase().startsWith("/http://")||e.pathname.toLowerCase().startsWith("/https://")?n.value=(e.pathname+e.search).substr(1):n.value=e.pathname+e.search}));let i=window.scrollY,a=0;document.addEventListener("scroll",(t=>{const n=window.scrollY,o=n-i;i=n;const r=Math.max(0,Math.min(100,n));a+=o,a>r&&(a=r),a<0&&(a=0);let l=a;n<0&&(l=-n),e.style.setProperty("--mobile-transform","translateY("+-l+"px)")}),{passive:!1})}else{const e=el("nav").adto(document.body);sr=e}console.log("ThreadClient built on "+T.build_time),gr=el("div").adto(body),history.replaceState({index:0,session_name:dr},"ThreadClient",location.pathname+location.search+location.hash),lr(0,location,void 0);let t=100;const n=()=>{var e;null==(e=document.head.querySelector(".darkreader"))||e.remove(),t*=2,setTimeout((()=>n()),t)};setTimeout((()=>n()),0),ar=el("div").adto(document.body).clss("alert-area")}();export{Ut as C,_e as I,Vn as R,Re as S,zt as T,R as _,H as a,B as b,W as c,X as d,U as e,bo as f,j as g,tr as h,fr as i,_r as j,Q as k,Do as l,A as m,ge as n,ne as o,ke as p,we as q,O as r,J as s,Y as t,mr as u,T as v,de as w,be as x,Eo as z};
