const ul=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}};ul();window.el=(...e)=>document.createElement(...e);window.txt=e=>document.createTextNode(e);window.anychange=(e,t)=>(e.forEach(n=>n.oninput=()=>t()),t(),t);window.body=document.getElementById("maincontent")||document.body;Node.prototype.attr=function(e){return Object.entries(e).forEach(([t,n])=>n==null?this.removeAttribute(t):this.setAttribute(t,n)),this};Node.prototype.adto=function(e){return e.appendChild(this),this};Node.prototype.adch=function(...e){return e.forEach(t=>this.appendChild(t)),this};Node.prototype.atxt=function(e){return this.appendChild(txt(e)),this};Node.prototype.onev=function(...e){return this.addEventListener(...e),this};Node.prototype.clss=function(...e){return e.forEach(t=>t.split(/[. ]/g).filter(n=>n).map(n=>this.classList.add(n))),this};Node.prototype.styl=function(e){return Object.entries(e).forEach(([t,n])=>this.style.setProperty(t,n)),this};Object.defineProperty(Array.prototype,"last",{enumerable:!1,get:function(){return this[this.length-1]}});Object.defineProperty(Object.prototype,"dwth",{enumerable:!1,value:function(e){return e(this),this}});const Yr=(e,t)=>e===t,ze=Symbol("solid-proxy"),At={equals:Yr};let Pe=null,Jr=to;const Qe={},_e=1,Ot=2,Xr={owned:null,cleanups:null,context:null,owner:null};var z=null;let yt=null,H=null,ft=null,Z=null,he=null,Mn=0;function pe(e,t){const n=H,r=z,o=e.length===0?Xr:{owned:null,cleanups:null,context:null,owner:t||r};z=o,H=null;try{return zn(()=>e(()=>Bn(o)),!0)}finally{H=n,z=r}}function P(e,t){t=t?Object.assign({},At,t):At;const n={value:e,observers:null,observerSlots:null,pending:Qe,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.pending!==Qe?n.pending:n.value)),jn(n,o));return[eo.bind(n),r]}function pn(e,t,n){const r=tt(e,t,!0,_e);Te(r)}function L(e,t,n){const r=tt(e,t,!1,_e);Te(r)}function U(e,t,n){Jr=bl;const r=tt(e,t,!1,_e);r.user=!0,he?he.push(r):queueMicrotask(()=>Te(r))}function fl(e,t){let n;const r=tt(()=>{n?n():D(e),n=void 0},void 0,!1,0);return r.user=!0,o=>{n=o,Te(r)}}function R(e,t,n){n=n?Object.assign({},At,n):At;const r=tt(e,t,!0,0);return r.pending=Qe,r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,Te(r),eo.bind(r)}function bn(e,t,n){arguments.length===2?typeof t=="object"&&(n=t,t=e,e=!0):arguments.length===1&&(t=e,e=!0),n||(n={}),n.globalRefetch!==!1&&(St||(St=new Set),St.add(x),z&&G(()=>St.delete(x)));const r=new Set,[o,l]=P(n.initialValue),[i,s]=P(void 0,{equals:!1}),[a,c]=P(!1),[d,f]=P();let h,m=null,v=null,y=!1,w=typeof e=="function";function C(b,$,N,S){return m===b&&(m=null,v&&b===v&&n.onHydrated&&n.onHydrated(S,{value:$}),v=null,f(h=N),k($)),$}function k(b){Be(()=>{l(()=>b),c(!1);for(const $ of r.keys())$.decrement();r.clear()})}function T(){const b=ml,$=o();if(h)throw h;return H&&!H.user&&b&&pn(()=>{i(),m&&(b.resolved||r.has(b)||(b.increment(),r.add(b)))}),$}function x(b=!0){if(b&&y)return;y=!1,f(h=void 0);const $=w?e():e;if($==null||$===!1){C(m,D(o));return}const N=v||D(()=>t($,{value:o(),refetching:b}));return typeof N!="object"||!("then"in N)?(C(m,N),N):(m=N,y=!0,queueMicrotask(()=>y=!1),Be(()=>{c(!0),s()}),N.then(S=>C(N,S,void 0,$),S=>C(N,S,S)))}return Object.defineProperties(T,{loading:{get(){return a()}},error:{get(){return d()}}}),w?pn(()=>x(!1)):x(!1),[T,{refetch:x,mutate:l}]}let St;function dr(e,t=Yr,n){const r=new Map,o=tt(l=>{const i=e();for(const s of r.keys())if(t(s,i)!==(l!==void 0&&t(s,l))){const a=r.get(s);for(const c of a.values())c.state=_e,c.pure?Z.push(c):he.push(c)}return i},void 0,!0,_e);return Te(o),l=>{let i;if(i=H){let s;(s=r.get(l))?s.add(i):r.set(l,s=new Set([i])),G(()=>{s.delete(i),!s.size&&r.delete(l)})}return t(l,o.value)}}function Be(e){if(ft)return e();let t;const n=ft=[];try{t=e()}finally{ft=null}return zn(()=>{for(let r=0;r<n.length;r+=1){const o=n[r];if(o.pending!==Qe){const l=o.pending;o.pending=Qe,jn(o,l)}}},!1),t}function D(e){let t,n=H;return H=null,t=e(),H=n,t}function Qr(e,t,n){const r=Array.isArray(e);let o,l=n&&n.defer;return i=>{let s;if(r){s=[];for(let c=0;c<e.length;c++)s.push(e[c]())}else s=e();if(l){l=!1;return}const a=D(()=>t(s,o,i));return o=s,a}}function hl(e){U(()=>D(e))}function G(e){return z===null||(z.cleanups===null?z.cleanups=[e]:z.cleanups.push(e)),e}function gl(e){Pe||(Pe=Symbol("error")),z===null||(z.context===null?z.context={[Pe]:[e]}:z.context[Pe]?z.context[Pe].push(e):z.context[Pe]=[e])}function Zr(){return H}function Ee(e){const t=Symbol("context");return{id:t,Provider:_l(t),defaultValue:e}}function Ue(e){let t;return(t=Wn(z,e.id))!==void 0?t:e.defaultValue}function Vn(e){const t=R(e);return R(()=>_n(t()))}let ml;function eo(){const e=yt;if(this.sources&&(this.state||e)){const t=Z;Z=null,this.state===_e||e?Te(this):Rt(this),Z=t}if(H){const t=this.observers?this.observers.length:0;H.sources?(H.sources.push(this),H.sourceSlots.push(t)):(H.sources=[this],H.sourceSlots=[t]),this.observers?(this.observers.push(H),this.observerSlots.push(H.sources.length-1)):(this.observers=[H],this.observerSlots=[H.sources.length-1])}return this.value}function jn(e,t,n){if(ft)return e.pending===Qe&&ft.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let r=!1;return e.value=t,e.observers&&e.observers.length&&zn(()=>{for(let o=0;o<e.observers.length;o+=1){const l=e.observers[o];r&&yt.disposed.has(l),(r&&!l.tState||!r&&!l.state)&&(l.pure?Z.push(l):he.push(l),l.observers&&no(l)),r||(l.state=_e)}if(Z.length>1e6)throw Z=[],new Error},!1),t}function Te(e){if(!e.fn)return;Bn(e);const t=z,n=H,r=Mn;H=z=e,vl(e,e.value,r),H=n,z=t}function vl(e,t,n){let r;try{r=e.fn(t)}catch(o){ro(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.observers&&e.observers.length?jn(e,r):e.value=r,e.updatedAt=n)}function tt(e,t,n,r=_e,o){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:z,context:null,pure:n};return z===null||z!==Xr&&(z.owned?z.owned.push(l):z.owned=[l]),l}function ht(e){const t=yt;if(e.state===0||t)return;if(e.state===Ot||t)return Rt(e);if(e.suspense&&D(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Mn);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===_e||t)Te(e);else if(e.state===Ot||t){const o=Z;Z=null,Rt(e,n[0]),Z=o}}function zn(e,t){if(Z)return e();let n=!1;t||(Z=[]),he?n=!0:he=[],Mn++;try{return e()}catch(r){ro(r)}finally{pl(n)}}function pl(e){Z&&(to(Z),Z=null),!e&&(he.length?Be(()=>{Jr(he),he=null}):he=null)}function to(e){for(let t=0;t<e.length;t++)ht(e[t])}function bl(e){let t,n=0;for(t=0;t<e.length;t++){const o=e[t];o.user?e[n++]=o:ht(o)}const r=e.length;for(t=0;t<n;t++)ht(e[t]);for(t=r;t<e.length;t++)ht(e[t])}function Rt(e,t){const n=yt;e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];o.sources&&(o.state===_e||n?o!==t&&ht(o):(o.state===Ot||n)&&Rt(o,t))}}function no(e){const t=yt;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=Ot,r.pure?Z.push(r):he.push(r),r.observers&&no(r))}}function Bn(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const l=o.pop(),i=n.observerSlots.pop();r<o.length&&(l.sourceSlots[i]=r,o[r]=l,n.observerSlots[r]=i)}}if(e.owned){for(t=0;t<e.owned.length;t++)Bn(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function ro(e){const t=Pe&&Wn(z,Pe);if(!t)throw e;t.forEach(n=>n(e))}function Wn(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:Wn(e.owner,t):void 0}function _n(e){if(typeof e=="function"&&!e.length)return _n(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=_n(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function _l(e){return function(n){let r;return pn(()=>r=D(()=>(z.context={[e]:n.value},Vn(()=>n.children)))),r}}const yn=Symbol("fallback");function It(e){for(let t=0;t<e.length;t++)e[t]()}function yl(e,t,n={}){let r=[],o=[],l=[],i=0,s=t.length>1?[]:null;return G(()=>It(l)),()=>{let a=e()||[],c,d;return D(()=>{let h=a.length,m,v,y,w,C,k,T,x,b;if(h===0)i!==0&&(It(l),l=[],r=[],o=[],i=0,s&&(s=[])),n.fallback&&(r=[yn],o[0]=pe($=>(l[0]=$,n.fallback())),i=1);else if(i===0){for(o=new Array(h),d=0;d<h;d++)r[d]=a[d],o[d]=pe(f);i=h}else{for(y=new Array(h),w=new Array(h),s&&(C=new Array(h)),k=0,T=Math.min(i,h);k<T&&r[k]===a[k];k++);for(T=i-1,x=h-1;T>=k&&x>=k&&r[T]===a[x];T--,x--)y[x]=o[T],w[x]=l[T],s&&(C[x]=s[T]);for(m=new Map,v=new Array(x+1),d=x;d>=k;d--)b=a[d],c=m.get(b),v[d]=c===void 0?-1:c,m.set(b,d);for(c=k;c<=T;c++)b=r[c],d=m.get(b),d!==void 0&&d!==-1?(y[d]=o[c],w[d]=l[c],s&&(C[d]=s[c]),d=v[d],m.set(b,d)):l[c]();for(d=k;d<h;d++)d in y?(o[d]=y[d],l[d]=w[d],s&&(s[d]=C[d],s[d](d))):o[d]=pe(f);o=o.slice(0,i=h),r=a.slice(0)}return o});function f(h){if(l[d]=h,s){const[m,v]=P(d);return s[d]=v,t(a[d],m)}return t(a[d])}}}function xl(e,t,n={}){let r=[],o=[],l=[],i=[],s=0,a;return G(()=>It(l)),()=>{const c=e()||[];return D(()=>{if(c.length===0)return s!==0&&(It(l),l=[],r=[],o=[],s=0,i=[]),n.fallback&&(r=[yn],o[0]=pe(f=>(l[0]=f,n.fallback())),s=1),o;for(r[0]===yn&&(l[0](),l=[],r=[],o=[],s=0),a=0;a<c.length;a++)a<r.length&&r[a]!==c[a]?i[a](()=>c[a]):a>=r.length&&(o[a]=pe(d));for(;a<r.length;a++)l[a]();return s=i.length=l.length=c.length,r=c.slice(0),o=o.slice(0,s)});function d(f){l[a]=f;const[h,m]=P(c[a]);return i[a]=m,t(h,a)}}}function u(e,t){return D(()=>e(t))}function Nt(){return!0}const oo={get(e,t,n){return t===ze?n:e.get(t)},has(e,t){return e.has(t)},set:Nt,deleteProperty:Nt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Nt,deleteProperty:Nt}},ownKeys(e){return e.keys()}};function rn(e){return typeof e=="function"?e():e}function ye(...e){return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){const r=rn(e[n])[t];if(r!==void 0)return r}},has(t){for(let n=e.length-1;n>=0;n--)if(t in rn(e[n]))return!0;return!1},keys(){const t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(rn(e[n])));return[...new Set(t)]}},oo)}function wl(e,...t){const n=new Set(t.flat()),r=Object.getOwnPropertyDescriptors(e),o=t.map(l=>{const i={};for(let s=0;s<l.length;s++){const a=l[s];Object.defineProperty(i,a,r[a]?r[a]:{get(){return e[a]},set(){return!0}})}return i});return o.push(new Proxy({get(l){return n.has(l)?void 0:e[l]},has(l){return n.has(l)?!1:l in e},keys(){return Object.keys(e).filter(l=>!n.has(l))}},oo)),o}function kl(e){let t,n;const r=o=>{if(t){const i=t();if(i)return i(o)}else{const[i]=bn(()=>(n||(n=e())).then(s=>s.default),{globalRefetch:!1});t=i}let l;return R(()=>(l=t())&&D(()=>l(o)))};return r.preload=()=>n||((n=e()).then(o=>t=()=>o.default),n),r}let $l=0;function Se(){return`cl-${$l++}`}function F(e){const t="fallback"in e&&{fallback:()=>e.fallback};return R(yl(()=>e.each,e.children,t||void 0))}function Id(e){const t="fallback"in e&&{fallback:()=>e.fallback};return R(xl(()=>e.each,e.children,t||void 0))}function Cl(e){let t=!1;const n=Vn(()=>e.children),r=R(()=>{let o=n();Array.isArray(o)||(o=[o]);for(let l=0;l<o.length;l++){const i=o[l].when;if(i)return[l,i,o[l]]}return[-1]},void 0,{equals:(o,l)=>o[0]===l[0]&&(t?o[1]===l[1]:!o[1]==!l[1])&&o[2]===l[2]});return R(()=>{const[o,l,i]=r();if(o<0)return e.fallback;const s=i.children;return(t=typeof s=="function"&&s.length>0)?D(()=>s(l)):s})}function on(e){return e}let Et;function Sl(e){let t;const[n,r]=P(t);Et||(Et=new Set),Et.add(r),G(()=>Et.delete(r));let o;return R(()=>{if((o=n())!=null){const l=e.fallback;return typeof l=="function"&&l.length?D(()=>l(o,()=>r(null))):l}return gl(r),e.children})}const ur="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";function fr(e,t){if(!e)throw new Error(t)}const Nl=(()=>{let e=0;const t=[];return(n,r)=>{const o=n===e;e=n;const l=new Array(8);for(let s=7;s>=0;s--)l[s]=ur.charAt(n%64),n=Math.floor(n/64);fr(n===0,"Cannot push at time == 0");let i=l.join("");if(o){let s;for(s=11;s>=0&&t[s]===63;s--)t[s]=0;t[s]++}else{const s=new Uint8Array(12);r.readBytes(s);for(let a=0;a<12;a++)t[a]=s[a]%64}for(let s=0;s<12;s++)i+=ur.charAt(t[s]);return fr(i.length===20,"nextPushId: Length should be 20."),i}})(),hr=Symbol("raw");function El(e){return(t,...n)=>{const r=[];return t.forEach((l,i)=>{if(r.push({raw:l}),i<n.length){const s=n[i];typeof s=="object"&&hr in s?r.push({raw:s[hr]}):r.push({val:s})}}),r.map(l=>"raw"in l?l.raw:e(l.val)).join("")}}const Ll=El(e=>encodeURIComponent(e));function Dd(e){let t="";for(const[n,r]of Object.entries(e))r!=null&&(t&&(t+="&"),t+=Ll`${n}=${r}`);return t}function Pl(e){return e.replace(/[^a-zA-Z0-9. ]/giu,t=>"&#"+t.codePointAt(0)+";")}function lo(e){throw console.log("not never:",e),new Error("Expected never")}function gr(e,t,n,r){const o={...e},l=[...t];for(const i of n)if(typeof i=="string"){if(l.shift()!==i)return null}else{const s=Object.entries(i);if(!s[0]||s.length!==1)throw new Error("bad bit object");const[a,c]=s[0];if(c==="any"){const d=l.shift();if(d==null)return null;o[a]=d}else if(c==="rest")o[a]=l.splice(0);else if(c==="optional")o[a]=l.shift()??null;else if(Array.isArray(c)||"forEach"in c){const d=l.shift()??null;if(!c.includes(d))return null;o[a]=d}else if(c.kind==="starts-with"){const d=l.shift();if(d==null||!d.startsWith(c.text))return null;o[a]=d.replace(c.text,"")}}return r.assert_end&&l.length!==0?null:{opts:o,path:l}}function io(e){const t=[],n={with(r,o){const l=io(!1);o(l),t.push((i,s)=>{const a=gr(i,s,r,{assert_end:!1});return a?l.parseSub(a.opts,a.path):null})},route(r,o){t.push((l,i)=>{const s=gr(l,i,r,{assert_end:!0});return s?o(s.opts):null})},catchall(r){t.push((o,l)=>r(o))},parse(r){if(!e)throw new Error("not root, ParentOpts \u2260 BaseParentOpts");let o;try{o=new URL(r,new URL("https://example/"))}catch{return null}const l=o.pathname.split("/").filter(s=>s),i={query:Object.fromEntries(o.searchParams),path:o.pathname};return n.parseSub(i,l)},parseSub(r,o){for(const l of t){const i=l(r,o);if(i!=null)return i}return null}};return n}function Md(){return io(!0)}function so(e,t){const n=t[e.kind]??t.unsupported??(()=>{throw new Error("condition "+e.kind+" was not handled and no unsupported branch")});return()=>n(e)}function xt(e,t){return so(e,t)()}try{self["workbox:window:6.5.1"]&&_()}catch{}function xn(e,t){return new Promise(function(n){var r=new MessageChannel;r.port1.onmessage=function(o){n(o.data)},e.postMessage(t,[r.port2])})}function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mr(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Al(e,t){var n;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=function(o,l){if(o){if(typeof o=="string")return mr(o,l);var i=Object.prototype.toString.call(o).slice(8,-1);return i==="Object"&&o.constructor&&(i=o.constructor.name),i==="Map"||i==="Set"?Array.from(o):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?mr(o,l):void 0}}(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.5.1"]&&_()}catch{}var ln=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})};function sn(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var lt=function(e,t){this.type=e,Object.assign(this,t)};function Lt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ol(){}var Rl={type:"SKIP_WAITING"};function vr(e,t){if(!t)return e&&e.then?e.then(Ol):Promise.resolve()}var Il=function(e){var t,n;function r(s,a){var c,d;return a===void 0&&(a={}),(c=e.call(this)||this).nn={},c.tn=0,c.rn=new ln,c.en=new ln,c.on=new ln,c.un=0,c.an=new Set,c.cn=function(){var f=c.fn,h=f.installing;c.tn>0||!sn(h.scriptURL,c.sn.toString())||performance.now()>c.un+6e4?(c.vn=h,f.removeEventListener("updatefound",c.cn)):(c.hn=h,c.an.add(h),c.rn.resolve(h)),++c.tn,h.addEventListener("statechange",c.ln)},c.ln=function(f){var h=c.fn,m=f.target,v=m.state,y=m===c.vn,w={sw:m,isExternal:y,originalEvent:f};!y&&c.mn&&(w.isUpdate=!0),c.dispatchEvent(new lt(v,w)),v==="installed"?c.wn=self.setTimeout(function(){v==="installed"&&h.waiting===m&&c.dispatchEvent(new lt("waiting",w))},200):v==="activating"&&(clearTimeout(c.wn),y||c.en.resolve(m))},c.dn=function(f){var h=c.hn,m=h!==navigator.serviceWorker.controller;c.dispatchEvent(new lt("controlling",{isExternal:m,originalEvent:f,sw:h,isUpdate:c.mn})),m||c.on.resolve(h)},c.gn=(d=function(f){var h=f.data,m=f.ports,v=f.source;return Lt(c.getSW(),function(){c.an.has(v)&&c.dispatchEvent(new lt("message",{data:h,originalEvent:f,ports:m,sw:v}))})},function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];try{return Promise.resolve(d.apply(this,f))}catch(m){return Promise.reject(m)}}),c.sn=s,c.nn=a,navigator.serviceWorker.addEventListener("message",c.gn),c}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,l,i=r.prototype;return i.register=function(s){var a=(s===void 0?{}:s).immediate,c=a!==void 0&&a;try{var d=this;return function(f,h){var m=f();return m&&m.then?m.then(h):h(m)}(function(){if(!c&&document.readyState!=="complete")return vr(new Promise(function(f){return window.addEventListener("load",f)}))},function(){return d.mn=Boolean(navigator.serviceWorker.controller),d.yn=d.pn(),Lt(d.bn(),function(f){d.fn=f,d.yn&&(d.hn=d.yn,d.en.resolve(d.yn),d.on.resolve(d.yn),d.yn.addEventListener("statechange",d.ln,{once:!0}));var h=d.fn.waiting;return h&&sn(h.scriptURL,d.sn.toString())&&(d.hn=h,Promise.resolve().then(function(){d.dispatchEvent(new lt("waiting",{sw:h,wasWaitingBeforeRegister:!0}))}).then(function(){})),d.hn&&(d.rn.resolve(d.hn),d.an.add(d.hn)),d.fn.addEventListener("updatefound",d.cn),navigator.serviceWorker.addEventListener("controllerchange",d.dn),d.fn})})}catch(f){return Promise.reject(f)}},i.update=function(){try{return this.fn?vr(this.fn.update()):void 0}catch(s){return Promise.reject(s)}},i.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(s){try{return Lt(this.getSW(),function(a){return xn(a,s)})}catch(a){return Promise.reject(a)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&xn(this.fn.waiting,Rl)},i.pn=function(){var s=navigator.serviceWorker.controller;return s&&sn(s.scriptURL,this.sn.toString())?s:void 0},i.bn=function(){try{var s=this;return function(a,c){try{var d=a()}catch(f){return c(f)}return d&&d.then?d.then(void 0,c):d}(function(){return Lt(navigator.serviceWorker.register(s.sn,s.nn),function(a){return s.un=performance.now(),a})},function(a){throw a})}catch(a){return Promise.reject(a)}},o=r,(l=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&Tl(o.prototype,l),r}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(n,r){this.Sn(n).add(r)},t.removeEventListener=function(n,r){this.Sn(n).delete(r)},t.dispatchEvent=function(n){n.target=this;for(var r,o=Al(this.Sn(n.type));!(r=o()).done;)(0,r.value)(n)},t.Sn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},e}());function Dl(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisterError:l}=e;let i,s;const a=async(c=!0)=>{c&&i?.addEventListener("controlling",d=>{d.isUpdate&&window.location.reload()}),s&&s.waiting&&await xn(s.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new Il("/sw.js",{scope:"/",type:"classic"}),i.addEventListener("activated",c=>{c.isUpdate||r?.()});{const c=()=>{n?.()};i.addEventListener("waiting",c),i.addEventListener("externalwaiting",c)}i.register({immediate:t}).then(c=>{s=c,o?.(c)}).catch(c=>{l?.(c)})}return a}const Ml={version:`a38ecb6
`,log:[{hash:"a38ecb6",hash_full:"a38ecb6607c983efcc761b7f24084a667311ca5e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650415504000",commit_title:"I give up. github actions are the worst.",commit_body:`I give up. github actions are the worst.
`},{hash:"71f65c9",hash_full:"71f65c9a1f0ad6a502428bd4868a7d291295717e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650415163000",commit_title:"it deployed! supply a valid tag name for next deploy, maybe the automatic release will work",commit_body:`it deployed! supply a valid tag name for next deploy, maybe the automatic release will work
`},{hash:"446fde3",hash_full:"446fde32187690a2b5a7efdb8f5511f4dc64805b",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650414756000",commit_title:"fix deploy script (3/?) (for some reason yarn doesn't cache dependencies that are required on a different platform than the on you are on. why do they even have an option for `--immutable --immutable-cache` if you can't even use it?",commit_body:"fix deploy script (3/?) (for some reason yarn doesn't cache dependencies that are required on a different platform than the on you are on. why do they even have an option for `--immutable --immutable-cache` if you can't even use it?\n"},{hash:"6b79116",hash_full:"6b791164613988a32e277608d41c3717c6d2a3fb",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650414024000",commit_title:"fix deploy script (2/?)",commit_body:`fix deploy script (2/?)
`},{hash:"cb51a04",hash_full:"cb51a046d84ef85ddc6b0fecc1e9b34b12b9de66",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650413754000",commit_title:"fix the deploy script (1/?)",commit_body:`fix the deploy script (1/?)
`},{hash:"9361f40",hash_full:"9361f400c33fe7a22194afb5e4d59c7aeda339fe",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650413670000",commit_title:"add a setting for changelogs",commit_body:`add a setting for changelogs
`},{hash:"1a97597",hash_full:"1a97597f0d049977c692e3d6810356f36c6978a7",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650413351000",commit_title:"try out auto generating a github release",commit_body:`try out auto generating a github release
`},{hash:"076c4d2",hash_full:"076c4d2ed317ed08a025cd0ba4a225c6e55a170e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650412440000",commit_title:"update actions. threadclient deploy now takes a release id",commit_body:`update actions. threadclient deploy now takes a release id
`},{hash:"d02edec",hash_full:"d02edec75de3c9c6fd390f6a97c78213e52d7a70",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650412233000",commit_title:"add a version to the deploy action",commit_body:`add a version to the deploy action
`},{hash:"90e3da4",hash_full:"90e3da40625a0b658cb219e3c8b3f34592dcd57e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1650410552000",commit_title:"display an update banner",commit_body:`display an update banner
`}],build_time:1650415747602,build_mode:"production"},Vl="modulepreload",pr={},jl="/",Y=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${jl}${r}`,r in pr)return;pr[r]=!0;const o=r.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Vl,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((s,a)=>{i.addEventListener("load",s),i.addEventListener("error",()=>a(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},zl=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],Bl=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",...zl]),Wl=new Set(["innerHTML","textContent","innerText","children"]),Ul={className:"class",htmlFor:"for"},br={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},Hl=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Fl=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),ql={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function j(e,t){return R(e,void 0,t?void 0:{equals:t})}function Gl(e,t,n){let r=n.length,o=t.length,l=r,i=0,s=0,a=t[o-1].nextSibling,c=null;for(;i<o||s<l;){if(t[i]===n[s]){i++,s++;continue}for(;t[o-1]===n[l-1];)o--,l--;if(o===i){const d=l<r?s?n[s-1].nextSibling:n[l-s]:a;for(;s<l;)e.insertBefore(n[s++],d)}else if(l===s)for(;i<o;)(!c||!c.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[l-1]&&n[s]===t[o-1]){const d=t[--o].nextSibling;e.insertBefore(n[s++],t[i++].nextSibling),e.insertBefore(n[--l],d),t[o]=n[l]}else{if(!c){c=new Map;let f=s;for(;f<l;)c.set(n[f],f++)}const d=c.get(t[i]);if(d!=null)if(s<d&&d<l){let f=i,h=1,m;for(;++f<o&&f<l&&!((m=c.get(t[f]))==null||m!==d+h);)h++;if(h>d-s){const v=t[i];for(;s<d;)e.insertBefore(n[s++],v)}else e.replaceChild(n[s++],t[i++])}else i++;else t[i++].remove()}}}const _r="_$DX_DELEGATE";function wt(e,t,n){let r;return pe(o=>{r=o,t===document?e():g(t,e(),t.firstChild?null:void 0,n)}),()=>{r(),t.textContent=""}}function p(e,t,n){const r=document.createElement("template");r.innerHTML=e;let o=r.content.firstChild;return n&&(o=o.firstChild),o}function se(e,t=window.document){const n=t[_r]||(t[_r]=new Set);for(let r=0,o=e.length;r<o;r++){const l=e[r];n.has(l)||(n.add(l),t.addEventListener(l,Ql))}}function W(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function Kl(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function at(e,t,n,r){r?Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n:Array.isArray(n)?e.addEventListener(t,o=>n[0](n[1],o)):e.addEventListener(t,n)}function Yl(e,t,n={}){const r=Object.keys(t||{}),o=Object.keys(n);let l,i;for(l=0,i=o.length;l<i;l++){const s=o[l];!s||s==="undefined"||t[s]||(yr(e,s,!1),delete n[s])}for(l=0,i=r.length;l<i;l++){const s=r[l],a=!!t[s];!s||s==="undefined"||n[s]===a||!a||(yr(e,s,!0),n[s]=a)}return n}function Kt(e,t,n={}){const r=e.style,o=typeof n=="string";if(t==null&&o||typeof t=="string")return r.cssText=t;o&&(r.cssText=void 0,n={}),t||(t={});let l,i;for(i in n)t[i]==null&&r.removeProperty(i),delete n[i];for(i in t)l=t[i],l!==n[i]&&(r.setProperty(i,l),n[i]=l);return n}function ao(e,t,n,r){typeof t=="function"?L(o=>wr(e,t(),o,n,r)):wr(e,t,void 0,n,r)}function g(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return Ze(e,t,r,n);L(o=>Ze(e,t(),o,n),r)}function Jl(e,t,n,r,o={},l=!1){t||(t={});for(const i in o)if(!(i in t)){if(i==="children")continue;xr(e,i,null,o[i],n,l)}for(const i in t){if(i==="children"){r||Ze(e,t.children);continue}const s=t[i];o[i]=xr(e,i,s,o[i],n,l)}}function Xl(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function yr(e,t,n){const r=t.trim().split(/\s+/);for(let o=0,l=r.length;o<l;o++)e.classList.toggle(r[o],n)}function xr(e,t,n,r,o,l){let i,s,a;if(t==="style")return Kt(e,n,r);if(t==="classList")return Yl(e,n,r);if(n===r)return r;if(t==="ref")l||n(e);else if(t.slice(0,3)==="on:")e.addEventListener(t.slice(3),n);else if(t.slice(0,10)==="oncapture:")e.addEventListener(t.slice(10),n,!0);else if(t.slice(0,2)==="on"){const c=t.slice(2).toLowerCase(),d=Hl.has(c);at(e,c,n,d),d&&se([c])}else if((a=Wl.has(t))||!o&&(br[t]||(s=Bl.has(t)))||(i=e.nodeName.includes("-")))i&&!s&&!a?e[Xl(t)]=n:e[br[t]||t]=n;else{const c=o&&t.indexOf(":")>-1&&ql[t.split(":")[0]];c?Kl(e,c,t,n):W(e,Ul[t]||t,n)}return n}function Ql(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n!==null;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r(o,e):r(e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function wr(e,t,n={},r,o){return t||(t={}),!o&&"children"in t&&L(()=>n.children=Ze(e,t.children,n.children)),t.ref&&t.ref(e),L(()=>Jl(e,t,r,!0,n,!0)),n}function Ze(e,t,n,r,o){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,l==="string"||l==="number")if(l==="number"&&(t=t.toString()),i){let s=n[0];s&&s.nodeType===3?s.data=t:s=document.createTextNode(t),n=Fe(e,n,r,s)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||l==="boolean")n=Fe(e,n,r);else{if(l==="function")return L(()=>{let s=t();for(;typeof s=="function";)s=s();n=Ze(e,s,n,r)}),()=>n;if(Array.isArray(t)){const s=[];if(wn(s,t,o))return L(()=>n=Ze(e,s,n,r,!0)),()=>n;if(s.length===0){if(n=Fe(e,n,r),i)return n}else Array.isArray(n)?n.length===0?kr(e,s,r):Gl(e,n,s):(n&&Fe(e),kr(e,s));n=s}else if(t instanceof Node){if(Array.isArray(n)){if(i)return n=Fe(e,n,r,t);Fe(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function wn(e,t,n){let r=!1;for(let o=0,l=t.length;o<l;o++){let i=t[o],s;if(i instanceof Node)e.push(i);else if(!(i==null||i===!0||i===!1))if(Array.isArray(i))r=wn(e,i)||r;else if((s=typeof i)=="string")e.push(document.createTextNode(i));else if(s==="function")if(n){for(;typeof i=="function";)i=i();r=wn(e,Array.isArray(i)?i:[i])||r}else e.push(i),r=!0;else e.push(document.createTextNode(i.toString()))}return r}function kr(e,t,n){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function Fe(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let l=!1;for(let i=t.length-1;i>=0;i--){const s=t[i];if(o!==s){const a=s.parentNode===e;!l&&!i?a?e.replaceChild(o,s):e.insertBefore(o,n):a&&s.remove()}else l=!0}}else e.insertBefore(o,n);return[o]}const Zl="http://www.w3.org/2000/svg";function co(e,t=!1){return t?document.createElementNS(Zl,e):document.createElement(e)}function ei(e){const{useShadow:t}=e,n=document.createTextNode(""),r=e.mount||document.body;function o(){return()=>e.children}if(r instanceof HTMLHeadElement){const[l,i]=P(!1),s=()=>i(!0);pe(a=>g(r,()=>l()?a():o()(),null)),G(()=>{s()})}else{const l=co(e.isSVG?"g":"div",e.isSVG),i=t&&l.attachShadow?l.attachShadow({mode:"open"}):l;Object.defineProperty(l,"host",{get(){return n.parentNode}}),g(i,o()),r.appendChild(l),e.ref&&e.ref(l),G(()=>r.removeChild(l))}return n}function Yt(e){const[t,n]=wl(e,["component"]);return R(()=>{const r=t.component;switch(typeof r){case"function":return D(()=>r(n));case"string":const o=Fl.has(r),l=co(r,o);return ao(l,n,o),l}})}function uo(e,t){const n=e,r=n[t];return r?Object.hasOwnProperty.call(n,t)?"error"in r?{error:r.error,value:null}:{value:r.data,error:null}:{error:"[read]Link found but not in hasOwnProperty: "+t.toString(),value:null}:{error:"[read]Link not found: "+t.toString(),value:null}}function ti(e,t,n){return{...t,kind:e,...n?{children:n}:{}}}const V={kind:ti,p:(...e)=>V.kind("paragraph",{},e),hn:(e,...t)=>V.kind("heading",{level:e},t),h1:(...e)=>V.hn(1,...e),h2:(...e)=>V.hn(2,...e),ul:(...e)=>V.kind("list",{ordered:!1},e),ol:(...e)=>V.kind("list",{ordered:!0},e),li:(...e)=>V.kind("list_item",{},e),ili:(...e)=>V.kind("tight_list_item",{},e),blockquote:(...e)=>V.kind("blockquote",{},e),txt:(e,t={})=>V.kind("text",{text:e,styles:t}),link:(e,t,n,...r)=>V.kind("link",{url:t,client_id:e.id,...n},r),pre:(e,t)=>V.kind("code_block",{text:e,lang:t}),error:(e,t)=>V.kind("error",{text:e,value:t}),br:()=>V.kind("br",{}),flair:e=>V.kind("flair",{flair:e}),table:(e,...t)=>V.kind("table",{headings:e},t),th:(e,...t)=>({align:e,children:t}),td:(...e)=>({children:e}),timeAgo:e=>V.kind("time_ago",{start:e}),hr:()=>V.kind("horizontal_line",{}),code:e=>V.kind("code",{text:e}),spoiler:(...e)=>V.kind("spoiler",{},e)},Vd={link:(e,t,n,r)=>({selected:r,action:{kind:"link",client_id:e.id,url:n},text:t})};function ni(e){const t="https://v.redd.it/"+e;return{kind:"video",sources:[{url:t+"/DASHPlaylist.mpd"},{url:t+"/HLSPlaylist.m3u8"}],preview:[{url:t+"/DASH_96.mp4",type:"video/mp4"},{url:t+"/DASH_96",type:"video/mp4"}]}}function $r(e,t){const n=e.split(".");return n.pop(),n.push(t),n.join(".")}function Cr(e){return{kind:"video",source:ni(e),gifv:!1}}const ri={image:({url:e,link:t,path:n,next:r})=>(e?n.endsWith(".gif")&&e.searchParams.get("format")==="mp4":!1)?{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}}:(e?.hostname??"")==="i.imgur.com"&&n.endsWith(".gif")||n.endsWith(".gifv")?{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:$r(t,"webm"),quality:"Highest"},{url:$r(t,"mp4"),quality:"Highest"},{url:t,quality:"Highest"}]}}:(e?.hostname??"")==="i.redd.it"||n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".gif")||n.endsWith(".webp")||(e?.hostname??"")==="pbs.twimg.com"?{kind:"captioned_image",url:t,w:null,h:null}:n.endsWith(".mp4")||n.endsWith(".webm")?{kind:"video",gifv:!1,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}}:n.endsWith(".mp3")?{kind:"audio",url:t}:r(),vreddit:({url:e,link:t,path:n,next:r})=>{if(t.startsWith("https://v.redd.it/"))return Cr(t.replace("https://v.redd.it/",""));if(e&&(e.host==="reddit.com"||e.host.endsWith(".reddit.com")&&e.pathname.startsWith("/link"))){const o=n.split("/");if(o.shift(),o[0]==="link"&&o[2]==="video"&&o[4]==="player")return Cr(o[3]??"")}return r()},gfycat:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="gfycat.com"||e.host.endsWith(".gfycat.com"))&&e.pathname.split("/").length===2)return{kind:"gfycatv1",id:e.pathname.replace("/","").split("-")[0].split(".")[0].toLowerCase(),host:"gfycat.com"};if(e&&(e.host==="redgifs.com"||e.host.endsWith(".redgifs.com"))&&e.pathname.split("/").length===3&&e.pathname.startsWith("/watch/")){const o=e.pathname.replace("/watch/","").split("-")[0].split(".")[0].toLowerCase();return{kind:"gfycatv2",id:o,host:"redgifs.com"}}return r()},youtube:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="www.youtube.com"||e.host==="youtube.com"||e.host==="m.youtube.com")&&e.pathname==="/watch"){const o=e.searchParams.get("v");if(o!=null)return{kind:"youtube",id:o,search:e.searchParams.toString()}}if(e&&e.host==="youtu.be"&&e.pathname.split("/").length===2){const o=e.pathname.split("/")[1]??"no_id";return{kind:"youtube",id:o,search:e.searchParams.toString()}}return r()},vocaroo:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="vocaroo.com"||e.host==="www.vocaroo.com"||e.host==="voca.ro")){const o=e.pathname.split("/").filter(l=>l);if(o.length===1&&o[0]!=null&&o[0]!=="")return{kind:"audio",url:"https://media.vocaroo.com/mp3/"+o[0]}}return r()},giphy:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="giphy.com"||e.host==="www.giphy.com")){const o=e.pathname.split("/").filter(l=>l);if(o.length===3&&o[0]==="gifs"&&o[2]==="fullscreen"){const l=o[1].split("-"),i=l[l.length-1];return{kind:"video",source:{kind:"video",sources:[{url:"https://media4.giphy.com/media/"+i+"/giphy.mp4",quality:"Highest"}]},gifv:!0}}}return r()},imgur:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="www.imgur.com"||e.host==="imgur.com"||e.host==="m.imgur.com")){const o=e.pathname.split("/").filter(s=>s),l=o[1],i=o[0]==="gallery"?"gallery":o[0]==="a"?"album":void 0;if(i!==void 0&&o.length===2)return{kind:"imgur",imgur_id:l,imgur_kind:i};if(o.length===1&&(o[0]??"").length>4)return{kind:"captioned_image",url:"https://i.imgur.com/"+o[0]+".jpg",w:null,h:null}}return r()},twitch:({url:e,link:t,path:n,next:r})=>{if(e&&e.host==="clips.twitch.tv"&&e.pathname.split("/").filter(o=>o).length===1){const o=e.pathname.split("/").filter(l=>l)[0];if(o!=null)return{kind:"twitch_clip",slug:o}}return r()},soundcloud:({url:e,link:t,path:n,next:r})=>e&&(e.host==="soundcloud.com"||e.host.endsWith(".soundcloud.com"))?{kind:"oembed",client_id:"n/a",url:"https://soundcloud.com/oembed?format=json&url="+encodeURIComponent(t)}:r(),tiktok:({url:e,link:t,path:n,next:r})=>e&&(e.host==="tiktok.com"||e.host.endsWith(".tiktok.com"))?{kind:"oembed",client_id:"n/a",url:"https://www.tiktok.com/oembed?url="+encodeURIComponent(t)}:r()};function Jt(e,t){let n;try{n=new URL(e)}catch{}const r=n,o=r?.pathname??e,l=Object.values(ri),i=a=>{const c=l[a];return c?c({url:r,link:e,path:o,next:()=>i(a+1)}):s()},s=()=>t.suggested_embed!=null?{kind:"reddit_suggested_embed",suggested_embed:t.suggested_embed}:null;return i(0)??void 0}async function oi(e,t){const n=await fetch("https://api."+e+"/v2/gifs/"+t).then(s=>s.json());if(console.log("gfy response",n),"errorMessage"in n)throw new Error("Gfycat error: "+n.errorMessage+"; logged="+n.logged+"; reported="+n.reported);if("message"in n)throw new Error("Gfycat error: "+n.message+"; logged="+n.logged+"; reported="+n.reported);const{gif:r,user:o}=n,l="https://www."+e,i={kind:"video",aspect:r.width/r.height,gifv:!1,source:{kind:"video",sources:[{url:r.urls.hd,quality:"HD"},{url:r.urls.sd,quality:"SD"}],thumbnail:r.urls.thumbnail}};return{kind:"post",parent:null,replies:null,url:"https://www."+e+"/watch/"+t,client_id:l,display_style:"centered",content:{kind:"post",title:null,thumbnail:{kind:"image",url:r.urls.thumbnail},flair:r.tags.map(s=>({content_warning:!1,elems:[{kind:"text",text:s}]})),info:{creation_date:r.createDate*1e3},author:o?{name:o.name,color_hash:o.username,link:o.url,client_id:l,pfp:{url:o.profileImageUrl,hover:o.profileImageUrl}}:void 0,body:i,show_replies_when_below_pivot:!1,collapsible:{default_collapsed:!1},actions:{vote:{kind:"counter",client_id:l,unique_id:"like_"+t,time:Date.now(),neutral_icon:"heart",special:void 0,increment:{icon:"heart",color:"pink",label:"Like",undo_label:"Unlike"},decrement:null,count_excl_you:r.likes,you:void 0,actions:{error:"gfycat liking is not supported"}},other:[{kind:"link",text:r.views+" Views",url:"https://www."+e+"/watch/"+t,client_id:l}]}},internal_data:n}}const li=p("<div><div></div></div>"),ii=p("<div aria-hidden></div>");function si(e){let t;const n=(o,l,i)=>{if(l.bottom<0||l.right<0||l.left>o[0]||l.top>o[1])return;let s=l.top,a=l.left,c=l.width,d=l.height;if(c<8){const f=8-c;a-=f,c+=f*2}if(d<8){const f=8-d;s-=f,d+=f*2}pe(f=>{const h=i/10%360|0,m=1e3,v=(()=>{const y=li.cloneNode(!0),w=y.firstChild;return(C=>{hl(()=>{C.offsetWidth,C.style.opacity="0"})})(y),y.addEventListener("transitionend",C=>{C.target===C.currentTarget&&f()}),y.style.setProperty("position","fixed"),y.style.setProperty("top",s+"px"),y.style.setProperty("left",a+"px"),y.style.setProperty("width",c+"px"),y.style.setProperty("height",d+"px"),y.style.setProperty("z-index","2147483647"),y.style.setProperty("opacity","100"),y.style.setProperty("transition","1000ms opacity"),w.style.setProperty("width","100%"),w.style.setProperty("height","100%"),w.style.setProperty("box-sizing","border-box"),w.style.setProperty("border","1px solid hsl("+h+", 100%, 50%)"),y})();t.appendChild(v),G(()=>v.remove())})},r=(o,l,i)=>{if(l instanceof Element)n(o,l.getBoundingClientRect(),i);else if(l instanceof Text){const s=document.createRange();s.selectNode(l),n(o,s.getBoundingClientRect(),i)}else l instanceof Comment||console.log("EBADNODE",l)};return U(()=>{const o=new MutationObserver(l=>{const i=new Set,s=c=>{c.forEach(d=>{i.add(d),s(d.childNodes)})};for(const c of l)c.type==="attributes"?i.add(c.target):c.type==="childList"?s(c.addedNodes):c.type==="characterData"&&i.add(c.target);const a=[window.innerWidth,window.innerHeight];i.forEach(c=>r(a,c,Date.now()))});o.observe(e.observe_root,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),G(()=>o.disconnect())}),(()=>{const o=ii.cloneNode(!0),l=t;return typeof l=="function"?l(o):t=o,o.style.setProperty("pointer-events","none"),o})()}const ai=p("<time></time>");function ee(e){return R(()=>{const t=so(e.item,"fallback"in e?{...e.children,unsupported:e.fallback}:e.children);return D(()=>t())})}function E(e){const t=R(()=>"if"in e?e.if??!1:!0);return R(()=>t()&&("when"in e?e.when!=null:!0)?"when"in e?(()=>{const n=e.children;return D(()=>n(e.when))})():e.children:e.fallback)}function fo(e,t){if(document.getSelection()?.isCollapsed===!1)return!1;let r=e;for(;r&&r!==t;){if(r instanceof HTMLElement&&(r.nodeName==="A"||r.nodeName==="BUTTON"||r.nodeName==="VIDEO"||r.nodeName==="AUDIO"||r.nodeName==="INPUT"||r.nodeName==="TEXTAREA"||r.nodeName==="IFRAME"||r.classList.contains("resizable-iframe")||r.classList.contains("handles-clicks")))return!1;r=r.parentNode}return!0}function an(e,t){if(!t.endsWith("s"))throw new Error("!s");return e===1?e+t.substring(0,t.length-1):e+t}function ci(e,t,n={}){const r=t-e;if(r<0)return[n.short??!1?"later":"in the future "+new Date(e).toISOString(),-r];if(r<60*1e3)return[n.short??!1?"now":"just now",60*1e3-r];let o=60*1e3,l=60;if(r<l*o){const s=r/o|0;return[n.short??!1?s+"m":an(s," minutes")+" ago",o-(r-s*o)]}if(o*=l,l=24,r<l*o){const s=r/o|0;return[n.short??!1?s+"h":an(s," hours")+" ago",o-(r-s*o)]}if(o*=l,l=30,r<l*o){const s=r/o|0;return[n.short??!1?s+"d":an(s," days")+" ago",o-(r-s*o)]}const i=new Date(e).getFullYear();return i===new Date(t).getFullYear()?[n.short??!1?new Date(e).toLocaleString(void 0,{month:"short"}):"in "+new Date(e).toLocaleString(void 0,{month:"long"}),-1]:[n.short??!1?""+i:"in "+i,-1]}function ho(e,t={}){const[n,r]=P(Date.now());return R(()=>{const l=ci(e,n(),t);if(l[1]>0){const i=setTimeout(()=>r(Date.now()),Math.min(l[1]+10,2147483647));G(()=>clearTimeout(i))}return l[0]})}function go(e){return(()=>{const t=ai.cloneNode(!0);return g(t,()=>ho(e.start)),L(n=>{const r=new Date(e.start).toString(),o=""+new Date(e.start);return r!==n._v$&&W(t,"datetime",n._v$=r),o!==n._v$2&&W(t,"title",n._v$2=o),n},{_v$:void 0,_v$2:void 0}),t})()}function mo(e){const[t,n]=P(localStorage.getItem(e)),r=o=>{o.key===e&&n(o.newValue)};return window.addEventListener("storage",r),G(()=>window.removeEventListener("storage",r)),[t,o=>{o==null?localStorage.removeItem(e):localStorage.setItem(e,o),n(o)}]}function di(e,t){return t==null||typeof t!="object"?!1:t.key===e.sym}function ui(e,t){const n=Vn(e);return R(()=>{let r=n();return Array.isArray(r)||(r=[r]),r.filter(o=>o).map(t)})}function vo(){const e=Symbol(""+Math.random()),r=Object.assign(o=>({key:e,value:o,toString(){throw new Error("TypesafeChild not allowed in DOM")}}),{useChildren:o=>ui(o,l=>{if(!di(r,l))throw console.log("Ebad_tsch_child",r,l),new Error("bad tsch child");return l.value}),sym:e});return r}function fi(e,t){return"status_msg"in e?{kind:"richtext",content:[V.p(V.error("Could not preview oembed",e))]}:e.url!=null?{kind:"link_preview",client_id:t,thumb:e.embed_url||e.image||void 0,click:e.embed_url?{kind:"captioned_image",url:e.embed_url,w:null,h:null}:{kind:"link",client_id:t,url:e.url,embed_html:e.html||void 0},click_enabled:!!(e.embed_url||e.html),title:e.title,description:e.description,url:e.url}:{kind:"reddit_suggested_embed",suggested_embed:e.html}}const Un=Symbol("store-raw"),Dt=Symbol("store-node"),hi=Symbol("store-name");function po(e,t){let n=e[ze];if(!n){Object.defineProperty(e,ze,{value:n=new Proxy(e,vi)});const r=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let l=0,i=r.length;l<i;l++){const s=r[l];if(o[s].get){const a=o[s].get.bind(n);Object.defineProperty(e,s,{get:a})}}}return n}function xe(e){return e!=null&&typeof e=="object"&&(e[ze]||!e.__proto__||e.__proto__===Object.prototype||Array.isArray(e))}function et(e,t=new Set){let n,r,o,l;if(n=e!=null&&e[Un])return n;if(!xe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,s=e.length;i<s;i++)o=e[i],(r=et(o,t))!==o&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),s=Object.getOwnPropertyDescriptors(e);for(let a=0,c=i.length;a<c;a++)l=i[a],!s[l].get&&(o=e[l],(r=et(o,t))!==o&&(e[l]=r))}return e}function Mt(e){let t=e[Dt];return t||Object.defineProperty(e,Dt,{value:t={}}),t}function gi(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===ze||t===Dt||t===hi||(delete n.value,delete n.writable,n.get=()=>e[ze][t]),n}function mi(e){if(Zr()){const t=Mt(e);(t._||(t._=kn()))()}return Reflect.ownKeys(e)}function kn(){const[e,t]=P(void 0,{equals:!1,internal:!0});return e.$=t,e}const vi={get(e,t,n){if(t===Un)return e;if(t===ze)return n;const r=e[t];if(t===Dt||t==="__proto__")return r;const o=xe(r);if(Zr()&&(typeof r!="function"||e.hasOwnProperty(t))){let l,i;o&&(l=Mt(r))&&(i=l._||(l._=kn()),i()),l=Mt(e),i=l[t]||(l[t]=kn()),i()}return o?po(r):r},set(){return!0},deleteProperty(){return!0},ownKeys:mi,getOwnPropertyDescriptor:gi};function de(e,t,n){if(e[t]===n)return;const r=Array.isArray(e),o=e.length,l=n===void 0,i=r||l===t in e;l?delete e[t]:e[t]=n;let s=Mt(e),a;(a=s[t])&&a.$(),r&&e.length!==o&&(a=s.length)&&a.$(),i&&(a=s._)&&a.$()}function pi(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];de(e,o,t[o])}}function ct(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,s=Array.isArray(e);if(Array.isArray(r)){for(let a=0;a<r.length;a++)ct(e,[r[a]].concat(t),n);return}else if(s&&i==="function"){for(let a=0;a<e.length;a++)r(e[a],a)&&ct(e,[a].concat(t),n);return}else if(s&&i==="object"){const{from:a=0,to:c=e.length-1,by:d=1}=r;for(let f=a;f<=c;f+=d)ct(e,[f].concat(t),n);return}else if(t.length>1){ct(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let l=t[0];typeof l=="function"&&(l=l(o,n),l===o)||r===void 0&&l==null||(l=et(l),r===void 0||xe(o)&&xe(l)&&!Array.isArray(l)?pi(o,l):de(e,r,l))}function bo(e,t){const n=et(e||{}),r=po(n);function o(...l){Be(()=>ct(n,l))}return[r,o]}function Ge(e,t,n,r,o){const l=t[n];if(e===l)return;if(!xe(e)||!xe(l)||o&&e[o]!==l[o]){e!==l&&de(t,n,e);return}if(Array.isArray(e)){if(e.length&&l.length&&(!r||o&&e[0][o]!=null)){let a,c,d,f,h,m,v,y;for(d=0,f=Math.min(l.length,e.length);d<f&&(l[d]===e[d]||o&&l[d][o]===e[d][o]);d++)Ge(e[d],l,d,r,o);const w=new Array(e.length),C=new Map;for(f=l.length-1,h=e.length-1;f>=d&&h>=d&&(l[f]===e[h]||o&&l[f][o]===e[h][o]);f--,h--)w[h]=l[f];if(d>h||d>f){for(c=d;c<=h;c++)de(l,c,e[c]);for(;c<e.length;c++)de(l,c,w[c]),Ge(e[c],l,c,r,o);l.length>e.length&&de(l,"length",e.length);return}for(v=new Array(h+1),c=h;c>=d;c--)m=e[c],y=o?m[o]:m,a=C.get(y),v[c]=a===void 0?-1:a,C.set(y,c);for(a=d;a<=f;a++)m=l[a],y=o?m[o]:m,c=C.get(y),c!==void 0&&c!==-1&&(w[c]=l[a],c=v[c],C.set(y,c));for(c=d;c<e.length;c++)c in w?(de(l,c,w[c]),Ge(e[c],l,c,r,o)):de(l,c,e[c])}else for(let a=0,c=e.length;a<c;a++)Ge(e[a],l,a,r,o);l.length>e.length&&de(l,"length",e.length);return}const i=Object.keys(e);for(let a=0,c=i.length;a<c;a++)Ge(e[i[a]],l,i[a],r,o);const s=Object.keys(l);for(let a=0,c=s.length;a<c;a++)e[s[a]]===void 0&&de(l,s[a],void 0)}function $e(e,t={}){const{merge:n,key:r="id"}=t,o=et(e);return l=>!xe(l)||!xe(o)?o:(Ge(o,{state:l},"state",n,r),l)}const _o={get(e,t){if(t===Un)return e;const n=e[t];return xe(n)?new Proxy(n,_o):n},set(e,t,n){return de(e,t,et(n)),!0},deleteProperty(e,t){return de(e,t,void 0),!0}};function jd(e){return t=>(xe(t)&&e(new Proxy(t,_o)),t)}const bi=p("<style>.cfg-reddit-pfp {display: none;}</style>"),_i=p('<div class="block"><div class="w-22px h-22px flex items-center justify-center"><i></i></div></div>'),yi=p("<div><pre><code> </code></pre><button>Code</button> / <button>Retry</button></div>"),$n=Ee(),Vt=["bg-slate-100 dark:bg-zinc-800","bg-slate-300 dark:bg-zinc-900"];function te(e){const n=Ue($n)?.i??0,r=n+1;return u($n.Provider,{value:{i:r},get children(){return e.children(Vt[n%Vt.length],n)}})}const Cn=Ee();function yo(e){const t=Ue(Cn),n=R(()=>{const r=t?.visible()??!0,o=e.visible();return r?o:!1});return u(Cn.Provider,{value:{visible:n},get children(){return e.children}})}function Hn(){return Ue(Cn)?.visible??(()=>!0)}const xo=Ee();function xi(e){return u(xo.Provider,{get value(){return{pgin:()=>e.pgin,content:()=>e.pgin.page.content,addContent:e.addContent}},get children(){return e.children}})}function wo(){return Ue(xo)}function kt(){const e=wo();if(!e)throw new Error("no page root context here.");return e}function re(e,t,n){const r=()=>{const c=localStorage.getItem(e)??void 0;return n.deserialize?n.deserialize(c):c},[o,l]=P(r()),i=()=>{l(r())};return window.addEventListener("storage",i),Object.assign(()=>o()??t(),{base:t,override:o,setOverride:c=>{c==null?localStorage.removeItem(e):localStorage.setItem(e,n.serialize?n.serialize(c):c),i()}})}function Sr(e,t,n){const r=window.matchMedia(e),[o,l]=P(r.matches?t:n),i=()=>{l(()=>r.matches?t:n)};return r.addEventListener("change",i),G(()=>{r.removeEventListener("change",i)}),o}const wi=pe(()=>{const e={colorScheme:re("color-scheme",Sr("(prefers-color-scheme: dark)","dark","light"),{}),authorPfp:re("pfp-cfg",()=>"on",{}),updateNotifications:re("update_notices",()=>"on",{}),customVideoControls:re("custom_video_controls",()=>"browser",{}),pageVersion:re("page_version",()=>"1",{}),linkHelpers:re("link_helpers",()=>"show",{}),highlightRerenders:re("cors_proxy",()=>"off",{}),galleryDisplay:re("gallery_display",()=>"fullscreen",{}),motion:re("motion",Sr("(prefers-reduced-motion: reduce)","reduce","full"),{}),animationTime:re("animation_time",()=>.2,{serialize:t=>JSON.stringify(t),deserialize:t=>t!=null&&t!==""?JSON.parse(t):void 0}),animationDevMode:re("animation_dev_mode",()=>"none",{}),signature:re("signature",()=>"",{}),links:re("links",()=>"new_tab",{}),changelog:re("changelog",()=>"show",{})};return U(()=>{document.documentElement.classList.toggle("dark",e.colorScheme()==="dark")}),e});wt(()=>u(E,{get if(){return X().authorPfp()==="off"},get children(){return bi.cloneNode(!0)}}),el("div").adto(document.head));function X(){return wi}const[Nr,ki]=P(window.innerWidth);window.addEventListener("resize",()=>{ki(window.innerWidth)});const jt=pe(e=>({sm:R(()=>Nr()<640),lg:R(()=>Nr()<1024)}));function B(...e){return e.flat().join(" ")}function $i(e){return(()=>{const t=_i.cloneNode(!0),n=t.firstChild,r=n.firstChild;return L(o=>{const l=e.icon.class+" "+e.size,i=e.icon.label;return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&W(r,"aria-label",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),t})()}function Xt(e){const[t,n]=P(!0);return u(Sl,{fallback:(r,o)=>(console.log(r),(()=>{const l=yi.cloneNode(!0),i=l.firstChild,s=i.firstChild,a=s.firstChild,c=i.nextSibling,d=c.nextSibling,f=d.nextSibling;return c.$$click=()=>console.log(r,e.data),f.$$click=()=>{n(!1),setTimeout(()=>n(!0),200),o()},L(h=>{const m=r instanceof Error?r.toString()+`

`+r.stack:"Something went wrong",v=J["outlined-button"],y=J["outlined-button"];return m!==h._v$3&&(a.data=h._v$3=m),v!==h._v$4&&(c.className=h._v$4=v),y!==h._v$5&&(f.className=h._v$5=y),h},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),l})()),get children(){return u(E,{get if(){return t()},get fallback(){return"Retrying..."},get children(){return e.children}})}})}se(["click"]);const Ci=p("<span></span>");function me(e,t,n){const r=A(),o=wt(()=>{const[l,i]=P(r.visible);return r.on("hide",()=>i(!1)),r.on("show",()=>i(!0)),u(yo,{visible:l,get children(){return u($n.Provider,{get value(){return{i:n.color_level}},get children(){return D(()=>t())}})}})},e);return r.on("cleanup",()=>o()),r}function ve(e){const t=Hn();return(()=>{const n=Ci.cloneNode(!0);return(r=>{U(()=>{const o=A(),l=e.getValue(o).adto(r);U(()=>{o.setVisible(t())}),G(()=>{o.cleanup(),l.remove()})})})(n),n})()}function Er({h:e,s:t,l:n,a:r=1}){if(t===0){const[d,f,h]=[n,n,n].map(m=>Math.round(m*255));return{r:d,g:h,b:f,a:r}}const o=(1-Math.abs(2*n-1))*t,l=o*(1-Math.abs(e/60%2-1)),i=n-o/2,[s,a,c]=(e<60?[o,l,0]:e<120?[l,o,0]:e<180?[0,o,l]:e<240?[0,l,o]:e<300?[l,0,o]:[o,0,l]).map(d=>Math.round((d+i)*255));return{r:s,g:a,b:c,a:r}}function zt(e){const{r:t,g:n,b:r,a:o}=e;return o!=null&&o<1?`rgba(${Oe(t)}, ${Oe(n)}, ${Oe(r)}, ${Oe(o,2)})`:`rgb(${Oe(t)}, ${Oe(n)}, ${Oe(r)})`}function Oe(e,t=0){const n=e.toFixed(t);if(t===0)return n;const r=n.indexOf(".");if(r>=0){const o=n.match(/0+$/);if(o)return o.index===r+1?n.substring(0,r):n.substring(0,o.index)}return n}function Si(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}function Ni(e,t,n,r){return function(){e>>>=0,t>>>=0,n>>>=0,r>>>=0;let o=e+t|0;return e=t^t>>>9,t=n+(n<<3)|0,n=n<<21|n>>>11,r=r+1|0,o=o+r|0,n=n+o|0,(o>>>0)/4294967296}}function ko(e){const t=Si(e);return Ni(t(),t(),t(),t())}function $o(e){const t=e()*360,n=e()*.5+.5,r=e(),o={h:t,s:n,l:r*.3+.2,a:1},l={...o,l:1-(r*.4+.1)};return[Er(o),Er(l)]}const cn=p("<div></div>");let $t=!1;document.addEventListener("keydown",e=>{e.key==="Shift"&&($t=!0)},{capture:!0});document.addEventListener("keyup",e=>{e.key==="Shift"&&($t=!1)},{capture:!0});document.addEventListener("focus",e=>{$t=!1});function Fn(){const e=X();return D(()=>e.motion()==="reduce")?0:D(()=>$t&&e.animationDevMode()==="shift_slow"?3:e.animationTime())}function qn(e,t,n,r){const[o,l]=P(null);e.addEventListener("transitionend",i=>{i.target===i.currentTarget&&(l(null),r(n(),!1,!1))}),U(Qr([n],()=>{const i=e.getBoundingClientRect(),s=qt.getBoundingClientRect(),a=()=>5+Math.max(0,s.bottom,window.visualViewport.offsetTop),c=()=>window.visualViewport.offsetTop+window.visualViewport.height;console.log("ANIMATE!",i.top,i.bottom,a(),c());let d=0;if(i.top<a()&&i.bottom>a()){const v=document.documentElement.scrollTop;e.scrollIntoView(),document.documentElement.scrollTop-=a();const y=document.documentElement.scrollTop;d=v-y}const f=n();if(t.motion()==="reduce"||t.animationTime()===0||i.top>c()||i.bottom<a()){r(f,!1,!1);return}const h=Math.min(i.bottom,c())-i.top-d,m=document.documentElement.scrollTop;l(null),r(f,!1,!0),requestAnimationFrame(()=>{const v=e.getBoundingClientRect(),y=Math.min(v.bottom,c())-v.top;if(y===h){r(f,!1,!1);return}r(f,!0,!0),l(h),e.scrollTop=d,requestAnimationFrame(()=>{document.documentElement.scrollTop=m,e.scrollTop=d,l(y)})})},{defer:!0})),U(()=>{o()!=null?(console.log("ANIMATING",$t),e.style.height=o()+"px",e.style.overflow="hidden",e.style.transition=Fn()+"s height",e.offsetHeight):(e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition"))})}function Co(e){const t=X(),[n,r]=P({main:e.when,animating:!1});return(()=>{const o=cn.cloneNode(!0);return(l=>{qn(l,t,()=>e.when,(i,s,a)=>{r({main:i||s,animating:a})}),U(()=>{l.style.display=n().main||e.fallback!=null?"block":"none"})})(o),g(o,u(E,{get if(){return n().main||n().animating},get children(){const l=cn.cloneNode(!0);return g(l,()=>e.children),L(()=>l.className=n().animating&&!n().main?"hidden":""),l}}),null),g(o,u(E,{get if(){return!n().main||n().animating},get children(){const l=cn.cloneNode(!0);return g(l,()=>e.fallback),L(()=>l.className=n().animating&&n().main?"hidden":""),l}}),null),o})()}const Lr=p("<a></a>"),So=p("<span></span>"),Ei=p("<button></button>");function Li(e){const t=R(()=>{if(!e.allow_preview)return;const n=Jt(e.href,{});if(!n)return;const[r,o]=P(!1);return{visible:r,setVisible:o,body:n}});return[u(fe,{get client_id(){return e.client_id},get href(){return e.href},get style(){return t()?"previewable":"normal"},get onClick(){return t()?()=>{const n=t();n.setVisible(!n.visible())}:void 0},get children(){return[j(()=>e.children),u(E,{get when(){return t()},children:n=>[" ",j(()=>n.visible()?"\u25BE":"\u25B8")]})]}}),u(E,{get when(){return t()},children:n=>u(Co,{get when(){return n.visible()},get children(){return u(oe,{autoplay:!0,get body(){return n.body}})}})})]}function le(e){const t=R(()=>e.href==null?{kind:"none"}:en(e.client_id,e.href)),n=X(),r=o=>l=>{if(!((o?.external??!1)&&!e.onClick&&!e.onClickNoPreventDefault)&&(e.onClickNoPreventDefault?.(l),l.stopPropagation(),!l.defaultPrevented&&l.button===0&&!Uo(l))){if(l.preventDefault(),e.onClick)return e.onClick(l);if(o==null)return alert("E_LINK_HREF_EXPECT_NAVIGATE: "+e.href);rt({path:o.url,page:e.page?.()})}};return u(ee,{get item(){return t()},children:{error:o=>(()=>{const l=Lr.cloneNode(!0);return(i=>e.btnref?.(i))(l),at(l,"click",r(void 0),!0),g(l,()=>e.children),L(i=>{const s=e.class+" error",a=o.title;return s!==i._v$&&(l.className=i._v$=s),a!==i._v$2&&W(l,"title",i._v$2=a),i},{_v$:void 0,_v$2:void 0}),l})(),mailto:o=>(()=>{const l=So.cloneNode(!0);return at(l,"click",r(void 0),!0),(i=>e.btnref?.(i))(l),g(l,()=>e.children),L(()=>W(l,"title",o.title)),l})(),link:o=>(()=>{const l=Lr.cloneNode(!0);return(i=>e.btnref?.(i))(l),at(l,"click",r(o),!0),ao(l,()=>o.external?n.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"}:{},!1,!0),g(l,()=>e.children),L(i=>{const s=e.class,a=o.url;return s!==i._v$3&&(l.className=i._v$3=s),a!==i._v$4&&W(l,"href",i._v$4=a),i},{_v$3:void 0,_v$4:void 0}),l})(),none:()=>(()=>{const o=Ei.cloneNode(!0);return(l=>e.btnref?.(l))(o),at(o,"click",r(void 0),!0),g(o,()=>e.children),L(l=>{const i=e.class,s=e.disabled;return i!==l._v$5&&(o.className=l._v$5=i),s!==l._v$6&&(o.disabled=l._v$6=s),l},{_v$5:void 0,_v$6:void 0}),o})()}})}function fe(e){return u(le,{get client_id(){return e.client_id},get class(){return J[e.style]+" outline-default"},get href(){return e.href},get onClick(){return e.onClick},get children(){return e.children}})}function No(e){const t=()=>{const[n,r]=$o(ko(e.color_hash.toLowerCase()));return{"--light-color":zt(n),"--dark-color":zt(r)}};return(()=>{const n=So.cloneNode(!0);return g(n,u(fe,{style:"userlink",get href(){return e.href},get client_id(){return e.client_id},get children(){return e.children}})),L(r=>Kt(n,t(),r)),n})()}se(["click"]);function Eo(e){if(typeof e.onClick!="string"&&"url"in e.onClick)return{href:e.onClick.url,client_id:e.client_id}}function Lo(e){if(typeof e.onClick!="string"&&typeof e.onClick=="function")return e.onClick}function Po(e){return e.onClick==="disabled"}const Pi={orange:"text-orange-600 dark:text-orange-400",indigo:"text-indigo-500 dark:text-indigo-400",blue:"text-blue-600 dark:text-blue-500",green:"text-green-600 dark:text-green-500",white:"text-gray-300 dark:text-black",yellow:"text-yellow-600 dark:text-yellow-300",pink:"text-pink-500 dark:text-pink-300"};function Qt(e){return e==null?"":Pi[e]}const Ti={blue:["bg-blue-700","bg-blue-500"],green:["bg-green-700","bg-green-500"]};function Ai(e,t){return e==null?"":Ti[e]?.[+t]??"bg-red-500"}const Oi=p("<i></i>");function pt(e){return(()=>{const t=Oi.cloneNode(!0);return L(n=>{const r=e.class,o=e.label??void 0,l=e.label==null;return r!==n._v$&&(t.className=n._v$=r),o!==n._v$2&&W(t,"aria-label",n._v$2=o),l!==n._v$3&&W(t,"aria-hidden",n._v$3=l),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()}function Me(e){return u(pt,{get class(){return e.class+" "+e.tag+" "+(e.filled?"fas":"far")},get label(){return e.label}})}const Pr={comments:[!0,"fa-comment"],creation_time:[!0,"fa-clock"],edit_time:[!0,"fa-edit","fa-pencil"],up_arrow:[!1,"fa-arrow-up"],down_arrow:[!1,"fa-arrow-down"],controversiality:[!0,"fa-smile"],pinned:[!1,"fa-thumbtack"],bookmark:[!0,"fa-bookmark"],envelope:[!0,"fa-envelope"],envelope_open:[!0,"fa-envelope-open"],star:[!0,"fa-star"],join:[!0,"fa-plus-square"],heart:[!0,"fa-heart"],code:[!1,"fa-code"],link:[!1,"fa-link"],eye:[!0,"fa-eye"],reply:[!1,"fa-reply"],chevron_up:[!1,"fa-chevron-up"],chevron_down:[!1,"fa-chevron-down"]};function Ct(e){return u(Me,{get tag(){return Pr[e.icon][1]},get filled(){return Pr[e.icon][0]?e.bold:!0},get label(){return e.label}})}const Ri=p('<button class="pl-2 pr-1"></button>'),Ii=p('<div tabindex="0"></div>'),Di=p('<div><div tabindex="0"></div><div tabindex="0"></div><div class="bg-gray-100 p-1 rounded-lg"></div><div tabindex="0"></div></div>'),[Mi,Vi]=P(Symbol());function ji(){Vi(Symbol())}function zi(e){const[t,n]=P({rect:new DOMRect(0,0,0,0),scroll:[0,0]}),[r,o]=P(!1),[l,i]=P(!1),s=c=>{o(d=>{const f=typeof c=="boolean"?c:c(d);return d!==f&&i(!0),f})};U(Qr(Mi,()=>{s(!1)},{defer:!0}));let a;return[(()=>{const c=Ri.cloneNode(!0);return c.$$click=d=>{const f=d.target.getBoundingClientRect();n({rect:f,scroll:[window.scrollX,window.scrollY],closing:!1}),s(h=>!h)},(d=>a=d)(c),g(c,u(pt,{class:"fa-solid fa-ellipsis",label:"More"})),c})(),u(E,{get if(){return r()||l()},get children(){return(()=>{let c,d;const[f,h]=P(!1);U(()=>{const v=y=>{let w=y.target;for(;w;){if(w===a||w===c)return;w=w.parentElement}s(!1)};document.addEventListener("click",v,{capture:!0,passive:!1}),G(()=>document.removeEventListener("click",v,{capture:!0}))});const m=document.createElement("div");return ue.appendChild(m),G(()=>{m.remove()}),[(()=>{const v=Ii.cloneNode(!0);return v.addEventListener("focus",()=>d.focus()),v})(),u(ei,{mount:m,get children(){const v=Di.cloneNode(!0),y=v.firstChild,w=y.nextSibling,C=w.nextSibling,k=C.nextSibling;(x=>{c=x,x.style.transformOrigin="top right";const b=()=>{const S=Fn()/2;x.style.transition=S+"s opacity, "+S+"s transform"},$=()=>{x.style.transform="scale(0.95)",x.style.opacity="0",b(),x.style.transitionTimingFunction="ease-in"},N=()=>{x.style.transform="",x.style.opacity="",b(),x.style.transitionTimingFunction="ease-out"};$(),U(()=>{const S=r();requestAnimationFrame(()=>{requestAnimationFrame(()=>{S?N():$()})})}),U(()=>{f()?x.style.outline="1px dotted var(--outline-color)":x.style.outline=""})})(v),v.addEventListener("transitionend",x=>{x.target===x.currentTarget&&i(!1)}),v.style.setProperty("--dbtn-max-width","24rem"),v.style.setProperty("--dbtn-padding","1rem"),v.style.setProperty("--dbtn-left","max(calc(var(--dbtn-target-pos) - var(--dbtn-max-width)),calc(0px + var(--dbtn-padding)))"),v.style.setProperty("left","var(--dbtn-left)"),v.style.setProperty("right","calc(100vw - min(calc(var(--dbtn-left) + var(--dbtn-max-width)),100vw - var(--dbtn-padding)))"),v.style.setProperty("z-index","1000000000"),y.addEventListener("focus",()=>{a.focus()}),w.$$focusout=()=>{h(!1)},w.$$focusin=()=>{h(!0)};const T=d;return typeof T=="function"?T(w):d=w,g(C,()=>e.children),k.addEventListener("focus",()=>{s(!1),a.focus()}),L(x=>{const b=B("absolute"),$=t().rect.bottom+t().scroll[1]+"px",N=t().rect.right+"px";return b!==x._v$&&(v.className=x._v$=b),$!==x._v$2&&v.style.setProperty("top",x._v$2=$),N!==x._v$3&&v.style.setProperty("--dbtn-target-pos",x._v$3=N),x},{_v$:void 0,_v$2:void 0,_v$3:void 0}),v}})]})()}})]}se(["click","focusin","focusout"]);const Bi=p("<div></div>"),Wi=p('<span class="ml-2"></span>');function Ui(e){return u(le,{onClick:t=>{ji(),e.onClick?.(t)},get href(){return e.url?.href},get client_id(){return e.url?.client_id??"ENOCLILENTID"},get class(){return B("w-full block p-2 text-left hover:bg-gray-200","focus-visible:bg-gray-200 rounded-lg",e.url!=null?"hover:underline":"")},get disabled(){return e.disabled},get children(){const t=Bi.cloneNode(!0);return g(t,u(E,{get when(){return e.icon},children:n=>[n,Wi.cloneNode(!0)]}),null),g(t,()=>e.children,null),L(()=>t.className="w-full "+e.class),t}})}function Hi(e){return u(Ui,{get icon(){return u(Ct,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}})},get class(){return B(e.action.color==null?"":"font-bold",Qt(e.action.color))},get url(){return Eo(e.action)},get onClick(){return Lo(e.action)},get disabled(){return Po(e.action)},get children(){return e.action.text}})}function Fi(e){return u(le,{get btnref(){return e.btnref},get class(){return B("py-1 px-2 rounded-md","text-gray-600","hover:text-black","bg-gray-200 border-b-1 border-gray-500","dark:border-t-1 dark:border-b-0 dark:bg-white dark:border-gray-400",e.url!=null?"hover:underline":"","outline-default")},get onClick(){return e.onClick},get href(){return e.url?.href},get client_id(){return e.url?.client_id??"ENOCLILENTID"},get disabled(){return e.disabled},get children(){return e.children}})}const qi=p("<span> </span>");function Gi(e){return u(Fi,{get url(){return Eo(e.action)},get onClick(){return Lo(e.action)},get disabled(){return Po(e.action)},get children(){const t=qi.cloneNode(!0),n=t.firstChild;return g(t,u(Ct,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}}),n),g(t,()=>e.action.text,null),L(()=>t.className=e.action.color==null?void 0:"font-bold "+Qt(e.action.color)),t}})}const Gn="@@!!ARRAY_KEY";//! flattens higherarchical page2 structure to a flat array
const bt={todo:(e,t)=>({kind:"todo",note:e,data:t}),err:(e,t)=>({kind:"error",note:e,data:t})};function Kn(e){return e.kind==="post"&&e.content.kind==="special"?{...e,content:e.content.fallback}:e}function Bt(e,t){if(e.kind==="post"){const n=e.collapsible;return n===!1?{default_collapsed:!1,user_controllable:!1}:n==="collapsed-unless-pivot"?{default_collapsed:!0,user_controllable:t.is_pivot}:{default_collapsed:n.default_collapsed,user_controllable:!0}}else return{default_collapsed:!1,user_controllable:!1}}function Ki(e,t){return e.kind==="post"?Bt(e.content,t):{default_collapsed:!1,user_controllable:!1}}function To(e,t,n,r){const o=We(n,e);if(o.error!=null)return bt.err(o.error,e);const l=Kn(o.value),{default_collapsed:i,user_controllable:s}=Ki(l,r),a=Ne(n.collapse_data,e,{default:i}).collapsed(),c=s?{id:e,threaded:!1,collapsed:a}:null;return{kind:"post",content:l,indent:r.threaded?t.map((d,f,h)=>f===h.length-1?{...d,threaded:!0}:d):t,collapse:c,first_in_wrapper:r.first_in_wrapper,is_pivot:r.is_pivot,at_or_above_pivot:r.at_or_above_pivot,threaded:r.threaded,depth:r.depth,id:e}}function Ao(e,t){const n=[];function r(o){for(const l of o){const i=We(t,l);if(i.error!=null)n.push(Symbol("error; "+i.error));else{const s=i.value;s.kind==="loaded"?r(s.replies?.items??[]):n.push(l)}}}return r(e?.items??[]),n}function Yn(e,t,n,r){const o=[],l=We(n,e);if(l.error!=null)return o.push(bt.err(l.error,e)),o;const i=Kn(l.value),s=To(e,t,n,r);if(o.push(s),s.kind!=="post")return o;const a=s.indent.map(f=>f.threaded?{...f,threaded:!1}:f),c=[...a,...s.collapse?[s.collapse]:[]];if(i.kind==="post"&&i.content.kind==="post"?i.content.show_replies_when_below_pivot:!0){const f=Ao(i.replies,n),h=n.settings?.allow_threading!==!1&&f.length===1&&(r.threaded?!0:We(n,f[0]).value?.replies?.items.length===1);if(h&&r.threaded||!(s.collapse?.collapsed??!1))for(const m of f)o.push(...Yn(m,r.threaded&&h?a:c,n,{...r,first_in_wrapper:!1,threaded:h,depth:r.depth+1}))}return o}function Ne(e,t,n){return D(()=>{const r=e.map.get(t);if(r==null){if(!n)throw new Error("accessing cstate before it has been created");const[o,l]=P(0),[i,s]=P(n.default),a={hovering:o,setHovering:l,collapsed:i,setCollapsed:s};return e.map.set(t,a),a}return r})}function We(e,t){const n=e.content;return uo(n,t)}function Yi(e,t){const n=We(e,t);if(n.error!=null)throw console.log("Failed to read link. Link:",t,"Result:",n,"Searching in",e.content),new Error("Could not read link; "+n.error);return n.value}function Ji(e,t){const n=[];function r(i){const s=We(t,i);if(s.error!=null)return n.push({error:s.error}),null;const a=s.value;if(a.kind==="loaded")for(const c of[...a.replies?.items??[]].reverse())r(c);else n.push({value:i});return a.parent}let o=e;for(;o;)o=r(o);const l=n[0];return l&&(l.pivot=!0),[...n].reverse()}function Tr(e,t){const n=[];e?.reply&&n.push(bt.todo("(add reply)",e));const r=Ao(e,t);for(const o of r)n.push({kind:"wrapper_start"}),n.push(...Yn(o,[],t,{first_in_wrapper:!0,is_pivot:!1,at_or_above_pivot:!1,threaded:!1,depth:0})),n.push({kind:"wrapper_end"});return e!=null&&r.length===0&&n.push(bt.todo("*There are no replies*",e)),n}function Xi(e,t){const n=[];let r=null,o=null;const l=Yi(t,e);let i=null;const s=Ji(e,t);for(const a of s){if(!("error"in a)){const c=We(t,a.value);if(c.value==null)continue;const d=Kn(c.value);if(d.kind==="post"&&d.content.kind==="page"){const f=d.content;if(r==null&&(r=Tr(f.wrap_page.sidebar,t)),o==null&&(a.pivot??!1)){o=f.wrap_page.header;continue}}d.kind==="post"&&d.content.kind==="post"&&i==null&&d.content.title!=null&&(i=d.content.title.text)}n.push({kind:"wrapper_start"}),"error"in a?n.push(bt.err(a.error,s)):n.push(To(a.value,[],t,{first_in_wrapper:!0,at_or_above_pivot:!0,is_pivot:a.pivot??!1,threaded:!1,depth:0})),n.push({kind:"wrapper_end"})}return l.replies&&(n.push({kind:"horizontal_line"}),n.push(...Tr(l.replies,t))),console.log("FLATTEN RESULT",n,t,Object.entries(t.content).length),{header:o??void 0,sidebar:r!=null?Sn(r):void 0,body:Sn(n),title:i??"*ERR_NO_TITLE*"}}function Sn(e){let t=0;const n=r=>{const o=(()=>r.kind==="post"?{v:r.id}:(t+=1,{v:t}))();return{...r,[Gn]:o.v}};return e.map(n)}const Qi=p('<button aria-label="Collapse"></button>'),Zi=p("<div></div>");function Jn(e){let t=!1;return G(()=>{if(!e.id||!e.cstates)return;const n=Ne(e.cstates,e.id);t&&n.setHovering(r=>r-1),t=!1}),(()=>{const n=Qi.cloneNode(!0);return n.addEventListener("mouseleave",()=>{if(!e.id||!e.cstates)return;const r=Ne(e.cstates,e.id);t&&r.setHovering(o=>o-1),t=!1}),n.$$mouseover=()=>{if(!e.id||!e.cstates)return;const r=Ne(e.cstates,e.id);t||r.setHovering(o=>o+1),t=!0},n.$$click=()=>e.onClick(),W(n,"draggable",!0),g(n,u(E,{get if(){return!e.collapsed_anim},get fallback(){return u(Me,{class:"mx-auto text-xs text-gray-600 dark:text-blue-400",tag:"fa-circle-plus",filled:!0,label:null})},get children(){return u(te,{children:(r,o)=>(()=>{const l=Zi.cloneNode(!0);return L(()=>l.className=B("w-3px mx-auto h-full",e.cstates&&e.id&&Ne(e.cstates,e.id).hovering()>0?"bg-slate-500 dark:bg-zinc-600":(o%2===1?"bg-slate-300":"bg-slate-400")+" dark:bg-zinc-700","group-hover:bg-slate-500 dark:group-hover:bg-zinc-600")),l})()})}})),L(r=>{const o=B("w-15px box-border cursor-pointer min-h-13px","z-1 static outline-default group",e.class??"",e.threaded??!1?"threaded-new":""),l=e.collapsed_raw,i=e.real?void 0:"-1",s=e.real?void 0:!0;return o!==r._v$&&(n.className=r._v$=o),l!==r._v$2&&W(n,"aria-pressed",r._v$2=l),i!==r._v$3&&W(n,"tabindex",r._v$3=i),s!==r._v$4&&W(n,"aria-hidden",r._v$4=s),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),n})()}se(["click","mouseover"]);p("<span> points</span>");const es=p("<button></button>"),ts=p('<div class="flex flex-col items-center gap-2px text-slate-700 dark:text-zinc-100"></div>');function Xn(e){const[t,n]=P(null);let r;return R(()=>{const o=qo(e().client_id+"_"+e().unique_id,{count:e().count_excl_you,you:e().you,time:e().time});G(()=>{o.cleanup()});const{state:l,onupdate:i}=o.associated_data;return r=o.associated_data,n({...l}),i(()=>n({...l})),0})(),[t,o=>{Object.assign(r.state,o),r.emit()}]}async function ns(e,t,n){if("error"in n.actions)throw await new Promise(o=>setTimeout(o,500)),new Error("counter is error: "+n.actions.error);const r=n.actions[e??"reset"];if(r==null)throw new Error("action "+e+" requested when it is not available.");await t.act(r)}async function Oo(e,t,n,r){n({...t,loading:!0,your_vote:e});try{const o=await ir(r.client_id);if(!o)throw new Error("missing client");await ns(e,o,r),n({...t,loading:!1,your_vote:e})}catch(o){n({...t}),console.log(o),alert("Error while voting: "+o)}}function Ar(e){const[t,n]=Xn(()=>e.counter),r=()=>t().your_vote===e.mode;return(()=>{const o=es.cloneNode(!0);return o.$$click=()=>{Oo(r()?void 0:e.mode,t(),n,e.counter)},o.style.setProperty("font-size","15px"),o.style.setProperty("width","15px"),o.style.setProperty("height","15px"),g(o,u(Ct,{get icon(){return r()?e.counter[e.mode].icon:e.counter.neutral_icon??e.counter[e.mode].icon},get label(){return e.counter[e.mode][r()?"undo_label":"label"]},get bold(){return r()}})),L(l=>{const i=Qt(r()?e.counter[e.mode].color:null),s=t().loading,a=r();return i!==l._v$&&(o.className=l._v$=i),s!==l._v$2&&(o.disabled=l._v$2=s),a!==l._v$3&&W(o,"aria-pressed",l._v$3=a),l},{_v$:void 0,_v$2:void 0,_v$3:void 0}),o})()}function rs(e){return(()=>{const t=ts.cloneNode(!0);return g(t,u(Ar,{get counter(){return e.counter},mode:"increment"}),null),g(t,u(E,{get if(){return e.counter.decrement!=null},get children(){return u(Ar,{get counter(){return e.counter},mode:"decrement"})}}),null),t})()}se(["click"]);const Or=p("<span></span>"),os=p('<img class="inline-block w-4 h-4 align-middle object-contain">');function Rr([e,t,n]){const r=[e,t,n].map(o=>{const l=o/255;return l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4)});return r[0]*.2126+r[1]*.7152+r[2]*.0722}function ls(e,t){const n=Rr(e),r=Rr(t),o=Math.max(n,r),l=Math.min(n,r);return(o+.05)/(l+.05)}function dn(e){const t=e.replace("#","");if(t.length!==6)return null;const n=parseInt(t,16);if(isNaN(n))return null;const r=n>>16&255,o=n>>8&255,l=n&255;return[r,o,l]}function Ir(e){return`#${e.map(t=>t.toString(16).padStart(2,"0")).join("")}`}function Dr(e,t,n){const r=dn(e??"")??dn(t);let o=[-1/0,[0,0,0]];for(const l of n){const i=dn(l),s=ls(r,i);s>o[0]&&(o=[s,i])}return{bg:Ir(r),text:Ir(o[1])}}function is(e){const t=["#FFFFFF","#000000"],n=Dr(e,"#94A3B8",t),r=Dr(e,"#52525B",t);return{"--flair-bg-dark":r.bg,"--flair-text-dark":r.text,"--flair-bg-light":n.bg,"--flair-text-light":n.text}}function gt(e){return(()=>{const t=Or.cloneNode(!0);return g(t,u(F,{get each(){return e.flairs},children:(n,r)=>{const o=R(()=>is(n.color));return[j(()=>r()!==0?" ":""),(()=>{const l=Or.cloneNode(!0);return g(l,u(F,{get each(){return n.elems},children:i=>u(ee,{item:i,children:{text:s=>j(()=>s.text),emoji:s=>(()=>{const a=os.cloneNode(!0);return L(c=>{const d=s.name,f=s.url,h=s.w,m=s.h;return d!==c._v$3&&W(a,"title",c._v$3=d),f!==c._v$4&&W(a,"src",c._v$4=f),h!==c._v$5&&W(a,"width",c._v$5=h),m!==c._v$6&&W(a,"height",c._v$6=m),c},{_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),a})()}})})),L(i=>{const s=n.system!=null?{none:"",op:"text-blue-500",cake:"text-gray-500",admin:"text-red-500",moderator:"text-green-500",approved:"text-green-500",error:"text-red-500"}[n.system]:"rounded-full px-2 bg-$flair-bg-light dark:bg-$flair-bg-dark text-$flair-text-light dark:text-$flair-text-dark",a=o();return s!==i._v$&&(l.className=i._v$=s),i._v$2=Kt(l,a,i._v$2),i},{_v$:void 0,_v$2:void 0}),l})()]}})),t})()}function ss(e){return[u(E,{get if(){return e.post.info?.pinned===!0},get children(){return u(Ie,{icon:"pinned",value:["none",-1e3],color:"green",text:"Pinned"})}}),u(E,{get when(){return e.post.actions?.vote},children:t=>{const[n]=Xn(()=>t),r=()=>n().pt_count;return[u(Ie,ye(()=>{const o=r(),l=n();return{value:o==="hidden"?["hidden",-1e3]:o==="none"?["none",-1e3]:["number",o+{increment:1,decrement:-1,none:0}[l.your_vote??"none"]],icon:{none:t.neutral_icon??t.increment.icon,increment:t.increment.icon,decrement:t.decrement?.icon??t.increment.icon}[l.your_vote??"none"],color:{none:null,increment:t.increment.color,decrement:t.decrement?.color??t.increment.color}[l.your_vote??"none"],text:"Points",disabled:l.loading}})),u(E,{get when(){return t.percent},children:o=>u(Ie,{icon:"controversiality",value:["percent",o],color:null,text:"Controversiality"})})]}}),u(E,{get when(){return e.post.info?.comments},children:t=>u(Ie,{icon:"comments",value:["number",t],color:null,text:"Comments"})}),u(E,{get when(){return e.post.info?.creation_date},children:t=>u(Ie,{icon:"creation_time",value:["timeago",t],color:null,text:"Posted"})}),u(E,{get when(){return e.post.info?.edited},children:t=>u(Ie,{icon:"edit_time",get value(){return t.date==null?["none",-1e3]:["timeago",t.date]},color:null,text:"Edited"})})]}const Ie=vo();function as(e){return Ie.useChildren(()=>u(ss,{get post(){return e()}}))}function Mr(e){return u(Ve,ye(()=>{const{action:t,state:n,setState:r,direction:o,client_id:l}=e,i=n.your_vote;return{icon:t[o].icon,color:i===o?t[o].color:null,text:i===o?t[o].undo_label:t[o].label,onClick:n.loading?"disabled":()=>{Oo(i===o?void 0:o,n,r,t)},client_id:l}}))}function un(e){return u(ee,{get item(){return e.action},fallback:t=>u(Ve,{icon:"code",color:null,get text(){return"TODO "+t.kind},onClick:"disabled",client_id:"*UNUSED*"}),children:{counter:t=>{const[n,r]=Xn(()=>t);return[u(Mr,ye(()=>({action:t,state:n(),setState:r,direction:"increment",client_id:e.opts.client_id}))),u(E,{get if(){return t.decrement!=null},get children(){return u(Mr,ye(()=>({action:t,state:n(),setState:r,direction:"decrement",client_id:e.opts.client_id})))}})]}}})}function cs(e){return[j((()=>{const t=j(()=>!!(e.opts.collapse_data&&e.opts.id&&Bt(e.post,{is_pivot:e.opts.is_pivot}).user_controllable),!0);return()=>t()?u(Ve,ye(()=>{const n=Ne(e.opts.collapse_data,e.opts.id),r=n.collapsed();return{icon:r?"chevron_down":"chevron_up",color:null,text:r?"Uncollapse":"Collapse",onClick:()=>n.setCollapsed(o=>!o),client_id:e.opts.client_id}})):null})()),j((()=>{const t=j(()=>e.opts.frame?.url!=null,!0);return()=>t()?u(Ve,{icon:"link",color:null,get text(){return j(()=>e.post.info?.comments!=null,!0)()?e.post.info.comments.toLocaleString()+" comment"+(e.post.info.comments===1?"":"s"):"Comments"},get onClick(){return{url:e.opts.frame.url}},get client_id(){return e.opts.client_id}}):null})()),u(E,{get when(){return e.post.actions?.vote},children:t=>u(un,{action:t,get opts(){return e.opts}})}),u(E,{get when(){return e.opts.frame?.replies?.reply},children:t=>u(Ve,{icon:"reply",color:null,text:"Reply",onClick:()=>alert("TODO"),get client_id(){return e.opts.client_id}})}),u(F,{get each(){return e.post.actions?.other??[]},children:t=>u(un,{action:t,get opts(){return e.opts}})}),u(E,{get when(){return e.post.actions?.code},get fallback(){return u(Ve,{icon:"code",color:null,text:"Code",onClick:()=>{console.log(e.post,e.opts)},get client_id(){return e.opts.client_id}})},children:t=>u(un,{action:t,get opts(){return e.opts}})})]}const Ve=vo();function ds(e,t){return Ve.useChildren(()=>u(cs,{get post(){return e()},get opts(){return t()}}))}function Ro(e){if(e.kind==="array"){const n=e.body.filter(r=>r&&r.kind!=="none")[0];return n!=null?Ro(n):null}return e.kind==="text"||e.kind==="richtext"?{kind:"icon",icon:"text"}:e.kind==="captioned_image"||e.kind==="none"?null:e.kind==="video"?{kind:"icon",icon:"video"}:e.kind==="gallery"?{kind:"gallery",count:e.images.length}:e.kind==="link"?{kind:"icon",icon:"link"}:{kind:"icon",icon:"other"}}const Vr=p("<div></div>"),it={Container(e){return(()=>{const t=Vr.cloneNode(!0);return g(t,()=>e.children),L(()=>t.className=B("flex flex-wrap",{top:"items-start",center:"items-center",bottom:"items-end",baseline:"items-baseline"}[e.vertical],e.dir==="right"?"justify-end":"",e.gap==="2"?"gap-2":"")),t})()},Child(e){return(()=>{const t=Vr.cloneNode(!0);return g(t,()=>e.children),L(()=>t.className=B({top:"self-start",center:"self-center",bottom:"self-end",none:""}[e.vertical??"none"],e.fullwidth??!1?"flex-1":"")),t})()}},us=p("<span></span>"),fs=p('<div class="text-gray-500 flex flex-wrap gap-2 <sm:text-xs"></div>');function hs(e){return e<1e4?""+e:e<1e5?(e/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"k":e<1e6?(e/1e3|0)+"k":e<1e8?(e/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"m":(e/1e6|0)+"m"}function gs({value:e}){if(e[0]==="none")return["",""];if(e[0]==="percent")return[" "+e[1].toLocaleString(void 0,{style:"percent"})," "+e[1].toLocaleString(void 0,{style:"percent"})];if(e[0]==="timeago")return[" "+ho(e[1],{short:!0})()," "+new Date(e[1]).toLocaleString()];if(e[0]==="number")return[" "+hs(e[1])," "+e[1].toLocaleString()];if(e[0]==="hidden")return[" \u2014"," Hidden"];lo(e[0])}function ms(e){const t=R(()=>gs(e.item)),n=()=>e.item.text+(e.item.value[0]==="none"?"":":");return(()=>{const r=us.cloneNode(!0);return g(r,u(Ct,{get icon(){return e.item.icon},get bold(){return e.item.color!=null},get label(){return n()}}),null),g(r,()=>t()[0],null),L(o=>{const l=B(Qt(e.item.color),e.item.disabled??!1?"opacity-50":""),i=n()+t()[1];return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&W(r,"title",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),r})()}function jr(e){const t=as(()=>e.post);return(()=>{const n=fs.cloneNode(!0);return g(n,u(F,{get each(){return t()},children:r=>u(ms,{item:r})})),n})()}const vs=p('<img alt="" class="w-8 h-8 object-center inline-block rounded-full">'),ps=p("<div><span></span></div>"),bs=p('<div class="flex flex-col items-center mr-1 gap-2 sm:pr-1"></div>'),_s=p('<div role="heading"></div>'),zr=p("<div></div>"),ys=p("<div><div><div><div></div></div></div></div>"),xs=p('<div class="pl-2"></div>'),ws=p('<div class="mt-2"></div>'),ks=p("<section></section>"),$s=p('<div class="text-sm"><div class="mt-2"></div><div class="flex flex-wrap gap-2"></div></div>'),Cs=p('<article><div class="flex-1"><div></div></div></article>'),Ss=p('<img alt="">'),Ns=p('<div><div class="whitespace-normal max-lines max-lines-1"></div></div>'),Es=p("<button>Show Anyway</button>");function Ls(e){return(()=>{const t=vs.cloneNode(!0);return L(()=>W(t,"src",e.src_url)),t})()}function Ps(e){const t=R(()=>Ro(e.body));return j((()=>{const n=j(()=>t()!=null,!0);return()=>n()?(()=>{const r=ps.cloneNode(!0),o=r.firstChild;return g(o,u(ee,{get item(){return t()},children:{icon:l=>u(Me,{get tag(){return{text:"fa-file-lines",video:"fa-circle-play",link:"fa-arrow-up-right-from-square",other:"fa-asterisk"}[l.icon]},get filled(){return l.icon==="other"||l.icon==="link"},get label(){return{text:"Text",video:"Video",link:"Link",other:""}[l.icon]}}),gallery:l=>j(()=>l.count)}})),L(()=>r.className=B("absolute bottom-1 right-1","text-xs sm:text-base w-6 h-6 sm:w-8 sm:h-8 p-1 bg-slate-300 dark:bg-zinc-700","rounded-md","flex items-center justify-center")),r})():null})())}function Wt(e){const[t,n]=e.opts.collapse_data&&e.opts.id?(()=>{const C=P(!0);if(e.opts.is_pivot)return P(!0);const k=Ne(e.opts.collapse_data,e.opts.id),T=x=>!k.setCollapsed(b=>!(typeof x=="boolean"?x:x(!b)));return[R(()=>e.opts.is_pivot?C[0]():!k.collapsed()),x=>e.opts.is_pivot?C[1](x):T(x)]})():P(e.opts.is_pivot?!0:!Bt(e.content,e.opts).default_collapsed),r=R(()=>Bt(e.content,e.opts),void 0,{equals:(C,k)=>JSON.stringify(C)===JSON.stringify(k)}),[o,l]=P(t()),[i,s]=P(!!(e.content.flair??[]).find(C=>C.content_warning)),a=()=>!!e.content.thumbnail||!!e.content.title,c=()=>!!e.content.thumbnail&&!o(),d=X(),[f,h]=P({visible:o(),animating:!1}),m=()=>!t()||e.opts.frame?.url!=null&&!e.opts.is_pivot,v=wo(),y=()=>{if(!!e.opts.id&&!!v&&!(e.opts.frame?.disallow_pivot??!1))return{pivot:e.opts.id,content:v.content()}},w=ds(()=>e.content,()=>e.opts);return(()=>{const C=Cs.cloneNode(!0),k=C.firstChild,T=k.firstChild;return(x=>qn(x,d,t,(b,$,N)=>{h({visible:$||b,animating:N}),l(b||$)}))(C),g(C,u(E,{get if(){return j(()=>!!(r().user_controllable&&(e.content.thumbnail!=null?!!o():!0)),!0)()&&!jt.sm()},get children(){const x=bs.cloneNode(!0);return g(x,u(E,{get when(){return e.content.actions?.vote},children:b=>(()=>{const $=zr.cloneNode(!0);return g($,u(rs,{counter:b})),L(()=>$.className=o()||c()?"":" hidden"),$})()}),null),g(x,u(Jn,{class:"flex-1",get collapsed_raw(){return!t()},get collapsed_anim(){return!o()},onClick:()=>{n(b=>!b)},real:!0,get cstates(){return e.opts.collapse_data},get id(){return e.opts.id}}),null),x}}),k),g(k,u(it.Container,{dir:"right",vertical:"center",get children(){return[u(E,{get if(){return!o()},get when(){return e.content.thumbnail},children:x=>u(te,{children:b=>u(it.Child,{get children(){return u(le,{get href(){return e.opts.frame?.url??"ENOHREF"},get client_id(){return e.opts.frame?.client_id??"ENOCLIENTID"},get class(){return B("w-12 h-12 sm:w-16 sm:h-16 mr-4 rounded-md "+b,i()&&x.kind==="image"?"thumbnail-content-warning":"","block","relative")},get onClick(){return r().user_controllable?()=>{n($=>!$)}:void 0},page:y,get children(){return[u(ee,{item:x,children:{image:$=>(()=>{const N=Ss.cloneNode(!0);return L(S=>{const O=$.url,M=B("w-full h-full object-cover rounded-md");return O!==S._v$6&&W(N,"src",S._v$6=O),M!==S._v$7&&(N.className=S._v$7=M),S},{_v$6:void 0,_v$7:void 0}),N})(),default:$=>["TODO ",j(()=>$.kind)]}}),u(Ps,{get body(){return e.content.body}})]}})}})})}),u(it.Child,{fullwidth:!0,get children(){const x=ys.cloneNode(!0),b=x.firstChild,$=b.firstChild,N=$.firstChild;return x.$$click=S=>{if(!m()||!fo(S.target,S.currentTarget))return;S.stopPropagation();const O="/"+e.opts.client_id+e.opts.frame?.url;if(S.ctrlKey||S.metaKey||S.altKey){if(e.opts.frame?.url==null)return;window.open(O)}else{if(r().user_controllable&&!t()){n(()=>!0);return}if(e.opts.frame?.url==null)return;rt({path:O,page:y()})}},g($,u(E,{get if(){return e.content.title!=null||e.content.flair!=null},get children(){const S=_s.cloneNode(!0);return g(S,u(E,{get when(){return e.content.title},children:O=>u(E,{get if(){return!e.opts.is_pivot},get when(){return e.opts.frame?.url},get fallback(){return O.text},children:M=>u(le,{get client_id(){return e.opts.client_id},href:M,class:"hover:underline",page:y,get children(){return O.text}})})}),null),g(S,u(gt,{get flairs(){return e.content.flair??[]}}),null),L(()=>S.className=B("text-black",e.opts.is_pivot&&o()?"text-3xl sm:text-2xl":"text-base")),S}}),N),g(N,u(E,{get when(){return e.content.author},children:S=>[u(E,{get if(){return j(()=>!!o(),!0)()&&d.authorPfp()==="on"},get when(){return S.pfp},fallback:"By ",children:O=>[u(Ls,{get src_url(){return O.url}})," "]}),u(No,{get client_id(){return S.client_id},get href(){return S.link},get color_hash(){return S.color_hash},get children(){return S.name}})," "]}),null),g(N,u(E,{get if(){return o()||a()},get children(){return[u(E,{get when(){return e.content.author},children:S=>u(E,{get when(){return S.flair},children:O=>[u(gt,{flairs:O})," "]})}),u(E,{get when(){return e.content.info?.in},children:S=>[" in ",u(fe,{get href(){return S.link},style:"previewable",get client_id(){return S.client_id},get children(){return S.name}})," "]})]}}),null),g($,u(E,{get if(){return!e.opts.is_pivot||!o()},get children(){const S=zr.cloneNode(!0);return g(S,u(jr,{get post(){return e.content}})),S}}),null),g($,u(it.Child,{fullwidth:!0,get children(){return u(E,{get if(){return!(o()||c())},get children(){return u(E,{get if(){return!r().default_collapsed},get children(){return(()=>{const S=Ns.cloneNode(!0),O=S.firstChild;return g(O,()=>"\u201C"+(()=>{const M=Ht(e.content.body);return M.length>500?M.substring(0,500)+"\u2026":M})()+"\u201D"),S})()}})}})}}),null),L(S=>{const O=m()?" hover-outline":"",M=B("text-gray-500","text-sm",o()||c()?"":"filter grayscale text-$collapsed-header-color italic"),ne=B(["flex",e.content.thumbnail?"flex-col":["flex-row flex-wrap gap-2 items-baseline"]]);return O!==S._v$&&(x.className=S._v$=O),M!==S._v$2&&(b.className=S._v$2=M),ne!==S._v$3&&($.className=S._v$3=ne),S},{_v$:void 0,_v$2:void 0,_v$3:void 0}),x}}),u(E,{get if(){return o()||c()},get children(){return u(it.Child,{get children(){return[xs.cloneNode(!0),u(zi,{get children(){return u(F,{get each(){return w()},children:x=>u(Hi,{action:x})})}})]}})}})]}}),T),g(T,u(yo,{visible:()=>f().visible||f().animating,get children(){return[(()=>{const x=ks.cloneNode(!0);return g(x,u(E,{get if(){return f().visible||f().animating},get children(){return[u(E,{get if(){return j(()=>!!o(),!0)()&&c()},get children(){return ws.cloneNode(!0)}}),u(Co,{get when(){return!i()},get fallback(){return["Content Warning:"," ",u(gt,{get flairs(){return(e.content.flair??[]).filter(b=>b.content_warning)}})," ",(()=>{const b=Es.cloneNode(!0);return b.$$click=()=>s(!1),L(()=>b.className=J["pill-filled"]),b})()]},get children(){return u(oe,{get body(){return e.content.body},autoplay:!1})}})]}})),L(()=>x.className=e.opts.is_pivot?"py-4":""),x})(),u(E,{get if(){return e.opts.is_pivot},get children(){const x=$s.cloneNode(!0),b=x.firstChild,$=b.nextSibling;return g(x,u(jr,{get post(){return e.content}}),b),g($,u(F,{get each(){return w()},children:N=>u(Gi,{action:N})})),x}})]}})),L(x=>{const b=B(e.opts.is_pivot?["text-base m-2"]:"text-sm","flex flex-row"),$=o()?"block":"none";return b!==x._v$4&&(C.className=x._v$4=b),$!==x._v$5&&T.style.setProperty("display",x._v$5=$),x},{_v$4:void 0,_v$5:void 0}),C})()}se(["click"]);const Ts=p("<button>code</button>"),Io=p("<div></div>");function Do(e){return u(ee,{get item(){return e.content},children:{post:t=>u(Wt,{content:t,get opts(){return e.opts}}),page:()=>"TODO page",legacy:t=>u(ve,{getValue:n=>{const r=el("div").clss("-mt-10px -ml-10px"),o=el("div").clss("post text-sm").adto(r),l=ge(t.client_id);return or(l,t.thread,o,{clickable:!0}).defer(n),r}}),client:()=>"TODO client",special:t=>u(Wt,{get content(){return t.fallback},get opts(){return e.opts}})}})}function Qn(e){const t=n=>["TODO support. also in the parent list these should probably"," ","be one of those navbars with bits like ClientName ",">"," PageName ",">"," \u2026"," ",(()=>{const r=Ts.cloneNode(!0);return r.$$click=()=>console.log(n),r})()];return(()=>{const n=Io.cloneNode(!0);return g(n,u(Xt,{get data(){return[e.listing,e.opts]},get children(){return u(ee,{get item(){return e.listing},children:{page:r=>t(r),client:r=>t(r),post:r=>u(Wt,{content:r,get opts(){return e.opts}}),special:r=>u(Wt,{get content(){return r.fallback},get opts(){return e.opts}}),legacy:r=>u(ve,{getValue:o=>{const l=ge(r.client_id);return De(l,r.thread,{clickable:e.opts.clickable}).defer(o)}})}})}})),n})()}function Zn(e){return u(te,{children:(t,n)=>(()=>{const r=Io.cloneNode(!0);return g(r,()=>e.children),L(()=>r.className=(n===0?"m-3 p-3 shadow-md sm:rounded-xl <sm:mx-0":"p-10px mt-10px rounded-xl")+" "+t+" "+(e.restrict_w??!1?"max-w-xl":"")),r})()})}se(["click"]);const As=p("<span></span>"),Os=p('<span class="whitespace-pre-wrap"></span>'),Rs=p("<br>"),Is=p('<button class="absolute top-0 left-0 bottom-0 right-0 w-full h-full rounded bg-spoiler-color hover:bg-spoiler-color-hover cursor-pointer" title="Click to reveal spoiler"></button>'),Ds=p('<span class="relative bg-spoiler-color-hover rounded"><span></span></span>'),Ms=p('<img class="w-4 h-4 object-contain inline-block">'),Vs=p('<code class="bg-slate-200 dark:bg-zinc-700 p-1 rounded"></code>'),js=p("<p></p>"),zs=p('<h1 class="text-3xl font-black"></h1>'),Bs=p('<h2 class="text-2xl font-bold"></h2>'),Ws=p('<h3 class="text-xl font-semibold"></h3>'),Us=p('<h4 class="text-lg font-medium"></h4>'),Hs=p('<h5 class="text-base text-slate-500 dark:text-zinc-400 font-normal"></h5>'),Fs=p('<h6 class="text-sm text-slate-500 dark:text-zinc-400 font-normal underline"></h6>'),qs=p('<div class="py-2"><hr class="w-full border-t-2 border-slate-500 dark:border-zinc-400 rounded"></div>'),Gs=p('<blockquote class="border-l-2 border-slate-500 dark:border-zinc-400 pl-3"></blockquote>'),Ks=p('<li class="flex flex-row gap-2 items-baseline"><div></div><div class="flex-1"></div></li>'),je=p("<div></div>"),Ys=p('<ol class="list-none"></ol>'),Js=p('<ul class="list-none"></ul>'),Xs=p("<table><thead><tr></tr></thead><tbody></tbody></table>"),Qs=p("<th></th>"),Zs=p("<tr></tr>"),ea=p("<td></td>"),ta=p('<select class="block"><option value="null">None</option></select>'),na=p('<pre tabindex="0"></pre>'),ra=p("<button> </button>"),oa=p("<option></option>"),la=p('<code class="!whitespace-pre-wrap"></code>'),ia=p('<div class="my-2"></div>'),sa=p('<div class="max-lines max-lines-1 select-none"></div>'),aa=p('<div><div class="max-lines max-lines-1 break-all font-light text-slate-800 dark:text-zinc-500 select-none"></div></div>'),ca=p('<div class="max-1-line break-all font-light text-slate-800 dark:text-zinc-500 select-none"></div>'),da=p('<div class="inline-block"></div>'),ua={link:"normal","pill-empty":"pill-empty"};function fa(e){const t=()=>(e.rts.style??"link")==="link",n=X();return(()=>{const r=As.cloneNode(!0);return g(r,u(Cl,{get children(){return[u(on,{get when(){return e.rts.is_user_link!=null&&e.rts.is_user_link},children:o=>u(No,{get client_id(){return e.rts.client_id},color_hash:o,get href(){return e.rts.url},get children(){return u(Ce,{get spans(){return e.rts.children}})}})}),u(on,{get when(){return j(()=>e.rts.is_user_link==null,!0)()&&t()},get children(){return u(Li,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get allow_preview(){return n.linkHelpers()==="hide"},get children(){return u(Ce,{get spans(){return e.rts.children}})}})}}),u(on,{get when(){return j(()=>e.rts.is_user_link==null,!0)()&&!t()},get children(){return u(fe,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get style(){return ua[e.rts.style??"link"]},get children(){return u(Ce,{get spans(){return e.rts.children}})}})}})]}})),L(()=>W(r,"title",e.rts.title)),r})()}function ha(e){return u(ee,{get item(){return e.span},children:{text:t=>(()=>{const n=Os.cloneNode(!0);return g(n,()=>t.text),L(r=>{const o=t.styles.strong,l=t.styles.emphasis,i=t.styles.strikethrough,s=t.styles.superscript,a=t.styles.superscript;return o!==r._v$&&n.classList.toggle("font-bold",r._v$=o),l!==r._v$2&&n.classList.toggle("italic",r._v$2=l),i!==r._v$3&&n.classList.toggle("line-through",r._v$3=i),s!==r._v$4&&n.classList.toggle("align-top",r._v$4=s),a!==r._v$5&&n.classList.toggle("text-xs",r._v$5=a),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),n})(),link:t=>u(fa,{rts:t}),br:()=>Rs.cloneNode(!0),spoiler:t=>{const[n,r]=P(!1);return(()=>{const o=Ds.cloneNode(!0),l=o.firstChild;return g(o,u(E,{get if(){return!n()},get children(){const i=Is.cloneNode(!0);return i.$$click=()=>r(!0),i}}),l),g(l,u(Ce,{get spans(){return t.children}})),L(()=>l.className=B("rounded","transition-opacity","bg-spoiler-color-revealed",n()?"":"opacity-0 invisible")),o})()},emoji:t=>(()=>{const n=Ms.cloneNode(!0);return L(r=>{const o=t.url,l=t.name;return o!==r._v$6&&W(n,"src",r._v$6=o),l!==r._v$7&&W(n,"title",r._v$7=l),r},{_v$6:void 0,_v$7:void 0}),n})(),flair:t=>u(gt,{get flairs(){return[t.flair]}}),time_ago:t=>u(go,{get start(){return t.start}}),error:t=>u(ve,{getValue:n=>I("error").atxt(t.text).onev("click",r=>{console.log(t.value)})}),code:t=>(()=>{const n=Vs.cloneNode(!0);return g(n,()=>t.text),n})()}})}function Ce(e){return u(F,{get each(){return e.spans},children:t=>u(ha,{span:t})})}function ga(e){return u(ee,{get item(){return e.paragraph},children:{paragraph:t=>(()=>{const n=js.cloneNode(!0);return g(n,u(Ce,{get spans(){return t.children}})),n})(),body:t=>u(oe,{get body(){return t.body},autoplay:!1}),heading:t=>{const n=()=>u(Ce,{get spans(){return t.children}});return t.level===1?(()=>{const r=zs.cloneNode(!0);return g(r,n),r})():t.level===2?(()=>{const r=Bs.cloneNode(!0);return g(r,n),r})():t.level===3?(()=>{const r=Ws.cloneNode(!0);return g(r,n),r})():t.level===4?(()=>{const r=Us.cloneNode(!0);return g(r,n),r})():t.level===5?(()=>{const r=Hs.cloneNode(!0);return g(r,n),r})():(()=>{const r=Fs.cloneNode(!0);return g(r,n),r})()},horizontal_line:()=>qs.cloneNode(!0),blockquote:t=>(()=>{const n=Gs.cloneNode(!0);return g(n,u(Ut,{get content(){return t.children}})),n})(),list:t=>{const n=R(()=>t.children.every(o=>o.kind==="tight_list_item"||o.children.length===1)),r=()=>u(F,{get each(){return t.children},children:(o,l)=>(()=>{const i=Ks.cloneNode(!0),s=i.firstChild,a=s.nextSibling;return g(s,(()=>{const c=j(()=>!!t.ordered,!0);return()=>c()?`${l()+1}. `:"- "})()),g(a,u(ee,{item:o,children:{list_item:c=>u(Ut,{get content(){return c.children},get tight(){return n()}}),tight_list_item:c=>(()=>{const d=je.cloneNode(!0);return g(d,u(Ce,{get spans(){return c.children}})),L(()=>d.classList.toggle("my-2",!n())),d})()}})),i})()});return t.ordered?(()=>{const o=Ys.cloneNode(!0);return g(o,r),o})():(()=>{const o=Js.cloneNode(!0);return g(o,r),o})()},code_block:t=>u(pa,{get text(){return t.text},get default_language(){return t.lang??null}}),table:t=>(()=>{const n=Xs.cloneNode(!0),r=n.firstChild,o=r.firstChild,l=r.nextSibling;return g(o,u(F,{get each(){return t.headings},children:i=>(()=>{const s=Qs.cloneNode(!0);return g(s,u(Ce,{get spans(){return i.children}})),L(()=>s.className=Br[i.align??"none"]),s})()})),g(l,u(F,{get each(){return t.children},children:i=>(()=>{const s=Zs.cloneNode(!0);return g(s,u(F,{each:i,children:(a,c)=>(()=>{const d=ea.cloneNode(!0);return g(d,u(Ce,{get spans(){return a.children}})),L(()=>d.className=Br[t.headings[c()]?.align??"none"]),d})()})),s})()})),n})()}})}const Br={left:"text-left",center:"text-center",right:"text-right",none:""},[dt,ma]=P(void 0);let fn=!1;function va(){(!dt()||fn)&&(fn=!0,Promise.all([Y(()=>import("./prismjs.80480c86.js").then(function(e){return e.p}),["assets/prismjs.80480c86.js","assets/_commonjsHelpers.2cf1d77b.js"]),D(()=>X().colorScheme())==="dark"?Y(()=>Promise.resolve({}),["assets/prism-atom-dark.f4615035.css"]):Y(()=>Promise.resolve({}),["assets/prism-duotone-light.c9c5c0db.css"])]).then(([e])=>ma(e)).catch(e=>{alert("error loading syntax highlighter"),fn=!1,console.log(e)}))}function pa(e){const[t,n]=P(e.default_language);U(()=>n(e.default_language));const[r,o]=P(null),l=()=>e.text.length<1e4,[i,s]=P(!1);return U(()=>{(t()!=null||i())&&va()}),U(()=>{if(!l())return;let a=!0;G(()=>a=!1),o(null),dt()&&t()!=null&&dt().highlight(e.text,t()??"plaintext").then(c=>{a&&(o(c),c==null&&console.log("syn hl language not supported",t()))}).catch(c=>{console.log(c),alert("error highlighting")})}),(()=>{const a=na.cloneNode(!0);return g(a,u(E,{get if(){return l()},get children(){const c=je.cloneNode(!0);return g(c,u(E,{get if(){return j(()=>!!dt(),!0)()&&i()},get fallback(){return(()=>{const d=ra.cloneNode(!0),f=d.firstChild;return d.$$click=()=>{s(h=>!h)},g(d,()=>t()??"None",f),g(d,()=>i()?"\u25B4":"\u25BE",null),L(()=>d.className=B(["font-sans"])),d})()},get children(){const d=ta.cloneNode(!0);return d.firstChild,d.$$input=f=>{const h=f.currentTarget.value;n(h==="null"?null:h)},g(d,u(F,{get each(){return dt().listLanguages().sort((f,h)=>f.localeCompare(h))},children:f=>(()=>{const h=oa.cloneNode(!0);return h.value=f,g(h,f),h})()}),null),d}})),L(()=>c.className=B(["absolute","top-0 right-0","transition-opacity","opacity-0","group-hover:opacity-100","group-focus:opacity-100","focus:opacity-100","bg-slate-400 dark:bg-zinc-600 text-slate-100 dark:text-zinc-100 rounded-md","p-2 px-3"])),c}}),null),g(a,u(E,{get when(){return r()},get fallback(){return(()=>{const c=la.cloneNode(!0);return g(c,()=>e.text),c})()},children:c=>(()=>{const d=je.cloneNode(!0);return d.innerHTML=c,d})()}),null),L(()=>a.className=B(["!bg-slate-200 !dark:bg-zinc-700 p-2 !rounded-md text-slate-900 dark:text-zinc-100","relative","group","outline-default","language-"+(t()??"none"),"!whitespace-pre-wrap"])),a})()}function ba(e){const t=X(),n=R(()=>{const i=Jt(e.link.url,{});if(!i)return;const[s,a]=P(!1);return{visible:s,toggleVisible:()=>a(c=>!c),body:i}}),r=R(()=>{const i=en(e.link.client_id,e.link.url);return i.kind==="link"?{link:i.url,external:i.external}:{link:"error",external:!0}}),[o,l]=P({open:!1,temporary:!1});return u(E,{get if(){return r().link!=="error"},get children(){const i=ia.cloneNode(!0);return g(i,u(te,{children:s=>u(le,{get client_id(){return e.link.client_id},get class(){return B("p-2 px-4","block",s,"rounded-xl","hover:dark:bg-zinc-700 dark:hover:shadow transition",o().open?"rounded-b-none":"")},get href(){return e.link.url},get onClick(){return n()?()=>{n().toggleVisible()}:void 0},get children(){return[(()=>{const a=sa.cloneNode(!0);return g(a,u(E,{get when(){return n()},children:c=>j(()=>c.visible()?"\u25BE ":"\u25B8 ")}),null),g(a,()=>e.link.title,null),a})(),u(E,{get if(){return!o().open||o().temporary},get children(){const a=aa.cloneNode(!0),c=a.firstChild;return g(c,u(E,{get if(){return j(()=>!n(),!0)()&&r().external},get children(){return[u(Wr,{})," "]}}),null),g(c,()=>r().link,null),L(()=>a.style.setProperty("display",o().open?"none":"block")),a}})]}})}),null),g(i,u(E,{get when(){return n()},children:s=>[(()=>{const a=je.cloneNode(!0);return(c=>qn(c,t,s.visible,(d,f,h)=>{l({open:d||f,temporary:h})}))(a),g(a,u(E,{get if(){return o().open||o().temporary},get children(){const c=je.cloneNode(!0);return g(c,u(oe,{get body(){return s.body},autoplay:!0})),L(()=>c.style.setProperty("display",o().open?"block":"none")),c}})),a})(),u(E,{get if(){return o().open||o().temporary},get children(){const a=je.cloneNode(!0);return g(a,u(te,{children:c=>u(le,{get client_id(){return e.link.client_id},get class(){return B("p-2 px-4","block",c,"rounded-xl rounded-t-none","hover:dark:bg-zinc-700 dark:hover:shadow transition")},get href(){return e.link.url},get children(){const d=ca.cloneNode(!0);return g(d,u(E,{get if(){return r().external},get children(){return[u(Wr,{})," "]}}),null),g(d,()=>r().link,null),d}})})),L(()=>a.style.setProperty("display",o().open?"block":"none")),a}})]}),null),i}})}function Ut(e){const t=X();return u(F,{get each(){return e.content},children:n=>[(()=>{const r=je.cloneNode(!0);return g(r,u(ga,{paragraph:n})),L(()=>r.classList.toggle("my-2",!(e.tight??!1))),r})(),u(E,{get if(){return t.linkHelpers()==="show"},get children(){return u(F,{get each(){return ya(n)},children:r=>u(ba,{link:r})})}})]})}function _a(e){return u(Ut,{get content(){return e.content}})}function Wr(){return(()=>{const e=da.cloneNode(!0);return g(e,u($i,{size:"icon-sm",icon:{class:"icon-external",label:"External"}})),e})()}function ya(e){return xt(e,{paragraph:t=>Ke(t.children),body:()=>[],heading:t=>Ke(t.children),horizontal_line:()=>[],blockquote:()=>[],list:t=>t.children.flatMap(n=>n.kind==="tight_list_item"?Ke(n.children):[]),code_block:()=>[],table:t=>[...t.headings.flatMap(n=>Ke(n.children)),...t.children.flatMap(n=>n.flatMap(r=>Ke(r.children)))]})}function Ke(e){return e.flatMap(t=>xt(t,{link:n=>[{title:mt(n.children),url:n.url,client_id:n.client_id}],error:()=>[],text:()=>[],br:()=>[],spoiler:n=>Ke(n.children),emoji:()=>[],flair:()=>[],time_ago:()=>[],code:()=>[]}))}function Nn(e){return e.map(t=>xt(t,{paragraph:n=>mt(n.children),body:n=>Ht(n.body),heading:n=>mt(n.children),horizontal_line:n=>"---",blockquote:n=>Nn(n.children),list:n=>n.children.map((r,o)=>{const l=n.ordered?""+o+". ":"\u2022 ";if(r.kind==="tight_list_item")return l+mt(r.children);if(r.kind==="list_item")return l+Nn(r.children);lo(r)}).join(`
`),code_block:n=>n.text,table:()=>"[table]"})).join(`
`)}function mt(e){return e.map(t=>xt(t,{link:n=>mt(n.children),error:n=>"[error]",text:n=>n.text,br:()=>`
`,spoiler:n=>"[spoiler]",emoji:n=>":"+n.name+":",flair:()=>"[flair]",time_ago:()=>"[time ago]",code:n=>n.text})).join("")}se(["click","input"]);const Ye=p("<div></div>"),xa=p("<div><div></div></div>"),wa=p('<div><div class="border p-2"><div class="font-bold"></div><div></div></div></div>'),ka=p("<button></button>"),$a=p("<div>Loading...</div>"),Ca=p("<div><div>TODO polls are currently not supported</div><ul></ul></div>"),Sa=p("<li> (<!>)</li>"),Na=p("<div>Caption: </div>"),Ea=p("<audio></audio>"),La=p('<div><h1 class="text-base font-light"><svg aria-label="Mastodon" class="preview-image" viewBox="0 0 713.35878 175.8678" style="fill: currentColor;"><use href="/images/mastodon/Logotype (Full).svg#base" width="713.35878" height="175.8678"></use></svg></h1><h2 class="text-2xl font-black py-1">Select your instance</h2><div class="py-1"><label>Instance Name: <input class="border rounded-md p-1" placeholder="mastodon.social"></label><button>Go \u2192</button></div><p class="py-2">Not on mastodon? Join at </p><p class="py-2">Note that some instances may require logging in before they let you view timelines.</p></div>'),Pa=p('<div><button>Retry</button><span class="text-red-500"></span></div>'),Ta=p("<button><img></button>"),Aa=p("<button>Prev</button>"),Oa=p("<button>Next</button>"),Ra=p("<button>Gallery</button>"),Ia=kl(()=>Y(()=>import("./preview_video.ca301454.js"),[]));function oe(e){return u(Xt,{get data(){return e.body},get children(){return u(Da,{get body(){return e.body},get autoplay(){return e.autoplay}})}})}function Da(e){return u(ee,{get item(){return e.body},children:{text:t=>{const[n]=bn(()=>JSON.parse(JSON.stringify(t)),o=>ed(o)),r=R(o=>n()??o,void 0);return(()=>{const o=Ye.cloneNode(!0);return g(o,u(E,{get when(){return r()},get fallback(){return"Loading\u2026"},children:l=>u(oe,{body:l,autoplay:!1})})),L(()=>o.className=n.loading?"animate-loading":""),o})()},link:t=>{const n=R(()=>{const r=Jt(t.url,{suggested_embed:t.embed_html});if(!!r)return{body:r}});return(()=>{const r=xa.cloneNode(!0),o=r.firstChild;return g(o,u(fe,{get client_id(){return t.client_id},get href(){return t.url},style:"normal",get children(){return t.url}})),g(r,u(E,{get when(){return n()},children:l=>u(oe,{get body(){return l.body},get autoplay(){return e.autoplay}})}),null),r})()},none:()=>[],gallery:t=>u(ja,{get images(){return t.images}}),removed:t=>{const[n,r]=P({kind:"none"});return(()=>{const o=wa.cloneNode(!0),l=o.firstChild,i=l.firstChild,s=i.nextSibling;return g(i,()=>t.removal_message.title),g(s,()=>t.removal_message.body),g(l,u(E,{get when(){return(n().kind!=="loaded"?!0:void 0)&&t.fetch_path},children:a=>{const c=async()=>{const d=await ir(t.client_id);let f,h=!1;if(r({kind:"loading"}),!d)throw new Error("invalid client");if(!d.fetchRemoved)throw new Error("client provided a removal fetch path but has no fetchRemoved");try{f=await d.fetchRemoved(a)}catch(m){const v=m;h=!0,console.log(v),f={kind:"text",client_id:"n/a",content:"Error! "+v.toString(),markdown_format:"none"}}console.log("Got new body:",f),r({kind:h?"error":"loaded",body:f})};return(()=>{const d=ka.cloneNode(!0);return d.$$click=()=>{c().catch(console.log)},g(d,()=>({none:"View",loading:"...",error:"Retry",loaded:"never"})[n().kind]),L(f=>{const h=J["outlined-button"],m=n().kind==="loading"||n().kind==="loaded";return h!==f._v$&&(d.className=f._v$=h),m!==f._v$2&&(d.disabled=f._v$2=m),f},{_v$:void 0,_v$2:void 0}),d})()}}),null),g(o,u(oe,{get body(){return t.body},get autoplay(){return e.autoplay}}),null),g(o,u(ee,{get item(){return n()},children:{none:()=>[],loading:()=>$a.cloneNode(!0),error:a=>(()=>{const c=Ye.cloneNode(!0);return g(c,u(oe,{get body(){return a.body},autoplay:!1})),c})(),loaded:a=>(()=>{const c=Ye.cloneNode(!0);return g(c,u(oe,{get body(){return a.body},autoplay:!1})),c})()}}),null),o})()},crosspost:t=>u(Zn,{restrict_w:!0,get children(){return u(Qn,{get listing(){return{kind:"legacy",thread:t.source,client_id:t.client_id}},get opts(){return{clickable:!0,client_id:t.client_id,frame:null,replies:null,at_or_above_pivot:!1,is_pivot:!1}}})}}),richtext:t=>(()=>{const n=Ye.cloneNode(!0);return g(n,u(_a,{get content(){return t.content}})),n})(),poll:t=>(()=>{const n=Ca.cloneNode(!0),r=n.firstChild,o=r.nextSibling;return g(o,u(F,{get each(){return t.choices},children:l=>(()=>{const i=Sa.cloneNode(!0),s=i.firstChild,a=s.nextSibling;return a.nextSibling,g(i,()=>l.name,s),g(i,()=>l.votes==="hidden"?"hidden":"Vote(s)",a),i})()})),n})(),captioned_image:t=>(()=>{const n=Ye.cloneNode(!0);return g(n,u(ve,{getValue:()=>{const r=el("div");return ad(t.url,{w:t.w??void 0,h:t.h??void 0,alt:t.alt}).adto(r),r}}),null),g(n,u(E,{get when(){return t.caption},children:r=>(()=>{const o=Na.cloneNode(!0);return o.firstChild,g(o,r,null),o})()}),null),n})(),video:t=>u(Ia,{video:t,get autoplay(){return e.autoplay}}),audio:t=>(()=>{const n=Ea.cloneNode(!0);return(r=>{const o=Hn();U(()=>{o()||r.pause()})})(n),n.controls=!0,g(n,()=>t.alt??"Audio is not supported and alt text was not provided"),L(r=>{const o=t.url,l=e.autoplay;return o!==r._v$3&&W(n,"src",r._v$3=o),l!==r._v$4&&(n.autoplay=r._v$4=l),r},{_v$3:void 0,_v$4:void 0}),n})(),array:t=>u(F,{get each(){return t.body},children:n=>n?u(oe,{body:n,autoplay:!1}):null}),gfycatv1:t=>u(ve,{getValue:n=>{const r=el("div");return Xc(t.host,t.id,{autoplay:e.autoplay}).defer(n).adto(r),r}}),gfycatv2:t=>u(Ma,{data:t}),imgur:t=>u(ve,{getValue:n=>{const r=el("div");return sd(t.imgur_kind,t.imgur_id).defer(n).adto(r),r}}),youtube:t=>u(ve,{getValue:n=>{const r=el("div");return id(t.id,t.search,{autoplay:e.autoplay}).defer(n).adto(r),r}}),twitch_clip:t=>{const[n]=bn(t.slug,ld);return u(E,{get when(){return n()},children:r=>u(oe,{body:r,autoplay:!1})})},reddit_suggested_embed:t=>u(ve,{getValue:n=>{const r=el("div");return od(t.suggested_embed).defer(n).adto(r),r}}),link_preview:t=>u(ve,{getValue:n=>{const r=el("div");return nd(t.client_id,t).defer(n).adto(r),r}}),oembed:t=>u(ve,{getValue:n=>{const r=el("div");return rd(t).defer(n).adto(r),r}}),mastodon_instance_selector:t=>{const[n,r]=P(""),o=R(()=>{const i=n();return i.trim()?i.indexOf("/")>-1?!1:i.indexOf(".")!==-1:!1}),l=()=>{!o()||rt({path:"/"+t.client_id+"/"+n().replaceAll("/","-")})};return(()=>{const i=La.cloneNode(!0),s=i.firstChild,a=s.nextSibling,c=a.nextSibling,d=c.firstChild,f=d.firstChild,h=f.nextSibling,m=d.nextSibling,v=c.nextSibling;return v.firstChild,s.style.setProperty("max-width","6rem"),h.$$keydown=y=>{y.key==="Enter"&&l()},h.$$input=y=>r(y.currentTarget.value),m.$$click=()=>{l()},g(v,u(fe,{client_id:"",style:"normal",href:"https://joinmastodon.org",children:"joinmastodon.org"}),null),L(y=>{const w=n(),C=!o(),k=J[o()?"pill-filled":"pill-empty"];return w!==y._v$5&&(h.value=y._v$5=w),C!==y._v$6&&(m.disabled=y._v$6=C),k!==y._v$7&&(m.className=y._v$7=k),y},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),i})()}}})}function Ht(e){return xt(e,{text:()=>"[text]",richtext:t=>Nn(t.content),link:t=>t.url,captioned_image:()=>"[image]",video:()=>"[video]",gfycatv1:()=>"[gif]",gfycatv2:()=>"[gif]",youtube:()=>"[video]",imgur:()=>"[images]",twitch_clip:()=>"[video]",oembed:()=>"[link]",reddit_suggested_embed:()=>"[content]",audio:()=>"[audio]",gallery:()=>"[gallery]",poll:()=>"[poll]",none:()=>"",removed:t=>Ht(t.body),crosspost:()=>"[crosspost]",array:t=>t.body.map(n=>n?Ht(n):"").join(`
`),link_preview:t=>t.url,mastodon_instance_selector:()=>"[mastodon instance selector]"})}function Ma(e){const[t,n]=P({kind:"loading"}),[r,o]=P(Symbol());return U(()=>{r();let l=!0;G(()=>l=!1);const i=e.data;oi(i.host,i.id).then(s=>{!l||n({kind:"loaded",frame:s})}).catch(s=>{!l||(console.log("got error",s,s.stack),n({kind:"error",message:s.toString()}))})}),u(Zn,{restrict_w:!0,get children(){return u(ee,{get item(){return t()},children:{loading:()=>"loading...",loaded:({frame:l})=>u(Qn,{get listing(){return l.content},get opts(){return{clickable:!0,client_id:l.client_id,frame:l,replies:null,at_or_above_pivot:!1,is_pivot:!1}}}),error:l=>(()=>{const i=Pa.cloneNode(!0),s=i.firstChild,a=s.nextSibling;return s.$$click=()=>{n({kind:"loading"}),o(Symbol())},g(a,()=>l.message),i})()}})}})}function Va(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top+(window.pageYOffset??document.documentElement.scrollTop),w:t.width,h:t.height}}function ja(e){const[t,n]=bo({kind:"overview"}),[r,o]=P({enabled:!1,index:0,loading:!1}),l=X(),i=R(()=>e.images.every(h=>h.body.kind==="captioned_image")),s=()=>i()&&l.galleryDisplay()==="fullscreen";let a;const c=h=>{n($e({kind:"overview",fullscreen_index:h},{merge:!0}));const m=a.querySelector(".img-"+h);if(!m)return{x:0,y:0,w:0};const v=Va(m),y=e.images[h];if(y&&y.aspect!=null)if(y.aspect>1){const w=v.h;v.h=v.w*(1/y.aspect),v.y+=(w-v.h)/2}else{const w=v.w;v.w=v.h*y.aspect,v.x+=(w-v.w)/2}return v};let d;G(()=>{d&&d()});const f=Hn();return U(()=>{f()||d&&d()}),(()=>{const h=Ye.cloneNode(!0),m=a;return typeof m=="function"?m(h):a=h,g(h,u(ee,{item:t,children:{overview:v=>u(te,{children:y=>u(F,{get each(){return e.images},children:(w,C)=>(()=>{const k=Ta.cloneNode(!0),T=k.firstChild;return k.$$click=()=>{s()?(o({enabled:!0,index:C(),loading:!0}),Y(()=>import("./gallery.b795e990.js"),["assets/gallery.b795e990.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(x=>{o({enabled:!0,index:C(),loading:!1}),d&&d();const b=x.showGallery(e.images,C(),c,{onclose:()=>{console.log("gallery closed"),o($=>({...$,enabled:!1}))},setIndex:$=>{o({enabled:!0,index:$,loading:!1})}});d=()=>{b.cleanup(),n($e({kind:"overview",fullscreen_index:void 0},{merge:!0}))}}).catch(x=>{console.log("Error loading gallery component",x),n($e({kind:"image",index:C()},{merge:!0}))})):n($e({kind:"image",index:C()},{merge:!0}))},L(x=>{const b=B("m-1 inline-block rounded-md",y),$=w.thumb??"error",N=B("w-24 h-24 object-contain img-"+C(),r().enabled&&r().index===C()?r().loading?"opacity-50":"opacity-0":"");return b!==x._v$8&&(k.className=x._v$8=b),$!==x._v$9&&W(T,"src",x._v$9=$),N!==x._v$10&&(T.className=x._v$10=N),x},{_v$8:void 0,_v$9:void 0,_v$10:void 0}),k})()})}),image:v=>[(()=>{const y=Aa.cloneNode(!0);return y.$$click=()=>n($e({kind:"image",index:v.index-1},{merge:!0})),L(w=>{const C=J["outlined-button"],k=v.index<=0;return C!==w._v$11&&(y.className=w._v$11=C),k!==w._v$12&&(y.disabled=w._v$12=k),w},{_v$11:void 0,_v$12:void 0}),y})(),j(()=>v.index+1),"/",j(()=>e.images.length),(()=>{const y=Oa.cloneNode(!0);return y.$$click=()=>n($e({kind:"image",index:v.index+1},{merge:!0})),L(w=>{const C=J["outlined-button"],k=v.index>=e.images.length-1;return C!==w._v$13&&(y.className=w._v$13=C),k!==w._v$14&&(y.disabled=w._v$14=k),w},{_v$13:void 0,_v$14:void 0}),y})(),(()=>{const y=Ra.cloneNode(!0);return y.$$click=()=>n($e({kind:"overview"},{merge:!0})),L(()=>y.className=J["outlined-button"]),y})(),u(oe,{get body(){return e.images[v.index].body},autoplay:!0})]}})),h})()}se(["click","input","keydown"]);const za=p('<div class="flex justify-center flex-row"><div class="w-full max-w-prose"><div class="bg-white p-5 sm:m-5 sm:p-10 shadow sm:rounded-xl"><header><h1 class="text-3xl sm:text-5xl font-black">ThreadClient</h1><h2 class="text-base font-light text-gray-800 dark:text-gray-400">A client for Reddit and Mastodon</h2></header><div class="mt-10"></div><main><p>Try for </p><p>Try for </p></main><div class="mt-10"></div><footer><p class="text-gray-800 dark:text-gray-400"> \xB7 <!> \xB7 </p></footer><div class="mt-2"></div></div></div></div>');function Ba(e){return(()=>{const t=za.cloneNode(!0),n=t.firstChild,r=n.firstChild,o=r.firstChild,l=o.nextSibling,i=l.nextSibling,s=i.firstChild;s.firstChild;const a=s.nextSibling;a.firstChild;const c=i.nextSibling,d=c.nextSibling,f=d.firstChild,h=f.firstChild,m=h.nextSibling;return m.nextSibling,g(s,u(fe,{client_id:"",href:"/reddit",style:"normal",children:"Reddit"}),null),g(a,u(fe,{client_id:"",href:"/mastodon",style:"normal",children:"Mastodon"}),null),g(f,u(fe,{client_id:"",href:"/settings",style:"action-button",children:"Settings"}),h),g(f,u(fe,{client_id:"",href:"https://github.com/pfgithub/threadclient",style:"action-button",children:"Github"}),m),g(f,u(fe,{client_id:"",href:"https://github.com/pfgithub/threadclient/blob/main/privacy.md",style:"action-button",children:"Privacy"}),null),t})()}function er(e,t){const[n,r]=bo({data:null}),o=fl(()=>{o(()=>r("data",$e(e(),{merge:t.merge,key:t.key})))});return o(()=>{r("data",$e(e()))}),n}function Zt(e,t){let n={},r=Object.keys(e);for(let o=0,l=r.length;o<l;o+=1){let i=r[o];t.includes(i)||Object.defineProperty(n,i,{get(){return e[i]},enumerable:!0})}return n}function En(e,t,n){if(t)return[t,n];let[r,o]=P(e);return[r,l=>{o(()=>l),n(l)}]}function Wa(e={}){let t="CONTROLLED"in e?e.CONTROLLED:"isOpen"in e,[n,r]=En(!!e.defaultOpen,t?()=>!!e.isOpen:void 0,o=>{var l;return(l=e.onChange)==null?void 0:l.call(e,o)});return{isOpen(){return n()},setState(o){e.disabled||r(o)},disabled(){return!!e.disabled}}}var Ua=Ee();function Ha(e){return typeof e=="function"&&e.length>0}function Fa(e){let t=Wa(e);return u(Ua.Provider,{value:t,get children(){return(()=>{let n=e.children;return Ha(n)?n(t):n})()}})}function qa(e){var t,n;let[r,o]=P();if(e.multiple){let a="CONTROLLED"in e?e.CONTROLLED:"value"in e,[c,d]=En((t=e.defaultValue)!=null?t:[],a?()=>{var f;return(f=e.value)!=null?f:[]}:void 0,f=>{var h;return(h=e.onChange)==null?void 0:h.call(e,f??[])});return{isSelected(f){return new Set(c()).has(f)},select(f){let h=new Set(D(c));e.toggleable&&h.has(f)?h.delete(f):h.add(f),d([...h])},hasSelected(){return c().length>0},disabled(){return!!e.disabled},hasActive(){return!!r()},isActive(f){let h=r();return h?Object.is(f,h.value):!1},focus(f){return o({value:f})},blur(){return o(void 0)}}}let l="CONTROLLED"in e?e.CONTROLLED:"value"in e,[i,s]=En((n=e.defaultValue)!=null?n:void 0,l?()=>e.value:void 0,a=>{var c;return(c=e.onChange)==null?void 0:c.call(e,a)});return{isSelected(a){return Object.is(a,i())},select(a){e.toggleable&&Object.is(D(i),a)?s(void 0):s(a)},hasSelected(){return i()!=null},disabled(){return!!e.disabled},hasActive(){return!!r()},isActive(a){let c=r();return c?Object.is(a,c.value):!1},focus(a){return o({value:a})},blur(){return o(void 0)}}}var Mo=Ee();function Ga(e){return typeof e=="function"&&e.length>0}function Vo(e){let t=qa(e);return u(Mo.Provider,{value:t,get children(){return(()=>{let n=e.children;return Ga(n)?n(t):n})()}})}function jo(){let e=Ue(Mo);if(e)return e;throw new Error("`useHeadlessSelectChild` must be used within HeadlessSelectRoot.")}function Ka(e,t){let n=jo(),r=()=>t?.()||n.disabled();return{isSelected(){return n.isSelected(e())},isActive(){return n.isActive(e())},select(){r()||n.select(e())},focus(){r()||n.focus(e())},blur(){!r()&&this.isActive()&&n.blur()},disabled:r}}function Ya(e){return typeof e=="function"&&e.length>0}var Ja=Ee();function Xa(e){let t=Ka(()=>e.value,()=>!!e.disabled);return u(Ja.Provider,{value:t,get children(){return(()=>{let n=e.children;return Ya(n)?n(t):n})()}})}function Qa(e){return typeof e=="function"}function zo(e,t){return n=>{"ref"in e&&(Qa(e.ref)?e.ref(n):e.ref=n),t(n)}}function Za(e){return e.children}function ec(e,t,n){return e.querySelectorAll(`[data-sh-${t}="${n}"]`)}var tc="radio";function Ur(e,t){return ec(e,tc,t)}var tr=Ee();function nc(e){let t=Ue(tr);if(t)return t;throw new Error(`<${e}> must be used inside a <RadioGroup> or <RadioGroupOption>`)}var Bo=Ee();function rc(e){let t=Ue(Bo);if(t)return t;throw new Error(`<${e}> must be used inside a <RadioGroup>`)}function oc(e){var t;let n=Se(),r=Se(),o=Se(),l;function i(c){c.focus()}function s(c){if(l instanceof HTMLElement){let d=Ur(l,n);for(let f=0,h=d.length;f<h;f+=1)if(c===d[f]){f===h-1?i(d[0]):i(d[f+1]);break}}}function a(c){if(l instanceof HTMLElement){let d=Ur(l,n);for(let f=0,h=d.length;f<h;f+=1)if(c===d[f]){i(f===0?d[h-1]:d[f-1]);break}}}return u(Bo.Provider,{value:{ownerID:n,setChecked:i,setNextChecked:s,setPrevChecked:a},get children(){return u(tr.Provider,{value:{descriptionID:r,labelID:o},get children(){return u(Yt,ye({get component(){return(t=e.as)!=null?t:"div"}},()=>Zt(e,["as","children","value","disabled","onChange","ref","defaultValue"]),{role:"radiogroup","aria-labelledby":o,"aria-describedby":r,get["aria-disabled"](){return e.disabled},get["data-sh-disabled"](){return e.disabled},get disabled(){return e.disabled},ref(c){const d=zo(e,f=>{l=f});typeof d=="function"&&d(c)},"data-sh-radiogroup":n,get children(){return u(Vo,{CONTROLLED:"value"in e,get defaultValue(){return e.defaultValue},get value(){return e.value},get disabled(){return e.disabled},get onChange(){return e.onChange},get children(){return e.children}})}}))}})}})}function lc(e){var t;let n=rc("RadioGroupOption"),r=jo(),o=Se(),l=Se(),[i,s]=P();return U(()=>{let a=i();if(a instanceof HTMLElement){let c=m=>{if(!(r.disabled()||e.disabled))switch(m.key){case"ArrowLeft":case"ArrowUp":m.preventDefault(),n.setPrevChecked(a);break;case"ArrowRight":case"ArrowDown":m.preventDefault(),n.setNextChecked(a);break;case" ":case"Enter":a.tagName==="BUTTON"&&m.preventDefault(),n.setChecked(a);break}},d=()=>{r.disabled()||e.disabled||r.select(e.value)},f=()=>{r.disabled()||e.disabled||(r.focus(e.value),r.select(e.value))},h=()=>{r.disabled()||e.disabled||r.blur()};a.addEventListener("keydown",c),a.addEventListener("click",d),a.addEventListener("focus",f),a.addEventListener("blur",h),G(()=>{a.removeEventListener("keydown",c),a.removeEventListener("click",d),a.removeEventListener("focus",f),a.removeEventListener("blur",h)})}}),u(tr.Provider,{value:{descriptionID:o,labelID:l},get children(){return u(Yt,ye({get component(){return(t=e.as)!=null?t:"div"}},()=>Zt(e,["as","children","value","disabled","ref"]),{ref(a){const c=zo(e,d=>{s(()=>d)});typeof c=="function"&&c(a)},role:"radio",get disabled(){return e.disabled},get tabindex(){return r.isSelected(e.value)?0:-1},get["aria-disabled"](){return e.disabled},get["aria-checked"](){return r.isSelected(e.value)},"aria-labelledby":l,"aria-describedby":o,get["data-sh-radio"](){return n.ownerID},get["data-sh-checked"](){return r.isSelected(e.value)},get["data-sh-disabled"](){return e.disabled},get children(){return u(Xa,{get value(){return e.value},get disabled(){return e.disabled},get children(){return e.children}})}}))}})}function ic(e){var t;let n=nc("RadioGroupLabel");return u(Yt,ye({get component(){return(t=e.as)!=null?t:"label"}},()=>Zt(e,["as"]),{get id(){return n.labelID},get children(){return e.children}}))}var sc=Ee();function ac(e){var t;let[n,r]=P(!1),o=Se(),l=Se(),i=Se(),s=Se();return u(sc.Provider,{get value(){return{horizontal:e.horizontal,multiple:e.multiple,ownerID:o,labelID:l,buttonID:i,optionsID:s,get hovering(){return n()},set hovering(a){r(a)}}},get children(){return u(Yt,ye({get component(){return(t=e.as)!=null?t:Za}},()=>Zt(e,["as","children","defaultOpen","disabled","horizontal","isOpen","multiple","onDisclosureChange","onSelectChange","toggleable","value","defaultValue"]),{"aria-labelledby":l,"data-sh-listbox":o,get disabled(){return e.disabled},get["aria-disabled"](){return e.disabled},get["data-sh-disabled"](){return e.disabled},get children(){return u(Vo,{CONTROLLED:"value"in e,get multiple(){return e.multiple},get toggleable(){return e.toggleable},get defaultValue(){return e.defaultValue},get value(){return e.value},get disabled(){return e.disabled},get onChange(){return e.onSelectChange},get children(){return u(Fa,{CONTROLLED:"isOpen"in e,get isOpen(){return e.isOpen},get defaultOpen(){return e.defaultOpen},get disabled(){return e.disabled},get onChange(){return e.onDisclosureChange},get children(){return e.children}})}})}}))}})}const cc=p('<div class="absolute top-0 left-0 w-full h-full"></div>'),dc=p("<div><div></div></div>");function uc(e){const[t,n]=P(null),r=R(()=>t()!=null),[o,l]=P(!1),i=R(()=>r()||o());let s=0;U(()=>{const d=t();d!=null&&(s=d)});let a,c=[];return G(()=>{c.forEach(d=>d())}),(()=>{const d=dc.cloneNode(!0),f=d.firstChild;d.$$pointerdown=m=>{const v=m.pointerId;if(m.pointerType==="mouse"||(c.forEach(N=>N()),document.getSelection()?.isCollapsed===!1))return;if(CSS.supports("-webkit-touch-callout: none")){const N=window.innerWidth,S=m.clientX;if(Math.min(Math.abs(S),Math.abs(N-S))<50)return}let w=!1;m.preventDefault(),a.style.transition="";const C=()=>{const N=t()!==0&&t()!=null;a.style.transition="0.1s transform",N&&a.offsetWidth,Be(()=>{N&&l(!0),n(null)}),$()},k=N=>{if(N.pointerId!==v)return;const S=N.clientX-m.clientX,O=N.clientY-m.clientY;(w||Math.abs(S)>10&&Math.abs(O)<Math.abs(S))&&(w=!0,n(S))},T=N=>{N.pointerId===v&&(e.onRelease(t()??0),C())},x=N=>{N.pointerId===v&&C()},b=()=>{$()};document.addEventListener("pointermove",k),document.addEventListener("pointerup",T),document.addEventListener("pointercancel",x),document.addEventListener("selectionchange",b);const $=()=>{c=c.filter(N=>N!==$),document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",T),document.removeEventListener("pointercancel",x),document.removeEventListener("selectionchange",b)};c.push($)},d.style.setProperty("width","100%"),d.style.setProperty("touch-action","pan-y pinch-zoom"),d.style.setProperty("position","relative"),g(d,u(E,{get if(){return i()},get children(){const m=cc.cloneNode(!0);return g(m,()=>D(()=>e.background(()=>t()??s))),m}}),f),f.addEventListener("transitionend",m=>{m.target===m.currentTarget&&l(!1)});const h=a;return typeof h=="function"?h(f):a=f,g(f,()=>e.children),L(m=>{const v=i()?"hidden":"unset",y=(()=>{const w=t();return w!=null?"translateX("+w+"px)":""})();return v!==m._v$&&d.style.setProperty("overflow-x",m._v$=v),y!==m._v$2&&f.style.setProperty("transform",m._v$2=y),m},{_v$:void 0,_v$2:void 0}),d})()}se(["pointerdown"]);const fc=p('<div><div class="absolute w-100px h-full flex items-center justify-center"><div></div></div></div>');function hc(e){return{background:t=>{const n=R(()=>t()<0?e.right_stop:e.left_stop),r=R(()=>t()<0),o=R(()=>Math.abs(t())>100);return(()=>{const l=fc.cloneNode(!0),i=l.firstChild,s=i.firstChild;return g(s,u(Ct,{get icon(){return n().icon},get bold(){return o()},label:null})),L(a=>{const c=Ai(n().color,o())+" w-full h-full relative",d={...r()?{right:"-100px"}:{left:"-100px"},transform:"translateX("+t()+"px)"},f=o()?"bounceanim":"";return c!==a._v$&&(l.className=a._v$=c),a._v$2=Kt(i,d,a._v$2),f!==a._v$3&&(s.className=a._v$3=f),a},{_v$:void 0,_v$2:void 0,_v$3:void 0}),l})()},onRelease:t=>{t<-100&&e.right_stop.onActivate(),t>100&&e.left_stop.onActivate()}}}const Hr=p("<div></div>"),gc=p('<div class="pt-2"></div>'),mc=p('<div><div class="flex flex-row gap-1"><div></div></div></div>'),vc=p("<div><div></div></div>"),pc=p('<div class="py-1"><button class="text-blue-500 hover:underline"></button></div>'),bc=p('<p class="text-red-600 dark:text-red-500">Error loading; </p>'),_c=p('<hr class="my-2 border-t-2">'),yc=p("<div>TODO: <!> <button>code</button></div>"),xc=p('<div class="text-red-500">Error: <!> <button>code</button></div>'),Fr=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-purple-500"];function wc(e){return Fr[e%Fr.length]}function Ln(e){return u(Xt,{get data(){return e.item},get children(){return u(kc,{get item(){return e.item},get collapse_data(){return e.collapse_data}})}})}function kc(e){return u(ee,{get item(){return e.item},children:{wrapper_start:()=>u(te,{children:t=>(()=>{const n=Hr.cloneNode(!0);return n.className=" "+t+" h-2 sm:rounded-t-xl mt-4",n})()}),wrapper_end:()=>u(te,{children:t=>(()=>{const n=Hr.cloneNode(!0);return n.className=" "+t+" h-2 sm:rounded-b-xl mb-4",n})()}),post:t=>u(uc,ye(()=>hc({left_stop:{icon:"bookmark",color:"green",onActivate:()=>{alert("TODO")}},right_stop:{icon:"chevron_up",color:"blue",onActivate:()=>{if(!t.collapse)return alert("TODO e;not-collapsible");Ne(e.collapse_data,t.collapse.id).setCollapsed(r=>!r)}}}),{get children(){return u(te,{children:n=>(()=>{const r=mc.cloneNode(!0),o=r.firstChild,l=o.firstChild;return g(o,u(E,{get if(){return!jt.sm()},get fallback(){return u(E,{get if(){return t.indent.length>0},get children(){const i=vc.cloneNode(!0),s=i.firstChild;return L(a=>{const c=(t.indent.length-3)*.25+"rem",d=B("w-1","mr-1","pl-0.5",t.first_in_wrapper?"":"pt-2"),f=B("w-full h-full",wc(t.depth-1),"rounded-md");return c!==a._v$3&&i.style.setProperty("margin-left",a._v$3=c),d!==a._v$4&&(i.className=a._v$4=d),f!==a._v$5&&(s.className=a._v$5=f),a},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),i}})},get children(){return u(F,{get each(){return t.indent},children:i=>u(Jn,{collapsed_raw:!1,collapsed_anim:!1,onClick:()=>{Ne(e.collapse_data,i.id).setCollapsed(a=>!a)},real:!1,get cstates(){return e.collapse_data},get threaded(){return i.threaded},get id(){return i.id}})})}}),l),g(l,u(E,{get if(){return!t.first_in_wrapper},get children(){return gc.cloneNode(!0)}}),null),g(l,u(ee,{get item(){return t.content},children:{post:i=>u(Do,{get content(){return i.content},get opts(){return{clickable:!1,frame:i,client_id:i.client_id,replies:i.replies,at_or_above_pivot:t.at_or_above_pivot,is_pivot:t.is_pivot,collapse_data:e.collapse_data,id:t.id}}}),loader:i=>{const[s,a]=P(!1),[c,d]=P(null),f=kt(),h=()=>{if(s())return;a(!0);const m=f.pgin();(async()=>(c()!=null&&await new Promise(v=>setTimeout(v,200)),await ge(i.client_id).loader(t.id,i)))().then(v=>{Be(()=>{a(!1),d(null),console.log("adding content",v.content,t),f.addContent(m,v.content)})}).catch(v=>{console.log("Error loading; ",v),Be(()=>{a(!1),d(v.toString())})})};return(()=>{const m=pc.cloneNode(!0),v=m.firstChild;return(y=>{if(i.autoload){const w=new IntersectionObserver(h,{root:document.body,rootMargin:"0px",threshold:1});w.observe(y),U(()=>{s()&&w.unobserve(y)})}})(v),v.$$click=h,g(v,(()=>{const y=j(()=>!!s(),!0);return()=>y()?"Loading\u2026":(c()!=null?"Retry Load":"Load More")+(i.load_count!=null?" ("+i.load_count+")":"")})()),g(m,u(E,{get when(){return c()},children:y=>(()=>{const w=bc.cloneNode(!0);return w.firstChild,g(w,y,null),w})()}),null),L(()=>v.disabled=s()),m})()}}}),null),L(i=>{const s="px-2 "+n+" "+(t.is_pivot?"@@IS_PIVOT@@":""),a="flex-1 "+(jt.sm()&&t.threaded?"threaded-new threaded-new-ltsm":"");return s!==i._v$&&(r.className=i._v$=s),a!==i._v$2&&(l.className=i._v$2=a),i},{_v$:void 0,_v$2:void 0}),r})()})}})),horizontal_line:()=>(()=>{const t=_c.cloneNode(!0);return t.style.setProperty("border-top-color","var(--collapse-line-color)"),t})(),todo:t=>(()=>{const n=yc.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return g(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})(),error:t=>(()=>{const n=xc.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return g(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})()}})}se(["click"]);const $c=p('<label class="my-3"><input type="checkbox"> Show my signature on this post</label>'),Cc=p('<div><textarea class="border my-3 w-full resize-y"></textarea><div class="flex space-x-1 my-3"><button></button><button>Cancel<div></div></button></div></div>'),Sc=p('<pre class="error"><code>There was an error! </code></pre>'),Nc=p("<button>Hide error</button>");function Wo(e){const t=X(),[n,r]=mo("comment-draft-"+e.action.client_id+"-"+e.action.key),[o,l]=P(!0),i=()=>{const m=n()??"",v=t.signature();return o()&&v.trim()?m+(m.trim()?`

`:"")+v:m},s=()=>i().trim()==="",[a,c]=P(!1),[d,f]=P(void 0),h=er(()=>ge(e.action.client_id).previewReply(i(),e.action.reply_info),{key:null,merge:!0});return(()=>{const m=Cc.cloneNode(!0),v=m.firstChild,y=v.nextSibling,w=y.firstChild,C=w.nextSibling;return v.$$input=k=>{r(k.currentTarget.value)},g(m,u(E,{get if(){return!!t.signature().trim()},get children(){const k=$c.cloneNode(!0),T=k.firstChild;return T.$$input=x=>{l(x.currentTarget.checked)},L(()=>T.checked=o()),k}}),y),w.$$click=k=>{c(!0),ge(e.action.client_id).sendReply(i(),e.action.reply_info,e.action.mode).then(x=>{console.log("Got response",x),r(null),e.onAddReply({kind:"post",internal_data:x.raw_value,content:x.kind==="thread"?{kind:"legacy",thread:x,client_id:e.action.client_id}:{kind:"post",title:{text:"Error"},body:{kind:"richtext",content:[V.p(V.error("Unsupported 'load more'",x))]},show_replies_when_below_pivot:!1,collapsible:!1},display_style:"centered",parent:null,replies:null,url:null,client_id:e.action.client_id})}).catch(x=>{c(!1);const b=x;console.log("Got error",b),f(b.toString()+`
`+b.stack)})},g(w,()=>a()?"\u2026":e.action.text),C.$$click=k=>{e.onCancel()},g(m,u(E,{get when(){return d()},children:k=>[(()=>{const T=Sc.cloneNode(!0),x=T.firstChild;return x.firstChild,g(x,k,null),T})(),(()=>{const T=Nc.cloneNode(!0);return T.$$click=()=>f(void 0),T})()]}),null),g(m,u(E,{get if(){return!s()},get when(){return h.data},children:k=>(console.log("Value changed",k),u(Zn,{restrict_w:!0,get children(){return u(Qn,{listing:k,get opts(){return{clickable:!1,replies:null,at_or_above_pivot:!0,is_pivot:!0,frame:null,client_id:e.action.client_id}}})}}))}),null),L(k=>{const T=a(),x=n()??"",b=s()||a(),$=J[s()?"pill-empty":"pill-filled"],N=a(),S=J["pill-empty"];return T!==k._v$&&(v.disabled=k._v$=T),x!==k._v$2&&(v.value=k._v$2=x),b!==k._v$3&&(w.disabled=k._v$3=b),$!==k._v$4&&(w.className=k._v$4=$),N!==k._v$5&&(C.disabled=k._v$5=N),S!==k._v$6&&(C.className=k._v$6=S),k},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),m})()}se(["input","click"]);function Ec(e){const t={get value(){return e()}},[n,r]=P(D(()=>t.value)),o=dr(e),l=dr(n),[i,s]=P(null);return U(a=>{const c=a,d=i(),f=D(()=>t.value);return c!=null&&d!=null&&d!==c&&D(()=>{const h=c.getBoundingClientRect(),m=d.getBoundingClientRect(),v=h.x-m.x,y=h.y-m.y,w=h.width/m.width,C=h.height/m.height;d.style.transform=["translate("+v+"px, "+y+"px)","scale("+w+", "+C+")"].join(" "),d.style.transformOrigin="top left",d.offsetHeight,d.style.transition=Fn()/2+"s transform ease-out",d.style.transform="";const k=T=>{T.target===T.currentTarget&&(d.removeEventListener("transitionend",k),d.style.transition="")};d.addEventListener("transitionend",k)}),r(()=>f),d},null),{if:a=>o(a)||l(a),ref:a=>s(a)}}const Lc=p('<div class="flex flex-row gap-1 rounded-md bg-slate-400 dark:bg-zinc-700 p-1 shadow-inner"></div>'),Pc=p(`<div class="
                                absolute top-0 left-0 w-full h-full
                                rounded-md bg-slate-100 dark:bg-zinc-500 shadow
                                group-focus-visible-outline-default
                            "></div>`);function qr(e){const t=R(l=>{const i=new Map;for(const a of e.choices)i.set(a[0],l?.fwd.get(a[0])??Gt());const s=new Map([...i.entries()].map(a=>[a[1],a[0]]));return{fwd:i,rev:s}},void 0),n=l=>t().fwd.get(l),r=R(()=>n(e.value));U(()=>{console.log("[!]MAINVALUE IS",r(),"CHOICES:",t())});const o=Ec(()=>r());return u(oc,{get value(){return r()},onChange:l=>(e.setValue(l!=null?t().rev.get(l):void 0),l),get children(){const l=Lc.cloneNode(!0);return g(l,u(F,{get each(){return e.choices},children:i=>u(lc,{get value(){return n(i[0])},class:"block relative px-2 group select-none cursor-pointer",get children(){return[u(E,{get if(){return o.if(n(i[0]))},get children(){const s=Pc.cloneNode(!0),a=o.ref;return typeof a=="function"?a(s):o.ref=s,s}}),u(ic,{class:"cursor-pointer relative z-1",get children(){return i[1]}})]}})})),l}})}const Tc=p('<div class="h-full"><span class="text-sm font-bold uppercase text-slate-900 dark:text-zinc-100" role="heading"></span><p class="text-base text-slate-500 dark:text-zinc-300"></p></div>'),Ac=p('<span class="text-slate-900 dark:text-zinc-100"></span>'),Oc=p(`<div class="
                        absolute inset-0
                        bg-gradient-to-br from-blue-400 to-blue-600
                        opacity-0 group-hover:opacity-100
                        transform -translate-y-3 group-hover:translate-y-0
                        transition duration-100
                    "></div>`),Rc=p('<div class="relative p-4">Open ThreadClient</div>'),Ic=p(`<div class="
                        absolute inset-0
                        border-4 border-slate-300 dark:border-zinc-600
                        rounded-lg
                    "></div>`),Dc=p('<div class="relative p-4"></div>'),Mc=p(`<div class="min-h-screen overflow-x-hidden bg-slate-300 dark:bg-zinc-900 text-slate-900 dark:text-zinc-100"><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-4 pb-0"><div class="flex flex-wrap justify-end items-center"><div></div><div class="flex-1"></div></div></div><div class="mx-auto max-w-3xl p-8"><span role="heading" class="text-3xl font-bold">ThreadClient</span><div class="text-2xl font-light text-slate-500 dark:text-zinc-400">A new client for <div class="inline-block relative"></div></div></div><div class="mx-auto max-w-3xl pt-0 p-8 flex flex-wrap gap-4"></div></div><div class="
            bg-slate-300 dark:bg-zinc-900
            bg-graph-slate-350 dark:bg-graph-zinc-800
            bg-fixed
            text-slate-900 dark:text-zinc-100
        "><div class="mx-auto max-w-3xl p-8"></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Link Previews</span><p>Preview links directly inline. ThreadClient supports previewing from many of the most popular sources.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Repivoting</span><p>When reading deep in comment threads, press the top part of the comment next to the username to just see replies to that comment.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Swipe Actions</span><p>Swipe comments to collapse them or repivot or something. Might be configurable eventually.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"><div class="relative"><div class="
                                absolute left-0 h-full w-full sm:rounded-xl
                                bg-slate-100 dark:bg-zinc-800 shadow-md
                            "></div><div class="relative p-4">put this in a phone ui and use a flag to force enable treating pointer as touch within this frame. and maybe even change the cursor to look like a touch</div></div></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Preview Before Posting</span><p>Preview your comments as they will show up to others before posting them. We're also working on a full richtext editor but that's not out yet</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"><div class="relative"><div class="
                                absolute left-0 h-full w-full sm:rounded-xl
                                bg-slate-100 dark:bg-zinc-800 shadow-md
                            "></div><div class="relative p-4"></div></div></div></div></div></div><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Performance</span><ul class="list-disc"><li>video. compare performance of threadclient, new.reddit, and old.reddit in these situations:</li><li>- first load</li><li>- opening comments on a post</li><li>we can even get technical and enable react devtools highlighting to show that threadclient doesn't update nearly as much as new.reddit</li></ul></div></div></div><div class="
            bg-slate-300 dark:bg-zinc-900
            bg-topography-slate-350 dark:bg-topography-zinc-800
            bg-fixed
            text-slate-900 dark:text-zinc-100
        "><div class="mx-auto max-w-3xl p-8"><div class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">More Features</div><div>these should be cards you can click for a fullscreen demo</div><div class="pb-4"></div><div class="grid sm:grid-cols-3 gap-4"></div></div></div><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Extension (TODO)</span><ul class="list-disc"><li>Automatically redirect to ThreadClient when you click a Reddit link</li><li>(TODO) Show if you have any new chat messages directly in ThreadClient</li><li>(TODO) Support uploading images and galleries when you create a post</li></ul></div></div></div><div class="bg-slate-600 text-slate-100 dark:bg-zinc-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8">ThreadClient. github link</div></div></div>`),Vc=p(`<div class="grid sm:grid-cols-2 sm:grid-flow-col-dense gap-x-8 gap-y-4"><div class="hidden sm:block sm:col-start-1"></div><div class="sm:col-start-1 text-lg"><span class="
                            text-sm font-bold uppercase
                            text-slate-500 dark:text-zinc-400
                        " role="heading">Unthreaded Replies</span><p>It often gets difficult to read long comment chains because of the increased indentation. ThreadClient automatically unthreads these chains.</p></div><div class="sm:col-start-2 flex flex-row justify-center"></div><div class="sm:col-start-2 h-max shadow-md -mx-8 sm:mx-0"></div></div>`),qe=p("<div></div>");function hn(e){const t={map:new Map},n=kt(),r=er(()=>Sn(Yn(e.post,[],{collapse_data:t,content:n.content(),settings:{allow_threading:e.options?.allow_threading}},{first_in_wrapper:!0,is_pivot:!1,at_or_above_pivot:!1,threaded:!1,depth:0})),{key:Gn,merge:!0});return u(F,{get each(){return r.data},children:o=>u(Ln,{item:o,collapse_data:t})})}function Re(e){const t=kt();return u(le,{get href(){return e.link},client_id:"shell",class:`
        dark:border-t-1 dark:border-zinc-500
        block rounded-xl
        bg-slate-200 dark:bg-zinc-700
        p-4 text-left
        hover:bg-slate-100 hover:dark:bg-zinc-600 hover:shadow-md
    `,page:()=>({content:t.content(),pivot:e.link}),get children(){const n=Tc.cloneNode(!0),r=n.firstChild,o=r.nextSibling;return g(r,()=>e.title),g(o,()=>e.description),n}})}function jc(){const[e,t]=P("reddit"),n=X();return(()=>{const r=Mc.cloneNode(!0),o=r.firstChild,l=o.firstChild,i=l.firstChild,s=i.firstChild;s.nextSibling;const a=l.nextSibling,c=a.firstChild,d=c.nextSibling,f=d.firstChild,h=f.nextSibling,m=a.nextSibling,v=o.nextSibling,y=v.firstChild,w=y.nextSibling,C=w.firstChild,k=C.firstChild,T=k.nextSibling,x=w.nextSibling,b=x.firstChild,$=b.firstChild,N=$.nextSibling,S=x.nextSibling,O=S.nextSibling,M=O.firstChild,ne=M.firstChild,ae=ne.nextSibling,we=ae.firstChild,tl=we.firstChild,nl=tl.nextSibling,rl=v.nextSibling,ol=rl.nextSibling,ll=ol.firstChild,il=ll.firstChild,sl=il.nextSibling,al=sl.nextSibling,Ae=al.nextSibling;return g(s,u(le,{class:"hover:underline",href:"https://github.com/pfgithub/threadclient",client_id:"",get children(){return[u(pt,{class:"fa-brands fa-github",label:null})," ","Github"]}})),g(i,u(qr,{get value(){return n.colorScheme()},setValue:K=>{const Q=n.colorScheme.base()===K?void 0:K;return n.colorScheme.setOverride(Q),Q},get choices(){return[["light",u(Me,{tag:"fa-sun",filled:!0,label:"Light"})],["dark",u(Me,{tag:"fa-moon",filled:!0,label:"Dark"})]]}}),null),g(h,u(ac,{get value(){return e()},onSelectChange:K=>t(K),get children(){return u(le,{class:`
                            border-slate-500 dark:border-zinc-400
                            border-b-2 border-dashed
                            hover:border-solid
                            hover:border-slate-900 hover:dark:border-zinc-100
                            hover:text-slate-900 hover:dark:text-zinc-100
                            transition duration-100
                            inline-block
                            outline-default
                        `,href:"/client-picker",client_id:"shell",get children(){return[(()=>{const K=Ac.cloneNode(!0);return g(K,()=>e()==="reddit"?"Reddit":"Mastodon"),K})()," ",u(Me,{class:"text-lg",tag:"fa-angle-down",filled:!0,label:null})]}})}})),g(m,u(le,{href:"/",client_id:"reddit",class:`
                    inline-block
                    relative group overflow-hidden
                    bg-gradient-to-br from-blue-500 to-blue-600
                    text-slate-100 dark:text-zinc-100
                    rounded-lg
                    <sm:flex-1
                    text-center
                `,get children(){return[Oc.cloneNode(!0),Rc.cloneNode(!0)]}}),null),g(m,u(le,{href:"/settings",client_id:"",class:`
                    inline-block
                    relative group overflow-hidden
                    text-slate-900 dark:text-zinc-100
                    rounded-lg
                    hover:bg-slate-200 dark:hover:bg-zinc-700
                    transition
                `,get children(){return[Ic.cloneNode(!0),(()=>{const K=Dc.cloneNode(!0);return g(K,u(Me,{tag:"fa-gear",filled:!0,label:"Settings"})),K})()]}}),null),g(y,()=>D(()=>{const[K,Q]=P("on");return(()=>{const ar=Vc.cloneNode(!0),cl=ar.firstChild,dl=cl.nextSibling,cr=dl.nextSibling,nn=cr.nextSibling;return g(cr,u(qr,{get value(){return K()},setValue:He=>He?Q(He):void 0,get choices(){return[["off","Nest"],["on","Unthread"]]}})),g(nn,u(te,{children:He=>(()=>{const ot=qe.cloneNode(!0);return ot.className="h-2 sm:rounded-t-xl "+He,ot})()}),null),g(nn,u(hn,{post:"/homepage/unthreading",get options(){return{allow_threading:K()==="on"}}}),null),g(nn,u(te,{children:He=>(()=>{const ot=qe.cloneNode(!0);return ot.className="h-2 sm:rounded-b-xl "+He,ot})()}),null),ar})()})),g(T,u(te,{children:K=>(()=>{const Q=qe.cloneNode(!0);return Q.className="h-2 rounded-t-xl "+K,Q})()}),null),g(T,u(hn,{post:"/homepage/link-previews"}),null),g(T,u(te,{children:K=>(()=>{const Q=qe.cloneNode(!0);return Q.className="h-2 rounded-b-xl "+K,Q})()}),null),g(N,u(te,{children:K=>(()=>{const Q=qe.cloneNode(!0);return Q.className="h-2 rounded-t-xl "+K,Q})()}),null),g(N,u(hn,{post:"/homepage/repivot"}),null),g(N,u(te,{children:K=>(()=>{const Q=qe.cloneNode(!0);return Q.className="h-2 rounded-b-xl "+K,Q})()}),null),g(nl,u(Wo,{get action(){return{kind:"reply",key:"@0",text:"Reply",reply_info:{encoding_type:"reply",encoding_symbol:Symbol()},client_id:"shell",mode:"reply"}},onCancel:()=>{},onAddReply:()=>{}})),g(Ae,u(Re,{title:"Syntax Highlighting",get description(){return"ThreadClient will (!TODO!) automatically syntax highlight code blocks"},link:"/homepage/syntax-highlighting"}),null),g(Ae,u(Re,{title:"Braille Art Fix",get description(){return"ThreadClient will correctly display braille art on desktop and mobile"},link:"/homepage/braille-art-fix"}),null),g(Ae,u(Re,{title:"Percent Upvoted",get description(){return"ThreadClient shows you what percentage of voters upvoted a post"},link:"/homepage/percent-upvoted"}),null),g(Ae,u(Re,{title:"See Markdown",get description(){return"ThreadClient can show you how someone else formatted something"},link:"/homepage/see-comment-markdown"}),null),g(Ae,u(Re,{title:"PWA",get description(){return"Add ThreadClient to your home screen to use it like an app on mobile"},link:"/homepage/pwa"}),null),g(Ae,u(Re,{title:"Offline Mode",get description(){return"TODO: should support an offline mode where you can save and read later"},link:"/homepage/offline-mode"}),null),g(Ae,u(Re,{title:"Hide Automod",get description(){return"TODO: automod 'don't show me again' to auto collapse"},link:"/homepage/hide-automod"}),null),r})()}const zc=p('<div class="flex-1">TODO show header</div>'),Bc=p('<div><button class="bg-gray-200 rounded-md p-2 px-3"></button></div>'),Wc=p('<div class="max-w-4xl w-full"></div>'),Uc=p('<div class="max-w-320px w-full"></div>'),Hc=p('<div class="flex flex-col gap-4 max-w-6xl mx-auto p-4 <sm:px-0"><div class="flex flex-row gap-8 justify-center"></div></div>'),Fc={"LandingPage@-N-ry9qt3N1VTG0iKMHy":()=>({title:"ThreadClient",children:u(jc,{})})};function qc(e){const t=kt(),n=R(()=>{const o=uo(t.content(),e.pivot);if(o.value==null)return null;const l=o.value;if(l.kind!=="post"||l.content.kind!=="special")return null;const i=Fc[l.content.tag_uuid];return i??null}),r=R(()=>{const o=n();return D(()=>o?o():Gc({get pivot(){return e.pivot}}))});return{get title(){return r().title},get children(){return r().children}}}function Gc(e){const t={map:new Map},n=kt(),r=er(()=>(console.log("Reloading data!"),Xi(e.pivot,{collapse_data:t,content:n.content()})),{key:Gn,merge:!0}),o=R(()=>jt.lg()&&r.data.sidebar!=null),[l,i]=P("content");return{get title(){return r.data.title},children:(()=>{const s=Hc.cloneNode(!0),a=s.firstChild;return g(s,u(E,{get if(){return r.data.header!=null},get children(){return zc.cloneNode(!0)}}),a),g(s,u(E,{get if(){return o()},get children(){const c=Bc.cloneNode(!0),d=c.firstChild;return d.$$click=()=>i(f=>f==="content"?"sidebar":"content"),g(d,()=>l()==="content"?"Sidebar":"Content"),c}}),a),g(a,u(E,{get if(){return j(()=>!!o(),!0)()?l()==="content":!0},get children(){const c=Wc.cloneNode(!0);return g(c,u(F,{get each(){return r.data.body},children:d=>u(Ln,{item:d,collapse_data:t})})),c}}),null),g(a,u(E,{get if(){return j(()=>r.data.sidebar!=null,!0)()&&(o()?l()==="sidebar":!0)},get children(){const c=Uc.cloneNode(!0);return g(c,u(F,{get each(){return r.data.sidebar},children:d=>u(Ln,{item:d,collapse_data:t})})),c}}),null),s})()}}se(["click"]);const Kc=p('<ul class="ml-10"></ul>'),Yc=p('<main class="client-wrapper"><div class="display-comments-view"></div></main>');function ce(e){throw console.log("not never:",e),new Error("is not never")}function Uo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function en(e,t){if(t.startsWith("/")&&e&&(t="/"+e+t),t.startsWith("mailto:"))return{kind:"mailto",title:t.replace("mailto:","")};let n=!1;if(t.startsWith("raw!")&&(t=t.replace("raw!",""),n=!0),!t.startsWith("http")&&!t.startsWith("/"))return{kind:"error",title:t};let r;try{r=new URL(t)}catch{r=void 0}return r&&!n&&(r.host==="reddit.com"||r.host.endsWith(".reddit.com"))&&(r.host==="mod.reddit.com"?t="/reddit/mod"+r.pathname+r.search+r.hash:t="/reddit"+r.pathname+r.search+r.hash),r&&!n&&r.host==="redd.it"&&(t="/reddit/comments"+r.pathname+r.search+r.hash),t.startsWith("/")?{kind:"link",url:t.replace("/","#"),external:!1}:{kind:"link",url:t,external:!0}}function q(e,t,n,r={}){const o=en(e,t);if(o.kind==="error")return el("a").clss(...Pn(n),"error").attr({title:o.title}).clss("error").onev("click",l=>{l.stopPropagation(),alert(t)});if(o.kind==="mailto")return el("span").attr({title:o.title});if(o.kind==="link"){const l=o.url,i=X(),s=el("a").clss(...Pn(n)).attr({href:l}).attr(i.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"});return(l.startsWith("/")||l.startsWith("#")||r.onclick)&&(s.onclick=a=>{if(a.stopPropagation(),!a.defaultPrevented&&a.button===0&&!Uo(a)){if(a.preventDefault(),r.onclick)return r.onclick();rt({path:l})}}),s}else ce(o)}function Jc(e,t,n){const r=n.get("t")??n.get("start")??void 0,o=el("iframe").attr({allow:"fullscreen",src:"https://www.youtube.com/embed/"+e+"?version=3&enablejsapi=1&playerapiid=ytplayer"+(t.autoplay?"&autoplay=1":"")+(r!=null?"&start="+r.replace("s",""):"")});return{node:el("div").clss("resizable-iframe").styl({width:"640px",height:"360px"}).adch(o),onhide:()=>{o.contentWindow?.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}}}function gn(e){return["inline-block mx-1 px-1 text-base border-b-2 transition-colors",e?"border-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900"].join(" ")}function Xc(e,t,n){const r=el("div"),o=A(r),l=nt().adto(r);return fetch("https://api."+e+"/v1/gfycats/"+t).then(i=>i.json()).then(i=>{if(console.log("gfylike response:",i),l.remove(),r.adch(el("div").adch(I("code-button").atxt("code").onev("click",f=>{f.stopPropagation(),console.log(i)}))),"message"in i){el("div").clss("error").adto(r).atxt("Error: "+i.message);return}if("errorMessage"in i){el("div").clss("error").adto(r).atxt("Error: "+i.errorMessage);return}const{gfyItem:s}=i;s.title!=null&&r.adch(el("div").atxt("Title: "+s.title)),s.description!=null&&r.adch(el("div").atxt("Description: "+s.description));const a=[...s.mp4Url!=null?[{url:s.mp4Url,type:"video/mp4",quality:"Highest"}]:[],...s.webmUrl!=null?[{url:s.webmUrl,type:"video/webm",quality:"Highest"}]:[],...s.content_urls.webm?[{url:s.content_urls.webm.url,quality:"Highest"}]:[],...s.content_urls.mp4?[{url:s.content_urls.mp4.url,quality:"Highest"},{url:s.content_urls.mp4.url.replace(".mp4","-mobile.mp4"),quality:"Mobile"}]:[],...s.content_urls.mobile?[{url:s.content_urls.mobile.url,quality:"Mobile"}]:[],...s.mobileUrl!=null?[{url:s.mobileUrl,quality:"Mobile"}]:[]],c=s.content_urls,d=c.max5mbGif??c.max2mbGif??c.max1mbGif;ie({kind:"video",aspect:s.width/s.height,gifv:!1,source:a.length>0?{kind:"video",sources:a}:d!=null?{kind:"img",url:d.url}:{kind:"img",url:(()=>{throw console.log("Bad gfy image in",s),new Error("Bad gfy image")})()}},{autoplay:n.autoplay}).defer(o).adto(r)}).catch(i=>{const s=i;console.log(s),l.parentNode&&l.remove(),r.adch(el("div").clss("error").atxt("Error loading gfycat : "+s.toString()))}),o}function Je(e){const t=el("span");return wt(()=>u(gt,{flairs:e}),t),t}function st(e){const t=el("span"),n=A(t);return me(t,()=>u(go,{start:e}),{color_level:1}).defer(n),n}function Qc(e){let t;return async()=>{if(!t){t=[];let r;try{r=await e()}catch(l){throw console.log("failed to load",l),alert("failed to load dynamic load object. check console."),l}const o=t;t={loaded:r},o.forEach(l=>l())}if("loaded"in t)return t.loaded;const n=t;return await new Promise(r=>n.push(r)),t.loaded}}const Zc=Qc(async()=>{const e=new TextEncoder,t=new TextDecoder,n=await(await Y(()=>import("./snudown.69d6942c.js"),[])).default({env:{__assert_fail:(r,o,l,i)=>{throw console.log(r,o,l,i),new Error("assert failed")},__stack_chk_fail:()=>{throw new Error("stack overflow")},debugprints:(r,o)=>{console.log("print text:",t.decode(new Uint8Array(n.memory.buffer,r,o)))},debugprinti:r=>{console.log("print int:",r)},debugprintc:r=>{console.log("print char:",String.fromCodePoint(r))},debugpanic:(r,o)=>{throw new Error("Panic: "+t.decode(new Uint8Array(n.memory.buffer,r,o)))}}});return{renderMd(r){try{const o=e.encode(r),l=n.allocString(o.byteLength);new Uint8Array(n.memory.buffer,l,o.byteLength).set(o);const s=n.markdownToHTML(l,o.byteLength),a=n.strlen(s),c=new Uint8Array(n.memory.buffer,s,a),d=t.decode(c);return n.freeText(l,o.byteLength),n.freeText(s,a),d}catch(o){const l=o;return console.log(l.toString()+`
`+l.stack),Pl("Error "+l.toString()+`
`+l.stack)}}}});async function ed(e){const t=e.content;if(e.markdown_format==="reddit"){const[n,r]=await Promise.all([Zc(),Y(()=>import("./html_to_richtext.a021a1ba.js"),[])]),o=n.renderMd(t);return{kind:"richtext",content:r.parseContentHTML(o,e.client_id)}}else{if(e.markdown_format==="none")return{kind:"richtext",content:[V.p(V.txt(t))]};if(e.markdown_format==="reddit_html"){const n=await Y(()=>import("./html_to_richtext.a021a1ba.js"),[]);return console.log(t),{kind:"richtext",content:n.parseContentHTML(t,e.client_id)}}else ce(e.markdown_format)}}function ie(e,t){try{return td(e,t)}catch(n){const r=n;console.log(r);const o=el("div");return el("div").clss("error").adto(o).atxt("Got error: "+r.toString()),el("code").adto(el("pre").adto(o)).atxt(r.stack??"no stack"),A(o)}}function td(e,t){const n=el("div"),r=A(n),o=el("div").adto(n);return me(o,()=>u(oe,{body:e,get autoplay(){return t.autoplay}}),{color_level:1}).defer(r),r}function nd(e,t){const n=el("div"),r=A(n);let o;t.click_enabled?o=el("div").clss("bg-body rounded-lg block").adto(n):o=q(e,t.url,"none",{onclick:t.click_enabled?()=>{o.remove(),ie(t.click,{autoplay:!0}).defer(r).adto(n)}:void 0}).clss("bg-body rounded-lg hover:shadow-md hover:bg-gray-100 block").adto(n);const l=el("article").clss("flex",t.click_enabled?"flex-col":"flex-row").adto(o),i=el("div").clss(t.click_enabled?"w-full h-auto min-h-10 relative":"w-24 h-full flex items-center justify-center bg-gray-100","rounded-lg overflow-hidden").adto(el("div").adto(l));if(t.thumb!=null?t.click_enabled?i.adch(el("img").clss(t.click_enabled?"w-full h-full":"").attr({src:t.thumb})):el("div").styl({"background-image":`url(${JSON.stringify(t.thumb)})`,"background-size":"contain","background-position":"center","background-repeat":"no-repeat"}).clss("w-full h-full").adto(i):i.adch(el("div").atxt("\u{1F517}")),t.click_enabled){const a=el("div").adto(i);a.clss("flex items-center justify-center absolute top-0 left-0 bottom-0 right-0");const c=el("div").clss("rounded-lg bg-gray-200 p-2 flex shadow-md gap-3").adto(a);el("button").clss("hover:underline").adto(c).atxt("Play").onev("click",d=>{d.stopPropagation(),i.innerHTML="",ie(t.click,{autoplay:!0}).defer(r).adto(i)}),c.atxt(" "),q(e,t.url,"none").clss("hover:underline").atxt("Open").adto(c)}const s=el("div").clss("flex flex-col p-3 text-sm").adto(l);return s.adch(el("h1").clss("max-lines max-lines-1 font-black").atxt(t.title)),s.adch(el("p").clss("max-lines max-lines-2").atxt(t.description)),s.adch(el("div").clss("max-lines max-lines-1 font-light break-all").atxt(t.url)),r}function rd(e){const t=el("div"),n=A(t);return tn(fetch(e.url,{headers:{Accept:"application/json"}}).then(r=>r.json()),r=>{console.log("oembed resp",r);const o=el("div"),l=A(o);return ie(fi(r,e.client_id),{autoplay:!1}).defer(n).adto(o),l}).defer(n).adto(t),n}function od(e){try{const t=el("template");t.innerHTML=e;const n=t.content.childNodes[0];if(!n)throw new Error("missing iframe");const r=n instanceof HTMLIFrameElement?{src:n.src,allow:n.allow,allowfullsreen:""}:{srcdoc:e},o=el("div").clss("resizable-iframe");let l;const i=()=>{l||(l=el("iframe").attr(r).adto(o))};i();const s=A(o);return s.on("hide",()=>{l&&(l.remove(),l=void 0)}),s.on("show",()=>i()),s}catch(t){const n=t;console.log(n);const r=el("div");return r.adch(el("p").atxt("Error adding suggestedembed: "+n.toString()).clss("error")),r.adch(el("pre").adch(el("code").atxt(e))),A(r)}}async function ld(e){function t(c,d,f){return{extensions:{persistedQuery:{sha256Hash:d,version:1}},operationName:c,variables:f}}const n=await fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Client-Id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify([t("VideoAccessToken_Clip","36b89d2507fce29e5ca551df756d27c1cfe079e2609642b4390aa4c35796eb11",{slug:e}),t("ClipsChatCard","94c1c7d97d860722a5b7ef3c3b3de3783b37fc32d69bcccc8ea0cda372cf1f01",{slug:e}),t("ClipsBroadcasterInfo","ce258d9536360736605b42db697b3636e750fdb14ff0a7da8c7225bdc2c07e8a",{slug:e}),t("ClipsTitle","f6cca7f2fdfbfc2cecea0c88452500dae569191e58a265f97711f8f2a838f5b4",{slug:e}),t("ClipsCurator","769e99d9ac3f68e53c63dd902807cc9fbea63dace36c81643d776bcb120902e2",{slug:e}),t("ClipsFullVideoButton","d519a5a70419d97a3523be18fe6be81eeb93429e0a41c3baa9441fc3b1dffebf",{slug:e})])}).then(c=>c.json());console.log(n);const[r,o,l,i,s,a]=n;return r.data.clip?{kind:"video",source:{kind:"video",sources:r.data.clip.videoQualities.map(c=>({url:c.sourceURL+"?sig="+encodeURIComponent(r.data.clip.playbackAccessToken.signature)+"&token="+encodeURIComponent(r.data.clip.playbackAccessToken.value),quality:c.quality+"p"}))},caption:i.data.clip.title,gifv:!1}:{kind:"richtext",content:[V.p(V.txt("The clip could not be found."))]}}function id(e,t,n){const r=new URLSearchParams(t),o=el("div"),l=Jc(e,{autoplay:n.autoplay},r);l.node.adto(o);const i=A(o);return i.on("hide",()=>l.onhide?.()),i.on("show",()=>l.onshow?.()),i}function sd(e,t){const n=el("div"),r=A(n),o=nt().adto(n);return fetch("https://api.imgur.com/3/"+e+"/"+t,{headers:{Authorization:"Client-ID 6ccf617dc7a8830",Accept:"application/json"}}).then(l=>l.json()).then(l=>{const i=l;if(console.log("imgur result",i),i.success){const s={kind:"gallery",images:("images"in i.data?i.data.images:[i.data]).map(a=>{const c=a.animated&&a.mp4!=null?{kind:"video",source:{kind:"video",sources:[{url:a.mp4,quality:a.width+"\xD7"+a.height}]},aspect:a.width/a.height,gifv:a.looping,caption:a.description}:{kind:"captioned_image",caption:a.description,url:a.link,w:a.width,h:a.height};return{thumb:"https://i.imgur.com/"+a.id+"t.jpg",aspect:a.width/a.height,body:c}})};ie(s,{autoplay:!1}).defer(r).adto(n),o.remove()}else console.log(i),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur: "+(location.hostname==="localhost"?"Imgur does not work on localhost. Follow the instructions in CONTRIBUTING.md to fix. Imgur said: "+i.data.error:i.data.error)))}).catch(l=>{console.log(l),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur : "+l.toString()))}),r}function nr(e){const t=el("button").clss("block").adch(e);return t.onclick=n=>{n.preventDefault(),n.stopPropagation(),t.disabled=!0,Y(()=>import("./gallery.b795e990.js"),["assets/gallery.b795e990.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(r=>{const o=e.naturalWidth/e.naturalHeight,l=A();t.style.opacity="0",r.showGallery([{thumb:e.src,aspect:o,body:{kind:"captioned_image",w:e.naturalWidth,h:e.naturalHeight,url:e.src}}],0,()=>{const i=t.getBoundingClientRect();return{x:i.left,y:i.top+(window.pageYOffset??document.documentElement.scrollTop),w:i.height*o}},{onclose:()=>{t.disabled=!1,t.style.opacity="1"},setIndex:()=>{}}).defer(l)}).catch(r=>{console.log(r),t.disabled=!1,alert(r.toString())})},t}function Ho(e,t){const n=el("img").clss("image-loading").attr({src:e,width:t.w!=null?`${t.w}`:void 0,height:t.h!=null?`${t.h}`:void 0,alt:t.alt,title:t.alt});return n.onload=()=>n.classList.remove("image-loading"),n.onerror=()=>n.classList.remove("image-loading"),n}function ad(e,t){return nr(Ho(e,t).clss("preview-image"))}function cd(e,t){const n=A();ie(e.bio,{autoplay:!1}).defer(n).adto(t);const r=el("div").adto(t);for(const o of e.actions)r.atxt(" "),be(o,r,{value_for_code_btn:e}).defer(n);return r.atxt(" "),I("code-button").adto(r).atxt("Code").onev("click",o=>{o.stopPropagation(),console.log(e)}),n}function dd(e){return e<1e4?""+e:e<1e5?(e/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"k":e<1e6?(e/1e3|0)+"k":e<1e8?(e/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"m":(e/1e6|0)+"m"}function ud(e,t,n){{let r="none";const o=I("action-button").atxt(e.text).adto(t),l=A();let i;l.on("cleanup",()=>{i&&i.cleanup()}),l.on("hide",()=>{i&&i.setParentVisible(!1)}),l.on("show",()=>{i&&i.setParentVisible(!0)});const s=()=>{if(r==="none"){if(i){const a=i.associated_data;i.cleanup(),a.remove(),i=void 0}o.disabled=!1}else if(!i){const a=el("div").adto(t);i=A(a),me(a,()=>u(Wo,{action:e,onCancel:()=>{r="none",s()},onAddReply:c=>{console.log("Got response",c),r="none",s();const d=el("div").adto(t);me(d,()=>(()=>{const f=Kc.cloneNode(!0);return g(f,u(Do,{get content(){return c.content},get opts(){return{clickable:!1,at_or_above_pivot:!1,is_pivot:!1,frame:c,client_id:c.client_id,replies:c.replies}}})),f})(),{color_level:1}).defer(l)}}),{color_level:1}).defer(i)}};return o.onev("click",a=>{a.stopPropagation(),r==="none"&&(r="some"),s()}),s(),l}}function be(e,t,n){if(e.kind==="link")return q(e.client_id,e.url,"action-button").atxt(e.text).adto(t),A();if(e.kind==="reply"){const r=A();return ud(e,t).defer(r),r}else if(e.kind==="counter"){const r=A();return Go(e,t,{parens:!0}).defer(r),r}else if(e.kind==="delete"){const r=el("span").adto(t),o=el("span").adto(t),l=el("span").adto(t),i=el("span").adto(t),s=el("span").adto(t),a=I("action-button").atxt("Delete").adto(r);o.atxt("Are you sure? ");const c=I("unsafe-action-button").atxt("Delete").adto(o);o.atxt(" / ");const d=I("safe-action-button").atxt("Cancel").adto(o);s.atxt("Deleting\u2026"),l.atxt("Deleted!");const f=h=>{r.style.display=h==="none"?"":"none",o.style.display=h==="confirm"?"":"none",l.style.display=h==="deleted"?"":"none",s.style.display=h==="load"?"":"none",i.style.display=typeof h!="string"?"":"none",typeof h!="string"&&(r.style.display="",i.innerHTML="",i.adch(el("span").clss("error").atxt(h.error)))};return f("none"),a.onev("click",h=>{h.stopPropagation(),f("confirm")}),c.onev("click",h=>{h.stopPropagation(),f("load"),ge(e.client_id).act(e.data).then(m=>{f("deleted")}).catch(m=>{console.log("Got error:",m),f({error:m.toString()})})}),d.onev("click",h=>{h.stopPropagation(),f("none")}),A()}else if(e.kind==="report"){const r=ge(e.client_id),o=A();let l;const i=I("action-button").atxt("Report").adto(t).onev("click",s=>{if(s.stopPropagation(),!l)i.setAttribute("class",J["action-button-active"]),l=fd(r,e.data),l.associated_data.adto(t);else{i.setAttribute("class",J["action-button"]);const a=l.associated_data;l.cleanup(),a.remove(),l=void 0}});return o}else if(e.kind==="login"){const r=ge(e.client_id),o=el("span").adto(t),l=A(),i=e.data,s=I("action-button").atxt("Log In").adto(o).onev("click",a=>{a.stopPropagation(),s.textContent="\u2026",s.disabled=!0,r.getLoginURL(i).then(c=>{o.innerHTML="",q(r.id,c,"pill-filled").atxt("Log In").adto(o)}).catch(c=>{s.textContent="Retry",o.atxt("Error:"+c),console.log(c),s.disabled=!1})});return l}else if(e.kind==="act"){const r=ge(e.client_id),o=el("span").adto(t),l=I("action-button").atxt(e.text).adto(o).onev("click",i=>{i.stopPropagation(),l.disabled=!0,l.textContent="\u2026",r.act(e.action).then(()=>{l.remove(),txt("\u2713").adto(o)}).catch(s=>{console.log("got error: "+s),l.disabled=!1,o.adch(el("span").clss("error").atxt(s.toString()))})});return A()}else{if(e.kind==="flair")return A();if(e.kind==="code"){const r=A();let o;const l=I("action-button").atxt("Code").adto(t).onev("click",i=>{if(i.stopPropagation(),console.log(n.value_for_code_btn),!o)l.setAttribute("class",J["action-button-active"]),o=ie(e.body,{autoplay:!0}),o.associated_data.adto(t);else{l.setAttribute("class",J["action-button"]);const s=o.associated_data;o.cleanup(),s.remove(),o=void 0}});return r}else ce(e)}}function Fo(e,t,n){const r=el("details").clss("report-item"),o=A(r);r.adch(el("summary").attr({draggable:"true"}).atxt(t.title));const l=el("div").clss("report-content").adto(r);switch(t.description&&ie(t.description,{autoplay:!1}).defer(o).adto(l),t.report.kind){case"submit":case"textarea":{const i=t.report.kind==="textarea"?el("textarea").adto(el("div").adto(l)):void 0;let s="none";const a=I("pill-filled").adto(l),c=txt("\u2026").adto(a),d=el("div").adto(l),f=()=>{s==="none"?(c.nodeValue="Send Report",a.disabled=!1):s==="load"?(c.nodeValue="\u2026",a.disabled=!0):(c.nodeValue="Retry",a.disabled=!1,d.adch(el("div").clss("error").atxt("Error: "+s.error)))};f();const h=t.report.data;a.onev("click",m=>{m.stopPropagation(),s="load",f(),e.sendReport(h,i?.value).then(v=>{n(v)}).catch(v=>{console.log(v),s={error:v.toString()},f()})})}break;case"link":q(e.id,t.report.url,"normal").atxt(t.report.text).adto(l);break;case"more":{const i=el("div").adto(l);for(const s of t.report.screens)Fo(e,s,n).defer(o).adto(i)}break;default:ce(t.report)}return o}function fd(e,t){const n=el("div").clss("report-screen text-sm"),r=A(n);if(!e.fetchReportScreen)return n.atxt("Missing fetchreportscreen?"),n.clss("error"),console.log(e),r;const o=nt().adto(n);return e.fetchReportScreen(t).then(l=>{o.remove();const i=A(),s=r.addChild(i);for(const a of l)Fo(e,a,c=>{s.cleanup(),n.innerHTML="",n.atxt("Report sent!"),console.log("Completed report",c);const d=rr().adto(n);d.adch(el("div").atxt(c.title)),ie(c.body,{autoplay:!1}).defer(r).adto(d),console.log(d,n,n.childNodes)}).defer(i).adto(n)}).catch(l=>{console.log("error loading report screen",l),n.adch(el("div").clss("error").atxt("Error loading: "+l.toString())),o.remove()}),r}function qo(e,t){const n=e??`${Math.random()}`,r=ut.get(n)??{state:{loading:!1,pt_count:t.count,your_vote:t.you},handlers:new Set,users:0,update_time:t.time};ut.has(n)||ut.set(n,r),r.update_time<t.time&&(r.state.pt_count=t.count,r.state.your_vote=t.you);const o={state:r.state,emit(){[...r.handlers].forEach(i=>{i()})},onupdate(i){const s=()=>{i()};r.handlers.add(s),l.on("cleanup",()=>{r.handlers.delete(s)})}},l=A(o);return r.users++,l.on("cleanup",()=>{r.users--,r.users===0&&ut.delete(n)}),l}function hd(e){if(e.pt_count==="hidden"||e.pt_count==="none")return{text:"\u2014",raw:"[score hidden]"};const t=e.pt_count+(e.your_vote==="increment"?1:e.your_vote==="decrement"?-1:0);return{text:dd(t),raw:t.toLocaleString()}}function Go(e,t,n){const r=e.count_excl_you!=="none",o=el("span").clss("counter").adto(t),l=I("action-button").adto(o).clss("counter-increment-btn").attr({"aria-label":"Up"}),i=el("span").adto(l),s=txt("").adto(i),a=txt("\u2026").adto(i),c=el("span").adto(o.atxt(" ")).clss("counter-count"),d=txt("\u2026").adto(c),f=e.percent==null?txt("\u2014% upvoted"):txt(e.percent.toLocaleString(void 0,{style:"percent"})+" upvoted");let h;const m=A({percent_voted_txt:f,votecount:c}),{state:v,emit:y,onupdate:w}=qo(e.unique_id,{count:e.count_excl_you,you:e.you,time:e.time}).defer(m);w(()=>{const{text:k,raw:T}=hd(v);a.nodeValue={increment:e.increment.undo_label,decrement:e.decrement?.undo_label??"ERR",none:e.increment.label}[v.your_vote??"none"],d.nodeValue=n.parens?"("+k+")":k,r||(d.nodeValue=""),c.title=T,o.classList.remove("counted-increment","counted-decrement","counted-reset"),o.classList.add("counted-"+(v.your_vote??"reset")),o.classList.toggle("counted-loading",v.loading),l.disabled=v.loading,h&&(h.disabled=v.loading),l.setAttribute("class","counter-increment-btn "+J[v.your_vote==="increment"?e.incremented_style??"action-button":e.style??"action-button"]),h&&h.setAttribute("class","counter-decrement-btn "+J[v.your_vote==="decrement"?e.decremented_style??"action-button":e.style??"action-button"]),l.setAttribute("aria-pressed",v.your_vote==="increment"?"true":"false"),h&&h.setAttribute("aria-pressed",v.your_vote==="decrement"?"true":"false")}),y();const C=k=>{if("error"in e.actions)return alert("Error: "+e.actions.error);const T=ge(e.client_id),x=v.your_vote;v.your_vote=k,v.loading=!0,y();const b=e.actions[k??"reset"];if(b==null)throw new Error("downvote label available but downvote action not provided");T.act(b).then(()=>{v.your_vote=k,v.loading=!1,y()}).catch($=>{v.your_vote=x,v.loading=!1,y(),console.log($),alert("Got error: "+$)})};return e.decrement!=null&&(s.nodeValue="\u2BC5 ",o.atxt(" "),h=I("action-button").adch(el("span").atxt("\u2BC6")).attr({"aria-label":"Down"}).adto(o).onev("click",k=>{k.stopPropagation(),v.your_vote==="decrement"?C(void 0):C("decrement")}).clss("counter-decrement-btn")),l.onev("click",k=>{k.stopPropagation(),v.your_vote==="increment"?C(void 0):C("increment")}),m}function Pt(e,t,n){const[r,o]=$o(ko(n.toLowerCase()));return q(e,t,"userlink").styl({"--light-color":zt(r),"--dark-color":zt(o)})}function gd(e){let t=e;const n=[];return{get value(){return t},set value(r){t=r,n.forEach(o=>o())},watch(r){const o=A(),l=()=>{r()};return n.push(l),o.on("cleanup",()=>n.splice(n.indexOf(l),1)),o}}}function mn(e,t,n){const r=A(t);for(const o of e)o.watch(()=>n(t)).defer(r);return n(t),r}function Ft(e){const t=el("div"),n=A(t),r=el("div").adto(t),o=s=>{const a=el("div");for(const c of s)c.action.kind==="link"?q(c.action.client_id,c.action.url,"none").clss("text-gray-600 dark:text-gray-400 hover:text-gray-900").adto(a).atxt(c.text):c.action.kind==="menu"?I("none").adto(a).atxt(c.text+" \u25B8").onev("click",d=>{d.stopPropagation(),d.preventDefault(),alert("TODO submenus")}).adto(a):c.action.kind==="show-line-two"?I("none").adto(a).atxt(c.text).onev("click",d=>{d.stopPropagation(),d.preventDefault(),alert("TODO submenu show-line-two")}).adto(a):ce(c.action);return a};let l;n.on("cleanup",()=>{l&&(l.cleanup(),l=void 0)});const i=gd(e.find(s=>s.selected));i.watch(()=>{l&&(l.cleanup(),l.associated_data.remove(),l=void 0)});for(const s of e){if(s.action.kind==="menu"){const a=txt("\u2026");let c=!1,d;const f=s.action.children;n.on("hide",()=>{console.log("open menu was asked to be hidden"),c=!1,h()});const h=()=>{if(a.nodeValue=c?"\u25B4":"\u25BE",y.attr({"aria-expanded":c?"true":"false"}),c){if(!d){d=o(f).clss("absolute z-10 flex flex-col shadow bg-gray-100 p-3 rounded w-max max-w-7xl").adto(ue);const w=m.getBoundingClientRect();d.styl({left:w.left+"px",top:w.bottom+(window.pageYOffset??document.documentElement.scrollTop)+"px"})}}else d&&(d.remove(),d=void 0)},m=el("span").adto(r),v=w=>{if(c){console.log("Got event: ",w.target);let C=w.target;for(;C;){if(C===m||d&&C===d)return;C=C.parentElement}c=!1,h()}};document.addEventListener("click",v,{capture:!0}),n.on("cleanup",()=>document.removeEventListener("click",v,{capture:!0}));const y=I("none").attr({"aria-haspopup":"true"}).atxt(s.text).atxt(" ").adch(a).adto(m).onev("click",w=>{w.preventDefault(),w.stopPropagation(),c=!c,h()});mn([i],0,()=>{y.setAttribute("class",gn(s===i.value))}).defer(n),h()}else if(s.action.kind==="link"){const a=q(s.action.client_id,s.action.url,"none").atxt(s.text).adto(r);mn([i],0,()=>{a.setAttribute("class",gn(s===i.value))}).defer(n)}else if(s.action.kind==="show-line-two"){const a=s.action,c=I("none").atxt(s.text).adto(r);mn([i],0,()=>{if(c.setAttribute("class",gn(s===i.value)),s===i.value){if(l)throw new Error("already existing menu_l2");l=Ft(a.children),l.defer(n),l.associated_data.clss("mt-2").adto(t)}}).defer(n),c.onev("click",d=>{d.stopPropagation(),i.value=s})}else ce(s.action);txt(" ").adto(r)}return n}function md(e,t){const n=A();if(t.clss("subreddit-banner"),e.banner){const a="absolute top-0 left-0 right-0 w-full max-h-full",c="w-full min-h-270px object-cover object-center sm:object-top",d="absolute left-0 right-0 bottom-0 header-gradient ";e.banner.kind==="image"?(nr(el("img").clss(c).attr({src:e.banner.desktop})).clss(a).adto(t).adch(el("div").clss(d+"top-150px")),el("div").clss("h-150px").adto(t)):e.banner.kind==="color"?el("div").adch(el("div").clss(c+" h-full").styl({"background-color":e.banner.color})).clss(a).adto(t).adch(el("div").clss(d+" top-0")):ce(e.banner)}const r=el("div").clss("subreddit-banner-content").adto(t);e.icon&&el("img").clss("sub-icon-img drop-shadow").attr({alt:"",src:e.icon.url}).adto(r);const o=el("div").clss("subreddit-title-area").adto(r);e.name.display!=null&&el("h1").atxt(e.name.display).clss("text-lg").adto(o),el("h2").atxt(e.name.link_name).clss("text-gray-500").adto(o);const l=el("div").clss("sub-subscribe-area").adto(r);if(e.subscribe){const a=el("div").adto(l);be(e.subscribe,a,{value_for_code_btn:e}).defer(n)}e.body&&ie(e.body,{autoplay:!1}).defer(n).adto(l);const i=el("div").clss("relative").adto(t);e.menu&&Ft(e.menu).defer(n).adto(el("div").clss("my-3").adto(i));const s=el("div").adto(i);if(e.more_actions)for(const a of e.more_actions)be(a,s,{value_for_code_btn:e}).defer(n);return I("action-button").atxt("Code").adto(s).onev("click",a=>{a.stopPropagation(),console.log(e)}),n}function vd(e,t,n){const r=A();n.clss("widget");const o=el("div").adto(n);txt(t.title).adto(el("div").adto(o).clss("widget-header font-bold text-base mb-2 text-gray-500"));const l=el("div").clss("widget-content").adto(o);if(t.actions_top){const s=el("div").clss("widget-actions-top").adto(l);for(const a of t.actions_top)be(a,s,{value_for_code_btn:t}).defer(r)}const i=t.widget_content;if(i.kind==="list"){const s=el("ul").clss("widget-list list-disc").adto(l);for(const a of i.items){const c=el("li").adto(s);let d;if(a.click.kind==="body"){c.clss("list-none");const h=el("details").adto(c);d=el("summary").attr({draggable:"true"}).adto(h),ie(a.click.body,{autoplay:!1}).defer(r).adto(h)}else c.clss("ml-4"),d=c;a.icon!=null&&el("div").adto(d).clss("widget-list-icon").styl({"--background-image-url":"url("+a.icon+")"});let f;if(a.name.kind==="text"?f=txt(a.name.text):a.name.kind==="flair"?(f=el("span"),Je([a.name.flair]).adto(f)):a.name.kind==="username"?f=txt(a.name.username):a.name.kind==="image"?f=el("img").clss("w-fill h-auto").attr({src:a.name.src,alt:a.name.alt,width:`${a.name.w}`,height:`${a.name.h}`}):ce(a.name),a.click.kind==="link"?a.name.kind==="username"?Pt(e.id,a.click.url,a.name.username).atxt(a.name.username).adto(d):q(e.id,a.click.url,"normal").adch(f).adto(d):el("span").adch(f).adto(d),a.action){const h=el("span").adto(d).atxt(" ");be(a.action,h,{value_for_code_btn:a}).defer(r)}}}else if(i.kind==="community-details")el("p").atxt(i.description).adto(l);else if(i.kind==="body")ie(i.body,{autoplay:!1}).defer(r).adto(l);else if(i.kind==="iframe"){const s=el("div");n.replaceChild(s,o),n.clss("widget-fullscreen-content");const a=el("iframe").adto(s).styl({width:"312px"}).attr({width:"312",height:i.height,srcdoc:i.srcdoc});a.onload=()=>{if(!a.contentWindow)return console.log("no content window");a.style.height=a.contentWindow.document.body.scrollHeight+20+"px"}}else if(i.kind==="image"){const s=el("div");n.clss("widget-fullscreen-content"),n.replaceChild(s,o);const a=Ho(i.src,{w:i.width,h:i.height}).clss("w-full h-auto");i.link_url!=null?q(e.id,i.link_url,"none").adch(a).adto(s):nr(a).adto(s)}else ce(i);if(t.actions_bottom){const s=el("div").clss("widget-actions-bottom").adto(l);for(const a of t.actions_bottom)be(a,s,{value_for_code_btn:t}).defer(r)}return el("div").adto(l).adch(I("code-button").atxt("Code").onev("click",s=>{s.stopPropagation(),console.log(t)})),r}function De(e,t,n){const r=rr(),o=A(r);try{if(t.kind==="user-profile")return cd(t,r).defer(o),o;if(t.kind==="bio")return md(t,r).defer(o),o;if(t.kind==="widget")return vd(e,t,r).defer(o),o;if(t.kind==="thread")return or(e,t,r,n).defer(o),o;ce(t)}catch(l){return o.cleanup(),console.log("Got error",l),r.innerHTML="",r.adch(el("pre").adch(el("code").atxt(l.toString()+`

`+l.stack))),r.adch(I("code-button").atxt("Code").onev("click",i=>{i.stopPropagation(),console.log(t)})),A(r)}}function rr(){return el("div").clss("post text-sm")}function or(e,t,n,r){let o,l,i,s,a,c,d;r.clickable&&t.link.startsWith("/")&&n.clss("hover-outline").attr({tabindex:"0"}).onev("click",b=>{if(!fo(b.target,n))return;b.stopPropagation();const $="/"+e.id+t.link;b.ctrlKey||b.metaKey||b.altKey?window.open($):rt({path:$})});const h=A({addChildren:void 0});if(t.layout==="reddit-post"){o=el("div").adto(n).clss("post-voting"),l=el("button").adto(n).clss("post-thumbnail");const b=el("div").adto(n).clss("post-titles");i=el("div").adto(n).clss("post-preview"),s=el("div").adto(n).clss("post-replies"),a=el("div").adto(b).clss("post-content-title text-base"),c=el("div").adto(b).clss("post-content-subminfo"),d=el("div").adto(b).clss("post-content-buttons")}else t.layout==="reddit-comment"||t.layout==="mastodon-post"?(o=el("div").adto(n).clss("post-voting"),a=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),c=el("div").adto(n).clss("post-content-subminfo text-xs"),i=el("div").adto(n).clss("post-preview"),d=el("div").adto(n).clss("post-content-buttons text-xs"),s=el("div").adto(n).clss("post-replies")):t.layout==="error"?(o=el("div").adto(n).clss("post-voting"),a=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),c=el("div").adto(n).clss("post-content-subminfo"),i=el("div").adto(n).clss("post-preview"),d=el("div").adto(n).clss("post-content-buttons"),s=el("div").adto(n).clss("post-replies")):ce(t.layout);if(t.thumbnail||l.clss("no-thumbnail"),t.layout==="reddit-comment"||t.layout==="mastodon-post"){const[b,$]=P(t.default_collapsed);U(()=>{const O=b();n.classList.toggle("comment-collapsed",O),h.setVisible(!O)});const N=el("div").clss("collapse-btn !px-0");n.insertBefore(N,n.childNodes[0]??null);const S=me(N,()=>u(Jn,{class:"h-full",get collapsed_raw(){return b()},get collapsed_anim(){return b()},onClick:()=>{const O=n.getBoundingClientRect(),M=qt.getBoundingClientRect(),ne=()=>5+Math.max(0,M.bottom,window.visualViewport.offsetTop),ae=window.visualViewport.offsetTop+window.visualViewport.height;console.log(ne(),ae,O.top),O.top<ne()&&O.bottom>ne()&&(n.scrollIntoView(),document.documentElement.scrollTop-=ne()),$(we=>!we)},real:!0}),{color_level:1});h.addChild(S)}n.clss("layout-"+t.layout),(t.layout==="reddit-comment"||t.layout==="mastodon-post")&&n.clss("layout-commentlike"),t.flair&&(a.adch(Je(t.flair.filter(b=>b.content_warning))),a.atxt(" ")),t.title&&(r.clickable?a.adch(q(e.id,t.link,"none").clss("hover:underline").atxt(t.title.text)):a.adch(txt(t.title.text))),t.flair&&(a.atxt(" "),a.adch(Je(t.flair.filter(b=>!b.content_warning))));let m=(t.flair??[]).filter(b=>b.content_warning),v=null;if(t.layout==="reddit-post"&&t.info)t.info.time!==!1&&(c.adch(st(t.info.time).defer(h)),c.atxt(" ")),t.info.author&&c.atxt("by ").adch(Pt(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&c.adch(Je(t.info.author.flair)),t.info.in&&c.atxt(" in ").adch(q(e.id,t.info.in.link,"normal").atxt(t.info.in.name)),t.info.edited!==!1&&(c.hasChildNodes()&&c.atxt(", "),c.atxt("Edited ").adch(st(t.info.edited).defer(h))),t.info.pinned&&(c.hasChildNodes()&&c.atxt(", "),c.adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")));else if((t.layout==="reddit-comment"||t.layout==="mastodon-post")&&t.info){if(t.layout==="reddit-comment"&&t.info.author?.pfp){const b=el("img").attr({src:t.info.author.pfp.url}).adto(c).clss("w-8 h-8 object-center inline-block rounded-full cfg-reddit-pfp");b.title="Disable in settings (thread.pfg.pw/settings)",c.atxt(" ")}if(t.info.author&&c.adch(Pt(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&c.adch(Je(t.info.author.flair)),t.layout==="mastodon-post"&&t.info.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp").styl({"--url":"url("+JSON.stringify(t.info.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.author.pfp.hover)+")"}).adto(o)),v=document.createComment("").adto(c),t.info.time!==!1){const b=el("span").adch(st(t.info.time).defer(h));c.atxt(" ").adch(b)}t.info.edited!==!1&&c.atxt(", Edited ").adch(st(t.info.edited).defer(h)),t.info.pinned&&c.atxt(", ").adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")),t.info.reblogged_by&&(c.atxt(" \u2190 Boosted by "),t.info.reblogged_by.author&&c.adch(Pt(e.id,t.info.reblogged_by.author.link,t.info.reblogged_by.author.color_hash).atxt(t.info.reblogged_by.author.name)),t.info.reblogged_by.time!==!1&&c.atxt(" at ").adch(st(t.info.reblogged_by.time).defer(h)),t.layout==="mastodon-post"&&t.info.reblogged_by.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp","pfp-reblog").styl({"--url":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.hover)+")"}).adto(o)))}{if(t.thumbnail)if(t.thumbnail.kind==="image")l.adch(el("img").attr({src:t.thumbnail.url,alt:""})),m.length&&l.clss("thumbnail-content-warning");else if(t.thumbnail.kind==="default"){const N={self:"self",default:"default",image:"image",spoiler:"spoiler",nsfw:"nsfw",account:"account",error:"error"}[t.thumbnail.thumb];l.adch(el("div").clss("thumbnail-builtin","thumbnail-"+N))}else ce(t.thumbnail);const b=(N,S)=>{const O=el("div").clss("post-body"),M=A(O);if(m.length){const ne=m,ae=el("div").adto(O);return ae.atxt("Content Warning"+(ne.length===1?"":"s")+": "),ae.adch(Je(ne)),ae.atxt(" "),I("pill-filled").adto(ae).atxt("Show Content").onev("click",we=>{we.stopPropagation(),ae.remove(),m=[],l.classList.remove("thumbnail-content-warning"),ie(N,{...S}).defer(M).adto(O)}),M}return ie(N,{...S}).defer(M).adto(O),M},$=N=>N.kind==="none"?!0:N.kind==="array"?N.body.every(S=>S==null?!0:$(S)):!1;if($(t.body))i.remove();else if(t.display_mode.body==="collapsed"){const N=I("outlined-button").adto(d),S=txt("\u2026").adto(N);let O;h.on("cleanup",()=>{O&&O.cleanup()}),h.on("hide",()=>{O&&O.setVisible(!1)}),h.on("show",()=>{O&&O.setVisible(!0)});let M=t.display_mode.body_default==="open";const ne=!M,ae=()=>{M&&!O?(O=b(t.body,{autoplay:ne}),O.associated_data.adto(i)):!M&&O&&(O.cleanup(),O.associated_data.remove(),O=void 0),S.nodeValue=M?"Hide":"Show"};ae(),N.onev("click",we=>{we.stopPropagation(),M=!M,ae()}),l.onev("click",we=>{we.stopPropagation(),M=!M,ae()})}else b(t.body,{autoplay:!1}).defer(h).adto(i)}let y=!1;for(const b of t.actions)if(b.kind==="counter"&&b.special==="reddit-points"){n.clss("spacefiller-redditpoints");const $=Go(b,o,{parens:!1}).defer(h);if(t.layout==="reddit-comment")c.insertBefore(txt(" "),v),c.insertBefore($.votecount,v),c.insertBefore(txt(" points"),v);else if(t.layout==="reddit-post"){c.atxt(", "),$.percent_voted_txt.adto(c),o.clss("desktop-only"),d.atxt(" ");const N=el("div").clss("mobile-only").adto(d);be(b,N,{value_for_code_btn:t}).defer(h)}}else b.kind==="code"&&(y=!0),d.atxt(" "),be(b,d,{value_for_code_btn:t}).defer(h);o.childNodes.length===0&&o.remove(),t.actions.length===0&&(d.atxt(" "),q(e.id,t.link,"action-button").atxt("View").adto(d)),y||(d.atxt(" "),I("code-button").onev("click",b=>{b.stopPropagation(),console.log(t)}).atxt("Code").adto(d));const w=el("ul").clss("replies").styl({margin:"0"}).adto(s),C=t.replies?.length===1&&t.replies[0].replies?.length===1;let k;const T=b=>{if(C&&b.length>1){if(!k)throw new Error("threaded comment has no lastElemAddChildren");k(b);return}b.forEach($=>x($))},x=b=>{const $=el("li").adto(w);if(C&&$.clss("relative threaded"),b.kind==="load_more"){Tn(e,b,T,()=>$.remove()).adto($);return}let N;C&&b.replies?.length===1&&(N=b.replies[0],b.replies=[]),$.clss("comment");const S=rr();k=or(e,b,S,{clickable:r.clickable}).defer(h).addChildren,S.adto($),N&&x(N)};return t.replies&&(t.display_mode.comments==="collapsed"||T(t.replies)),h.associated_data.addChildren=T,h}const J={none:"",normal:"text-blue-600 dark:text-blue-500 underline",previewable:"text-blue-600 dark:text-blue-500 hover:underline","action-button":"p-1 rounded hover:bg-gray-200","action-button-active":"p-1 rounded bg-gray-200 hover:bg-gray-300","save-button-saved":"text-green-600 dark:text-green-500 hover:underline","safe-action-button":"text-blue-600 dark:text-blue-500 hover:underline","unsafe-action-button":"text-red-600 dark:text-red-500 hover:underline","code-button":"text-gray-600 dark:text-gray-500 hover:underline","load-more":"text-blue-600 dark:text-blue-500 hover:underline text-base",userlink:"text-$light-color dark:text-$dark-color hover:underline","pill-empty":"text-sm border-2 border-black text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-transparent":"text-sm border-2 border-transparent text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-filled":"text-sm border-2 border-black bg-black text-white hover:text-black hover:bg-transparent p-1 px-3 rounded-full transition-colors","outlined-button":"border border-gray-600 dark:border-gray-500 px-2",error:"text-red-600 dark:text-red-500 hover:underline"},Pn=e=>[J[e]];function I(e){return el("button").clss(...Pn(e)).attr({draggable:"true"})}function nt(){return el("div").clss("lds-ripple").adch(el("div")).adch(el("div"))}function Tn(e,t,n,r){const o=el("div"),l=()=>q(e.id,t.url,"load-more",{onclick:()=>{const s=el("div").adto(o);s.adch(el("span").atxt("Loading\u2026")),s.adch(nt()),i.remove(),i=s;const a=i;e.loadMore(t.load_more).then(c=>{a.remove(),n(c),r()}).catch(c=>{console.log("error loading more:",c),a.parentNode&&a.remove(),i=el("span").atxt("Error. ").adch(l().atxt("\u{1F5D8} Retry")).adto(o)})}});let i=l().atxt(t.count!=null?"Load "+t.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more");return o.atxt(" "),I("code-button").onev("click",s=>{s.stopPropagation(),console.log(t)}).atxt("Code").adto(o),o}function pd(e,t,n,r){const o=el("div"),l=a=>q(e.id,a.url,"load-more",{onclick:()=>{const c=el("div").adto(o);c.adch(el("span").atxt("Loading\u2026")),c.adch(nt()),s&&s.remove(),s=c,e.loadMoreUnmounted(a.load_more_unmounted).then(d=>{s&&s.remove(),n(d.children),d.next?i(d.next):r()}).catch(d=>{console.log("error loading more:",d),s&&s.parentNode!=null&&s.remove(),s=el("span").atxt("Error. ").adch(l(a).atxt("\u{1F5D8} Retry")).adto(o)})}}),i=a=>{s=el("div").adch(l(a).atxt(a.count!=null?"Load "+a.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more")).atxt(" ").adch(I("code-button").onev("click",c=>{c.stopPropagation(),console.log(a)}).atxt("Code")).adto(o)};let s;return i(t),o}function Ko(e,t){let n=e.visible;e.on("hide",()=>n=!1),e.on("show",()=>{n=!0,document.title=r(o)});const r=i=>i+" | "+t+" | ThreadClient";let o="\u2026";const l={setTitle(i){o=i,n&&(document.title=r(i))}};return l.setTitle("\u2026"),l}function bd(e,t){const n=q(e.id,t.url,"action-button"),r=A(n),o=el("span").adto(n),l=txt("\u2026 ").adto(o);return o.atxt(t.name),e.hydrateInbox(t.hydrate).then(i=>{i.messages.kind==="zero"?l.nodeValue="":i.messages.kind==="exact"?l.nodeValue=i.messages.value+" ":i.messages.kind==="minimum"&&(l.nodeValue=i.messages.min+"+ "),i.messages.kind!=="zero"&&o.classList.add({green:"text-green-500",orange:"text-orange-500"}[t.active_color])}).catch(i=>{l.nodeValue="\uFFFD "}),r}const Le=()=>el("div").clss("object-wrapper-csshack","m-3 p-3 shadow-md sm:rounded-xl <sm:mx-0",Vt[0]);function Yo(e,t,n,r){const o=A();r.setTitle(t.title),n.classList.add("display-"+t.display_style);const l=el("div").adto(n).clss("navbar-area");for(const c of t.navbar.actions)be(c,l,{value_for_code_btn:t}).defer(o),txt(" ").adto(l);const i=[{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Report Issue"},{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Feature Request"}];for(const c of i)be(c,l,{value_for_code_btn:t}).defer(o),l.atxt(" ");I("code-button").atxt("Code").adto(l).onev("click",()=>console.log(t)),txt(" ").adto(l);for(const c of t.navbar.inboxes)bd(e,c).defer(o).adto(l),txt(" ").adto(l);const s=el("div").adto(n).clss("header-area"),a=el("div").adto(n).clss("content-area");if(t.sidebar){I("pill-filled").adto(n).clss("sidebar-toggle-mobile","my-1").atxt("Toggle Sidebar").onev("click",d=>{d.stopPropagation(),c.classList.toggle("sidebar-visible-mobile")});const c=el("div").adto(n).clss("sidebar-area");for(const d of t.sidebar)De(e,d,{clickable:!1}).defer(o).adto(Le().adto(c))}if(t.body.kind==="listing"){De(e,t.body.header,{clickable:!1}).defer(o).adto(Le().adto(s)),t.body.menu&&Ft(t.body.menu).defer(o).adto(Le().adto(a));const c=el("div").adto(a),d=h=>{for(const m of h)f(m)},f=h=>{if(h.parents.length===0){el("div").clss("error").atxt("unmounted.parents.length === 0").adto(Le().adto(c));return}const m=Le().adto(c);for(const v of h.parents)if(v.kind==="load_more"){const y=el("div").adto(m);q(e.id,v.url,"load-more").atxt("Load More").adto(y),y.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"))}else De(e,v,{clickable:!0}).defer(o).adto(m);if(h.replies.length>0){let v;const y=I("previewable").adto(m).atxt("Replies \u25B8").onev("click",w=>{if(w.stopPropagation(),v)v.cleanup(),v.associated_data.remove(),v=void 0,y.textContent="Replies \u25B8";else{y.textContent="Replies \u25BE";const C=el("div").adto(m),k=A(C);v=k;const T=b=>{for(const $ of b)x($)},x=b=>{if(b.kind==="load_more"){const $=Tn(e,b,T,()=>$.remove());$.adto(C);return}De(e,b,{clickable:!1}).defer(k).adto(C)};T(h.replies)}})}};if(d(t.body.items),t.body.next){const h=pd(e,t.body.next,d,()=>h.remove());h.adto(a)}}else if(t.body.kind==="one"){const c=Le().adto(s);for(const h of t.body.item.parents){if(h.kind==="load_more"){const v=c;q(e.id,h.url,"load-more").atxt("Load More").adto(v),v.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"));continue}const m=h===t.body.item.parents[t.body.item.parents.length-1];De(e,h,{clickable:!m}).defer(o).adto(c)}t.body.item.menu&&Ft(t.body.item.menu).defer(o).adto(Le().adto(a));const d=h=>{for(const m of h)f(m)},f=h=>{if(h.kind==="load_more"){const m=Tn(e,h,d,()=>m.remove());m.adto(a).clss("top-level-load-more");return}De(e,h,{clickable:!1}).defer(o).adto(Le().adto(a))};d(t.body.item.replies),t.body.item.replies.length===0&&el("div").atxt("*There are no replies*").adto(a)}else ce(t.body);return o}function _d(e,t){const n=el("div").clss("client-wrapper"),r=A(n),o=el("div").adto(n);o.classList.add("client-main-frame");const l=el("div").adto(o);l.classList.add("display-loading"),l.adch(nt());const i=Ko(r,e.id);return i.setTitle("Loading "+e.id+"\u2026"),(async()=>{if(!e.getThread||e.getPage&&X().pageVersion()==="2"){const a={page:await e.getPage(t)};l.remove(),r.visible&&_t(a,!0),r.on("hide",()=>lr()),r.on("show",()=>_t(a,!1))}else{const s=await e.getThread(t);l.remove(),Yo(e,s,o,i).defer(r)}})().catch(s=>{console.log(s,s.stack??"*no stack*"),l.parentNode&&l.remove(),el("div").atxt("Error! "+s+", check console.").clss("error").adto(o)}),r}let _t,lr;{const[e,t]=P(null,{equals:(o,l)=>!1});let n=!1;const r=()=>{n||(n=!0,me(Tt,()=>u(Xt,{data:e,get children(){return u(xi,{get pgin(){return e()},addContent:(o,l)=>{o.page={...o.page,content:{...o.page.content,...l}},e()===o&&t(e())},get children(){return D(()=>{const o=qc({get pivot(){return e().page.pivot}});return U(()=>{document.title=o.title+" | ThreadClient"}),()=>o.children})}})}}),{color_level:0}))};_t=(o,l)=>{console.log("showing page2",o.page),Tt.style.display="",t(o),console.log("SHOWPAGE2 CALLED ON",o),r(),l&&(document.querySelector(".\\@\\@IS_PIVOT\\@\\@")??document.body).scrollIntoView()},lr=()=>{Tt.style.display="none"}}function An(e){const t=document.createElement("div"),n=A(t);return t.appendChild(document.createTextNode(e)),n}function yd(e,t,n){const r=document.createElement("div"),o=A(r);return r.atxt("\u2026"),(async()=>{r.innerHTML="",r.atxt("Logging In\u2026");try{await e.login(t,n)}catch(l){console.log(l),r.innerHTML="",r.adch(el("div").clss("error").atxt("Login error! "+l.toString()));return}r.innerHTML="",r.atxt("Logged In! You may now close this page.")})().catch(l=>{console.log(l),alert("Unexpected error "+l.toString())}),o}const xd={reddit:()=>Y(()=>import("./reddit.490232fc.js"),["assets/reddit.490232fc.js","assets/base.50b98d34.js"]).then(e=>e.client),mastodon:()=>Y(()=>import("./mastodon.ca5f1837.js"),["assets/mastodon.ca5f1837.js","assets/base.50b98d34.js"]).then(e=>e.client),hackernews:()=>Y(()=>import("./hackernews.bac5cf05.js"),[]).then(e=>e.client),test:()=>Y(()=>import("./test.d9ceef67.js"),["assets/test.d9ceef67.js","assets/_commonjsHelpers.2cf1d77b.js","assets/base.50b98d34.js"]).then(e=>e.client),shell:()=>Y(()=>import("./shell_client.67a3510d.js"),[]).then(e=>e.client)};async function ir(e){const t=e.toLowerCase(),n=xd[t];if(!!n){if(Xe[t]||(Xe[t]=await n()),Xe[t].id!==t)throw new Error("client has incorrect id");return Xe[t]}}function ge(e){return Xe[e]??void 0}function rt({path:e,page:t}){e.startsWith("/")&&(e=e.replace("/","#")||"#/");const n={key:Gt()};console.log("Appending history state index",n,e),history.pushState(n,"",e),Rn(n.key,location,t)}function wd(){const e=el("div"),t=A(e);return me(e,()=>u(Ba,{}),{color_level:0}).defer(t),t}function kd(){return tn(Y(()=>import("./settings.1f762412.js"),[]),({default:e})=>{const t=el("div"),n=A(t);return me(t,()=>u(e,{}),{color_level:0}).defer(n),n})}function $d(){return tn(Y(()=>import("./ui_testing.cd640533.js"),["assets/ui_testing.cd640533.js","assets/index.d9a19671.js","assets/settings.1f762412.js"]),({default:e})=>{const t=el("div"),n=A(t);return me(t,()=>u(e,{}),{color_level:0}).defer(n),n})}function Cd(){const e=el("div"),t=A(e);return q("","/reddit","normal").atxt("Reddit").adto(e),e.atxt(" \xB7 "),q("","/mastodon","normal").atxt("Mastodon").adto(e),e.atxt(" \xB7 "),q("","/settings","normal").atxt("Settings").adto(e),e.atxt(" \xB7 "),q("","/","normal").atxt("Home").adto(e),t}function A(e){const t=e,n={};let r=!0,o=!0,l=!0;const i=()=>{const f=r&&o;f!==l&&(l=f,c(f?"show":"hide"),a.forEach(h=>h.setParentVisible(f)))};let s=!0;const a=new Set,c=f=>{const h=n[f];!h||h.forEach(m=>m())},d={on(f,h){n[f]??=[],n[f].push(h)},setVisible(f){if(!s)return console.log("hideshow called on a deleted object");r!==f&&(r=f,i())},setParentVisible(f){if(!s)return console.log("hideshow called on a deleted object");o!==f&&(o=f,i())},get visible(){return r},cleanup(){s=!1,a.forEach(f=>f.cleanup()),c("cleanup")},emit:c,addChild(f){return a.add(f),{cleanup:()=>{f.cleanup(),a.delete(f)}}},get associated_data(){return t},defer(f){return f.addChild(d),t}};return d}function vn(e,t){const n=ge(e);return n?t(n):tn(ir(e),r=>r?t(r):An("404. Client "+e+" not found."))}function tn(e,t){const n=el("div").adto(ue),r=A(n),o=el("div").adto(n);return el("span").atxt("Fetching client\u2026").adto(o),e.then(l=>{t(l).defer(r).adto(n),o.remove()}).catch(l=>{console.log("error rendering",l),n.adch(el("span").clss("error").atxt("Got error! Check console! "+l.toString()))}),r}function On(e,t){console.log("RENDERPATH",e,t);const n=(e+t).substring(1);if(n.toLowerCase().startsWith("http://")||n.toLowerCase().startsWith("https://")){let i;try{i=new URL(n)}catch{return An("Invalid URL: "+n)}if(i.hostname==="thread.pfg.pw")return On(i.pathname,i.search);const s=en("null",i.toString());if(s.kind==="link"&&!s.external){const[c,...d]=s.url.split("?");return On(c.replace("#",""),"?"+d.join("?"))}const a=Jt(n,{});if(a){const c=el("div"),d=A(c);return me(c,()=>u(oe,{body:a,autoplay:!1}),{color_level:0}).defer(d),d}return An("Unsupported Link: "+n)}const r=e.split("/").filter(i=>i),o=r.shift();if(console.log(r),o==null)return wd();if(o==="pwa_start")return Cd();if(o==="settings")return kd();if(o==="ui_testing")return $d();function l(){const[i,s]=P("loading\u2026");return(async()=>{const{client:a}=await Y(()=>import("./reddit.490232fc.js"),["assets/reddit.490232fc.js","assets/base.50b98d34.js"]),{stringify:c}=await Y(()=>import("./main.724a0124.js").then(function(f){return f.m}),["assets/main.724a0124.js","assets/_commonjsHelpers.2cf1d77b.js"]),d=await a.getPage("/"+r.join("/")+t);s(c(d))})().catch(a=>{console.log("err;",a),s(a.toString()+`
`+a.stack)}),(()=>{const a=Yc.cloneNode(!0),c=a.firstChild;return g(c,u(Ut,{get content(){return[V.pre(i(),"json")]}})),a})()}if(o==="temp0"){const i=el("div"),s=A(i);return me(i,()=>u(l,{}),{color_level:0}).defer(s),s}return o==="login"?vn(r[0]??"ENOCLIENT",i=>yd(i,r,new URLSearchParams(t))):o==="saved"?vn("reddit",i=>{const s=el("div").clss("client-wrapper"),a=A(s),c=el("div").adto(s);c.classList.add("client-main-frame");const d=Ko(a,i.id);return d.setTitle("Loading "+i.id+"\u2026"),Yo(i,JSON.parse(localStorage.getItem("saved-post")??"{}"),c,d),a}):vn(o,i=>_d(i,"/"+r.join("/")+t))}function Rn(e,t,n){const r=t.pathname==="/"&&t.search===""&&t.hash.length>2?(()=>{try{return new URL("https://thread.pfg.pw/"+t.hash.substring(1))}catch{return t}})():t;console.log("Navigating",e,r,e,n,[...ke.keys()]),document.title="ThreadClient",Dn.forEach(d=>d(r));const o=r.pathname+r.search,l=vt;Ad(e),lr(),[...ke.values()].forEach(d=>{d.node.kind==="t1"&&d.node.hide()});const i=ke.get(e);if(i){i.node.kind==="t1"?i.node.show():_t(i.node.page2,!1);return}else{const d=[...ke.keys()].sort();for(let f=d.length-1;f>=0;f--){const h=d[f];if(h<=l)break;const m=ke.get(h);ke.delete(h),m.node.kind==="t1"&&m.node.removeSelf()}}if(n){const f={page:n};_t(f,!0),ke.set(e,{node:{kind:"t2",page2:f},url:o});return}const s=A(),a=On(r.pathname,r.search).defer(s).adto(ue);s.on("cleanup",()=>a.remove()),s.on("hide",()=>a.style.display="none"),s.on("show",()=>a.style.display="");const c={kind:"t1",removeSelf:()=>s.cleanup(),hide:()=>s.setVisible(!1),show:()=>s.setVisible(!0)};ke.set(e,{node:c,url:o})}function Sd(e){const t=document.createElement("div");document.body.appendChild(t);const n=X();wt(()=>u(E,{get if(){return n.highlightRerenders()==="on"},get children(){return u(si,{observe_root:e})}}),t)}console.log("APP.TSX WAS RELOADED.");localStorage.setItem("seen-page1","true");const Nd=p('<div class="bg-indigo-600"><div class="mx-auto max-w-7xl py-3 px-3 sm:px-6 lg:px-8"><div class="flex flex-wrap items-center justify-between"><div class="flex w-0 flex-1 items-center"><span class="flex rounded-lg bg-indigo-800 p-2"></span><p class="ml-3 truncate font-medium text-rwhite">ThreadClient was updated</p></div><div class="order-3 mt-2 w-full flex-shrink-0 sm:order-2 sm:mt-0 sm:w-auto"></div><div class="order-2 flex-shrink-0 sm:order-3 sm:ml-3"></div></div></div></div>'),sr="-N02c8ctxITU-BqvlytL";function Ed(){return localStorage.getItem("seen-page1")==="true"}const[Jo,In]=mo("tc-latest-viewed-changelog-version");function Ld(){const e=Jo();return e==null?(console.warn("E_NO_LS_VERSION_IN_CHECK_UPDATED"),!1):sr>e}function Gr(){In(sr)}function Pd(e){D(()=>Jo())==null&&(Ed()?In("\0"):In(sr));const t=X();wt(()=>u(E,{get if(){return j(()=>t.changelog()==="show",!0)()&&Ld()},get children(){return u(Td,{})}}),e)}function Td(){return(()=>{const e=Nd.cloneNode(!0),t=e.firstChild,n=t.firstChild,r=n.firstChild,o=r.firstChild,l=r.nextSibling,i=l.nextSibling;return g(o,u(pt,{class:"fa-solid fa-bullhorn",label:"Update"})),g(l,u(le,{client_id:"shell",href:"/changelog",class:`
                flex items-center justify-center
                rounded-md border border-transparent
                bg-rwhite px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm
                hover:bg-indigo-50
            `,onClickNoPreventDefault:()=>Gr(),children:"Show Changelog"})),g(i,u(le,{class:`
                -mr-1 flex rounded-md p-2 hover:bg-indigo-500
                focus:outline-none focus:ring-2 focus:ring-rwhite sm:-mr-2
            `,onClick:()=>Gr(),get children(){return u(pt,{class:"fa-solid fa-x",label:"Close"})}})),e})()}let ue,ut,Xo,qt,ke,vt,Xe,Dn,Tt;function Gt(){return Nl(Date.now(),{readBytes:e=>crypto.getRandomValues(e)})}function Ad(e){vt=e}function Kr(){if(location.hash===""){const e=new URL(location.origin+"/#"+(location.pathname.replace("/","")+location.search+location.hash||"/"));history.replaceState(history.state,"",e)}}function Od(){const e=document.createElement("div").adto(document.body);if(ue=document.createElement("threadclient"),document.body.appendChild(ue),ut=new Map,Kr(),window.onpopstate=o=>{Kr(),console.log("onpopstate. ev:",o.state);const l=o.state,i=l?.key??Gt();if(i!==l?.key){const s={key:i};history.replaceState(s,"",location.href)}Rn(i,location,void 0)},Xe={},ke=new Map,Dn=[],vt=Gt(),el("div").adto(ue),navigator.standalone||window.matchMedia("(display-mode: standalone)").matches){const o=el("nav").clss("navbar",Vt[0],"transition-opacity").adto(ue);qt=o;const l=["px-2"];el("button").adto(o).attr({"aria-label":"Back"}).atxt("\u2190").clss(...l).onev("click",h=>{h.stopPropagation(),history.back()}),el("button").adto(o).attr({"aria-label":"Forward"}).atxt("\u2192").clss(...l).onev("click",h=>{h.stopPropagation(),history.forward()});const i=el("input").attr({"aria-label":"URL"}).adto(o).clss("bg-transparent text-center border border-gray-600 dark:border-gray-500"),s=el("button").attr({"aria-label":"Go"}).clss(...l).atxt("\u23CE").adto(o),a=el("button").attr({"aria-label":"Reload"}).clss(...l).atxt("\u{1F5D8}").adto(o),c=()=>rt({path:"/"+i.value.replace(/^\//,"")});s.onclick=()=>c(),i.onkeydown=h=>h.key==="Enter"?c():0,a.onclick=()=>alert("TODO refresh"),Dn.push(h=>{h.pathname.toLowerCase().startsWith("/http://")||h.pathname.toLowerCase().startsWith("/https://")?i.value=(h.pathname+h.search).substr(1):i.value=h.pathname+h.search});let d=window.scrollY,f=0;document.addEventListener("scroll",h=>{const m=window.scrollY,v=m-d;d=m;const y=Math.max(0,Math.min(100,m));f+=v,f>y&&(f=y),f<0&&(f=0);let w=f;m<0&&(w=-m),o.style.setProperty("--mobile-transform","translateY("+-w+"px)")},{passive:!1})}else qt=el("nav").adto(ue);console.log("ThreadClient built on "+Ml.build_time),Tt=el("div").adto(ue);const t={key:vt};history.replaceState(t,"ThreadClient",location.pathname+location.search+location.hash),Rn(vt,location,void 0);let n=100;const r=()=>{document.head.querySelector(".darkreader")?.remove(),n*=2,setTimeout(()=>r(),n)};setTimeout(()=>r(),0),Xo=el("div").adto(ue).clss("alert-area"),Sd(ue),Pd(e)}const[zd,Qo]=P(!1),[Bd,Rd]=P(!1),Zo=Dl({onNeedRefresh(){if(console.log("An update to ThreadClient is available"),Rd(!0),X().updateNotifications()==="on"){const t=el("div").clss("alert").adto(Xo);el("div").clss("alert-body").adto(t).atxt("An update to ThreadClient is available."),I("pill-empty").atxt("Ignore").adto(t).onev("click",n=>{n.stopPropagation(),t.remove()}),t.atxt(" "),I("pill-empty").atxt("Update (Refresh)").adto(t).onev("click",n=>{n.stopPropagation(),Zo(!0)})}},onOfflineReady(){console.log("Ready for offline use."),Qo(!0)}});console.log("updateSW",Zo);navigator.serviceWorker!=null&&navigator.serviceWorker.getRegistrations().then(e=>{e.every(t=>t.active)&&e.length!==0&&Qo(!0)}).catch(e=>console.log("Error checking sw registrations",e));console.log("ROUTER.TS WAS RELOADED.",!1);Od();export{Id as $,le as A,me as B,Qn as C,ve as D,W as E,zi as F,F as G,Fi as H,Kt as I,zt as J,B as K,fe as L,te as M,Ui as N,$o as O,ko as P,ad as Q,Ut as R,Co as S,Zn as T,ee as U,bo as V,R as W,Hn as X,U as Y,$i as Z,Y as _,ue as a,hl as a0,Qr as a1,G as a2,jd as a3,lo as b,Md as c,Ll as d,Dd as e,P as f,ni as g,A as h,g as i,u as j,qr as k,j as l,Vd as m,L as n,fi as o,J as p,zd as q,V as r,xt as s,p as t,Bd as u,Ml as v,Zo as w,E as x,X as y,se as z};
