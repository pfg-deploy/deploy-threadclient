import{E as J,c as E,F as G,i as M,a as r,m as v,G as L,t as A,g as W,H as B,d as z,n as R,f as U,q as V,I as K,J as Q}from"./index.e666e6a6.js";const X=A("<button></button>"),Z=A(`<div class="inline relative"><div class="
            absolute inline-block w-[2px] text-transparent select-none transform translate-x-[-50%]
            rounded-md bg-blue-400
        ">.</div></div>`),q=A(`<div class="m-2"><div class="bg-slate-300 text-slate-900"><div class="max-w-screen-lg mx-auto"><div class="p-4"><h2 class="font-black text-3xl my-3">Current Projects</h2><p class="mb-3">Large projects I'm working on right now</p><div class="my-2 flex flex-col sm:flex-row hover:shadow-md bg-slate-100 hover:bg-hex-fff"><div class="sm:w-40 sm:h-auto flex-none overflow-hidden" aria-hidden="true"><a rel="noopener" target="" tabindex="-1" href="/projects/interpunct_bot"><img src="https://pfg.pw/icons/interpunct_img.png" alt="" class="w-full h-full object-cover " width="960" height="600"></a></div><div class="p-4 flex flex-col z-10 relative"><h3><a rel="noopener" target="_blank" class="font-black hover:underline" href="https://pfg.pw/projects/interpunct_bot">inter\xB7punct bot</a></h3><div class="mb-2 mt-1">A bot for the chat service <a href="https://discord.com" class="hover:underline text-blue-900" target="_blank" rel="noopener">Discord</a> that adds many features including games such as Checkers and Paper Soccer and moderator functions such as a ticketing system and a way for moderators to give people roles faster using emojis.</div><div class="font-light text-sm"><a href="https://www.typescriptlang.org/" class="hover:underline" target="_blank" rel="noopener">Typescript</a> \u2022 <a href="https://nodejs.org/en/" class="hover:underline" target="_blank" rel="noopener">NodeJS</a> \u2022 <a href="https://discord.js.org/" class="hover:underline" target="_blank" rel="noopener">discord.js</a></div></div></div></div></div></div></div>`),F=A("<div></div>"),ee=A('<button class="underline">Replay</button>'),ne=A('<div class="bg-hex-000 h-screen py-2"><div><div class="pt-2 px-2"><input class="block w-full border border-hex-fff rounded-md px-1"></div><div class="pt-2 px-2"><button class="border border-hex-fff rounded-md px-1">dbg:undo</button><button class="border border-hex-fff rounded-md px-1">dbg:clr</button></div></div></div>');function te(e){return r(z,{class:"underline",action:()=>{e.t.execute(e.to)},get children(){return e.children}})}const re={forest:{id:"forest",look:e=>e.print(r(o,{get children(){return["You are standing in a forest.",`
`,"There are quite a few trees.",`
`,"You see a ",r(te,{t:e,to:"open trapdoor",children:"Trapdoor"}),"."]}})),objects:()=>({trapdoor:"$forest$trapdoor"})},$forest$trapdoor:{id:"$forest$trapdoor",look:e=>e.print(r(o,{children:"It's a trapdoor. Rusted. Looks like it's been here a while."})),go:()=>"passage"},passage:{id:"passage",look:e=>e.print(r(o,{children:"It's a passage."}))}};async function ie(e){let _="forest";const y=l=>{const n=re[l];if(n==null)throw new Error("not exists: "+n);return n},$=l=>{const n=y(_);if(l==="")return n;const s=n.objects?.()[l];return s!=null?y(s):null};for(;;){const[l,n]=E("");e.print(r(o,{class:"bg-zinc-900",get children(){return["[What to do?] ",v(()=>l())]}}));const s=(await e.read({onProgress:u=>void n(u)})).split(" ");if(n(s.join(" ")+""),s[0]==="look"){const u=s.slice(1).join(" "),a=$(u);a==null?e.print(r(o,{class:"text-red-500",children:"Not found?"})):a.look?a.look(e):e.print(r(o,{children:"You can't look at that."}))}else if(s[0]==="go"){const u=s.slice(1).join(" "),a=$(u);a==null?e.print(r(o,{class:"text-red-500",children:"Not found?"})):a.go?_=a.go():e.print(r(o,{children:"You can't go there."}))}else if(s[0]==="help")e.print(r(o,{children:"Commands: `look`, `exit`"}));else if(s[0]==="exit"){e.print(r(o,{children:"Goodbye."}));break}else e.print(r(o,{children:"I'm not sure what you mean. `help` for help."}))}}async function se(e){const _=new Map;function y([t,b]){const d=`${t},${b}`,k=K(d),j=_.get(d);if(j!=null)return j;const N={pos:[t,b],earth:k()>.2||t===0&&b===0?{kind:"grass"}:k()>.5?{kind:"rebar_tree",branches_remaining:k()*3+5|0}:{kind:"stone_deposit",stones_remaining:k()*4+2|0,ore_remaining:k()*100+100|0}};return _.set(d,N),N}function $(t,b){return[t[0]+b[0],t[1]+b[1]]}const l={pos:[0,0],features:{eyes:!0,wheels:!0},inventory:{left_hand:null,right_hand:null}};function n(t){return l.inventory.left_hand===t||l.inventory.right_hand===t}function s(){return l.inventory.left_hand==null||l.inventory.right_hand==null}function u(t){if(l.inventory.left_hand==null)l.inventory.left_hand=t;else if(l.inventory.right_hand==null)l.inventory.right_hand=t;else throw new Error("no space to insert")}function a(t){return!(t.item!=null||t.earth.kind==="battery_acid_lake"||t.earth.kind==="stone_deposit"||t.earth.kind==="rebar_tree")}function w(t,b){if(t.item!=null)throw new Error("bad drop point");t.item=b}function c(t){const b=$(l.pos,t),d=y(b);if(!a(d))return e.print(r(o,{class:"text-red-500",children:"You can't stand there"}));l.pos=b}const i={w:[0,-1],a:[-1,0],s:[0,1],d:[1,0]};function p(t){return t==="w"||t==="s"||t==="a"||t==="d"}function T(t){return t.item!=null?"item: "+h(t.item):t.earth.kind==="stone_deposit"?"stone deposit ("+t.earth.stones_remaining+" stones, "+t.earth.ore_remaining+" ore remain)":t.earth.kind==="battery_acid_lake"?"battery acid lake ("+t.earth.count_remaining+" drops remain)":t.earth.kind==="grass"?"grass":t.earth.kind==="rebar_tree"?"rebar tree ("+t.earth.branches_remaining+" branches remain)":"EBADTILE"}function h(t){return t??"nothing"}let f=null;for(;;){const[t,b]=E(""),[d,k]=E(!1),[j,N]=E(!0);e.print([r(o,{class:"bg-zinc-900",get children(){return["[What to do?] ",v(()=>t())]}}),v((()=>{const x=v(()=>!d(),!0);return()=>x()?r(o,{class:"text-zinc-400",get children(){return["You are holding:",`
`,"l:","  "," ",v(()=>h(l.inventory.left_hand)),`
`,"  ","r: ",v(()=>h(l.inventory.right_hand)),`
`,`
`,"You are standing in ",v(()=>y(l.pos).earth.kind),".",`
`,"   ","\u2191w:","   "," ",v(()=>T(y($(l.pos,[0,-1])))),`
`,"\u2190a:","   ","   "," ",v(()=>T(y($(l.pos,[-1,0])))),`
`,"   ","   ","\u2192d: ",v(()=>T(y($(l.pos,[1,0])))),`
`,"   ","\u2193s:","   "," ",v(()=>T(y($(l.pos,[0,1])))),`
`,v(()=>null)]}}):null})())]);const g=(await e.read({onProgress:x=>void b(x)})).split(" ");f?.(!1),f=N,b(g.join(" ")+""),k(!0);const O=x=>(()=>{const m=X.cloneNode(!0);return m.$$click=()=>j()&&e.execute(x.cmd),M(m,()=>x.children),U(C=>{const I=x.cmd,Y=j()?"underline":"!opacity-100 cursor-default",S=!j();return I!==C._v$&&Q(m,"title",C._v$=I),Y!==C._v$2&&(m.className=C._v$2=Y),S!==C._v$3&&(m.disabled=C._v$3=S),C},{_v$:void 0,_v$2:void 0,_v$3:void 0}),m})();if(g[0]!=null&&p(g[0]))c(i[g[0]]);else if(g[0]==="e")if(g[1]!=null&&p(g[1])){const x=$(l.pos,i[g[1]]),m=y(x);m.item!=null?s()?(u(m.item),m.item=void 0):e.print(r(o,{children:"You are holding stuff in both hands"})):m.earth.kind==="stone_deposit"?s()?m.earth.stones_remaining>0?(m.earth.stones_remaining-=1,u("stone")):e.print(r(o,{children:"No stones left to pick up"})):e.print(r(o,{children:"You're holding things in both hands"})):m.earth.kind==="rebar_tree"?s()?m.earth.branches_remaining>0?(m.earth.branches_remaining-=1,u("rebar_rod")):e.print(r(o,{children:"No rods left to take"})):e.print(r(o,{children:"You're holding things in both hands"})):e.print(r(o,{children:"Cannot harvest that"}))}else e.print(r(o,{children:"Usage: e [w|a|s|d]"}));else if(g[0]==="mine")if(g[1]!=null&&p(g[1])){const x=$(l.pos,i[g[1]]),m=y(x);m.earth.kind==="stone_deposit"?n("stone_rebar_pickaxe")?s()?m.earth.ore_remaining>0?(m.earth.ore_remaining-=1,u("stone")):e.print(r(o,{children:"No stones left to mine"})):e.print(r(o,{children:"You're holding things in both hands"})):e.print(r(o,{children:"You need a pickaxe to mine"})):e.print(r(o,{children:"Cannot mine that"}))}else e.print(r(o,{children:"Usage: mine [w|a|s|d]"}));else if(g[0]==="craft"){const x=(Y,S)=>[Y??"",S??""].sort().join(","),m={[x("stone","rebar_rod")]:["stone_rebar_pickaxe","stone_rebar_axe"]},C=x(l.inventory.left_hand,l.inventory.right_hand),I=m[C];if(!Object.hasOwn(m,C)||I==null)e.print(r(o,{children:"You can't craft anything with what you're holding"}));else{const Y=g[1],S=I.find(D=>D===Y);S==null?e.print(r(o,{get children(){return["Usage: craft [",r(L,{each:I,children:(D,H)=>[v(()=>H()!==0?"|":""),r(O,{cmd:"craft "+D,children:D})]}),"]"]}})):(l.inventory.left_hand=null,l.inventory.right_hand=null,u(S))}}else if(g[0]==="drop"){const x=g[1]==="l"||g[1]==="r"?g[1]:null;if(x!=null&&g[2]!=null&&p(g[2])){const m=y($(l.pos,i[g[2]])),C=x==="l"?"left_hand":"right_hand";if(l.inventory[C]!=null)if(a(m)){const I=l.inventory[C];l.inventory[C]=null,w(m,I)}else e.print(r(o,{class:"text-red-500",children:"There's something in the way"}));else e.print(r(o,{class:"text-red-500",get children(){return["You're not holding anything in ",C]}}))}else e.print(r(o,{class:"text-red-500",children:"Usage: `drop [l|r] [w|a|s|d]`"}))}else if(g[0]==="help")e.print(r(o,{children:"TODO help"}));else if(g[0]==="exit"){e.print(r(o,{children:"Goodbye."}));break}else e.print(r(o,{children:"I'm not sure what you mean. `help` for help."}))}}function oe(){return(()=>{const e=Z.cloneNode(!0);return e.firstChild,e})()}async function le(e){function _(n,s){const u=[];for(;;){const a=n();if(a==null||a===s)break;u.push(a)}return u.join("")}const y={insert:(n,s)=>{const u=s;n.file=n.file.substring(0,n.crs)+u+n.file.substring(n.crs),n.crs+=u.length},start:n=>{n.crs=0},end:n=>{n.crs=n.file.length},"line-above":n=>{let s=n.file.lastIndexOf(`
`,n.crs-1);s===-1&&(s=0),n.file=n.file.substring(0,s)+`
`+n.file.substring(s),n.crs=s===0?s:s+1},"line-below":n=>{let s=n.file.indexOf(`
`,n.crs+1);s===-1&&(s=n.file.length),n.file=n.file.substring(0,s)+`
`+n.file.substring(s),n.crs=s+1},"cursor-left":n=>{n.crs=Math.max(n.crs-1,0)},"cursor-right":n=>{n.crs=Math.max(n.crs+1,0)}};function $(n,s){const u=(()=>{let a=0;const w=[...n];return()=>w[a++]})();for(;;){const a=u();if(a==null)return;let w=!1;const c=(()=>{if(a==="[")return _(u,"]");if(a==="/")return w=!0,"insert: "+(s.prev_lyn_slash?`
`:"")+_(u,void 0);if(a==="g"){const t=u();return t==="g"?"start":"error: bad-g-command: `"+t+"`"}return a==="G"?"end":a==="O"?"line-above":a==="o"?"line-below":a==="w"?"cursor-right: word":a==="b"?"cursor-left: word":a==="h"?"cursor-left: grapheme-cluster":a==="j"?"cursor-down":a==="k"?"cursor-up":a==="l"?"cursor-right: grapheme-cluster":a==="l"?"line-below":"error: bad-char: `"+a+"`"})();if(s.prev_lyn_slash=w,c==="exit")throw new Error("exit");const[i,...p]=c.split(": "),T=p.join(": "),h=y[i??""];if(h==null)return r(o,{class:"text-red-500",get children(){return["Error: Command not found: [",i,"]"]}});const f=h(s,T);if(f!=null)return f}}const l={file:"",crs:0,prev_lyn_slash:!1};for(;;){const[n,s]=E(l),[u,a]=E(null);e.print([r(R,{get when(){return(()=>{const c=n();return typeof c=="string"?null:c})()},get fallback(){return r(o,{class:"bg-zinc-900",get children(){return"$ "+n()}})},children:c=>r(o,{get children(){return[v(()=>c.file.substring(0,c.crs)),r(oe,{}),v(()=>c.file.substring(c.crs))]}})}),v(u)]);const w=await e.read({onProgress:c=>{const i={...l};a($(c,i)),s(i)}});s(w),e.print($(w,l))}}async function ae(e){const _=w=>({kind:"dir",files:w}),$=_({projects:_({current:_({interpunct_bot:{kind:"fyl",previewDisplay:()=>q.cloneNode(!0)},threadreader:_({})}),past:_({})})});let l=[];function n(w){let c=$;for(const i of w){if(c.kind==="dir"&&Object.hasOwn(c.files,i)){c=c.files[i];continue}return}return c}function s(w,c){const i=[...w];for(const p of c)if(p==="..")i.pop();else{if(p===".")continue;if(p==="")continue;i.push(p)}return i}function u(w){const c=w.split("/");return c.length>1&&c[0]===""?s([],c):s(l,c)}let a=null;for(;;){const[w,c]=E("");e.print(r(o,{class:"bg-zinc-900",get children(){return["https://pfg.pw/",v(()=>l.join("/")),"$ ",v(()=>w())]}}));const i=(await e.read({onProgress:h=>void c(h)})).split(" ");a?.(!1);const[p,T]=E(!0);if(a=T,c(i.join(" ")+""),i[0]==="ls"){const h=[...i.slice(1)].join(" "),f=n(u(h)),t=f==null?[]:f.kind==="dir"?Object.entries(f.files):[["?",f]];for(const[b,d]of t){const k=b+(d.kind==="dir"?"/":"");e.print(d.previewDisplay?(()=>{const j=F.cloneNode(!0);return(N=>{W(()=>{p()?(N.removeAttribute("inert"),N.style.filter=""):(N.setAttribute("inert","true"),N.style.filter="grayscale(100%)")})})(j),M(j,()=>B(()=>d.previewDisplay())),j})():r(o,{get children(){return r(z,{action:()=>{!p()||e.execute("cd /"+s(u(h),[k]).join("/"))},get class(){return p()?"underline":"cursor-arrow"},children:k})}}))}}else if(i[0]==="cd"){const h=[...i.slice(1)].join(" "),f=u(h);if(n(f)?.kind!=="dir"){e.print(r(o,{children:"Not found"}));continue}l=f}else if(i[0]==="exit"){e.print(r(o,{children:"Exiting"}));break}else if(i[0]==="pwd")e.print(r(o,{get children(){return["/",v(()=>l.join("/"))]}}));else if(i[0]==="adventure")try{await ie(e)}catch(h){const f=h;e.print(r(o,{get children(){return["Adventure game errored: ",v(()=>f.toString()+`
`+f.stack)]}}))}else if(i[0]==="world")try{await se(e)}catch(h){const f=h;e.print(r(o,{get children(){return["Adventure game errored: ",v(()=>f.toString()+`
`+f.stack)]}}))}else if(i[0]==="edit")try{await le(e)}catch(h){const f=h;e.print(r(o,{get children(){return["Text editor errored: ",v(()=>f.toString()+`
`+f.stack)]}}))}else if(i[0]==="showanimtest"){const h="Here is some text. I'm trying out animating it in",[f,t]=E(""),b=k=>{if(k>=1)return void t(h);t([...h].map(j=>{if(j===" ")return j;const N=["@","$","#","^","&"],g=N[Math.random()*N.length|0],O=[""," ","!",".",",","*","-"],x=O[Math.random()*O.length|0];return Math.random()>k?Math.random()<k?g:x:j}).join(""))},d=()=>{b(0),setTimeout(()=>{b(.2),setTimeout(()=>{b(.4),setTimeout(()=>{b(.6),setTimeout(()=>{b(.8),setTimeout(()=>{b(1)},40)},40)},40)},40)},40)};d(),e.print(r(o,{get children(){return[v(()=>f()),r(R,{get if(){return f()===h},get children(){return[" ",(()=>{const k=ee.cloneNode(!0);return(j=>{G(()=>{j.style.opacity="0",setTimeout(()=>{j.style.opacity="1",j.animate([{opacity:0},{opacity:1}],{duration:200,iterations:1})},500)})})(k),k.$$click=()=>{d()},k})()]}})]}}))}else e.print(r(o,{children:"I'm not sure what you mean. `help` for help."}))}a?.(!1),a=null}function P(){const e=window;return e["@term-app-hmr-data"]??=[]}function o(e){return(()=>{const _=F.cloneNode(!0);return M(_,()=>e.children),U(()=>_.className=e.class+" px-2 whitespace-pre-wrap font-mono"),_})()}function de(e){const _=document.createElement("style");_.textContent=`
        html, body {
            background-color: #000 !important;
        }
    `,J(()=>{_.remove()}),document.body.appendChild(_);const y=[],[$,l]=E([]),n=[],s=[],u=i=>{y[y.length-1]!==i&&y.push(i),P().push(i);const p=s.shift();if(p!=null){p.complete(i);return}n.push(i)};for(const i of P().splice(0,P().length))u(i);const a=async i=>{const p=n.shift();return p??await new Promise(h=>s.push({complete:h,progress:f=>{i?.onProgress?.(f)}}))};let w;const c={print:i=>{l(p=>[...p,{itm:i}])},read:async i=>a(i),execute:i=>{u(i),w.focus()}};return ae(c).then(i=>{c.print("App exited.")}).catch(i=>{c.print("App errored: "+i.toString()+`
`+i.stack)}),(()=>{const i=ne.cloneNode(!0),p=i.firstChild,T=p.firstChild,h=T.firstChild,f=T.nextSibling,t=f.firstChild,b=t.nextSibling;return(d=>{G(()=>{d.animate([{backgroundColor:"#222"},{}],{duration:200,iterations:1})})})(i),(d=>{G(()=>{d.animate([{opacity:0},{opacity:1}],{duration:200,iterations:1})})})(p),M(p,r(L,{get each(){return $()},children:d=>v(()=>d.itm)}),T),h.$$input=d=>{s[0]?.progress(d.currentTarget.value)},h.$$keydown=d=>{d.code==="Enter"&&(d.preventDefault(),d.stopPropagation(),u(d.currentTarget.value),d.currentTarget.value=""),d.code==="ArrowUp"&&(d.currentTarget.value=y[y.length-1]??"")},(d=>{w=d,G(()=>{d.focus()})})(h),t.$$click=()=>{P().pop(),e.reloadSelf()},b.$$click=()=>{!confirm("really clear?")||(P().splice(0,P().length),e.reloadSelf())},i})()}V(["click","keydown","input"]);export{de as default};
