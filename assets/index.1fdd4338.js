import{b as e,$ as t,g as n,c as o,t as r,a as l,u as i,o as a,i as s,d as c,s as d,e as u,r as h,f as p,h as g,j as f,k as v,E as m,l as b,m as _,n as y,p as x,F as w,M as k,S as $,q as N,v as C,w as E,x as L,y as P}from"./vendor.03bc8c46.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();window.el=(...e)=>document.createElement(...e),window.txt=e=>document.createTextNode(e),window.anychange=(e,t)=>(e.forEach((e=>e.oninput=()=>t())),t(),t),window.body=document.getElementById("maincontent")||document.body,Node.prototype.attr=function(e){return Object.entries(e).forEach((([e,t])=>null==t?this.removeAttribute(e):this.setAttribute(e,t))),this},Node.prototype.adto=function(e){return e.appendChild(this),this},Node.prototype.adch=function(...e){return e.forEach((e=>this.appendChild(e))),this},Node.prototype.atxt=function(e){return this.appendChild(txt(e)),this},Node.prototype.onev=function(...e){return this.addEventListener(...e),this},Node.prototype.clss=function(...e){return e.forEach((e=>e.split(/[. ]/g).filter((e=>e)).map((e=>this.classList.add(e))))),this},Node.prototype.styl=function(e){return Object.entries(e).forEach((([e,t])=>this.style.setProperty(e,t))),this},Object.defineProperty(Array.prototype,"last",{enumerable:!1,get:function(){return this[this.length-1]}}),Object.defineProperty(Object.prototype,"dwth",{enumerable:!1,value:function(e){return e(this),this}});const S={},T=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/${e}`)in S)return;S[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((e,t)=>{o.addEventListener("load",e),o.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};const O={kind:function(e,t,n){return{...t,kind:e,...n?{children:n}:{}}},p:(...e)=>O.kind("paragraph",{},e),hn:(e,...t)=>O.kind("heading",{level:e},t),h1:(...e)=>O.hn(1,...e),h2:(...e)=>O.hn(2,...e),ul:(...e)=>O.kind("list",{ordered:!1},e),ol:(...e)=>O.kind("list",{ordered:!0},e),li:(...e)=>O.kind("list_item",{},e),ili:(...e)=>O.kind("tight_list_item",{},e),blockquote:(...e)=>O.kind("blockquote",{},e),txt:(e,t={})=>O.kind("text",{text:e,styles:t}),link:(e,t,...n)=>O.kind("link",{url:e,...t},n),pre:(e,t)=>O.kind("code_block",{text:e,lang:t}),error:(e,t)=>O.kind("error",{text:e,value:t}),br:()=>O.kind("br",{}),flair:e=>O.kind("flair",{flair:e}),table:(e,...t)=>O.kind("table",{headings:e},t),th:(e,...t)=>({align:e,children:t}),td:(...e)=>({children:e}),timeAgo:e=>O.kind("time_ago",{start:e}),hr:()=>O.kind("horizontal_line",{}),code:e=>O.kind("code",{text:e}),spoiler:(...e)=>O.kind("spoiler",{},e)},A={link:(e,t,n)=>({selected:n,action:{kind:"link",url:t},text:e})};function j(e){return"status_msg"in e?{kind:"richtext",content:[O.p(O.error("Could not preview oembed",e))]}:null!=e.url?{kind:"link_preview",thumb:e.embed_url||e.image||void 0,click:e.embed_url?{kind:"captioned_image",url:e.embed_url,w:null,h:null}:{kind:"link",url:e.url,embed_html:e.html||void 0},click_enabled:!(!e.embed_url&&!e.html),title:e.title,description:e.description,url:e.url}:{kind:"reddit_suggested_embed",suggested_embed:e.html}}const R=Symbol("store-raw"),V=Symbol("store-node"),M=Symbol("store-name");function I(e,n){let o=e[t];if(!o){Object.defineProperty(e,t,{value:o=new Proxy(e,H)});const n=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let t=0,l=n.length;t<l;t++){const l=n[t];if(r[l].get){const t=r[l].get.bind(o);Object.defineProperty(e,l,{get:t})}}}return o}function D(e){return null!=e&&"object"==typeof e&&(!e.__proto__||e.__proto__===Object.prototype||Array.isArray(e))}function W(e,t=new Set){let n,o,r,l;if(n=null!=e&&e[R])return n;if(!D(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let n=0,l=e.length;n<l;n++)r=e[n],(o=W(r,t))!==r&&(e[n]=o)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const n=Object.keys(e),i=Object.getOwnPropertyDescriptors(e);for(let a=0,s=n.length;a<s;a++)l=n[a],i[l].get||(r=e[l],(o=W(r,t))!==r&&(e[l]=o))}return e}function q(e){let t=e[V];return t||Object.defineProperty(e,V,{value:t={}}),t}function U(){const[e,t]=o(void 0,{equals:!1,internal:!0});return e.$=t,e}const H={get(e,o,r){if(o===R)return e;if(o===t)return r;const l=e[o];if(o===V||"__proto__"===o)return l;const i=D(l);if(n()&&("function"!=typeof l||e.hasOwnProperty(o))){let t,n;i&&(t=q(l))&&(n=t._||(t._=U()),n()),t=q(e),n=t[o]||(t[o]=U()),n()}return i?I(l):l},set:()=>!0,deleteProperty:()=>!0,ownKeys:function(e){if(n()){const t=q(e);(t._||(t._=U()))()}return Reflect.ownKeys(e)},getOwnPropertyDescriptor:function(e,n){const o=Reflect.getOwnPropertyDescriptor(e,n);return!o||o.get||n===t||n===V||n===M||(delete o.value,delete o.writable,o.get=()=>e[t][n]),o}};function z(e,t,n){if(e[t]===n)return;const o=Array.isArray(e),r=e.length,l=void 0===n,i=o||l===t in e;l?delete e[t]:e[t]=n;let a,s=q(e);(a=s[t])&&a.$(),o&&e.length!==r&&(a=s.length)&&a.$(a,void 0),i&&(a=s._)&&a.$(a,void 0)}function B(e,t,n=[]){let o,r=e;if(t.length>1){o=t.shift();const l=typeof o,i=Array.isArray(e);if(Array.isArray(o)){for(let r=0;r<o.length;r++)B(e,[o[r]].concat(t),[o[r]].concat(n));return}if(i&&"function"===l){for(let r=0;r<e.length;r++)o(e[r],r)&&B(e,[r].concat(t),[r].concat(n));return}if(i&&"object"===l){const{from:r=0,to:l=e.length-1,by:i=1}=o;for(let o=r;o<=l;o+=i)B(e,[o].concat(t),[o].concat(n));return}if(t.length>1)return void B(e[o],t,[o].concat(n));r=e[o],n=[o].concat(n)}let l=t[0];"function"==typeof l&&(l=l(r,n),l===r)||void 0===o&&null==l||(l=W(l),void 0===o||D(r)&&D(l)&&!Array.isArray(l)?function(e,t){const n=Object.keys(t);for(let o=0;o<n.length;o+=1){const r=n[o];z(e,r,t[r])}}(r,l):z(e,o,l))}function G(t,n){const o=W(t||{});return[I(o),function(...t){e((()=>B(o,t)))}]}function F(e,t,n,o,r){const l=t[n];if(e===l)return;if(!D(e)||!D(l)||r&&e[r]!==l[r])return void(e!==l&&z(t,n,e));if(Array.isArray(e)){if(e.length&&l.length&&(!o||r&&null!=e[0][r])){let t,n,i,a,s,c,d,u;for(i=0,a=Math.min(l.length,e.length);i<a&&(l[i]===e[i]||r&&l[i][r]===e[i][r]);i++)F(e[i],l,i,o,r);const h=new Array(e.length),p=new Map;for(a=l.length-1,s=e.length-1;a>=i&&s>=i&&(l[a]===e[s]||r&&l[a][r]===e[s][r]);a--,s--)h[s]=l[a];if(i>s||i>a){for(n=i;n<=s;n++)z(l,n,e[n]);for(;n<e.length;n++)z(l,n,h[n]),F(e[n],l,n,o,r);return void(l.length>e.length&&z(l,"length",e.length))}for(d=new Array(s+1),n=s;n>=i;n--)c=e[n],u=r?c[r]:c,t=p.get(u),d[n]=void 0===t?-1:t,p.set(u,n);for(t=i;t<=a;t++)c=l[t],u=r?c[r]:c,n=p.get(u),void 0!==n&&-1!==n&&(h[n]=l[t],n=d[n],p.set(u,n));for(n=i;n<e.length;n++)n in h?(z(l,n,h[n]),F(e[n],l,n,o,r)):z(l,n,e[n])}else for(let t=0,n=e.length;t<n;t++)F(e[t],l,t,o,r);return void(l.length>e.length&&z(l,"length",e.length))}const i=Object.keys(e);for(let s=0,c=i.length;s<c;s++)F(e[i[s]],l,i[s],o,r);const a=Object.keys(l);for(let s=0,c=a.length;s<c;s++)void 0===e[a[s]]&&z(l,a[s],void 0)}function K(e,t={}){const{merge:n,key:o="id"}=t,r=W(e);return e=>{const t=e;return D(t)&&D(r)?(F(r,{state:t},"state",n,o),t):r}}const J={get(e,t){if(t===R)return e;const n=e[t];return D(n)?new Proxy(n,J):n},set:(e,t,n)=>(z(e,t,W(n)),!0),deleteProperty:(e,t)=>(z(e,t,void 0),!0)};function Y(e){return t=>{const n=t;return D(n)&&e(new Proxy(n,J)),n}}const Q=Symbol("raw");const X=(Z=e=>encodeURIComponent(e),(e,...t)=>{const n=[];return e.forEach(((e,o)=>{if(n.push({raw:e}),o<t.length){const e=t[o];"object"==typeof e&&Q in e?n.push({raw:e[Q]}):n.push({val:e})}})),n.map((e=>"raw"in e?e.raw:Z(e.val))).join("")});var Z;function ee(e){let t="";for(const[n,o]of Object.entries(e))null!=o&&(t&&(t+="&"),t+=X`${n}=${o}`);return t}function te(e){throw console.log("not never:",e),new Error("Expected never")}function ne(e,t,n,o){var r,l;const i={...e},a=[...t];for(const s of n)if("string"==typeof s){if(a.shift()!==s)return null}else{const e=Object.entries(s);if(!e[0]||1!==e.length)throw new Error("bad bit object");const[t,n]=e[0];if("any"===n){const e=a.shift();if(null==e)return null;i[t]=e}else if("rest"===n)i[t]=a.splice(0);else if("optional"===n)i[t]=null!=(r=a.shift())?r:null;else if(Array.isArray(n)||"forEach"in n){const e=null!=(l=a.shift())?l:null;if(!n.includes(e))return null;i[t]=e}else if("starts-with"===n.kind){const e=a.shift();if(null==e)return null;if(!e.startsWith(n.text))return null;i[t]=e.replace(n.text,"")}}return o.assert_end&&0!==a.length?null:{opts:i,path:a}}function oe(e){const t=[],n={with(e,n){const o=oe(!1);n(o),t.push(((t,n)=>{const r=ne(t,n,e,{assert_end:!1});return r?o.parseSub(r.opts,r.path):null}))},route(e,n){t.push(((t,o)=>{const r=ne(t,o,e,{assert_end:!0});return r?n(r.opts):null}))},catchall(e){t.push(((t,n)=>e(t)))},parse(t){if(!e)throw new Error("not root, ParentOpts ≠ BaseParentOpts");let o;try{o=new URL(t,new URL("https://example/"))}catch(i){return null}const r=o.pathname.split("/").filter((e=>e)),l={query:Object.fromEntries(o.searchParams),path:o.pathname};return n.parseSub(l,r)},parseSub(e,n){for(const o of t){const t=o(e,n);if(t)return t}return null}};return n}function re(){return oe(!0)}function le(e,t){var n,o;const r=null!=(o=null!=(n=t[e.kind])?n:t.unsupported)?o:()=>{throw new Error("condition "+e.kind+" was not handled and no unsupported branch")};return()=>r(e)}function ie(e,t){return le(e,t)()}const ae=r("<time></time>");function se(e){return l((()=>le(e.item,e.children)()))}function ce(e){const t=l((()=>e.when),void 0,{equals:(e,t)=>!e==!t});return l((()=>t()?e.children:e.fallback))}function de(e){return l((()=>{var t,n;if((null==(n=null==(t=e.if)?void 0:t[0])||n)&&null!=e.when){const t=e.children;return i((()=>t(e.when)))}return e.fallback}))}function ue(e,t){const n=document.getSelection();if(!1===(null==n?void 0:n.isCollapsed))return!1;let o=e;for(;o&&o!==t;){if(o instanceof HTMLElement&&("A"===o.nodeName||"BUTTON"===o.nodeName||"VIDEO"===o.nodeName||"AUDIO"===o.nodeName||"INPUT"===o.nodeName||"TEXTAREA"===o.nodeName||"IFRAME"===o.nodeName||o.classList.contains("resizable-iframe")||o.classList.contains("handles-clicks")))return!1;o=o.parentNode}return!0}function he(e,t){if(!t.endsWith("s"))throw new Error("!s");return 1===e?e+t.substring(0,t.length-1):e+t}function pe(e){const[t,n]=o(Date.now()),r=l((()=>{const o=function(e,t){const n=t-e;if(n<0)return["in the future "+new Date(e).toISOString(),-n];if(n<6e4)return["just now",6e4-n];let o=6e4,r=60;if(n<r*o){const e=n/o|0;return[he(e," minutes")+" ago",o-(n-e*o)]}if(o*=r,r=24,n<r*o){const e=n/o|0;return[he(e," hours")+" ago",o-(n-e*o)]}if(o*=r,r=30,n<r*o){const e=n/o|0;return[he(e," days")+" ago",o-(n-e*o)]}return[new Date(e).toISOString(),-1]}(e.start,t());if(o[1]>0){const e=setTimeout((()=>n(Date.now())),Math.min(o[1]+10,2147483647));a((()=>clearTimeout(e)))}return o[0]}));return(()=>{const t=ae.cloneNode(!0);return s(t,r),c((n=>{const o=new Date(e.start).toString(),r=""+new Date(e.start);return o!==n._v$&&d(t,"datetime",n._v$=o),r!==n._v$2&&d(t,"title",n._v$2=r),n}),{_v$:void 0,_v$2:void 0}),t})()}const ge=r("<style>.cfg-reddit-pfp {display: none;}</style>"),fe=r('<div class="block"><div class="w-22px h-22px flex items-center justify-center"><i></i></div></div>'),ve=r("<div><pre><code> </code></pre><button>Code</button> / <button>Retry</button></div>"),me=f();function be(e){var t;const n=v(me),o=null!=(t=null==n?void 0:n.i)?t:0,r=o+1;return p(me.Provider,{value:{i:r},get children(){return e.children(o%2==0?"bg-postcolor-100":"bg-body",o)}})}const _e=f();function ye(e){return p(_e.Provider,{get value(){return{client:e.client}},get children(){return e.children}})}function xe(){const e=v(_e);if(!e)throw new Error("A client is required to render this component");return l((()=>e.client))}const we=f();function ke(e){const t=v(we),n=l((()=>{var n;const o=null==(n=null==t?void 0:t.visible())||n,r=e.visible();return!!o&&r}));return p(we.Provider,{value:{visible:n},get children(){return e.children}})}function $e(){var e;const t=v(we);return null!=(e=null==t?void 0:t.visible)?e:()=>!0}function Ne(e,t,n){const r=()=>{var t;const o=null!=(t=localStorage.getItem(e))?t:void 0;return n.deserialize?n.deserialize(o):o},[l,i]=o(r()),a=()=>{i(r())};return window.addEventListener("storage",a),{value:()=>{var e;return null!=(e=l())?e:t()},compute:{base:t,override:l,setOverride:t=>{null==t?localStorage.removeItem(e):localStorage.setItem(e,n.serialize?n.serialize(t):t),a()}}}}function Ce(e,t,n){const r=window.matchMedia(e),[l,i]=o(r.matches?t:n),s=()=>{i((()=>r.matches?t:n))};return r.addEventListener("change",s),a((()=>{r.removeEventListener("change",s)})),l}const Ee=u((()=>{const e={color_scheme:Ne("color-scheme",Ce("(prefers-color-scheme: dark)","dark","light"),{}),author_pfp:Ne("pfp-cfg",(()=>"on"),{}),update_notifications:Ne("update_notices",(()=>"on"),{}),custom_video_controls:Ne("custom_video_controls",(()=>"browser"),{}),page_version:Ne("page_version",(()=>"1"),{}),link_helpers:Ne("link_helpers",(()=>"show"),{}),cors_proxy:Ne("cors_proxy",(()=>"off"),{}),gallery_display:Ne("gallery_display",(()=>"fullscreen"),{}),motion:Ne("motion",Ce("(prefers-reduced-motion: reduce)","reduce","full"),{}),animation_time:Ne("animation_time",(()=>.2),{serialize:e=>JSON.stringify(e),deserialize:e=>null!=e&&""!==e?JSON.parse(e):void 0}),animation_dev_mode:Ne("animation_dev_mode",(()=>"none"),{})};return g((()=>{document.documentElement.classList.toggle("dark","dark"===e.color_scheme.value())})),e}));function Le(){return Ee}h((()=>p(ce,{get when(){return"off"===Le().author_pfp.value()},get children(){return ge.cloneNode(!0)}})),el("div").adto(document.head));const[Pe,Se]=o(window.innerWidth);window.addEventListener("resize",(()=>{Se(window.innerWidth)}));const Te=640;function Oe(...e){return e.flat().join(" ")}function Ae(e){return(()=>{const t=fe.cloneNode(!0),n=t.firstChild.firstChild;return c((t=>{const o=e.icon.class+" "+e.size,r=e.icon.label;return o!==t._v$&&(n.className=t._v$=o),r!==t._v$2&&d(n,"aria-label",t._v$2=r),t}),{_v$:void 0,_v$2:void 0}),t})()}function je(e){const[t,n]=o(!0);return p(m,{fallback:(t,o)=>(console.log(t),(()=>{const r=ve.cloneNode(!0),l=r.firstChild,i=l.firstChild.firstChild,a=l.nextSibling,s=a.nextSibling.nextSibling;return a.addEventListener("click",(()=>console.log(t,e.data))),s.addEventListener("click",(()=>{n(!1),setTimeout((()=>n(!0)),200),o()})),c((e=>{const n=t instanceof Error?t.toString()+"\n\n"+t.stack:"Something went wrong",o=Yo["outlined-button"],r=Yo["outlined-button"];return n!==e._v$3&&(i.data=e._v$3=n),o!==e._v$4&&(a.className=e._v$4=o),r!==e._v$5&&(s.className=e._v$5=r),e}),{_v$3:void 0,_v$4:void 0,_v$5:void 0}),r})()),get children(){return p(ce,{get when(){return t()},get fallback(){return"Retrying..."},get children(){return e.children}})}})}const Re=r("<span></span>");function Ve(e,t,n,r){const l=ur(),i=h((()=>{const[t,i]=o(l.visible);return l.on("hide",(()=>i(!1))),l.on("show",(()=>i(!0))),p(ke,{visible:t,get children(){return p(ye,{client:e,get children(){return p(me.Provider,{get value(){return{i:r.color_level}},get children(){return n()}})}})}})}),t);return l.on("cleanup",(()=>i())),l}function Me(e){const t=xe(),n=$e();return(()=>{const o=Re.cloneNode(!0);var r;return r=o,g((()=>{const o=ur(),l=e.getValue(o,t).adto(r);g((()=>{o.setVisible(n())})),a((()=>{o.cleanup(),l.remove()}))})),o})()}function Ie({h:e,s:t,l:n,a:o=1}){if(0===t){const[e,t,r]=[n,n,n].map((e=>Math.round(255*e)));return{r:e,g:r,b:t,a:o}}const r=(1-Math.abs(2*n-1))*t,l=r*(1-Math.abs(e/60%2-1)),i=n-r/2,[a,s,c]=(e<60?[r,l,0]:e<120?[l,r,0]:e<180?[0,r,l]:e<240?[0,l,r]:e<300?[l,0,r]:[r,0,l]).map((e=>Math.round(255*(e+i))));return{r:a,g:s,b:c,a:o}}function De(e){const{r:t,g:n,b:o,a:r}=e;return null!=r&&r<1?`rgba(${We(t)}, ${We(n)}, ${We(o)}, ${We(r,2)})`:`rgb(${We(t)}, ${We(n)}, ${We(o)})`}function We(e,t=0){const n=e.toFixed(t);if(0===t)return n;const o=n.indexOf(".");if(o>=0){const e=n.match(/0+$/);if(e)return e.index===o+1?n.substring(0,o):n.substring(0,e.index)}return n}function qe(e){const t=function(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}(e);return n=t(),o=t(),r=t(),l=t(),function(){let e=(n>>>=0)+(o>>>=0)|0;return n=o^o>>>9,o=(r>>>=0)+(r<<3)|0,e=e+(l=1+(l>>>=0)|0)|0,r=(r=r<<21|r>>>11)+e|0,(e>>>0)/4294967296};var n,o,r,l}function Ue(e){const t={h:360*e(),s:.5*e()+.5,l:.4*e()+.1,a:1},n={...t,l:1-t.l};return[Ie(t),Ie(n)]}const He=r("<div></div>");let ze=!1;function Be(e,t,n,r){const[l,a]=o(null);e.addEventListener("transitionend",(()=>{a(null),r(n(),!1,!1)})),g(b([n],(()=>{const o=e.getBoundingClientRect(),l=fr.getBoundingClientRect(),i=()=>5+Math.max(0,l.bottom,window.visualViewport.offsetTop),s=()=>window.visualViewport.offsetTop+window.visualViewport.height;console.log(o.top,o.bottom,i(),s());let c=0;if(o.top<i()&&o.bottom>i()){const t=document.documentElement.scrollTop;e.scrollIntoView(),document.documentElement.scrollTop-=i();const n=document.documentElement.scrollTop;c=t-n}const d=n();if("reduce"===t.motion.value()||0===t.animation_time.value())return void r(d,!1,!1);const u=Math.min(o.bottom,s())-o.top-c,h=document.documentElement.scrollTop;a(null),r(d,!1,!0),requestAnimationFrame((()=>{const t=e.getBoundingClientRect(),n=Math.min(t.bottom,s())-t.top;n!==u?(r(d,!0,!0),a(u),e.scrollTop=c,requestAnimationFrame((()=>{document.documentElement.scrollTop=h,e.scrollTop=c,a(n)}))):r(d,!1,!1)}))}),{defer:!0})),g((()=>{console.log("ANIMATING",ze),null!=l()?(e.style.height=l()+"px",e.style.overflow="hidden",e.style.transition=i((()=>ze&&"shift_slow"===t.animation_dev_mode.value()?3:t.animation_time.value()))+"s height"):(e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition"))}))}function Ge(e){const t=Le(),[n,r]=o({main:e.when,animating:!1});return(()=>{const o=He.cloneNode(!0);var l;return Be(l=o,t,(()=>e.when),((e,t,n)=>{r({main:e||t,animating:n})})),g((()=>{l.style.display=n().main||null!=e.fallback?"block":"none"})),s(o,p(ce,{get when(){return n().main||n().animating},get children(){const t=He.cloneNode(!0);return s(t,(()=>e.children)),c((()=>t.className=n().animating&&!n().main?"hidden":"")),t}}),null),s(o,p(ce,{get when(){return!n().main||n().animating},get children(){const t=He.cloneNode(!0);return s(t,(()=>e.fallback)),c((()=>t.className=n().animating&&n().main?"hidden":"")),t}}),null),o})()}document.addEventListener("keydown",(e=>{"Shift"===e.key&&(ze=!0)}),{capture:!0}),document.addEventListener("keyup",(e=>{"Shift"===e.key&&(ze=!1)}),{capture:!0}),document.addEventListener("focus",(e=>{ze=!1}));const Fe=r("<a></a>"),Ke=r("<span></span>"),Je=r('<a target="_blank" rel="noopener noreferrer"></a>');function Ye(e){const t=xe(),n=l((()=>{const n=Eo(t(),e.href,{});if(!n)return;const[r,l]=o(!1);return{visible:r,setVisible:l,body:n}}));return[p(Xe,{get href(){return e.href},get style(){return n()?"previewable":"normal"},get onClick(){return n()?()=>{const e=n();e.setVisible(!e.visible())}:void 0},get children(){return[y((()=>e.children)),p(de,{get when(){return n()},children:e=>[" ",y((()=>e.visible()?"▾":"▸"))]})]}}),p(de,{get when(){return n()},children:e=>p(Ge,{get when(){return e.visible()},get children(){return p(uo,{autoplay:!0,get body(){return e.body}})}})})]}function Qe(e){const t=xe(),n=l((()=>xo(t().id,e.href)));return p(se,{get item(){return n()},children:{error:t=>(()=>{const n=Fe.cloneNode(!0);return n.addEventListener("click",(t=>{t.stopPropagation(),alert(e.href)})),s(n,(()=>e.children)),c((o=>{const r=e.class+" error",l=t.title;return r!==o._v$&&(n.className=o._v$=r),l!==o._v$2&&d(n,"title",o._v$2=l),o}),{_v$:void 0,_v$2:void 0}),n})(),mailto:t=>(()=>{const n=Ke.cloneNode(!0);return s(n,(()=>e.children)),c((()=>d(n,"title",t.title))),n})(),link:t=>(()=>{const n=Je.cloneNode(!0);return n.addEventListener("click",!t.external||e.onClick?n=>{if(n.stopPropagation(),!n.defaultPrevented&&0===n.button&&!yo(n)){if(n.preventDefault(),e.onClick)return e.onClick();cr({path:t.url})}}:void 0),s(n,(()=>e.children)),c((o=>{const r=e.class,l=t.url;return r!==o._v$3&&(n.className=o._v$3=r),l!==o._v$4&&d(n,"href",o._v$4=l),o}),{_v$3:void 0,_v$4:void 0}),n})()}})}function Xe(e){return p(Qe,{get class(){return Yo[e.style]},get href(){return e.href},get onClick(){return e.onClick},get children(){return e.children}})}function Ze(e){return(()=>{const t=Ke.cloneNode(!0);return s(t,p(Xe,{style:"userlink",get href(){return e.href},get children(){return e.children}})),c((n=>_(t,(()=>{const[t,n]=Ue(qe(e.color_hash.toLowerCase()));return{"--light-color":De(t),"--dark-color":De(n)}})(),n))),t})()}const et=r("<span> points</span>"),tt=r("<button>⯆</button>"),nt=r("<span><button>⯅ </button></span>"),ot=r('<div class="flex flex-col items-center gap-2px"><button class="reddit-vote-button reddit-upvote-button" aria-label="Vote Up"><span>⯅ Vote</span></button><button class="reddit-vote-button reddit-downvote-button" aria-label="Vote Down"><span>⯆</span></button></div>');function rt(e){const[t,n]=o(null);let r;return l((()=>{const t=Wo(e().unique_id,{count:e().count_excl_you,you:e().you,time:e().time});a((()=>{t.cleanup()}));const{state:o,onupdate:l}=t.associated_data;return r=t.associated_data,n({...o}),l((()=>n({...o}))),0}))(),[t,e=>{Object.assign(r.state,e),r.emit()}]}function lt(e){const[t]=rt((()=>e.counter)),n=()=>qo(t());return[(()=>{const e=et.cloneNode(!0),t=e.firstChild;return s(e,(()=>n().text),t),c((()=>d(e,"title",n().raw))),e})(),p(de,{get when(){return e.counter.percent},children:e=>" "+e.toLocaleString(void 0,{style:"percent"})+" upvoted"})]}async function it(e,t,n,o,r){o({...n,loading:!0,your_vote:e});try{await async function(e,t,n){if("error"in n.actions)throw new Error("counter is error: "+n.actions.error);const o=n.actions[null!=e?e:"reset"];if(null==o)throw new Error("action "+e+" requested when it is not available.");await t.act(o)}(e,t,r),o({...n,loading:!1,your_vote:e})}catch(l){o({...n}),console.log(l),alert("Error while voting: "+l)}}function at(e){const[t,n]=rt((()=>e.counter)),o=xe();return(()=>{const r=nt.cloneNode(!0),l=r.firstChild;return l.firstChild,l.$$click=()=>{it("increment"===t().your_vote?void 0:"increment",o(),t(),n,e.counter)},s(l,p(lt,{get counter(){return e.counter}}),null),s(r,p(ce,{get when(){return null!=e.counter.decremented_label},get children(){const r=tt.cloneNode(!0);return r.$$click=()=>{it("decrement"===t().your_vote?void 0:"decrement",o(),t(),n,e.counter)},c((e=>{const n=t().loading,o=Yo["decrement"===t().your_vote?"action-button-active":"action-button"];return n!==e._v$&&(r.disabled=e._v$=n),o!==e._v$2&&(r.className=e._v$2=o),e}),{_v$:void 0,_v$2:void 0}),r}}),null),c((e=>{const n=t().loading,o=Yo["increment"===t().your_vote?"action-button-active":"action-button"];return n!==e._v$3&&(l.disabled=e._v$3=n),o!==e._v$4&&(l.className=e._v$4=o),e}),{_v$3:void 0,_v$4:void 0}),r})()}function st(e){const[t,n]=rt((()=>e.counter)),o=xe();return(()=>{const r=ot.cloneNode(!0),l=r.firstChild,i=l.nextSibling;return l.$$click=()=>{it("increment"===t().your_vote?void 0:"increment",o(),t(),n,e.counter)},i.$$click=()=>{it("decrement"===t().your_vote?void 0:"decrement",o(),t(),n,e.counter)},c((e=>{const n="increment"===t().your_vote,o=t().loading,r="increment"===t().your_vote,a="decrement"===t().your_vote,s=t().loading,c="decrement"===t().your_vote;return n!==e._v$5&&l.classList.toggle("vote-icon-voted",e._v$5=n),o!==e._v$6&&(l.disabled=e._v$6=o),r!==e._v$7&&d(l,"aria-pressed",e._v$7=r),a!==e._v$8&&i.classList.toggle("vote-icon-voted",e._v$8=a),s!==e._v$9&&(i.disabled=e._v$9=s),c!==e._v$10&&d(i,"aria-pressed",e._v$10=c),e}),{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),r})()}x(["click"]);const ct=r('<div><textarea class="border my-3 w-full resize-y"></textarea><div class="flex space-x-1"><button></button><button>Cancel<div></div></button></div></div>'),dt=r('<pre class="error"><code>There was an error! </code></pre>'),ut=r("<button>Hide error</button>");function ht(e){const t=xe(),[n,r]=o(""),l=()=>""===n().trim(),[i,a]=o(!1),[d,u]=o(void 0),[h,f]=G({value:null});return g((()=>{const o=t().previewReply(n(),e.action.reply_info);f(K({value:o},{merge:!0}))})),(()=>{const o=ct.cloneNode(!0),g=o.firstChild,f=g.nextSibling.firstChild,v=f.nextSibling;return g.$$input=e=>{r(e.currentTarget.value)},f.$$click=o=>{a(!0),t().sendReply(n(),e.action.reply_info).then((t=>{console.log("Got response",t),e.onAddReply({ref:{kind:"post",internal_data:t.raw_value,content:"thread"===t.kind?{kind:"legacy",thread:t}:{kind:"post",title:{text:"Error"},body:{kind:"richtext",content:[O.p(O.error("Unsupported 'load more'",t))]},show_replies_when_below_pivot:!1,collapsible:!1},display_style:"centered",parent:null,replies:null,url:null}})})).catch((e=>{a(!1);const t=e;console.log("Got error",t),u(t.toString()+"\n"+t.stack)}))},s(f,(()=>i()?"…":"Reply")),v.addEventListener("click",(t=>{console.log("Cancel button clicked"),n()&&!confirm("delete draft?")||e.onCancel()})),s(o,p(de,{get when(){return d()},children:e=>[(()=>{const t=dt.cloneNode(!0),n=t.firstChild;return n.firstChild,s(n,e,null),t})(),(()=>{const e=ut.cloneNode(!0);return e.addEventListener("click",(()=>u(void 0))),e})()]}),null),s(o,p(de,{get if(){return[!l()]},get when(){return h.value},children:e=>(console.log("Value changed",e),p(Jt,{restrict_w:!0,get children(){return p(Kt,{listing:e,opts:{clickable:!1,replies:null,at_or_above_pivot:!0,is_pivot:!0,top_level:!0,frame:null}})}}))}),null),c((e=>{const t=i(),o=n(),r=l()||i(),a=Yo[l()?"pill-empty":"pill-filled"],s=i(),c=Yo["pill-empty"];return t!==e._v$&&(g.disabled=e._v$=t),o!==e._v$2&&(g.value=e._v$2=o),r!==e._v$3&&(f.disabled=e._v$3=r),a!==e._v$4&&(f.className=e._v$4=a),s!==e._v$5&&(v.disabled=e._v$5=s),c!==e._v$6&&(v.className=e._v$6=c),e}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0}),o})()}x(["input","click"]);const pt=r("<section></section>"),gt=r("<button></button>"),ft=r("<button>Code</button>");function vt(e){const[t,n]=o(null);return[(()=>{const o=pt.cloneNode(!0);return s(o,(()=>e.children),null),s(o,p(de,{get when(){var t;return null==(t=e.opts.frame)?void 0:t.url},children:t=>p(Xe,{href:t,style:"action-button",get children(){return p(de,{get when(){var t;return null==(t=e.content.info)?void 0:t.comments},fallback:"Focus",children:e=>e.toLocaleString()+" comment"+(1===e?"":"s")})}})}),null),s(o,p(de,{get if(){return[!1===e.content.collapsible]},get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>p(at,{counter:e})}),null),s(o,p(de,{get if(){return[e.content.show_replies_when_below_pivot&&!e.opts.at_or_above_pivot]},get when(){var t,n;return null==(n=null==(t=e.opts.frame)?void 0:t.replies)?void 0:n.reply},children:o=>{const r=()=>p(ht,{get action(){return o.action},onCancel:()=>n(null),onAddReply:t=>{e.onAddReply(t),n(null)}});return(()=>{const e=gt.cloneNode(!0);return e.addEventListener("click",(()=>{t()===r?n(null):n((()=>r))})),s(e,(()=>o.action.text+(o.locked?" (Locked)":""))),c((n=>{const l=Yo[t()===r?"action-button-active":"action-button"],i=o.locked;return l!==n._v$&&(e.className=n._v$=l),i!==n._v$2&&(e.disabled=n._v$2=i),n}),{_v$:void 0,_v$2:void 0}),e})()}}),null),s(o,p(de,{get when(){var t;return null==(t=e.content.actions)?void 0:t.other},children:e=>p(w,{each:e,children:(e,t)=>p(mt,{action:e})})}),null),s(o,p(de,{get when(){var t,n,o;return null==(o=null==(n=null==(t=e.content)?void 0:t.actions)?void 0:n.code)?void 0:o.body},get fallback(){return(()=>{const t=ft.cloneNode(!0);return t.addEventListener("click",(()=>{console.log(e.opts.frame)})),c((()=>t.className=Yo["code-button"])),t})()},children:o=>{const r=()=>p(uo,{body:o,autoplay:!0});return(()=>{const o=ft.cloneNode(!0);return o.addEventListener("click",(()=>{console.log(e.opts.frame),t()===r?n(null):n((()=>r))})),c((()=>o.className=Yo[t()===r?"action-button-active":"action-button"])),o})()}}),null),c((()=>o.className="flex flex-wrap gap-2 "+(Pe()<Te?"flex-col":"items-center"))),o})(),p(de,{get when(){return t()},children:e=>e()})]}function mt(e){return p(Me,{getValue:(t,n)=>{const o=el("span");return Mo(n(),e.action,o,{value_for_code_btn:0}).defer(t),o}})}const bt=r('<img class="w-8 h-8 object-center inline-block rounded-full">'),_t=r("<span></span>"),yt=r('<img class="inline-block w-4 h-4 align-middle object-contain">'),xt=r("<div>Error! </div>"),wt=r("<li></li>"),kt=r('<div><button class="flex-1 collapse-btn z-1 static outline-default" aria-label="Collapse"><div class="collapse-btn-inner"></div></button></div>'),$t=r("<button></button>"),Nt=r("<div><button></button></div>"),Ct=r("<div></div>"),Et=r('<div class="mt-2"></div>'),Lt=r("<section></section>"),Pt=r('<article><div class="flex-1"><div class="flex flex-row"><div><div></div><div></div></div></div><div></div></div></article>'),St=r('<img alt="">'),Tt=r('<span role="heading"></span>'),Ot=r('<span class="whitespace-normal"></span>'),At=r('<span class="text-green-600 dark:text-green-500">Pinned</span>'),jt=r("<button>Show Anyway</button>"),Rt=r('<ul class="-ml-3px"></ul>'),Vt=r("<button>code</button>"),Mt=r('<hr class="my-2 border-t-2">'),It=r('<div class="mb-6"></div>'),Dt=r("<div><button>Write Reply</button></div>"),Wt=r("<div>*There are no replies*</div>"),qt=r("<div>Error: </div>");function Ut(e){return(()=>{const t=bt.cloneNode(!0);return d(t,"alt",""),c((()=>d(t,"src",e.src_url))),t})()}function Ht(e){return(()=>{const t=_t.cloneNode(!0);return s(t,p(w,{get each(){return e.flairs},children:e=>[" ",(()=>{const t=_t.cloneNode(!0);return s(t,p(w,{get each(){return e.elems},children:e=>p(se,{item:e,children:{text:e=>()=>e.text,emoji:e=>(()=>{const t=yt.cloneNode(!0);return c((n=>{const o=e.name,r=e.url,l=e.w,i=e.h;return o!==n._v$4&&d(t,"title",n._v$4=o),r!==n._v$5&&d(t,"src",n._v$5=r),l!==n._v$6&&d(t,"width",n._v$6=l),i!==n._v$7&&d(t,"height",n._v$7=i),n}),{_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),t})()}})})),c((n=>{const o=null!=e.system?e.system:"rounded-full px-2"+(null!=e.color?" bg-flair-light dark:bg-flair-dark":" bg-gray-300")+(null!=e.fg_color?" flair-text-"+e.fg_color:""),r=e.color,l=e.color;return o!==n._v$&&(t.className=n._v$=o),r!==n._v$2&&t.style.setProperty("--flair-color",n._v$2=r),l!==n._v$3&&t.style.setProperty("--flair-color-dark",n._v$3=l),n}),{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()]})),t})()}function zt(e){return(()=>{const t=y((()=>!!e.fallback),!0);return p(ce,{get when(){return null==e.link.err},get fallback(){return t()?i((()=>e.fallback(e.link.err))):(()=>{const t=xt.cloneNode(!0);return t.firstChild,s(t,(()=>e.link.err),null),t})()},get children(){return i((()=>e.children(e.link.ref)))}})})()}function Bt(e){const t=l((()=>{var t,n;if(!e.is_threaded)return;const o=null==(n=null==(t=e.reply.ref)?void 0:t.replies)?void 0:n.items;return o&&1===o.length?o[0]:void 0}));return[(()=>{const n=wt.cloneNode(!0);return s(n,p(zt,{get link(){return e.reply},children:e=>p(se,{item:e,children:{post:n=>p(Gt,{get content(){return n.content},get opts(){return{clickable:!1,at_or_above_pivot:!1,is_pivot:!1,frame:n,replies:null!=t()?null:e.replies,top_level:!1}}}),loader:()=>"TODO load more TODO load more may have replies"}})})),c((()=>{var o;return n.className=Oe(e.is_threaded&&(null!=t()||null!=(o=e.parent_is_threaded)&&o)?["relative","threaded"]:[])})),n})(),p(de,{get when(){return t()},children:e=>p(Bt,{reply:e,is_threaded:!0,parent_is_threaded:!0})})]}function Gt(e){return p(se,{get item(){return e.content},children:{post:t=>p(Ft,{content:t,get opts(){return e.opts}}),page:()=>"TODO page",legacy:e=>p(Me,{getValue:(t,n)=>{const o=el("div").clss("-mt-10px -ml-10px"),r=el("div").clss("post text-sm").adto(o);return Jo(n(),e.thread,r,{clickable:!0}).defer(t),o}}),client:()=>"TODO client"}})}function Ft(e){var t;const n=!1!==e.content.collapsible&&e.content.collapsible.default_collapsed,[r,i]=o(!!e.opts.is_pivot||!n),[a,u]=o(!!(null!=(t=e.content.flair)?t:[]).find((e=>e.content_warning))),h=()=>!!e.content.thumbnail||!!e.content.title,f=()=>!!e.content.thumbnail,v=Le(),m=xe(),[b,_]=o(r()),[x,k]=o({visible:r(),animating:!1}),[$,N]=o(!1),C=()=>Pe()<Te;g((()=>{C()||N(!1)}));const E=()=>{var t;return null!=(null==(t=e.opts.frame)?void 0:t.url)&&!e.opts.is_pivot},[L,P]=o([]),S=e=>{P((t=>[e,...t]))};return(()=>{const t=Pt.cloneNode(!0),o=t.firstChild,g=o.firstChild,P=g.firstChild,T=P.firstChild,O=T.nextSibling,A=g.nextSibling;return Be(t,v,b,((e,t,n)=>{k({visible:t||e,animating:n}),i(e||t)})),t.style.setProperty("--left-v","8px"),s(t,p(ce,{get when(){return!1!==e.content.collapsible},get children(){const t=kt.cloneNode(!0),n=t.firstChild;return s(t,p(de,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>(()=>{const t=Ct.cloneNode(!0);return s(t,p(st,{counter:e})),c((()=>t.className=r()||f()?"":" hidden")),t})()}),n),n.$$click=e=>{_((e=>!e))},d(n,"draggable",!0),c((o=>{const l="flex flex-col items-center mr-1 gap-2 "+(e.opts.top_level?"sm:px-1":"sm:pr-1"),i=!r(),a=!b();return l!==o._v$8&&(t.className=o._v$8=l),i!==o._v$9&&n.classList.toggle("collapsed",o._v$9=i),a!==o._v$10&&d(n,"aria-pressed",o._v$10=a),o}),{_v$8:void 0,_v$9:void 0,_v$10:void 0}),t}}),o),s(g,p(de,{get when(){return e.content.thumbnail},children:e=>(()=>{const t=$t.cloneNode(!0);return t.$$click=()=>_((e=>!e)),s(t,p(se,{item:e,children:{image:e=>(()=>{const t=St.cloneNode(!0);return c((n=>{const o=e.url,r=Oe("w-full h-full object-contain");return o!==n._v$16&&d(t,"src",n._v$16=o),r!==n._v$17&&(t.className=n._v$17=r),n}),{_v$16:void 0,_v$17:void 0}),t})(),default:e=>["TODO ",y((()=>e.kind))]}})),c((()=>t.className=Oe("w-50px h-50px sm:w-70px sm:h-70px mr-4",a()&&"image"===e.kind?"thumbnail-content-warning":""))),t})()}),P),P.$$click=t=>{var n;if(!E())return;if(!ue(t.target,t.currentTarget))return;t.stopPropagation();const o="/"+m().id+(null==(n=e.opts.frame)?void 0:n.url);t.ctrlKey||t.metaKey||t.altKey?window.open(o):cr({path:o})},s(T,p(de,{get when(){return e.content.title},children:t=>(()=>{const n=Tt.cloneNode(!0);return s(n,p(de,{get when(){var t;return null==(t=e.opts.frame)?void 0:t.url},get fallback(){return t.text},children:e=>p(Qe,{href:e,class:"hover:underline",get children(){return t.text}})})),n})()}),null),s(T,p(Ht,{get flairs(){var t;return null!=(t=e.content.flair)?t:[]}}),null),s(O,p(de,{get when(){return e.content.author},children:e=>[p(de,{get if(){return[r()&&"on"===v.author_pfp.value()]},get when(){return e.pfp},fallback:"By ",children:e=>[p(Ut,{get src_url(){return e.url}})," "]}),p(Ze,{get href(){return e.link},get color_hash(){return e.color_hash},get children(){return e.name}})," "]}),null),s(O,p(ce,{get when(){return r()||h()},get fallback(){return p(ce,{when:n,get fallback(){return(()=>{const t=Ot.cloneNode(!0);return s(t,(()=>"“"+(()=>{const t=po(e.content.body);return t.length>500?t.substring(0,500)+"…":t})()+"”")),t})()},get children(){return p(de,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},fallback:"[Collapsed by default]",children:e=>[p(lt,{counter:e})," "]})}})},get children(){return[p(de,{get when(){return e.content.author},children:e=>p(de,{get when(){return e.flair},children:e=>[p(Ht,{flairs:e})," "]})}),p(de,{get when(){var t;return null==(t=e.content.info)?void 0:t.in},children:e=>[" in ",p(Xe,{get href(){return e.link},style:"normal",get children(){return e.name}})," "]}),p(de,{get when(){var t;return null==(t=e.content.actions)?void 0:t.vote},children:e=>[p(lt,{counter:e})," "]}),p(de,{get when(){return e.content.info},children:e=>[p(de,{get when(){return e.creation_date},children:e=>[p(pe,{start:e})," "]}),p(de,{get when(){return e.edited},children:e=>["Edited",p(de,{get when(){return e.date},children:e=>[" ",p(pe,{start:e})]})," "]}),p(ce,{get when(){var t;return null!=(t=e.pinned)&&t},get children(){return[At.cloneNode(!0)," "]}})]}),p(ce,{get when(){return C()},get children(){const e=$t.cloneNode(!0);return e.$$click=()=>N((e=>!e)),s(e,(()=>$()?"▾":"▸")),c((()=>e.className=Yo["outlined-button"])),e}})]}}),null),s(P,(()=>{const t=y((()=>!!f()),!0);return p(ce,{get when(){return t()&&!C()},get children(){const t=Ct.cloneNode(!0);return s(t,p(vt,{get content(){return e.content},get opts(){return e.opts},onAddReply:S,get children(){const e=Nt.cloneNode(!0),t=e.firstChild;return t.$$click=()=>_((e=>!e)),s(t,(()=>b()?"Hide":"Show")),c((()=>t.className=Yo["outlined-button"])),e}})),c((()=>t.className=h()?"":"text-xs")),t}})})(),null),s(o,(()=>{const t=y((()=>!!C()),!0);return p(Ge,{get when(){return t()&&$()},get children(){return p(vt,{get content(){return e.content},get opts(){return e.opts},onAddReply:S})}})})(),A),s(A,p(ke,{visible:()=>x().visible||x().animating,get children(){return[(()=>{const t=Lt.cloneNode(!0);return s(t,p(ce,{get when(){return x().visible||x().animating},get children(){return[(()=>{const e=y((()=>!!r()),!0);return p(ce,{get when(){return e()&&f()},get children(){return Et.cloneNode(!0)}})})(),p(Ge,{get when(){return!a()},get fallback(){return["Content Warning:"," ",p(Ht,{get flairs(){var t;return(null!=(t=e.content.flair)?t:[]).filter((e=>e.content_warning))}})," ",(()=>{const e=jt.cloneNode(!0);return e.$$click=()=>u(!1),c((()=>e.className=Yo["pill-filled"])),e})()]},get children(){return p(uo,{get body(){return e.content.body},autoplay:!1})}})]}})),t})(),(()=>{const t=y((()=>!f()),!0);return p(ce,{get when(){return t()&&!C()},get children(){const t=Ct.cloneNode(!0);return s(t,p(vt,{get content(){return e.content},get opts(){return e.opts},onAddReply:S})),c((()=>t.className=h()?"":"text-xs")),t}})})(),p(ce,{get when(){return!e.opts.at_or_above_pivot},get children(){return p(de,{get when(){return e.opts.replies},children:t=>{const n=l((()=>[...L(),...t.items]));return p(ce,{get when(){return!1!==e.content.show_replies_when_below_pivot},get children(){const e=Rt.cloneNode(!0);return s(e,p(w,{get each(){return n()},children:e=>p(Bt,{reply:e,get is_threaded(){return 1===n().length}})})),e}})}})}})]}})),c((n=>{const o=Oe("text-sm","pt-10px",!1!==e.content.collapsible?e.opts.top_level?"pl-1":"":"pl-15px","flex flex-row",e.opts.top_level?"-mt-10px -ml-10px":[]),l="flex-1"+(E()?" hover-outline":""),i=Oe(h()?"text-base":"text-xs"),a=Oe(h()?"":"text-xs",r()||f()?"":"filter grayscale text-$collapsed-header-color italic max-lines max-lines-1"),s=r()?"block":"none";return o!==n._v$11&&(t.className=n._v$11=o),l!==n._v$12&&(P.className=n._v$12=l),i!==n._v$13&&(T.className=n._v$13=i),a!==n._v$14&&(O.className=n._v$14=a),s!==n._v$15&&A.style.setProperty("display",n._v$15=s),n}),{_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),t})()}function Kt(e){const t=e=>["TODO support. also in the parent list these should probably"," ","be one of those navbars with bits like ClientName ",">"," PageName ",">"," …"," ",(()=>{const t=Vt.cloneNode(!0);return t.addEventListener("click",(()=>console.log(e))),t})()];return(()=>{const n=Ct.cloneNode(!0);return s(n,p(je,{get data(){return[e.listing,e.opts]},get children(){return p(se,{get item(){return e.listing},children:{page:e=>t(e),client:e=>t(e),post:t=>p(Ft,{content:t,get opts(){return e.opts}}),legacy:t=>p(Me,{getValue:(n,o)=>Fo(o(),t.thread,{clickable:e.opts.clickable}).defer(n)})}})}})),n})()}function Jt(e){return p(be,{children:(t,n)=>(()=>{const o=Ct.cloneNode(!0);return s(o,(()=>e.children)),c((()=>{var r;return o.className=(0===n?"object-wrapper top-level-wrapper":"p-10px mt-10px rounded-xl")+" "+t+" "+(null!=(r=e.restrict_w)&&r?"max-w-xl":"")})),o})()})}function Yt(e){const t=()=>[p(se,{get item(){return e.node},children:{post:t=>p(se,{get item(){return t.content},children:{post:n=>p(Jt,{get children(){return p(Kt,{listing:n,get opts(){return{clickable:!e.is_pivot,frame:t,replies:t.replies,at_or_above_pivot:!0,top_level:!0,is_pivot:e.is_pivot}}})}}),page:e=>p(Jt,{get children(){return p(Me,{getValue:(t,n)=>{const o=el("div").clss("post text-sm").styl({margin:"-10px",padding:"10px"});return Go(n(),e.wrap_page.header,o).defer(t),o}})}}),legacy:e=>"TODO legacy in wrapParent",client:()=>"TODO client"}}),loader:()=>"TODO loader"}}),y((()=>e.children))];return p(de,{get when(){return e.node.parent},get fallback(){return t()},children:e=>p(zt,{link:e,fallback:e=>[(()=>{const t=qt.cloneNode(!0);return t.firstChild,s(t,e,null),t})(),(()=>{const e=Ct.cloneNode(!0);return s(e,t),e})()],children:e=>p(Yt,{node:e,get children(){return t()},is_pivot:!1})})})}x(["click"]);var Qt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",AuthorPfp:Ut,Flair:Ht,ClientPostReply:Bt,ClientContentAny:Gt,ClientContent:Kt,ClientPage:function(e){const[t,n]=o(!1),[r,l]=o([]);return p(Yt,{get node(){return e.page.pivot.ref},is_pivot:!0,get children(){return p(de,{get when(){return e.page.pivot.ref.replies},children:o=>[(()=>{const e=Mt.cloneNode(!0);return e.style.setProperty("border-top-color","var(--collapse-line-color)"),e})(),p(de,{get when(){return o.reply},children:e=>p(Ge,{get when(){return t()},get fallback(){return(()=>{const t=Dt.cloneNode(!0),o=t.firstChild;return o.firstChild,o.$$click=()=>{n(!0)},s(o,(()=>e.locked?" (Locked)":""),null),c((t=>{const n=Yo["pill-empty"],r=e.locked;return n!==t._v$18&&(o.className=t._v$18=n),r!==t._v$19&&(o.disabled=t._v$19=r),t}),{_v$18:void 0,_v$19:void 0}),t})()},get children(){return p(ht,{get action(){return e.action},onCancel:()=>{n(!1)},onAddReply:e=>{n(!1),l((t=>[e,...t]))}})}})}),It.cloneNode(!0),null,p(w,{get each(){return[...r(),...o.items]},get fallback(){return Wt.cloneNode(!0)},children:t=>p(zt,{link:t,children:t=>p(se,{item:t,children:{post:t=>p(Jt,{get children(){return[p(ce,{get when(){return t.parent!==e.page.pivot},children:"TODO parent posts"}),p(Gt,{get content(){return t.content},get opts(){return{clickable:!1,frame:t,replies:t.replies,at_or_above_pivot:!1,top_level:!0,is_pivot:!1}}})]}}),loader:()=>"TODO load more"}})})})]})}})},TopLevelWrapper:Jt});const Xt=r("<span></span>"),Zt=r("<br>"),en=r('<button title="Click to reveal spoiler"></button>'),tn=r('<span class="relative bg-spoiler-color-hover rounded"><span></span></span>'),nn=r('<img class="w-4 h-4 object-contain inline-block">'),on=r('<code class="bg-gray-200 p-1 rounded text-gray-800"></code>'),rn=r("<p></p>"),ln=r('<h1 class="text-3xl text-gray-900 font-black"></h1>'),an=r('<h2 class="text-2xl text-gray-900 font-bold"></h2>'),sn=r('<h3 class="text-xl text-gray-900 font-semibold"></h3>'),cn=r('<h4 class="text-lg text-gray-900 font-medium"></h4>'),dn=r('<h5 class="text-base text-gray-600 font-normal"></h5>'),un=r('<h6 class="text-sm text-gray-600 font-normal underline"></h6>'),hn=r('<div class="py-2"><div class="w-full h-2px bg-gray-400 rounded"></div></div>'),pn=r('<blockquote class="border-l-2 border-gray-600 text-gray-600 pl-3"></blockquote>'),gn=r("<li></li>"),fn=r("<div></div>"),vn=r('<ol class="list-decimal pl-4"></ol>'),mn=r('<ul class="list-disc pl-4"></ul>'),bn=r("<table><thead><tr></tr></thead><tbody></tbody></table>"),_n=r("<th></th>"),yn=r("<tr></tr>"),xn=r("<td></td>"),wn=r('<select class="block"><option value="null">None</option></select>'),kn=r('<pre tabindex="0"><div></div></pre>'),$n=r("<button> </button>"),Nn=r("<option></option>"),Cn=r('<code class="!whitespace-pre-wrap"></code>'),En=r('<div class="my-2"></div>'),Ln=r('<div class="max-lines max-lines-1"></div>'),Pn=r('<div><div class="max-lines max-lines-1 break-all font-light text-gray-800 dark:text-gray-400"></div></div>'),Sn=r('<div class="max-1-line break-all font-light text-gray-800 dark:text-gray-400"></div>'),Tn=r('<div class="inline-block"></div>'),On={link:"normal","pill-empty":"pill-empty"};function An(e){const t=()=>{var t;return"link"===(null!=(t=e.rts.style)?t:"link")};return(()=>{const n=Xt.cloneNode(!0);return s(n,p($,{get children(){return[p(k,{get when(){return null!=e.rts.is_user_link&&e.rts.is_user_link},children:t=>p(Ze,{color_hash:t,get href(){return e.rts.url},get children(){return p(Rn,{get spans(){return e.rts.children}})}})}),(()=>{const n=y((()=>null==e.rts.is_user_link),!0);return p(k,{get when(){return n()&&t()},get children(){return p(Ye,{get href(){return e.rts.url},get children(){return p(Rn,{get spans(){return e.rts.children}})}})}})})(),(()=>{const n=y((()=>null==e.rts.is_user_link),!0);return p(k,{get when(){return n()&&!t()},get children(){return p(Xe,{get href(){return e.rts.url},get style(){var t;return On[null!=(t=e.rts.style)?t:"link"]},get children(){return p(Rn,{get spans(){return e.rts.children}})}})}})})()]}})),c((()=>d(n,"title",e.rts.title))),n})()}function jn(e){return p(se,{get item(){return e.span},children:{text:e=>(()=>{const t=Xt.cloneNode(!0);return t.classList.toggle("whitespace-pre-wrap",!0),s(t,(()=>e.text)),c((n=>{const o=e.styles.strong,r=e.styles.emphasis,l=e.styles.strikethrough,i=e.styles.superscript,a=e.styles.superscript;return o!==n._v$&&t.classList.toggle("font-bold",n._v$=o),r!==n._v$2&&t.classList.toggle("italic",n._v$2=r),l!==n._v$3&&t.classList.toggle("line-through",n._v$3=l),i!==n._v$4&&t.classList.toggle("align-top",n._v$4=i),a!==n._v$5&&t.classList.toggle("text-xs",n._v$5=a),n}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})(),link:e=>p(An,{rts:e}),br:()=>Zt.cloneNode(!0),spoiler:e=>{const[t,n]=o(!1);return(()=>{const o=tn.cloneNode(!0),r=o.firstChild;return s(o,p(ce,{get when(){return!t()},get children(){const e=en.cloneNode(!0);return e.className="absolute top-0 left-0 bottom-0 right-0 w-full h-full rounded bg-spoiler-color hover:bg-spoiler-color-hover cursor-pointer",e.addEventListener("click",(()=>n(!0))),e}}),r),s(r,p(Rn,{get spans(){return e.children}})),c((()=>r.className=Oe("rounded","transition-opacity","bg-spoiler-color-revealed",t()?"":"opacity-0 invisible"))),o})()},emoji:e=>(()=>{const t=nn.cloneNode(!0);return c((n=>{const o=e.url,r=e.name;return o!==n._v$6&&d(t,"src",n._v$6=o),r!==n._v$7&&d(t,"title",n._v$7=r),n}),{_v$6:void 0,_v$7:void 0}),t})(),flair:e=>p(Ht,{get flairs(){return[e.flair]}}),time_ago:e=>p(pe,{get start(){return e.start}}),error:e=>p(Me,{getValue:(t,n)=>Xo("error").atxt(e.text).onev("click",(t=>{console.log(e.value)}))}),code:e=>(()=>{const t=on.cloneNode(!0);return s(t,(()=>e.text)),t})()}})}function Rn(e){return p(w,{get each(){return e.spans},children:e=>p(jn,{span:e})})}function Vn(e){return p(se,{get item(){return e.paragraph},children:{paragraph:e=>(()=>{const t=rn.cloneNode(!0);return s(t,p(Rn,{get spans(){return e.children}})),t})(),body:e=>p(uo,{get body(){return e.body},autoplay:!1}),heading:e=>{const t=()=>p(Rn,{get spans(){return e.children}});return 1===e.level?(()=>{const e=ln.cloneNode(!0);return s(e,t),e})():2===e.level?(()=>{const e=an.cloneNode(!0);return s(e,t),e})():3===e.level?(()=>{const e=sn.cloneNode(!0);return s(e,t),e})():4===e.level?(()=>{const e=cn.cloneNode(!0);return s(e,t),e})():5===e.level?(()=>{const e=dn.cloneNode(!0);return s(e,t),e})():(()=>{const e=un.cloneNode(!0);return s(e,t),e})()},horizontal_line:()=>hn.cloneNode(!0),blockquote:e=>(()=>{const t=pn.cloneNode(!0);return s(t,p(Hn,{get content(){return e.children}})),t})(),list:e=>{const t=l((()=>e.children.every((e=>"tight_list_item"===e.kind||1===e.children.length)))),n=()=>p(w,{get each(){return e.children},children:e=>(()=>{const n=gn.cloneNode(!0);return s(n,p(se,{item:e,children:{list_item:e=>p(Hn,{get content(){return e.children},get tight(){return t()}}),tight_list_item:e=>(()=>{const n=fn.cloneNode(!0);return s(n,p(Rn,{get spans(){return e.children}})),c((()=>n.classList.toggle("my-2",!t()))),n})()}})),c((()=>n.classList.toggle("tight",t()))),n})()});return e.ordered?(()=>{const e=vn.cloneNode(!0);return s(e,n),e})():(()=>{const e=mn.cloneNode(!0);return s(e,n),e})()},code_block:e=>p(qn,{get text(){return e.text},get default_language(){var t;return null!=(t=e.lang)?t:null}}),table:e=>(()=>{const t=bn.cloneNode(!0),n=t.firstChild,o=n.firstChild,r=n.nextSibling;return s(o,p(w,{get each(){return e.headings},children:e=>(()=>{const t=_n.cloneNode(!0);return s(t,p(Rn,{get spans(){return e.children}})),c((()=>{var n;return t.className=Mn[null!=(n=e.align)?n:"none"]})),t})()})),s(r,p(w,{get each(){return e.children},children:t=>(()=>{const n=yn.cloneNode(!0);return s(n,p(w,{each:t,children:(t,n)=>(()=>{const o=xn.cloneNode(!0);return s(o,p(Rn,{get spans(){return t.children}})),c((()=>{var t,r;return o.className=Mn[null!=(r=null==(t=e.headings[n()])?void 0:t.align)?r:"none"]})),o})()})),n})()})),t})()}})}const Mn={left:"text-left",center:"text-center",right:"text-right",none:""},[In,Dn]=o(void 0);let Wn=!1;function qn(e){const[t,n]=o(e.default_language);g((()=>n(e.default_language)));const[r,l]=o(null),[i,d]=o(!1);return g((()=>{(null!=t()||i())&&(In()&&!Wn||(Wn=!0,T((()=>import("./prismjs.598efd6d.js").then((function(e){return e.p}))),["assets/prismjs.598efd6d.js","assets/_commonjsHelpers.4e997714.js"]).then((e=>Dn(e))).catch((e=>{alert("error loading syntax highlighter"),Wn=!1,console.log(e)}))))})),g((()=>{var n;let o=!0;a((()=>o=!1)),l(null),In()&&null!=t()&&In().highlight(e.text,null!=(n=t())?n:"plaintext").then((e=>{o&&(l(e),null==e&&console.log("syn hl language not supported",t()))})).catch((e=>{console.log(e),alert("error highlighting")}))})),(()=>{const o=kn.cloneNode(!0),l=o.firstChild;return s(l,(()=>{const e=y((()=>!!In()),!0);return p(ce,{get when(){return e()&&i()},get fallback(){return(()=>{const e=$n.cloneNode(!0),n=e.firstChild;return e.$$click=()=>{d((e=>!e))},s(e,(()=>{var e;return null!=(e=t())?e:"None"}),n),s(e,(()=>i()?"▴":"▾"),null),c((()=>e.className=Oe(["font-sans"]))),e})()},get children(){const e=wn.cloneNode(!0);return e.firstChild,e.$$input=e=>{const t=e.currentTarget.value;n("null"===t?null:t)},s(e,p(w,{get each(){return In().listLanguages().sort(((e,t)=>e.localeCompare(t)))},children:e=>(()=>{const t=Nn.cloneNode(!0);return t.value=e,s(t,e),t})()}),null),e}})})()),s(o,p(de,{get when(){return r()},get fallback(){return(()=>{const t=Cn.cloneNode(!0);return s(t,(()=>e.text)),t})()},children:e=>(()=>{const t=fn.cloneNode(!0);return t.innerHTML=e,t})()}),null),c((e=>{var n;const r=Oe(["bg-gray-200 p-2 rounded text-gray-800","relative","group","outline-default","language-"+(null!=(n=t())?n:"none"),"!whitespace-pre-wrap"]),i=Oe(["absolute","top-0 right-0","transition-opacity","opacity-0","group-hover:opacity-100","group-focus:opacity-100","focus:opacity-100","bg-gray-100 rounded","p-2 px-3"]);return r!==e._v$8&&(o.className=e._v$8=r),i!==e._v$9&&(l.className=e._v$9=i),e}),{_v$8:void 0,_v$9:void 0}),o})()}function Un(e){const t=Le(),n=xe(),r=l((()=>{const t=Eo(n(),e.link.url,{});if(!t)return;const[r,l]=o(!1);return{visible:r,toggleVisible:()=>l((e=>!e)),body:t}})),i=l((()=>{const t=xo(n().id,e.link.url);return"link"===t.kind?{link:t.url,external:t.external}:{link:"error",external:!0}})),[a,d]=o({open:!1,temporary:!1});return p(ce,{get when(){return"error"!==i().link},get children(){const n=En.cloneNode(!0);return s(n,p(be,{children:t=>p(Qe,{get class(){return Oe("p-2 px-4","block",t,"rounded-xl",a().open?"rounded-b-none":"")},get href(){return e.link.url},get onClick(){return r()?()=>{r().toggleVisible()}:void 0},get children(){return[(()=>{const t=Ln.cloneNode(!0);return s(t,p(de,{get when(){return r()},children:e=>()=>e.visible()?"▾ ":"▸ "}),null),s(t,(()=>e.link.title),null),t})(),p(ce,{get when(){return!a().open||a().temporary},get children(){const e=Pn.cloneNode(!0),t=e.firstChild;return s(t,(()=>{const e=y((()=>!r()),!0);return p(ce,{get when(){return e()&&i().external},get children(){return[p(Bn,{})," "]}})})(),null),s(t,(()=>i().link),null),c((()=>e.style.setProperty("display",a().open?"none":"block"))),e}})]}})}),null),s(n,p(de,{get when(){return r()},children:n=>[(()=>{const e=fn.cloneNode(!0);return Be(e,t,n.visible,((e,t,n)=>{d({open:e||t,temporary:n})})),s(e,p(ce,{get when(){return a().open||a().temporary},get children(){const e=fn.cloneNode(!0);return s(e,p(uo,{get body(){return n.body},autoplay:!0})),c((()=>e.style.setProperty("display",a().open?"block":"none"))),e}})),e})(),p(ce,{get when(){return a().open||a().temporary},get children(){const t=fn.cloneNode(!0);return s(t,p(be,{children:t=>p(Qe,{get class(){return Oe("p-2 px-4","block",t,"rounded-xl rounded-t-none")},get href(){return e.link.url},get children(){const e=Sn.cloneNode(!0);return s(e,p(ce,{get when(){return i().external},get children(){return[p(Bn,{})," "]}}),null),s(e,(()=>i().link),null),e}})})),c((()=>t.style.setProperty("display",a().open?"block":"none"))),t}})]}),null),n}})}function Hn(e){const t=Le();return p(w,{get each(){return e.content},children:n=>[(()=>{const t=fn.cloneNode(!0);return s(t,p(Vn,{paragraph:n})),c((()=>{var n;return t.classList.toggle("my-2",!(null!=(n=e.tight)&&n))})),t})(),p(ce,{get when(){return"show"===t.link_helpers.value()},get children(){return p(w,{get each(){return function(e){return ie(e,{paragraph:e=>Gn(e.children),body:()=>[],heading:e=>Gn(e.children),horizontal_line:()=>[],blockquote:()=>[],list:e=>e.children.flatMap((e=>"tight_list_item"===e.kind?Gn(e.children):[])),code_block:()=>[],table:e=>[...e.headings.flatMap((e=>Gn(e.children))),...e.children.flatMap((e=>e.flatMap((e=>Gn(e.children)))))]})}(n)},children:e=>p(Un,{link:e})})}})]})}function zn(e){return p(Hn,{get content(){return e.content}})}function Bn(){return(()=>{const e=Tn.cloneNode(!0);return s(e,p(Ae,{size:"icon-sm",icon:{class:"icon-external",label:"External"}})),e})()}function Gn(e){return e.flatMap((e=>ie(e,{link:e=>[{title:Kn(e.children),url:e.url}],error:()=>[],text:()=>[],br:()=>[],spoiler:e=>Gn(e.children),emoji:()=>[],flair:()=>[],time_ago:()=>[],code:()=>[]})))}function Fn(e){return e.map((e=>ie(e,{paragraph:e=>Kn(e.children),body:e=>po(e.body),heading:e=>Kn(e.children),horizontal_line:e=>"---",blockquote:e=>Fn(e.children),list:e=>e.children.map(((t,n)=>{const o=e.ordered?n+". ":"• ";return"tight_list_item"===t.kind?o+Kn(t.children):"list_item"===t.kind?o+Fn(t.children):void te(t)})).join("\n"),code_block:e=>e.text,table:()=>"[table]"}))).join("\n")}function Kn(e){return e.map((e=>ie(e,{link:e=>Kn(e.children),error:e=>"[error]",text:e=>e.text,br:()=>"\n",spoiler:e=>"[spoiler]",emoji:e=>":"+e.name+":",flair:()=>"[flair]",time_ago:()=>"[time ago]",code:e=>e.text}))).join("")}x(["input","click"]);const Jn=r("<div>Loading...</div>"),Yn=r("<div><div></div></div>"),Qn=r('<div><div class="border p-2"><div class="font-bold"></div><div></div></div></div>'),Xn=r("<button></button>"),Zn=r("<div></div>"),eo=r("<div><div>TODO polls are currently not supported</div><ul></ul></div>"),to=r("<li> (<!>)</li>"),no=r("<div>Caption: </div>"),oo=r("<audio></audio>"),ro=r('<div><h1 class="text-base font-light"><svg aria-label="Mastodon" class="preview-image" viewBox="0 0 713.35878 175.8678" style="fill: currentColor;"><use href="/images/mastodon/Logotype (Full).svg#base" width="713.35878" height="175.8678"></use></svg></h1><h2 class="text-2xl font-black py-1">Select your instance</h2><div class="py-1"><label>Instance Name: <input class="border rounded-md p-1" placeholder="mastodon.social"></label><button>Go →</button></div><p class="py-2">Not on mastodon? Join at </p><p class="py-2">Note that some instances may require logging in before they let you view timelines.</p></div>'),lo=r("<button><img></button>"),io=r("<button>Prev</button>"),ao=r("<button>Next</button>"),so=r("<button>Gallery</button>"),co=E((()=>T((()=>import("./preview_video.2225e7bd.js")),["assets/preview_video.2225e7bd.js","assets/vendor.03bc8c46.js"])));function uo(e){return p(je,{get data(){return e.body},get children(){return p(N,{get fallback(){return Jn.cloneNode(!0)},get children(){return p(ho,{get body(){return e.body},get autoplay(){return e.autoplay}})}})}})}function ho(e){return p(se,{get item(){return e.body},children:{text:e=>{const[t]=C(e,To);return p(de,{get when(){return t()},children:e=>p(uo,{body:e,autoplay:!1})})},link:t=>{const n=xe(),o=l((()=>{const e=Eo(n(),t.url,{suggested_embed:t.embed_html});if(e)return{body:e}}));return(()=>{const n=Yn.cloneNode(!0),r=n.firstChild;return s(r,p(Xe,{get href(){return t.url},style:"normal",get children(){return t.url}})),s(n,p(de,{get when(){return o()},children:t=>p(uo,{get body(){return t.body},get autoplay(){return e.autoplay}})}),null),n})()},none:()=>[],gallery:e=>p(go,{get images(){return e.images}}),removed:t=>{const[n,r]=o({kind:"none"});return(()=>{const o=Qn.cloneNode(!0),l=o.firstChild,i=l.firstChild,a=i.nextSibling;return s(i,(()=>t.removal_message.title)),s(a,(()=>t.removal_message.body)),s(l,p(de,{get when(){return"loaded"!==n().kind?t.fetch_path:void 0},children:e=>{const t=xe();return(()=>{const o=Xn.cloneNode(!0);return o.addEventListener("click",(()=>{(async()=>{let n,o=!1;if(r({kind:"loading"}),!t().fetchRemoved)throw new Error("client provided a removal fetch path but has no fetchRemoved");try{n=await t().fetchRemoved(e)}catch(l){const e=l;o=!0,console.log(e),n={kind:"text",content:"Error! "+e.toString(),markdown_format:"none"}}console.log("Got new body:",n),r({kind:o?"error":"loaded",body:n})})().catch(console.log)})),s(o,(()=>({none:"View",loading:"...",error:"Retry",loaded:"never"}[n().kind]))),c((e=>{const t=Yo["outlined-button"],r="loading"===n().kind||"loaded"===n().kind;return t!==e._v$&&(o.className=e._v$=t),r!==e._v$2&&(o.disabled=e._v$2=r),e}),{_v$:void 0,_v$2:void 0}),o})()}}),null),s(o,p(uo,{get body(){return t.body},get autoplay(){return e.autoplay}}),null),s(o,p(se,{get item(){return n()},children:{none:()=>[],loading:()=>Jn.cloneNode(!0),error:e=>(()=>{const t=Zn.cloneNode(!0);return s(t,p(uo,{get body(){return e.body},autoplay:!1})),t})(),loaded:e=>(()=>{const t=Zn.cloneNode(!0);return s(t,p(uo,{get body(){return e.body},autoplay:!1})),t})()}}),null),o})()},crosspost:e=>p(Jt,{restrict_w:!0,get children(){return p(Kt,{get listing(){return{kind:"legacy",thread:e.source}},opts:{clickable:!0,frame:null,replies:null,at_or_above_pivot:!1,is_pivot:!1,top_level:!1}})}}),richtext:e=>(()=>{const t=Zn.cloneNode(!0);return s(t,p(zn,{get content(){return e.content}})),t})(),poll:e=>(()=>{const t=eo.cloneNode(!0),n=t.firstChild.nextSibling;return s(n,p(w,{get each(){return e.choices},children:e=>(()=>{const t=to.cloneNode(!0),n=t.firstChild,o=n.nextSibling;return o.nextSibling,s(t,(()=>e.name),n),s(t,(()=>"hidden"===e.votes?"hidden":"Vote(s)"),o),t})()})),t})(),captioned_image:e=>(()=>{const t=Zn.cloneNode(!0);return s(t,p(Me,{getValue:()=>{var t,n;const o=el("div");return Vo(e.url,{w:null!=(t=e.w)?t:void 0,h:null!=(n=e.h)?n:void 0,alt:e.alt}).adto(o),o}}),null),s(t,p(de,{get when(){return e.caption},children:e=>(()=>{const t=no.cloneNode(!0);return t.firstChild,s(t,e,null),t})()}),null),t})(),video:t=>p(co,{video:t,get autoplay(){return e.autoplay}}),audio:t=>(()=>{const n=oo.cloneNode(!0);return(e=>{const t=$e();g((()=>{t()||e.pause()}))})(n),n.controls=!0,s(n,(()=>{var e;return null!=(e=t.alt)?e:"Audio is not supported and alt text was not provided"})),c((o=>{const r=t.url,l=e.autoplay;return r!==o._v$3&&d(n,"src",o._v$3=r),l!==o._v$4&&(n.autoplay=o._v$4=l),o}),{_v$3:void 0,_v$4:void 0}),n})(),array:e=>p(w,{get each(){return e.body},children:e=>e?p(uo,{body:e,autoplay:!1}):null}),gfycat:t=>p(Me,{getValue:(n,o)=>{const r=el("div");return function(e,t,n,o){const r=el("div"),l=ur(r),i=Zo().adto(r);return fetch("https://api."+t+"/v1/gfycats/"+n).then((e=>e.json())).then((t=>{var n,a,s;console.log("gfylike response:",t),i.remove(),r.adch(el("div").adch(Xo("code-button").atxt("code").onev("click",(e=>{e.stopPropagation(),console.log(t)}))));const c=t;if("message"in c||"errorMessage"in c)return void el("div").clss("error").adto(r).atxt("Error: "+(null!=(n=c.message)?n:"string"==typeof c.errorMessage?c.errorMessage:c.errorMessage.description)+("logged"in c?" ; logged="+c.logged:"")+("reported"in c?" ; reported="+c.reported:""));const{gfyItem:d}=t;null!=d.title&&r.adch(el("div").atxt("Title: "+d.title)),null!=d.description&&r.adch(el("div").atxt("Description: "+d.description));const u=[...null!=d.mp4Url?[{url:d.mp4Url,type:"video/mp4",quality:"Highest"}]:[],...null!=d.webmUrl?[{url:d.webmUrl,type:"video/webm",quality:"Highest"}]:[],...d.content_urls.webm?[{url:d.content_urls.webm.url,quality:"Highest"}]:[],...d.content_urls.mp4?[{url:d.content_urls.mp4.url,quality:"Highest"},{url:d.content_urls.mp4.url.replace(".mp4","-mobile.mp4"),quality:"Mobile"}]:[],...d.content_urls.mobile?[{url:d.content_urls.mobile.url,quality:"Mobile"}]:[],...null!=d.mobileUrl?[{url:d.mobileUrl,quality:"Mobile"}]:[]],h=d.content_urls,p=null!=(s=null!=(a=h.max5mbGif)?a:h.max2mbGif)?s:h.max1mbGif;Oo(e,{kind:"video",aspect:d.width/d.height,gifv:!1,source:u.length>0?{kind:"video",sources:u}:null!=p?{kind:"img",url:p.url}:{kind:"img",url:(()=>{throw console.log("Bad gfy image in",d),new Error("Bad gfy image")})()}},{autoplay:o.autoplay}).defer(l).adto(r)})).catch((e=>{const t=e;console.log(t),i.parentNode&&i.remove(),r.adch(el("div").clss("error").atxt("Error loading gfycat : "+t.toString()))})),l}(o(),t.host,t.id,{autoplay:e.autoplay}).defer(n).adto(r),r}}),imgur:e=>p(Me,{getValue:(t,n)=>{const o=el("div");return function(e,t,n){const o=el("div"),r=ur(o),l=Zo().adto(o);return fetch("https://api.imgur.com/3/"+t+"/"+n,{headers:{Authorization:"Client-ID 6ccf617dc7a8830",Accept:"application/json"}}).then((e=>e.json())).then((t=>{const n=t;if(console.log("imgur result",n),n.success){const t={kind:"gallery",images:("images"in n.data?n.data.images:[n.data]).map((e=>{const t=e.animated&&null!=e.mp4?{kind:"video",source:{kind:"video",sources:[{url:e.mp4,quality:e.width+"×"+e.height}]},aspect:e.width/e.height,gifv:e.looping,caption:e.description}:{kind:"captioned_image",caption:e.description,url:e.link,w:e.width,h:e.height};return{thumb:"https://i.imgur.com/"+e.id+"t.jpg",aspect:e.width/e.height,body:t}}))};Oo(e,t,{autoplay:!1}).defer(r).adto(o),l.remove()}else console.log(n),l.parentNode&&l.remove(),o.adch(el("div").clss("error").atxt("Error loading imgur: "+("localhost"===location.hostname?"Imgur does not work on localhost. Follow the instructions in CONTRIBUTING.md to fix. Imgur said: "+n.data.error:n.data.error)))})).catch((e=>{console.log(e),l.parentNode&&l.remove(),o.adch(el("div").clss("error").atxt("Error loading imgur : "+e.toString()))})),r}(n(),e.imgur_kind,e.imgur_id).defer(t).adto(o),o}}),youtube:t=>p(Me,{getValue:(n,o)=>{const r=el("div");return function(e,t,n){const o=new URLSearchParams(t),r=el("div"),l=function(e,t,n){var o,r;const l=null!=(r=null!=(o=n.get("t"))?o:n.get("start"))?r:void 0,i=el("iframe").attr({allow:"fullscreen",src:"https://www.youtube.com/embed/"+e+"?version=3&enablejsapi=1&playerapiid=ytplayer"+(t.autoplay?"&autoplay=1":"")+(null!=l?"&start="+l.replace("s",""):"")});return{node:el("div").clss("resizable-iframe").styl({width:"640px",height:"360px"}).adch(i),onhide:()=>{var e;null==(e=i.contentWindow)||e.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}}}(e,{autoplay:n.autoplay},o);l.node.adto(r);const i=ur(r);return i.on("hide",(()=>{var e;return null==(e=l.onhide)?void 0:e.call(l)})),i.on("show",(()=>{var e;return null==(e=l.onshow)?void 0:e.call(l)})),i}(t.id,t.search,{autoplay:e.autoplay}).defer(n).adto(r),r}}),twitch_clip:e=>{const[t]=C(e.slug,Ao);return p(de,{get when(){return t()},children:e=>p(uo,{body:e,autoplay:!1})})},reddit_suggested_embed:e=>p(Me,{getValue:(t,n)=>{const o=el("div");return function(e){try{const t=el("template");t.innerHTML=e;const n=t.content.childNodes[0];if(!n)throw new Error("missing iframe");const o=n instanceof HTMLIFrameElement?{src:n.src,allow:n.allow,allowfullsreen:""}:{srcdoc:e},r=el("div").clss("resizable-iframe");let l;const i=()=>{l||(l=el("iframe").attr(o).adto(r))};i();const a=ur(r);return a.on("hide",(()=>{l&&(l.remove(),l=void 0)})),a.on("show",(()=>i())),a}catch(t){const n=t;console.log(n);const o=el("div");return o.adch(el("p").atxt("Error adding suggestedembed: "+n.toString()).clss("error")),o.adch(el("pre").adch(el("code").atxt(e))),ur(o)}}(e.suggested_embed).defer(t).adto(o),o}}),link_preview:e=>p(Me,{getValue:(t,n)=>{const o=el("div");return function(e,t){const n=el("div"),o=ur(n);let r;r=t.click_enabled?el("div").clss("bg-body rounded-lg block").adto(n):wo(e.id,t.url,"none",{onclick:t.click_enabled?()=>{r.remove(),Oo(e,t.click,{autoplay:!0}).defer(o).adto(n)}:void 0}).clss("bg-body rounded-lg hover:shadow-md hover:bg-gray-100 block").adto(n);const l=el("article").clss("flex",t.click_enabled?"flex-col":"flex-row").adto(r),i=el("div").clss(t.click_enabled?"w-full h-auto min-h-10 relative":"w-24 h-full flex items-center justify-center bg-gray-100","rounded-lg overflow-hidden").adto(el("div").adto(l));null!=t.thumb?t.click_enabled?i.adch(el("img").clss(t.click_enabled?"w-full h-full":"").attr({src:t.thumb})):el("div").styl({"background-image":`url(${JSON.stringify(t.thumb)})`,"background-size":"contain","background-position":"center","background-repeat":"no-repeat"}).clss("w-full h-full").adto(i):i.adch(el("div").atxt("🔗"));if(t.click_enabled){const n=el("div").adto(i);n.clss("flex items-center justify-center absolute top-0 left-0 bottom-0 right-0");const r=el("div").clss("rounded-lg bg-gray-200 p-2 flex shadow-md gap-3").adto(n);el("button").clss("hover:underline").adto(r).atxt("Play").onev("click",(n=>{n.stopPropagation(),i.innerHTML="",Oo(e,t.click,{autoplay:!0}).defer(o).adto(i)})),r.atxt(" "),wo(e.id,t.url,"none").clss("hover:underline").atxt("Open").adto(r)}const a=el("div").clss("flex flex-col p-3 text-sm").adto(l);return a.adch(el("h1").clss("max-lines max-lines-1 font-black").atxt(t.title)),a.adch(el("p").clss("max-lines max-lines-2").atxt(t.description)),a.adch(el("div").clss("max-lines max-lines-1 font-light break-all").atxt(t.url)),o}(n(),e).defer(t).adto(o),o}}),oembed:e=>p(Me,{getValue:(t,n)=>{const o=el("div");return function(e,t){const n=el("div"),o=ur(n);return pr(fetch(t.url,{headers:{Accept:"application/json"}}).then((e=>e.json())),(t=>{console.log("oembed resp",t);const n=el("div"),r=ur(n);return Oo(e,j(t),{autoplay:!1}).defer(o).adto(n),r})).defer(o).adto(n),o}(n(),e).defer(t).adto(o),o}}),mastodon_instance_selector:()=>{const e=xe(),[t,n]=o(""),r=l((()=>{const e=t();return!!e.trim()&&(!(e.indexOf("/")>-1)&&-1!==e.indexOf("."))})),i=()=>{r()&&cr({path:"/"+e().id+"/"+t().replaceAll("/","-")})};return(()=>{const e=ro.cloneNode(!0),o=e.firstChild,l=o.nextSibling.nextSibling,a=l.firstChild,d=a.firstChild.nextSibling,u=a.nextSibling,h=l.nextSibling;return h.firstChild,o.style.setProperty("max-width","6rem"),d.$$keydown=e=>{"Enter"===e.key&&i()},d.$$input=e=>n(e.currentTarget.value),u.addEventListener("click",(()=>{i()})),s(h,p(Xe,{style:"normal",href:"https://joinmastodon.org",children:"joinmastodon.org"}),null),c((e=>{const n=t(),o=!r(),l=Yo[r()?"pill-filled":"pill-empty"];return n!==e._v$5&&(d.value=e._v$5=n),o!==e._v$6&&(u.disabled=e._v$6=o),l!==e._v$7&&(u.className=e._v$7=l),e}),{_v$5:void 0,_v$6:void 0,_v$7:void 0}),e})()}}})}function po(e){return ie(e,{text:()=>"[text]",richtext:e=>Fn(e.content),link:e=>e.url,captioned_image:()=>"[image]",video:()=>"[video]",gfycat:()=>"[gif]",youtube:()=>"[video]",imgur:()=>"[images]",twitch_clip:()=>"[video]",oembed:()=>"[link]",reddit_suggested_embed:()=>"[content]",audio:()=>"[audio]",gallery:()=>"[gallery]",poll:()=>"[poll]",none:()=>"",removed:e=>po(e.body),crosspost:()=>"[crosspost]",array:e=>e.body.map((e=>e?po(e):"")).join("\n"),link_preview:e=>e.url,mastodon_instance_selector:()=>"[mastodon instance selector]"})}function go(e){const[t,n]=G({kind:"overview"}),[r,i]=o({enabled:!1,index:0,loading:!1}),u=Le(),h=l((()=>e.images.every((e=>"captioned_image"===e.body.kind))));let f;const v=t=>{n({kind:"overview",fullscreen_index:t});const o=f.querySelector(".img-"+t);if(!o)return{x:0,y:0,w:0};const r=function(e){var t;const n=e.getBoundingClientRect();return{x:n.left,y:n.top+(null!=(t=window.pageYOffset)?t:document.documentElement.scrollTop),w:n.width,h:n.height}}(o),l=e.images[t];if(l&&null!=l.aspect)if(l.aspect>1){const e=r.h;r.h=r.w*(1/l.aspect),r.y+=(e-r.h)/2}else{const e=r.w;r.w=r.h*l.aspect,r.x+=(e-r.w)/2}return r};let m;a((()=>{m&&m()}));const b=$e();return g((()=>{b()||m&&m()})),(()=>{const o=Zn.cloneNode(!0);return"function"==typeof f?f(o):f=o,s(o,p(se,{item:t,children:{overview:t=>p(be,{children:t=>p(w,{get each(){return e.images},children:(o,l)=>(()=>{const a=lo.cloneNode(!0),s=a.firstChild;return a.addEventListener("click",(()=>{h()&&"fullscreen"===u.gallery_display.value()?(i({enabled:!0,index:l(),loading:!0}),T((()=>import("./gallery.9434f73a.js")),["assets/gallery.9434f73a.js","assets/gallery.1f1f3f72.css","assets/_commonjsHelpers.4e997714.js","assets/vendor.03bc8c46.js"]).then((t=>{i({enabled:!0,index:l(),loading:!1}),m&&m();const o=t.showGallery(e.images,l(),v,{onclose:()=>{console.log("gallery closed"),i((e=>({...e,enabled:!1})))},setIndex:e=>{i({enabled:!0,index:e,loading:!1})}});m=()=>{o.cleanup(),n({kind:"overview",fullscreen_index:void 0})}})).catch((e=>{console.log("Error loading gallery component",e),n({kind:"image",index:l()})}))):n({kind:"image",index:l()})})),c((e=>{var n;const i=Oe("m-1 inline-block rounded-md",t),c=null!=(n=o.thumb)?n:"error",u=Oe("w-24 h-24 object-contain img-"+l(),r().enabled&&r().index===l()?r().loading?"opacity-50":"opacity-0":"");return i!==e._v$8&&(a.className=e._v$8=i),c!==e._v$9&&d(s,"src",e._v$9=c),u!==e._v$10&&(s.className=e._v$10=u),e}),{_v$8:void 0,_v$9:void 0,_v$10:void 0}),a})()})}),image:t=>[(()=>{const e=io.cloneNode(!0);return e.addEventListener("click",(()=>n({kind:"image",index:t.index-1}))),c((n=>{const o=Yo["outlined-button"],r=t.index<=0;return o!==n._v$11&&(e.className=n._v$11=o),r!==n._v$12&&(e.disabled=n._v$12=r),n}),{_v$11:void 0,_v$12:void 0}),e})(),y((()=>t.index+1)),"/",y((()=>e.images.length)),(()=>{const o=ao.cloneNode(!0);return o.addEventListener("click",(()=>n({kind:"image",index:t.index+1}))),c((n=>{const r=Yo["outlined-button"],l=t.index>=e.images.length-1;return r!==n._v$13&&(o.className=n._v$13=r),l!==n._v$14&&(o.disabled=n._v$14=l),n}),{_v$13:void 0,_v$14:void 0}),o})(),(()=>{const e=so.cloneNode(!0);return e.addEventListener("click",(()=>n({kind:"overview"}))),c((()=>e.className=Yo["outlined-button"])),e})(),p(uo,{get body(){return e.images[t.index].body},autoplay:!0})]}})),o})()}x(["input","keydown"]);const fo=r('<div class="flex justify-center flex-row"><div class="w-full max-w-prose"><div class="bg-white p-5 sm:m-5 sm:p-10 shadow sm:rounded-xl"><header><h1 class="text-3xl sm:text-5xl font-black">ThreadClient</h1><h2 class="text-base font-light text-gray-800 dark:text-gray-400">A client for Reddit and Mastodon</h2></header><div class="mt-10"></div><main><p>Try for </p><p>Try for </p></main><div class="mt-10"></div><footer><p class="text-gray-800 dark:text-gray-400"> · <!> · </p></footer><div class="mt-2"></div></div></div></div>');function vo(e){return(()=>{const e=fo.cloneNode(!0),t=e.firstChild.firstChild.firstChild.nextSibling.nextSibling,n=t.firstChild;n.firstChild;const o=n.nextSibling;o.firstChild;const r=t.nextSibling.nextSibling.firstChild,l=r.firstChild,i=l.nextSibling;return i.nextSibling,s(n,p(Xe,{href:"/reddit",style:"normal",children:"Reddit"}),null),s(o,p(Xe,{href:"/mastodon",style:"normal",children:"Mastodon"}),null),s(r,p(Xe,{href:"/settings",style:"action-button",children:"Settings"}),l),s(r,p(Xe,{href:"https://github.com/pfgithub/threadclient",style:"action-button",children:"Github"}),i),s(r,p(Xe,{href:"https://github.com/pfgithub/threadclient/blob/main/privacy.md",style:"action-button",children:"Privacy"}),null),e})()}const mo={version:"3453f4f\n",log:[{hash:"3453f4f",hash_full:"3453f4fb0b95b42f1da7dff9c78f7b721fa4b672",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632961394000",commit_title:"fix(threadclient-ui-web): improve experience collapsing things while zoomed in",commit_body:"fix(threadclient-ui-web): improve experience collapsing things while zoomed in\n"},{hash:"24d3390",hash_full:"24d3390174940bbabe28e347eb627373e539c796",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632548526000",commit_title:"fix(threadclient-ui-web): a bug where 'load more' buttons wouldn't work",commit_body:"fix(threadclient-ui-web): a bug where 'load more' buttons wouldn't work\n"},{hash:"d95c288",hash_full:"d95c28822052562221f0326a6bc71ba9dfc279f7",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632374011000",commit_title:"future(threadclient-extension-firefox)",commit_body:"future(threadclient-extension-firefox)\n"},{hash:"b5dffce",hash_full:"b5dffce26f6d13a9d0d35907e3d12969b7dcc5a5",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632260860000",commit_title:"future(tmeta): a todo item",commit_body:"future(tmeta): a todo item\n"},{hash:"7b673f5",hash_full:"7b673f5fd55682c6bea16ea0a65d34472b970ef9",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632260790000",commit_title:"upgrade prism.js",commit_body:"upgrade prism.js\n"},{hash:"e0704c8",hash_full:"e0704c80752082058149f45b8e29d3ced6c8e886",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632260640000",commit_title:"future(threadclient-extension-firefox)",commit_body:"future(threadclient-extension-firefox)\n"},{hash:"d903f30",hash_full:"d903f305d9258f7a1ef5333f8674d2766c8b21a1",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632072640000",commit_title:"future(threadclient-ui-web)",commit_body:"future(threadclient-ui-web)\n"},{hash:"708f676",hash_full:"708f6767087277f7d131b4d4a89eae091c86d245",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632027800000",commit_title:"fix(threadclient-client-reddit): more errors support",commit_body:"fix(threadclient-client-reddit): more errors support\n"},{hash:"84e4f69",hash_full:"84e4f69a0eb4dfc5ea8bb36e42298bc8a0d768bc",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632027308000",commit_title:"fix(threadclient-client-reddit): lint",commit_body:"fix(threadclient-client-reddit): lint\n"},{hash:"cc42fe5",hash_full:"cc42fe5fa8bdc251234ca45a47b354a1b6dcb6fd",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1632027203000",commit_title:"fix(threadclient-client-reddit): apparently reddit returns an error if you try to vote but aren't logged in. I thought I'd checked that and it was blank. huh. - support error deleting - support error upvoting - oh, I see. deleting someone else's post just returns `{}` with no error. - not sure why I didn't catch error upvoting earlier though",commit_body:"fix(threadclient-client-reddit): apparently reddit returns an error if you try to vote but aren't logged in. I thought I'd checked that and it was blank. huh.\n- support error deleting\n- support error upvoting\n- oh, I see. deleting someone else's post just returns `{}` with no error.\n- not sure why I didn't catch error upvoting earlier though\n"}],build_time:1632962568459,build_mode:"production"};const bo=r('<ul class="ml-10"></ul>');function _o(e){throw console.log("not never:",e),new Error("is not never")}function yo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function xo(e,t){if(t.startsWith("/")&&e&&(t="/"+e+t),t.startsWith("mailto:"))return{kind:"mailto",title:t.replace("mailto:","")};let n,o=!1;if(t.startsWith("raw!")&&(t=t.replace("raw!",""),o=!0),!t.startsWith("http")&&!t.startsWith("/"))return{kind:"error",title:t};try{n=new URL(t)}catch(r){n=void 0}return!n||o||"reddit.com"!==n.host&&!n.host.endsWith(".reddit.com")||(t="/reddit"+n.pathname+n.search+n.hash),n&&!o&&"redd.it"===n.host&&(t="/reddit/comments"+n.pathname+n.search+n.hash),{kind:"link",url:t,external:!t.startsWith("/")}}function wo(e,t,n,o={}){const r=xo(e,t);if("error"===r.kind)return el("a").clss(...Qo(n),"error").attr({title:r.title}).clss("error").onev("click",(e=>{e.stopPropagation(),alert(t)}));if("mailto"===r.kind)return el("span").attr({title:r.title});if("link"===r.kind){const e=r.url,t=el("a").clss(...Qo(n)).attr({href:e,target:"_blank",rel:"noopener noreferrer"});return(e.startsWith("/")||o.onclick)&&(t.onclick=t=>{if(t.stopPropagation(),!t.defaultPrevented&&0===t.button&&!yo(t)){if(t.preventDefault(),o.onclick)return o.onclick();cr({path:e})}}),t}_o(r)}function ko(e){return["inline-block mx-1 px-1 text-base border-b-2 transition-colors",e?"border-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900"].join(" ")}function $o(e){const t="https://v.redd.it/"+e;return{kind:"video",sources:[{url:t+"/DASHPlaylist.mpd"},{url:t+"/HLSPlaylist.m3u8"}],preview:[{url:t+"/DASH_96.mp4",type:"video/mp4"},{url:t+"/DASH_96",type:"video/mp4"}]}}function No(e){return{kind:"video",source:$o(e),gifv:!1}}function Co(e,t){const n=e.split(".");return n.pop(),n.push(t),n.join(".")}function Eo(e,t,n){var o,r,l,i,a,s,c;let d;try{d=new URL(t)}catch(p){}const u=d,h=null!=(o=null==u?void 0:u.pathname)?o:t;if(!!u&&(h.endsWith(".gif")&&"mp4"===u.searchParams.get("format")))return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}};if("i.imgur.com"===(null!=(r=null==u?void 0:u.hostname)?r:"")&&h.endsWith(".gif")||h.endsWith(".gifv"))return{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:Co(t,"webm"),quality:"Highest"},{url:Co(t,"mp4"),quality:"Highest"},{url:t,quality:"Highest"}]}};if("i.redd.it"===(null!=(l=null==u?void 0:u.hostname)?l:"")||h.endsWith(".png")||h.endsWith(".jpg")||h.endsWith(".jpeg")||h.endsWith(".gif")||h.endsWith(".webp")||"pbs.twimg.com"===(null!=(i=null==u?void 0:u.hostname)?i:""))return{kind:"captioned_image",url:t,w:null,h:null};if(t.startsWith("https://v.redd.it/"))return No(t.replace("https://v.redd.it/",""));if(u&&("reddit.com"===u.host||u.host.endsWith(".reddit.com")&&u.pathname.startsWith("/link"))){const e=h.split("/");if(e.shift(),"link"===e[0]&&"video"===e[2]&&"player"===e[4])return No(null!=(a=e[3])?a:"")}if(u&&("gfycat.com"===u.host||u.host.endsWith(".gfycat.com"))&&2===u.pathname.split("/").length)return{kind:"gfycat",id:u.pathname.replace("/","").split("-")[0].split(".")[0].toLowerCase(),host:"gfycat.com"};if(u&&("redgifs.com"===u.host||u.host.endsWith(".redgifs.com"))&&3===u.pathname.split("/").length&&u.pathname.startsWith("/watch/")){return{kind:"gfycat",id:u.pathname.replace("/watch/","").split("-")[0].split(".")[0].toLowerCase(),host:"redgifs.com"}}if(h.endsWith(".mp4")||h.endsWith(".webm"))return{kind:"video",gifv:!1,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}};if(h.endsWith(".mp3"))return{kind:"audio",url:t};if(u&&("www.youtube.com"===u.host||"youtube.com"===u.host||"m.youtube.com"===u.host)&&"/watch"===u.pathname){const e=u.searchParams.get("v");if(null!=e)return{kind:"youtube",id:e,search:u.searchParams.toString()}}if(u&&"youtu.be"===u.host&&2===u.pathname.split("/").length){return{kind:"youtube",id:null!=(s=u.pathname.split("/")[1])?s:"no_id",search:u.searchParams.toString()}}if(u&&("vocaroo.com"===u.host||"www.vocaroo.com"===u.host||"voca.ro"===u.host)){const e=u.pathname.split("/").filter((e=>e));if(1===e.length&&null!=e[0]&&""!==e[0])return{kind:"audio",url:"https://media.vocaroo.com/mp3/"+e[0]}}if(u&&("giphy.com"===u.host||"www.giphy.com"===u.host)){const e=u.pathname.split("/").filter((e=>e));if(3===e.length&&"gifs"===e[0]&&"fullscreen"===e[2]){const t=e[1].split("-");return{kind:"video",source:{kind:"video",sources:[{url:"https://media4.giphy.com/media/"+t[t.length-1]+"/giphy.mp4",quality:"Highest"}]},gifv:!0}}}if(u&&("www.imgur.com"===u.host||"imgur.com"===u.host||"m.imgur.com"===u.host)){const e=u.pathname.split("/").filter((e=>e)),t=e[1],n="gallery"===e[0]?"gallery":"a"===e[0]?"album":void 0;if(void 0!==n&&2===e.length)return{kind:"imgur",imgur_id:t,imgur_kind:n};if(1===e.length&&(null!=(c=e[0])?c:"").length>4)return{kind:"captioned_image",url:"https://i.imgur.com/"+e[0]+".jpg",w:null,h:null}}if(u&&"clips.twitch.tv"===u.host&&1===u.pathname.split("/").filter((e=>e)).length){const e=u.pathname.split("/").filter((e=>e))[0];if(null!=e)return{kind:"twitch_clip",slug:e}}return u&&("soundcloud.com"===u.host||u.host.endsWith(".soundcloud.com"))?{kind:"oembed",url:"https://soundcloud.com/oembed?format=json&url="+encodeURIComponent(t)}:u&&("tiktok.com"===u.host||u.host.endsWith(".tiktok.com"))?{kind:"oembed",url:"https://www.tiktok.com/oembed?url="+encodeURIComponent(t)}:null!=n.suggested_embed?{kind:"reddit_suggested_embed",suggested_embed:n.suggested_embed}:void 0}function Lo(e){const t=el("span");return h((()=>p(Ht,{flairs:e})),t),t}function Po(e){const t=el("span"),n=ur(t);return Ve(0,t,(()=>p(pe,{start:e})),{color_level:1}).defer(n),n}const So=function(e){let t;return async()=>{if(!t){let n;t=[];try{n=await e()}catch(o){throw console.log("failed to load",o),alert("failed to load dynamic load object. check console."),o}const r=t;t={loaded:n},r.forEach((e=>e()))}if("loaded"in t)return t.loaded;const n=t;return await new Promise((e=>n.push(e))),t.loaded}}((async()=>{const e=new TextEncoder,t=new TextDecoder,n=await(await T((()=>import("./snudown.69d6942c.js")),[])).default({env:{__assert_fail:(e,t,n,o)=>{throw console.log(e,t,n,o),new Error("assert failed")},__stack_chk_fail:()=>{throw new Error("stack overflow")},debugprints:(e,o)=>{console.log("print text:",t.decode(new Uint8Array(n.memory.buffer,e,o)))},debugprinti:e=>{console.log("print int:",e)},debugprintc:e=>{console.log("print char:",String.fromCodePoint(e))},debugpanic:(e,o)=>{throw new Error("Panic: "+t.decode(new Uint8Array(n.memory.buffer,e,o)))}}});return{renderMd(o){try{const r=e.encode(o),l=n.allocString(r.byteLength);new Uint8Array(n.memory.buffer,l,r.byteLength).set(r);const i=n.markdownToHTML(l,r.byteLength),a=n.strlen(i),s=new Uint8Array(n.memory.buffer,i,a),c=t.decode(s);return n.freeText(l,r.byteLength),n.freeText(i,a),c}catch(r){const e=r;return console.log(e.toString()+"\n"+e.stack),("Error "+e.toString()+"\n"+e.stack).replace(/[^a-zA-Z0-9. ]/giu,(e=>"&#"+e.codePointAt(0)+";"))}}}}));async function To(e){if("reddit"===e.markdown_format){const[t,n]=await Promise.all([So(),T((()=>import("./html_to_richtext.69c8a86e.js")),["assets/html_to_richtext.69c8a86e.js","assets/vendor.03bc8c46.js"])]),o=t.renderMd(e.content);return{kind:"richtext",content:n.parseContentHTML(o)}}if("none"===e.markdown_format)return{kind:"richtext",content:[O.p(O.txt(e.content))]};if("reddit_html"===e.markdown_format){const t=await T((()=>import("./html_to_richtext.69c8a86e.js")),["assets/html_to_richtext.69c8a86e.js","assets/vendor.03bc8c46.js"]);return console.log(e.content),{kind:"richtext",content:t.parseContentHTML(e.content)}}_o(e.markdown_format)}function Oo(e,t,n){var o;try{return function(e,t,n){const o=el("div"),r=ur(o),l=el("div").adto(o);return Ve(e,l,(()=>p(uo,{body:t,get autoplay(){return n.autoplay}})),{color_level:1}).defer(r),r}(e,t,n)}catch(r){const e=r;console.log(e);const t=el("div");return el("div").clss("error").adto(t).atxt("Got error: "+e.toString()),el("code").adto(el("pre").adto(t)).atxt(null!=(o=e.stack)?o:"no stack"),ur(t)}}async function Ao(e){function t(e,t,n){return{extensions:{persistedQuery:{sha256Hash:t,version:1}},operationName:e,variables:n}}const n=await fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Client-Id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify([t("VideoAccessToken_Clip","36b89d2507fce29e5ca551df756d27c1cfe079e2609642b4390aa4c35796eb11",{slug:e}),t("ClipsChatCard","94c1c7d97d860722a5b7ef3c3b3de3783b37fc32d69bcccc8ea0cda372cf1f01",{slug:e}),t("ClipsBroadcasterInfo","ce258d9536360736605b42db697b3636e750fdb14ff0a7da8c7225bdc2c07e8a",{slug:e}),t("ClipsTitle","f6cca7f2fdfbfc2cecea0c88452500dae569191e58a265f97711f8f2a838f5b4",{slug:e}),t("ClipsCurator","769e99d9ac3f68e53c63dd902807cc9fbea63dace36c81643d776bcb120902e2",{slug:e}),t("ClipsFullVideoButton","d519a5a70419d97a3523be18fe6be81eeb93429e0a41c3baa9441fc3b1dffebf",{slug:e})])}).then((e=>e.json()));console.log(n);const[o,r,l,i,a,s]=n;return o.data.clip?{kind:"video",source:{kind:"video",sources:o.data.clip.videoQualities.map((e=>({url:e.sourceURL+"?sig="+encodeURIComponent(o.data.clip.playbackAccessToken.signature)+"&token="+encodeURIComponent(o.data.clip.playbackAccessToken.value),quality:e.quality+"p"})))},caption:i.data.clip.title,gifv:!1}:{kind:"richtext",content:[O.p(O.txt("The clip could not be found."))]}}function jo(e){const t=el("button").adch(e);return t.onclick=n=>{n.preventDefault(),n.stopPropagation(),t.disabled=!0,T((()=>import("./gallery.9434f73a.js")),["assets/gallery.9434f73a.js","assets/gallery.1f1f3f72.css","assets/_commonjsHelpers.4e997714.js","assets/vendor.03bc8c46.js"]).then((n=>{const o=e.naturalWidth/e.naturalHeight,r=ur();t.style.opacity="0",n.showGallery([{thumb:e.src,aspect:o,body:{kind:"captioned_image",w:e.naturalWidth,h:e.naturalHeight,url:e.src}}],0,(()=>{var e;const n=t.getBoundingClientRect();return{x:n.left,y:n.top+(null!=(e=window.pageYOffset)?e:document.documentElement.scrollTop),w:n.height*o}}),{onclose:()=>{t.disabled=!1,t.style.opacity="1"},setIndex:()=>{}}).defer(r)})).catch((e=>{console.log(e),t.disabled=!1,alert(e.toString())}))},t}function Ro(e,t){const n=el("img").clss("image-loading").attr({src:e,width:null!=t.w?`${t.w}`:void 0,height:null!=t.h?`${t.h}`:void 0,alt:t.alt,title:t.alt});return n.onload=()=>n.classList.remove("image-loading"),n.onerror=()=>n.classList.remove("image-loading"),n}function Vo(e,t){return jo(Ro(e,t).clss("preview-image"))}function Mo(e,t,n,o){if("link"===t.kind)return wo(e.id,t.url,"action-button").atxt(t.text).adto(n),ur();if("reply"===t.kind){const o=ur();return function(e,t,n,o){{let o="none";const r=Xo("action-button").atxt("Reply").adto(n),l=ur();let i;l.on("cleanup",(()=>{i&&i.cleanup()})),l.on("hide",(()=>{i&&i.setParentVisible(!1)})),l.on("show",(()=>{i&&i.setParentVisible(!0)}));const a=()=>{if("none"===o){if(i){const e=i.associated_data;i.cleanup(),e.remove(),i=void 0}r.disabled=!1}else if(!i){const r=el("div").adto(n);i=ur(r),Ve(e,r,(()=>p(ht,{action:t,onCancel:()=>{o="none",a()},onAddReply:t=>{console.log("Got response",t),o="none",a();const r=el("div").adto(n);Ve(e,r,(()=>(()=>{const e=bo.cloneNode(!0);return s(e,p(Bt,{reply:t,is_threaded:!1,parent_is_threaded:!1})),e})()),{color_level:1}).defer(l)}})),{color_level:1}).defer(i)}};return r.onev("click",(e=>{e.stopPropagation(),"none"===o&&(o="some"),a()})),a(),l}}(e,t,n).defer(o),o}if("counter"===t.kind){const o=ur();return Uo(e,t,n,{parens:!0}).defer(o),o}if("delete"===t.kind){const o=el("span").adto(n),r=el("span").adto(n),l=el("span").adto(n),i=el("span").adto(n),a=el("span").adto(n),s=Xo("action-button").atxt("Delete").adto(o);r.atxt("Are you sure? ");const c=Xo("unsafe-action-button").atxt("Delete").adto(r);r.atxt(" / ");const d=Xo("safe-action-button").atxt("Cancel").adto(r);a.atxt("Deleting…"),l.atxt("Deleted!");const u=e=>{o.style.display="none"===e?"":"none",r.style.display="confirm"===e?"":"none",l.style.display="deleted"===e?"":"none",a.style.display="load"===e?"":"none",i.style.display="string"!=typeof e?"":"none","string"!=typeof e&&(o.style.display="",i.innerHTML="",i.adch(el("span").clss("error").atxt(e.error)))};return u("none"),s.onev("click",(e=>{e.stopPropagation(),u("confirm")})),c.onev("click",(n=>{n.stopPropagation(),u("load"),e.act(t.data).then((e=>{u("deleted")})).catch((e=>{console.log("Got error:",e),u({error:e.toString()})}))})),d.onev("click",(e=>{e.stopPropagation(),u("none")})),ur()}if("report"===t.kind){const o=ur();let r;const l=Xo("action-button").atxt("Report").adto(n).onev("click",(o=>{if(o.stopPropagation(),r){l.setAttribute("class",Yo["action-button"]);const e=r.associated_data;r.cleanup(),e.remove(),r=void 0}else l.setAttribute("class",Yo["action-button-active"]),r=function(e,t){const n=el("div").clss("report-screen text-sm"),o=ur(n);if(!e.fetchReportScreen)return n.atxt("Missing fetchreportscreen?"),n.clss("error"),console.log(e),o;const r=Zo().adto(n);return e.fetchReportScreen(t).then((t=>{r.remove();const l=ur(),i=o.addChild(l);for(const r of t)Io(e,r,(t=>{i.cleanup(),n.innerHTML="",n.atxt("Report sent!"),console.log("Completed report",t);const r=Ko().adto(n);r.adch(el("div").atxt(t.title)),Oo(e,t.body,{autoplay:!1}).defer(o).adto(r),console.log(r,n,n.childNodes)})).defer(l).adto(n)})).catch((e=>{console.log("error loading report screen",e),n.adch(el("div").clss("error").atxt("Error loading: "+e.toString())),r.remove()})),o}(e,t.data),r.associated_data.adto(n)}));return o}if("login"===t.kind){const o=el("span").adto(n),r=ur(),l=t.data,i=Xo("action-button").atxt("Log In").adto(o).onev("click",(t=>{t.stopPropagation(),i.textContent="…",i.disabled=!0,e.getLoginURL(l).then((t=>{o.innerHTML="",wo(e.id,t,"pill-filled").atxt("Log In").adto(o)})).catch((e=>{i.textContent="Retry",o.atxt("Error:"+e),console.log(e),i.disabled=!1}))}));return r}if("act"===t.kind){const o=el("span").adto(n),r=Xo("action-button").atxt(t.text).adto(o).onev("click",(n=>{n.stopPropagation(),r.disabled=!0,r.textContent="…",e.act(t.action).then((()=>{r.remove(),txt("✓").adto(o)})).catch((e=>{console.log("got error: "+e),r.disabled=!1,o.adch(el("span").clss("error").atxt(e.toString()))}))}));return ur()}if("flair"===t.kind)return ur();if("code"===t.kind){const r=ur();let l;const i=Xo("action-button").atxt("Code").adto(n).onev("click",(r=>{if(r.stopPropagation(),console.log(o.value_for_code_btn),l){i.setAttribute("class",Yo["action-button"]);const e=l.associated_data;l.cleanup(),e.remove(),l=void 0}else i.setAttribute("class",Yo["action-button-active"]),l=Oo(e,t.body,{autoplay:!0}),l.associated_data.adto(n)}));return r}_o(t)}function Io(e,t,n){const o=el("details").clss("report-item"),r=ur(o);o.adch(el("summary").attr({draggable:"true"}).atxt(t.title));const l=el("div").clss("report-content").adto(o);switch(t.description&&Oo(e,t.description,{autoplay:!1}).defer(r).adto(l),t.report.kind){case"submit":case"textarea":{const o="textarea"===t.report.kind?el("textarea").adto(el("div").adto(l)):void 0;let r="none";const i=Xo("pill-filled").adto(l),a=txt("…").adto(i),s=el("div").adto(l),c=()=>{"none"===r?(a.nodeValue="Send Report",i.disabled=!1):"load"===r?(a.nodeValue="…",i.disabled=!0):(a.nodeValue="Retry",i.disabled=!1,s.adch(el("div").clss("error").atxt("Error: "+r.error)))};c();const d=t.report.data;i.onev("click",(t=>{t.stopPropagation(),r="load",c(),e.sendReport(d,null==o?void 0:o.value).then((e=>{n(e)})).catch((e=>{console.log(e),r={error:e.toString()},c()}))}))}break;case"link":wo(e.id,t.report.url,"normal").atxt(t.report.text).adto(l);break;case"more":{const o=el("div").adto(l);for(const l of t.report.screens)Io(e,l,n).defer(r).adto(o)}break;default:_o(t.report)}return r}const Do=new Map;function Wo(e,t){var n;const o=null!=e?e:`${Math.random()}`,r=null!=(n=Do.get(o))?n:{state:{loading:!1,pt_count:t.count,your_vote:t.you},handlers:new Set,users:0,update_time:t.time};Do.has(o)||Do.set(o,r),r.update_time<t.time&&(r.state.pt_count=t.count,r.state.your_vote=t.you);const l=ur({state:r.state,emit(){r.handlers.forEach((e=>e()))},onupdate(e){const t=()=>{e()};r.handlers.add(t),l.on("cleanup",(()=>{r.handlers.delete(t)}))}});return r.users++,l.on("cleanup",(()=>{r.users--,0===r.users&&Do.delete(o)})),l}function qo(e){if("hidden"===e.pt_count||"none"===e.pt_count)return{text:"—",raw:"[score hidden]"};const t=e.pt_count+("increment"===e.your_vote?1:"decrement"===e.your_vote?-1:0);return{text:(n=t,n<1e4?""+n:n<1e5?(null==(o=(n/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/))?void 0:o[0])+"k":n<1e6?(n/1e3|0)+"k":n<1e8?(null==(r=(n/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/))?void 0:r[0])+"m":(n/1e6|0)+"m"),raw:t.toLocaleString()};var n,o,r}function Uo(e,t,n,o){const r="none"!==t.count_excl_you,l=el("span").clss("counter").adto(n),i=Xo("action-button").adto(l).clss("counter-increment-btn").attr({"aria-label":"Up"}),a=el("span").adto(i),s=txt("").adto(a),c=txt("…").adto(a),d=el("span").adto(l.atxt(" ")).clss("counter-count"),u=txt("…").adto(d);let h;const p=ur({percent_voted_txt:null==t.percent?txt("—% upvoted"):txt(t.percent.toLocaleString(void 0,{style:"percent"})+" upvoted"),votecount:d}),{state:g,emit:f,onupdate:v}=Wo(t.unique_id,{count:t.count_excl_you,you:t.you,time:t.time}).defer(p);v((()=>{var e,n,a,s,p,f,v;const{text:m,raw:b}=qo(g);c.nodeValue={increment:t.incremented_label,decrement:null!=(e=t.decremented_label)?e:"ERR",none:t.label}[null!=(n=g.your_vote)?n:"none"],u.nodeValue=o.parens?"("+m+")":m,r||(u.nodeValue=""),d.title=b,l.classList.remove("counted-increment","counted-decrement","counted-reset"),l.classList.add("counted-"+(null!=(a=g.your_vote)?a:"reset")),l.classList.toggle("counted-loading",g.loading),i.disabled=g.loading,h&&(h.disabled=g.loading),i.setAttribute("class","counter-increment-btn "+Yo["increment"===g.your_vote?null!=(s=t.incremented_style)?s:"action-button":null!=(p=t.style)?p:"action-button"]),h&&h.setAttribute("class","counter-decrement-btn "+Yo["decrement"===g.your_vote?null!=(f=t.decremented_style)?f:"action-button":null!=(v=t.style)?v:"action-button"]),i.setAttribute("aria-pressed","increment"===g.your_vote?"true":"false"),h&&h.setAttribute("aria-pressed","decrement"===g.your_vote?"true":"false")})),f();const m=n=>{if("error"in t.actions)return alert("Error: "+t.actions.error);const o=g.your_vote;g.your_vote=n,g.loading=!0,f();const r=t.actions[null!=n?n:"reset"];if(null==r)throw new Error("downvote label available but downvote action not provided");e.act(r).then((()=>{g.your_vote=n,g.loading=!1,f()})).catch((e=>{g.your_vote=o,g.loading=!1,f(),console.log(e),alert("Got error: "+e)}))};return null!=t.decremented_label&&(s.nodeValue="⯅ ",l.atxt(" "),h=Xo("action-button").adch(el("span").atxt("⯆")).attr({"aria-label":"Down"}).adto(l).onev("click",(e=>{e.stopPropagation(),"decrement"===g.your_vote?m(void 0):m("decrement")})).clss("counter-decrement-btn")),i.onev("click",(e=>{e.stopPropagation(),"increment"===g.your_vote?m(void 0):m("increment")})),p}function Ho(e,t,n){const[o,r]=Ue(qe(n.toLowerCase()));return wo(e,t,"userlink").styl({"--light-color":De(o),"--dark-color":De(r)})}function zo(e,t,n){const o=ur(t);for(const r of e)r.watch((()=>n(t))).defer(o);return n(t),o}function Bo(e,t){const n=el("div"),o=ur(n),r=el("div").adto(n),l=t=>{const n=el("div");for(const o of t)"link"===o.action.kind?wo(e.id,o.action.url,"none").clss("text-gray-600 dark:text-gray-400 hover:text-gray-900").adto(n).atxt(o.text):"menu"===o.action.kind?Xo("none").adto(n).atxt(o.text+" ▸").onev("click",(e=>{e.stopPropagation(),e.preventDefault(),alert("TODO submenus")})).adto(n):"show-line-two"===o.action.kind?Xo("none").adto(n).atxt(o.text).onev("click",(e=>{e.stopPropagation(),e.preventDefault(),alert("TODO submenu show-line-two")})).adto(n):_o(o.action);return n};let i;o.on("cleanup",(()=>{i&&(i.cleanup(),i=void 0)}));const a=function(e){let t=e;const n=[];return{get value(){return t},set value(e){t=e,n.forEach((e=>e()))},watch(e){const t=ur(),o=()=>{e()};return n.push(o),t.on("cleanup",(()=>n.splice(n.indexOf(o),1))),t}}}(t.find((e=>e.selected)));a.watch((()=>{i&&(i.cleanup(),i.associated_data.remove(),i=void 0)}));for(const s of t){if("menu"===s.action.kind){const e=txt("…");let t,n=!1;const i=s.action.children;o.on("hide",(()=>{console.log("open menu was asked to be hidden"),n=!1,c()}));const c=()=>{var o;if(e.nodeValue=n?"▴":"▾",h.attr({"aria-expanded":n?"true":"false"}),n){if(!t){t=l(i).clss("absolute z-10 flex flex-col shadow bg-gray-100 p-3 rounded w-max max-w-7xl").adto(document.body);const e=d.getBoundingClientRect();t.styl({left:e.left+"px",top:e.bottom+(null!=(o=window.pageYOffset)?o:document.documentElement.scrollTop)+"px"})}}else t&&(t.remove(),t=void 0)},d=el("span").adto(r),u=e=>{if(n){console.log("Got event: ",e.target);let o=e.target;for(;o;){if(o===d)return;if(t&&o===t)return;o=o.parentElement}n=!1,c()}};document.addEventListener("click",u,{capture:!0}),o.on("cleanup",(()=>document.removeEventListener("click",u,{capture:!0})));const h=Xo("none").attr({"aria-haspopup":"true"}).atxt(s.text).atxt(" ").adch(e).adto(d).onev("click",(e=>{e.preventDefault(),e.stopPropagation(),n=!n,c()}));zo([a],0,(()=>{h.setAttribute("class",ko(s===a.value))})).defer(o),c()}else if("link"===s.action.kind){const t=wo(e.id,s.action.url,"none").atxt(s.text).adto(r);zo([a],0,(()=>{t.setAttribute("class",ko(s===a.value))})).defer(o)}else if("show-line-two"===s.action.kind){const t=s.action,l=Xo("none").atxt(s.text).adto(r);zo([a],0,(()=>{if(l.setAttribute("class",ko(s===a.value)),s===a.value){if(i)throw new Error("already existing menu_l2");i=Bo(e,t.children),i.defer(o),i.associated_data.clss("mt-2").adto(n)}})).defer(o),l.onev("click",(e=>{e.stopPropagation(),a.value=s}))}else _o(s.action);txt(" ").adto(r)}return o}function Go(e,t,n){const o=ur();if(n.clss("subreddit-banner"),t.banner){jo(el("img").clss("w-full min-h-270px object-cover object-center sm:object-top").attr({src:t.banner.desktop})).clss("absolute top-0 left-0 right-0 w-full max-h-full").adto(n).adch(el("div").clss("absolute top-150px left-0 right-0 bottom-0 header-gradient")),el("div").clss("h-150px").adto(n)}const r=el("div").clss("subreddit-banner-content").adto(n);t.icon&&el("img").clss("sub-icon-img drop-shadow").attr({alt:"",src:t.icon.url}).adto(r);const l=el("div").clss("subreddit-title-area").adto(r);null!=t.name.display&&el("h1").atxt(t.name.display).clss("text-lg").adto(l),el("h2").atxt(t.name.link_name).clss("text-gray-500").adto(l);const i=el("div").clss("sub-subscribe-area").adto(r);if(t.subscribe){const n=el("div").adto(i);Mo(e,t.subscribe,n,{value_for_code_btn:t}).defer(o)}t.body&&Oo(e,t.body,{autoplay:!1}).defer(o).adto(i);const a=el("div").clss("relative").adto(n);t.menu&&Bo(e,t.menu).defer(o).adto(el("div").clss("my-3").adto(a));const s=el("div").adto(a);if(t.more_actions)for(const c of t.more_actions)Mo(e,c,s,{value_for_code_btn:t}).defer(o);return Xo("action-button").atxt("Code").adto(s).onev("click",(e=>{e.stopPropagation(),console.log(t)})),o}function Fo(e,t,n){const o=Ko(),r=ur(o);try{if("user-profile"===t.kind)return function(e,t,n){const o=ur();Oo(e,t.bio,{autoplay:!1}).defer(o).adto(n);const r=el("div").adto(n);for(const l of t.actions)r.atxt(" "),Mo(e,l,r,{value_for_code_btn:t}).defer(o);return r.atxt(" "),Xo("code-button").adto(r).atxt("Code").onev("click",(e=>{e.stopPropagation(),console.log(t)})),o}(e,t,o).defer(r),r;if("bio"===t.kind)return Go(e,t,o).defer(r),r;if("widget"===t.kind)return function(e,t,n){const o=ur();n.clss("widget");const r=el("div").adto(n);txt(t.title).adto(el("div").adto(r).clss("widget-header font-bold text-base mb-2 text-gray-500"));const l=el("div").clss("widget-content").adto(r);if(t.actions_top){const n=el("div").clss("widget-actions-top").adto(l);for(const r of t.actions_top)Mo(e,r,n,{value_for_code_btn:t}).defer(o)}const i=t.widget_content;if("list"===i.kind){const t=el("ul").clss("widget-list list-disc").adto(l);for(const n of i.items){const r=el("li").adto(t);let l,i;if("body"===n.click.kind){r.clss("list-none");const t=el("details").adto(r);l=el("summary").attr({draggable:"true"}).adto(t),Oo(e,n.click.body,{autoplay:!1}).defer(o).adto(t)}else r.clss("ml-4"),l=r;if(null!=n.icon&&el("div").adto(l).clss("widget-list-icon").styl({"--background-image-url":"url("+n.icon+")"}),"text"===n.name.kind?i=txt(n.name.text):"flair"===n.name.kind?(i=el("span"),Lo([n.name.flair]).adto(i)):"username"===n.name.kind?i=txt(n.name.username):"image"===n.name.kind?i=el("img").clss("w-fill h-auto").attr({src:n.name.src,alt:n.name.alt,width:`${n.name.w}`,height:`${n.name.h}`}):_o(n.name),"link"===n.click.kind?"username"===n.name.kind?Ho(e.id,n.click.url,n.name.username).atxt(n.name.username).adto(l):wo(e.id,n.click.url,"normal").adch(i).adto(l):el("span").adch(i).adto(l),n.action){const t=el("span").adto(l).atxt(" ");Mo(e,n.action,t,{value_for_code_btn:n}).defer(o)}}}else if("community-details"===i.kind)el("p").atxt(i.description).adto(l);else if("body"===i.kind)Oo(e,i.body,{autoplay:!1}).defer(o).adto(l);else if("iframe"===i.kind){const e=el("div");n.replaceChild(e,r),n.clss("widget-fullscreen-content");const t=el("iframe").adto(e).styl({width:"312px"}).attr({width:"312",height:i.height,srcdoc:i.srcdoc});t.onload=()=>{if(!t.contentWindow)return console.log("no content window");t.style.height=t.contentWindow.document.body.scrollHeight+20+"px"}}else if("image"===i.kind){const t=el("div");n.clss("widget-fullscreen-content"),n.replaceChild(t,r);const o=Ro(i.src,{w:i.width,h:i.height}).clss("w-full h-auto");null!=i.link_url?wo(e.id,i.link_url,"none").adch(o).adto(t):jo(o).adto(t)}else _o(i);if(t.actions_bottom){const n=el("div").clss("widget-actions-bottom").adto(l);for(const r of t.actions_bottom)Mo(e,r,n,{value_for_code_btn:t}).defer(o)}return el("div").adto(l).adch(Xo("code-button").atxt("Code").onev("click",(e=>{e.stopPropagation(),console.log(t)}))),o}(e,t,o).defer(r),r;if("thread"===t.kind)return Jo(e,t,o,n).defer(r),r;_o(t)}catch(l){return r.cleanup(),console.log("Got error",l),o.innerHTML="",o.adch(el("pre").adch(el("code").atxt(l.toString()+"\n\n"+l.stack))),o.adch(Xo("code-button").atxt("Code").onev("click",(e=>{e.stopPropagation(),console.log(t)}))),ur(o)}}function Ko(){return el("div").clss("post text-sm")}function Jo(e,t,n,o){var r,l,i,a,s,c,d,u,h;let p,g,f,v,m,b,_;o.clickable&&t.link.startsWith("/")&&n.clss("hover-outline").attr({tabindex:"0"}).onev("click",(o=>{if(!ue(o.target,n))return;o.stopPropagation();const r="/"+e.id+t.link;o.ctrlKey||o.metaKey||o.altKey?window.open(r):cr({path:r})}));const y=ur({addChildren:void 0});if("reddit-post"===t.layout){p=el("div").adto(n).clss("post-voting"),g=el("button").adto(n).clss("post-thumbnail");const e=el("div").adto(n).clss("post-titles");f=el("div").adto(n).clss("post-preview"),v=el("div").adto(n).clss("post-replies"),m=el("div").adto(e).clss("post-content-title text-base"),b=el("div").adto(e).clss("post-content-subminfo"),_=el("div").adto(e).clss("post-content-buttons")}else"reddit-comment"===t.layout||"mastodon-post"===t.layout?(p=el("div").adto(n).clss("post-voting"),m=el("div").adto(n).clss("post-content-title"),g=el("button").adto(n).clss("post-thumbnail"),b=el("div").adto(n).clss("post-content-subminfo text-xs"),f=el("div").adto(n).clss("post-preview"),_=el("div").adto(n).clss("post-content-buttons text-xs"),v=el("div").adto(n).clss("post-replies")):"error"===t.layout?(p=el("div").adto(n).clss("post-voting"),m=el("div").adto(n).clss("post-content-title"),g=el("button").adto(n).clss("post-thumbnail"),b=el("div").adto(n).clss("post-content-subminfo"),f=el("div").adto(n).clss("post-preview"),_=el("div").adto(n).clss("post-content-buttons"),v=el("div").adto(n).clss("post-replies")):_o(t.layout);if(t.thumbnail||g.clss("no-thumbnail"),"reddit-comment"===t.layout||"mastodon-post"===t.layout){let e=t.default_collapsed;const o=()=>{y.setVisible(!e),e?(n.classList.add("comment-collapsed"),l.setAttribute("aria-label","Uncollapse"),l.setAttribute("aria-pressed","true")):(n.classList.remove("comment-collapsed"),l.setAttribute("aria-label","Collapse"),l.setAttribute("aria-pressed","false"))},l=el("button").clss("collapse-btn outline-default").attr({draggable:"true","aria-label":"Collapse"}).adch(el("div").clss("collapse-btn-inner")).onev("click",(t=>{t.stopPropagation();const r=n.getBoundingClientRect(),l=fr.getBoundingClientRect(),i=()=>5+Math.max(0,l.bottom,window.visualViewport.offsetTop),a=window.visualViewport.offsetTop+window.visualViewport.height;console.log(i(),a,r.top),r.top<i()&&r.bottom>i()&&(n.scrollIntoView(),document.documentElement.scrollTop-=i()),e=!e,o()}));n.insertBefore(l,null!=(r=n.childNodes[0])?r:null),o()}n.clss("layout-"+t.layout),"reddit-comment"!==t.layout&&"mastodon-post"!==t.layout||n.clss("layout-commentlike"),t.flair&&(m.adch(Lo(t.flair.filter((e=>e.content_warning)))),m.atxt(" ")),t.title&&(o.clickable?m.adch(wo(e.id,t.link,"none").clss("hover:underline").atxt(t.title.text)):m.adch(txt(t.title.text))),t.flair&&(m.atxt(" "),m.adch(Lo(t.flair.filter((e=>!e.content_warning)))));let x=(null!=(l=t.flair)?l:[]).filter((e=>e.content_warning)),w=null;if("reddit-post"===t.layout&&t.info)!1!==t.info.time&&(b.adch(Po(t.info.time).defer(y)),b.atxt(" ")),t.info.author&&b.atxt("by ").adch(Ho(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),(null==(i=t.info.author)?void 0:i.flair)&&b.adch(Lo(t.info.author.flair)),t.info.in&&b.atxt(" in ").adch(wo(e.id,t.info.in.link,"normal").atxt(t.info.in.name)),!1!==t.info.edited&&(b.hasChildNodes()&&b.atxt(", "),b.atxt("Edited ").adch(Po(t.info.edited).defer(y))),t.info.pinned&&(b.hasChildNodes()&&b.atxt(", "),b.adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")));else if(("reddit-comment"===t.layout||"mastodon-post"===t.layout)&&t.info){if("reddit-comment"===t.layout&&(null==(a=t.info.author)?void 0:a.pfp)){el("img").attr({src:t.info.author.pfp.url}).adto(b).clss("w-8 h-8 object-center inline-block rounded-full cfg-reddit-pfp").title="Disable in settings (thread.pfg.pw/settings)",b.atxt(" ")}if(t.info.author&&b.adch(Ho(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),(null==(s=t.info.author)?void 0:s.flair)&&b.adch(Lo(t.info.author.flair)),"mastodon-post"===t.layout&&(null==(c=t.info.author)?void 0:c.pfp)){n.clss("spacefiller-pfp");el("div").clss("pfp").styl({"--url":"url("+JSON.stringify(t.info.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.author.pfp.hover)+")"}).adto(p)}if(w=document.createComment("").adto(b),!1!==t.info.time){const e=el("span").adch(Po(t.info.time).defer(y));b.atxt(" ").adch(e)}if(!1!==t.info.edited&&b.atxt(", Edited ").adch(Po(t.info.edited).defer(y)),t.info.pinned&&b.atxt(", ").adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")),t.info.reblogged_by&&(b.atxt(" ← Boosted by "),t.info.reblogged_by.author&&b.adch(Ho(e.id,t.info.reblogged_by.author.link,t.info.reblogged_by.author.color_hash).atxt(t.info.reblogged_by.author.name)),!1!==t.info.reblogged_by.time&&b.atxt(" at ").adch(Po(t.info.reblogged_by.time).defer(y)),"mastodon-post"===t.layout&&(null==(d=t.info.reblogged_by.author)?void 0:d.pfp))){n.clss("spacefiller-pfp");el("div").clss("pfp","pfp-reblog").styl({"--url":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.hover)+")"}).adto(p)}}{if(t.thumbnail)if("image"===t.thumbnail.kind)g.adch(el("img").attr({src:t.thumbnail.url,alt:""})),x.length&&g.clss("thumbnail-content-warning");else if("default"===t.thumbnail.kind){const e={self:"self",default:"default",image:"image",spoiler:"spoiler",nsfw:"nsfw",account:"account",error:"error"}[t.thumbnail.thumb];g.adch(el("div").clss("thumbnail-builtin","thumbnail-"+e))}else _o(t.thumbnail);const n=(t,n)=>{const o=el("div").clss("post-body"),r=ur(o);if(x.length){const l=x,i=el("div").adto(o);return i.atxt("Content Warning"+(1===l.length?"":"s")+": "),i.adch(Lo(l)),i.atxt(" "),Xo("pill-filled").adto(i).atxt("Show Content").onev("click",(l=>{l.stopPropagation(),i.remove(),x=[],g.classList.remove("thumbnail-content-warning"),Oo(e,t,{...n}).defer(r).adto(o)})),r}return Oo(e,t,{...n}).defer(r).adto(o),r},o=e=>"none"===e.kind||"array"===e.kind&&e.body.every((e=>null==e||o(e)));if(o(t.body))f.remove();else if("collapsed"===t.display_mode.body){const e=Xo("outlined-button").adto(_),o=txt("…").adto(e);let r;y.on("cleanup",(()=>{r&&r.cleanup()})),y.on("hide",(()=>{r&&r.setVisible(!1)})),y.on("show",(()=>{r&&r.setVisible(!0)}));let l="open"===t.display_mode.body_default;const i=!l,a=()=>{l&&!r?(r=n(t.body,{autoplay:i}),r.associated_data.adto(f)):!l&&r&&(r.cleanup(),r.associated_data.remove(),r=void 0),o.nodeValue=l?"Hide":"Show"};a(),e.onev("click",(e=>{e.stopPropagation(),l=!l,a()})),g.onev("click",(e=>{e.stopPropagation(),l=!l,a()}))}else n(t.body,{autoplay:!1}).defer(y).adto(f)}let k=!1;for(const P of t.actions)if("counter"===P.kind&&"reddit-points"===P.special){n.clss("spacefiller-redditpoints");const o=Uo(e,P,p,{parens:!1}).defer(y);if("reddit-comment"===t.layout)b.insertBefore(txt(" "),w),b.insertBefore(o.votecount,w),b.insertBefore(txt(" points"),w);else if("reddit-post"===t.layout){b.atxt(", "),o.percent_voted_txt.adto(b),p.clss("desktop-only"),_.atxt(" ");const n=el("div").clss("mobile-only").adto(_);Mo(e,P,n,{value_for_code_btn:t}).defer(y)}}else"code"===P.kind&&(k=!0),_.atxt(" "),Mo(e,P,_,{value_for_code_btn:t}).defer(y);0===p.childNodes.length&&p.remove(),0===t.actions.length&&(_.atxt(" "),wo(e.id,t.link,"action-button").atxt("View").adto(_)),k||(_.atxt(" "),Xo("code-button").onev("click",(e=>{e.stopPropagation(),console.log(t)})).atxt("Code").adto(_));const $=el("ul").clss("replies").styl({margin:"0"}).adto(v),N=1===(null==(u=t.replies)?void 0:u.length)&&1===(null==(h=t.replies[0].replies)?void 0:h.length);let C;const E=e=>{if(N&&e.length>1){if(!C)throw new Error("threaded comment has no lastElemAddChildren");C(e)}else e.forEach((e=>L(e)))},L=t=>{var n;const r=el("li").adto($);if(N&&r.clss("relative threaded"),"load_more"===t.kind)return void er(e,t,E,(()=>r.remove())).adto(r);let l;N&&1===(null==(n=t.replies)?void 0:n.length)&&(l=t.replies[0],t.replies=[]),r.clss("comment");const i=Ko();C=Jo(e,t,i,{clickable:o.clickable}).defer(y).addChildren,i.adto(r),l&&L(l)};return t.replies&&("collapsed"===t.display_mode.comments||E(t.replies)),y.associated_data.addChildren=E,y}const Yo={none:"",normal:"text-blue-600 dark:text-blue-500 underline",previewable:"text-blue-600 dark:text-blue-500 hover:underline","action-button":"p-1 rounded hover:bg-gray-200","action-button-active":"p-1 rounded bg-gray-200 hover:bg-gray-300","save-button-saved":"text-green-600 dark:text-green-500 hover:underline","safe-action-button":"text-blue-600 dark:text-blue-500 hover:underline","unsafe-action-button":"text-red-600 dark:text-red-500 hover:underline","code-button":"text-gray-600 dark:text-gray-500 hover:underline","load-more":"text-blue-600 dark:text-blue-500 hover:underline text-base",userlink:"text-$light-color dark:text-$dark-color hover:underline","pill-empty":"text-sm border-2 border-black text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-transparent":"text-sm border-2 border-transparent text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-filled":"text-sm border-2 border-black bg-black text-white hover:text-black hover:bg-transparent p-1 px-3 rounded-full transition-colors","outlined-button":"border border-gray-600 dark:border-gray-500 px-2",error:"text-red-600 dark:text-red-500 hover:underline"},Qo=e=>[Yo[e]];function Xo(e){return el("button").clss(...Qo(e)).attr({draggable:"true"})}function Zo(){return el("div").clss("lds-ripple").adch(el("div")).adch(el("div"))}function er(e,t,n,o){const r=el("div"),l=()=>wo(e.id,t.url,"load-more",{onclick:()=>{const a=el("div").adto(r);a.adch(el("span").atxt("Loading…")),a.adch(Zo()),i.remove(),i=a;const s=i;e.loadMore(t.load_more).then((e=>{s.remove(),n(e),o()})).catch((e=>{console.log("error loading more:",e),s.parentNode&&s.remove(),i=el("span").atxt("Error. ").adch(l().atxt("🗘 Retry")).adto(r)}))}});let i=l().atxt(null!=t.count?"Load "+t.count+" More…":"Load More…").adto(r).clss("load-more");return r.atxt(" "),Xo("code-button").onev("click",(e=>{e.stopPropagation(),console.log(t)})).atxt("Code").adto(r),r}function tr(e,t){let n=e.visible;e.on("hide",(()=>n=!1)),e.on("show",(()=>{n=!0,document.title=o(r)}));const o=e=>e+" | "+t+" | ThreadClient";let r="…";const l={setTitle(e){r=e,n&&(document.title=o(e))}};return l.setTitle("…"),l}function nr(e,t){const n=wo(e.id,t.url,"action-button"),o=ur(n),r=el("span").adto(n),l=txt("… ").adto(r);return r.atxt(t.name),e.hydrateInbox(t.hydrate).then((e=>{"zero"===e.messages.kind?l.nodeValue="":"exact"===e.messages.kind?l.nodeValue=e.messages.value+" ":"minimum"===e.messages.kind&&(l.nodeValue=e.messages.min+"+ "),"zero"!==e.messages.kind&&r.classList.add({green:"text-green-500",orange:"text-orange-500"}[t.active_color])})).catch((e=>{l.nodeValue="� "})),o}const or=()=>el("div").clss("top-level-wrapper","object-wrapper","bg-postcolor-100");function rr(e,t,n,o){const r=ur();o.setTitle(t.title),n.classList.add("display-"+t.display_style);const l=el("div").adto(n).clss("navbar-area");for(const c of t.navbar.actions)Mo(e,c,l,{value_for_code_btn:t}).defer(r),txt(" ").adto(l);const i=[{kind:"link",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Report Issue"},{kind:"link",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Feature Request"}];for(const c of i)Mo(e,c,l,{value_for_code_btn:t}).defer(r),l.atxt(" ");Xo("code-button").atxt("Code").adto(l).onev("click",(()=>console.log(t))),txt(" ").adto(l);for(const c of t.navbar.inboxes)nr(e,c).defer(r).adto(l),txt(" ").adto(l);const a=el("div").adto(n).clss("header-area"),s=el("div").adto(n).clss("content-area");if(t.sidebar){Xo("pill-filled").adto(n).clss("sidebar-toggle-mobile","my-1").atxt("Toggle Sidebar").onev("click",(e=>{e.stopPropagation(),o.classList.toggle("sidebar-visible-mobile")}));const o=el("div").adto(n).clss("sidebar-area");for(const n of t.sidebar)Fo(e,n,{clickable:!1}).defer(r).adto(or().adto(o))}if("listing"===t.body.kind){Fo(e,t.body.header,{clickable:!1}).defer(r).adto(or().adto(a)),t.body.menu&&Bo(e,t.body.menu).defer(r).adto(or().adto(s));const n=el("div").adto(s),o=e=>{for(const t of e)l(t)},l=t=>{if(0===t.parents.length){return void el("div").clss("error").atxt("unmounted.parents.length === 0").adto(or().adto(n))}const o=or().adto(n);for(const n of t.parents)if("load_more"===n.kind){const t=el("div").adto(o);wo(e.id,n.url,"load-more").atxt("Load More").adto(t),t.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"))}else Fo(e,n,{clickable:!0}).defer(r).adto(o);if(t.replies.length>0){let n;const r=Xo("previewable").adto(o).atxt("Replies ▸").onev("click",(l=>{if(l.stopPropagation(),n)n.cleanup(),n.associated_data.remove(),n=void 0,r.textContent="Replies ▸";else{r.textContent="Replies ▾";const l=el("div").adto(o),i=ur(l);n=i;const a=e=>{for(const t of e)s(t)},s=t=>{if("load_more"!==t.kind)Fo(e,t,{clickable:!1}).defer(i).adto(l);else{const n=er(e,t,a,(()=>n.remove()));n.adto(l)}};a(t.replies)}}))}};if(o(t.body.items),t.body.next){const n=function(e,t,n,o){const r=el("div"),l=t=>wo(e.id,t.url,"load-more",{onclick:()=>{const s=el("div").adto(r);s.adch(el("span").atxt("Loading…")),s.adch(Zo()),a&&a.remove(),a=s,e.loadMoreUnmounted(t.load_more_unmounted).then((e=>{a&&a.remove(),n(e.children),e.next?i(e.next):o()})).catch((e=>{console.log("error loading more:",e),a&&null!=a.parentNode&&a.remove(),a=el("span").atxt("Error. ").adch(l(t).atxt("🗘 Retry")).adto(r)}))}}),i=e=>{a=el("div").adch(l(e).atxt(null!=e.count?"Load "+e.count+" More…":"Load More…").adto(r).clss("load-more")).atxt(" ").adch(Xo("code-button").onev("click",(t=>{t.stopPropagation(),console.log(e)})).atxt("Code")).adto(r)};let a;return i(t),r}(e,t.body.next,o,(()=>n.remove()));n.adto(s)}}else if("one"===t.body.kind){const n=or().adto(a);for(const i of t.body.item.parents){if("load_more"===i.kind){const t=n;wo(e.id,i.url,"load-more").atxt("Load More").adto(t),t.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"));continue}const o=i===t.body.item.parents[t.body.item.parents.length-1];Fo(e,i,{clickable:!o}).defer(r).adto(n)}t.body.item.menu&&Bo(e,t.body.item.menu).defer(r).adto(or().adto(s));const o=e=>{for(const t of e)l(t)},l=t=>{if("load_more"!==t.kind)Fo(e,t,{clickable:!1}).defer(r).adto(or().adto(s));else{const n=er(e,t,o,(()=>n.remove()));n.adto(s).clss("top-level-load-more")}};o(t.body.item.replies),0===t.body.item.replies.length&&el("div").atxt("*There are no replies*").adto(s)}else _o(t.body);return r}window.onpopstate=e=>{var t;console.log("onpopstate. ev:",e.state);const n=e.state;if((null==n?void 0:n.session_name)!==sr)return console.log("Going to history item from different session"),void br(0,location);br(null!=(t=null==n?void 0:n.index)?t:0,location)};const lr={},ir={reddit:()=>T((()=>import("./reddit.cc7b03ed.js")),["assets/reddit.cc7b03ed.js","assets/base.50b98d34.js","assets/vendor.03bc8c46.js"]).then((e=>e.client)),mastodon:()=>T((()=>import("./mastodon.cddfd7c8.js")),["assets/mastodon.cddfd7c8.js","assets/base.50b98d34.js","assets/vendor.03bc8c46.js"]).then((e=>e.client)),hackernews:()=>T((()=>import("./hackernews.bf0ac536.js")),["assets/hackernews.bf0ac536.js","assets/vendor.03bc8c46.js"]).then((e=>e.client)),test:()=>T((()=>import("./test.5ed69bce.js")),["assets/test.5ed69bce.js","assets/_commonjsHelpers.4e997714.js","assets/base.50b98d34.js","assets/vendor.03bc8c46.js"]).then((e=>e.client))};const ar=[],sr=""+Math.random();function cr({path:e,replace:t}){null!=t||(t=!1),t?(console.log("Replacing history item",mr,e),ar[mr]={url:"::redirecting::",node:{removeSelf:()=>{},hide:()=>{},show:()=>{}}},history.replaceState({index:mr,session_name:sr},"ThreadClient",e),br(mr,location)):(console.log("Appending history state index",mr+1,e),history.pushState({index:mr+1,session_name:sr},"ThreadClient",e),br(mr+1,location))}const dr=[];function ur(e){const t=e,n={};let o=!0,r=!0,l=!0;const i=()=>{const e=o&&r;e!==l&&(l=e,c(e?"show":"hide"),s.forEach((t=>t.setParentVisible(e))))};let a=!0;const s=new Set,c=e=>{const t=n[e];t&&t.forEach((e=>e()))},d={on(e,t){null!=n[e]||(n[e]=[]),n[e].push(t)},setVisible(e){if(!a)return console.log("hideshow called on a deleted object");o!==e&&(o=e,i())},setParentVisible(e){if(!a)return console.log("hideshow called on a deleted object");r!==e&&(r=e,i())},get visible(){return o},cleanup(){a=!1,s.forEach((e=>e.cleanup())),c("cleanup")},emit:c,addChild:e=>(s.add(e),{cleanup:()=>{e.cleanup(),s.delete(e)}}),get associated_data(){return t},defer:e=>(e.addChild(d),t)};return d}function hr(e,t){const n=null!=(o=lr[e])?o:void 0;var o;return n?t(n):pr(async function(e){const t=e.toLowerCase(),n=ir[t];if(n){if(lr[t]||(lr[t]=await n()),lr[t].id!==t)throw new Error("client has incorrect id");return lr[t]}}(e),(n=>n?t(n):function(e){const t=document.createElement("div"),n=ur(t);return t.appendChild(document.createTextNode(e)),n}("404. Client "+e+" not found.")))}function pr(e,t){const n=el("div").adto(document.body),o=ur(n),r=el("div").adto(n);return el("span").atxt("Fetching client…").adto(r),e.then((e=>{t(e).defer(o).adto(n),r.remove()})).catch((e=>{console.log("error rendering",e),n.adch(el("span").clss("error").atxt("Got error! Check console! "+e.toString()))})),o}function gr(e,t){var n;const o=e.split("/").filter((e=>e)),r=o.shift();return console.log(o),null==r?function(){const e=el("div"),t=ur(e);return Ve(0,e,(()=>p(vo,{})),{color_level:0}).defer(t),t}():"pwa_start"===r?function(){const e=el("div"),t=ur(e);return wo("","/reddit","normal").atxt("Reddit").adto(e),e.atxt(" · "),wo("","/mastodon","normal").atxt("Mastodon").adto(e),e.atxt(" · "),wo("","/settings","normal").atxt("Settings").adto(e),e.atxt(" · "),wo("","/","normal").atxt("Home").adto(e),t}():"settings"===r?pr(T((()=>import("./settings.ce0a32d8.js")),["assets/settings.ce0a32d8.js","assets/vendor.03bc8c46.js"]),(({SettingsPage:e})=>{const t=el("div"),n=ur(t);return Ve(0,t,(()=>p(e,{})),{color_level:0}).defer(n),n})):"login"===r?hr(null!=(n=o[0])?n:"ENOCLIENT",(e=>function(e,t,n){const o=document.createElement("div"),r=ur(o);return o.atxt("…"),(async()=>{o.innerHTML="",o.atxt("Logging In…");try{await e.login(t,n)}catch(r){return console.log(r),o.innerHTML="",void o.adch(el("div").clss("error").atxt("Login error! "+r.toString()))}o.innerHTML="",o.atxt("Logged In! You may now close this page.")})().catch((e=>{console.log(e),alert("Unexpected error "+e.toString())})),r}(e,o,new URLSearchParams(t)))):"saved"===r?hr("reddit",(e=>{var t;const n=el("div").clss("client-wrapper"),o=ur(n),r=el("div").adto(n);r.classList.add("client-main-frame");const l=tr(o,e.id);return l.setTitle("Loading "+e.id+"…"),rr(e,JSON.parse(null!=(t=localStorage.getItem("saved-post"))?t:"{}"),r,l),o})):hr(r,(e=>function(e,t){const n=el("div").clss("client-wrapper"),o=ur(n),r=el("div").adto(n);r.classList.add("client-main-frame");const l=el("div").adto(r);l.classList.add("display-loading"),l.adch(Zo());const i=tr(o,e.id);return i.setTitle("Loading "+e.id+"…"),(async()=>{var n;if(!e.getThread||e.getPage&&"2"===Le().page_version.value()){const a=await e.getPage(t);let s,c,d=a.pivot.ref;for(;d;)"post"===d.kind&&"post"===d.content.kind&&(d.content.title&&null==s&&(s=d.content.title.text),null==c&&(c=d.display_style)),d=null==(n=d.parent)?void 0:n.ref;i.setTitle(null!=s?s:"«err no title»");const{ClientPage:u}=await T((()=>Promise.resolve().then((function(){return Qt}))),void 0);l.remove(),r.classList.remove("client-main-frame"),r.classList.add("display-"+{centered:"comments-view",fullscreen:"fullscreen-view"}[null!=c?c:"centered"]),Ve(e,r,(()=>p(u,{page:a})),{color_level:0}).defer(o)}else{const n=await e.getThread(t);l.remove(),rr(e,n,r,i).defer(o)}})().catch((e=>{var t;console.log(e,null!=(t=e.stack)?t:"*no stack*"),l.parentNode&&l.remove(),el("div").atxt("Error! "+e+", check console.").clss("error").adto(r)})),o}(e,"/"+o.join("/")+t)))}let fr,vr,mr=0;function br(e,t){console.log("Navigating",e,t,ar),document.title="ThreadClient",dr.forEach((e=>e(t)));const n=t.pathname+t.search;mr=e;const o=ar[e];if(o){if(ar.forEach((e=>e.node.hide())),o.url===n)return void o.node.show();console.log("URLS differ. «",o.url,"» «",n,"»");for(let t=ar.length-1;t>=e;t--){const e=ar.pop();if(!e)throw new Error("bad logic");e.node.removeSelf()}}else ar.forEach((e=>e.node.hide()));const r=ur(),l=gr(t.pathname,t.search).defer(r).adto(document.body);r.on("cleanup",(()=>l.remove())),r.on("hide",(()=>l.style.display="none")),r.on("show",(()=>l.style.display=""));const i={removeSelf:()=>r.cleanup(),hide:()=>r.setVisible(!1),show:()=>r.setVisible(!0)};ar[e]={node:i,url:n}}el("div").adto(document.body);{const e=el("nav").clss("navbar","bg-postcolor-100","transition-opacity").adto(document.body);fr=e;const t=["px-2"];el("button").adto(e).attr({"aria-label":"Back"}).atxt("←").clss(...t).onev("click",(e=>{e.stopPropagation(),history.back()})),el("button").adto(e).attr({"aria-label":"Forward"}).atxt("→").clss(...t).onev("click",(e=>{e.stopPropagation(),history.forward()}));const n=el("input").attr({"aria-label":"URL"}).adto(e).clss("bg-transparent text-center border border-gray-600 dark:border-gray-500"),o=el("button").attr({"aria-label":"Go"}).clss(...t).atxt("⏎").adto(e),r=el("button").attr({"aria-label":"Reload"}).clss(...t).atxt("🗘").adto(e),l=()=>cr({path:n.value});o.onclick=()=>l(),n.onkeydown=e=>"Enter"===e.key?l():0,r.onclick=()=>alert("TODO refresh"),dr.push((e=>n.value=e.pathname+e.search));let i=window.scrollY,a=0;document.addEventListener("scroll",(t=>{const n=window.scrollY,o=n-i;i=n;const r=Math.max(0,Math.min(100,n));a+=o,a>r&&(a=r),a<0&&(a=0);let l=a;n<0&&(l=-n),e.style.setProperty("--mobile-transform","translateY("+-l+"px)")}),{passive:!1})}console.log("ThreadClient built on "+mo.build_time);const[_r,yr]=o(!1),[xr,wr]=o(!1),kr=function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisterError:l}=e;let i,a;if("serviceWorker"in navigator){i=new L("/sw.js",{scope:"/"}),i.addEventListener("activated",(e=>{e.isUpdate||null==o||o()}));{const e=()=>{null==n||n()};i.addEventListener("waiting",e),i.addEventListener("externalwaiting",e)}i.register({immediate:t}).then((e=>{a=e,null==r||r(e)})).catch((e=>{null==l||l(e)}))}return async(e=!0)=>{e&&(null==i||i.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),a&&a.waiting&&await P(a.waiting,{type:"SKIP_WAITING"})}}({onNeedRefresh(){console.log("An update to ThreadClient is available"),wr(!0);if("on"===Le().update_notifications.value()){const e=el("div").clss("alert").adto(vr);el("div").clss("alert-body").adto(e).atxt("An update to ThreadClient is available."),Xo("pill-empty").atxt("Ignore").adto(e).onev("click",(t=>{t.stopPropagation(),e.remove()})),e.atxt(" "),Xo("pill-empty").atxt("Update (Refresh)").adto(e).onev("click",(e=>{e.stopPropagation(),kr(!0)}))}},onOfflineReady(){console.log("Ready for offline use."),yr(!0)}});console.log("updateSW",kr),null!=navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((e=>{e.every((e=>e.active))&&0!==e.length&&yr(!0)})).catch((e=>console.log("Error checking sw registrations",e)));{history.replaceState({index:0,session_name:sr},"ThreadClient",location.pathname+location.search+location.hash),br(0,location);let e=100;const t=()=>{var n;null==(n=document.head.querySelector(".darkreader"))||n.remove(),e*=2,setTimeout((()=>t()),e)};setTimeout((()=>t()),0),vr=el("div").adto(document.body).clss("alert-area")}export{Oe as A,Y as B,ye as C,Ae as I,Hn as R,Ge as S,Jt as T,T as _,te as a,re as b,X as c,Kt as d,ee as e,de as f,$o as g,ur as h,_r as i,kr as j,ce as k,ko as l,A as m,Le as n,j as o,Yo as p,Ve as q,O as r,ie as s,Me as t,xr as u,mo as v,se as w,G as x,$e as y,Vo as z};
