const Wl=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}};Wl();window.el=(...e)=>document.createElement(...e);window.txt=e=>document.createTextNode(e);window.anychange=(e,t)=>(e.forEach(n=>n.oninput=()=>t()),t(),t);window.body=document.getElementById("maincontent")||document.body;Node.prototype.attr=function(e){return Object.entries(e).forEach(([t,n])=>n==null?this.removeAttribute(t):this.setAttribute(t,n)),this};Node.prototype.adto=function(e){return e.appendChild(this),this};Node.prototype.adch=function(...e){return e.forEach(t=>this.appendChild(t)),this};Node.prototype.atxt=function(e){return this.appendChild(txt(e)),this};Node.prototype.onev=function(...e){return this.addEventListener(...e),this};Node.prototype.clss=function(...e){return e.forEach(t=>t.split(/[. ]/g).filter(n=>n).map(n=>this.classList.add(n))),this};Node.prototype.styl=function(e){return Object.entries(e).forEach(([t,n])=>this.style.setProperty(t,n)),this};Object.defineProperty(Array.prototype,"last",{enumerable:!1,get:function(){return this[this.length-1]}});Object.defineProperty(Object.prototype,"dwth",{enumerable:!1,value:function(e){return e(this),this}});const zo=(e,t)=>e===t,Ye=Symbol("solid-proxy"),an={equals:zo};let Ue=null,Mo=Wo;const dt={},Ne=1,sn=2,jo={owned:null,cleanups:null,context:null,owner:null};var K=null;let jt=null,J=null,It=null,se=null,xe=null,wr=0;function Se(e,t){const n=J,r=K,o=e.length===0?jo:{owned:null,cleanups:null,context:null,owner:t||r};K=o,J=null;try{return Cr(()=>e(()=>Sr(o)),!0)}finally{J=n,K=r}}function C(e,t){t=t?Object.assign({},an,t):an;const n={value:e,observers:null,observerSlots:null,pending:dt,comparator:t.equals||void 0},r=o=>(typeof o=="function"&&(o=o(n.pending!==dt?n.pending:n.value)),kr(n,o));return[Uo.bind(n),r]}function cn(e,t,n){const r=mt(e,t,!0,Ne);He(r)}function $(e,t,n){const r=mt(e,t,!1,Ne);He(r)}function F(e,t,n){Mo=Yl;const r=mt(e,t,!1,Ne);r.user=!0,xe?xe.push(r):queueMicrotask(()=>He(r))}function Hl(e,t){let n;const r=mt(()=>{n?n():z(e),n=void 0},void 0,!1,0);return r.user=!0,o=>{n=o,He(r)}}function T(e,t,n){n=n?Object.assign({},an,n):an;const r=mt(e,t,!0,0);return r.pending=dt,r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,He(r),Uo.bind(r)}function Zn(e,t,n){arguments.length===2?typeof t=="object"&&(n=t,t=e,e=!0):arguments.length===1&&(t=e,e=!0),n||(n={}),n.globalRefetch!==!1&&(Kt||(Kt=new Set),Kt.add(E),K&&G(()=>Kt.delete(E)));const r=new Set,[o,l]=C(n.initialValue),[i,a]=C(void 0,{equals:!1}),[s,c]=C(!1),[u,f]=C();let h,m=null,v=null,b=!1,w=typeof e=="function";function k(y,S,P,M){return m===y&&(m=null,v&&y===v&&n.onHydrated&&n.onHydrated(M,{value:S}),v=null,f(h=P),N(S)),S}function N(y){Je(()=>{l(()=>y),c(!1);for(const S of r.keys())S.decrement();r.clear()})}function I(){const y=Gl,S=o();if(h)throw h;return J&&!J.user&&y&&cn(()=>{i(),m&&(y.resolved||r.has(y)||(y.increment(),r.add(y)))}),S}function E(y=!0){if(y&&b)return;b=!1,f(h=void 0);const S=w?e():e;if(S==null||S===!1){k(m,z(o));return}const P=v||z(()=>t(S,{value:o(),refetching:y}));return typeof P!="object"||!("then"in P)?(k(m,P),P):(m=P,b=!0,queueMicrotask(()=>b=!1),Je(()=>{c(!0),a()}),P.then(M=>k(P,M,void 0,S),M=>k(P,M,M)))}return Object.defineProperties(I,{loading:{get(){return s()}},error:{get(){return u()}}}),w?cn(()=>E(!1)):E(!1),[I,{refetch:E,mutate:l}]}let Kt;function Yr(e,t=zo,n){const r=new Map,o=mt(l=>{const i=e();for(const a of r.keys())if(t(a,i)!==(l!==void 0&&t(a,l))){const s=r.get(a);for(const c of s.values())c.state=Ne,c.pure?se.push(c):xe.push(c)}return i},void 0,!0,Ne);return He(o),l=>{let i;if(i=J){let a;(a=r.get(l))?a.add(i):r.set(l,a=new Set([i])),G(()=>{a.delete(i),!a.size&&r.delete(l)})}return t(l,o.value)}}function Je(e){if(It)return e();let t;const n=It=[];try{t=e()}finally{It=null}return Cr(()=>{for(let r=0;r<n.length;r+=1){const o=n[r];if(o.pending!==dt){const l=o.pending;o.pending=dt,kr(o,l)}}},!1),t}function z(e){let t,n=J;return J=null,t=e(),J=n,t}function xr(e,t,n){const r=Array.isArray(e);let o,l=n&&n.defer;return i=>{let a;if(r){a=[];for(let c=0;c<e.length;c++)a.push(e[c]())}else a=e();if(l){l=!1;return}const s=z(()=>t(a,o,i));return o=a,s}}function Sn(e){F(()=>z(e))}function G(e){return K===null||(K.cleanups===null?K.cleanups=[e]:K.cleanups.push(e)),e}function ql(e){Ue||(Ue=Symbol("error")),K===null||(K.context===null?K.context={[Ue]:[e]}:K.context[Ue]?K.context[Ue].push(e):K.context[Ue]=[e])}function Bo(){return J}function Fo(){return K}function we(e){const t=Symbol("context");return{id:t,Provider:Jl(t),defaultValue:e}}function fe(e){let t;return(t=Er(K,e.id))!==void 0?t:e.defaultValue}function $r(e){const t=T(e);return T(()=>er(t()))}let Gl;function Uo(){const e=jt;if(this.sources&&(this.state||e)){const t=se;se=null,this.state===Ne||e?He(this):dn(this),se=t}if(J){const t=this.observers?this.observers.length:0;J.sources?(J.sources.push(this),J.sourceSlots.push(t)):(J.sources=[this],J.sourceSlots=[t]),this.observers?(this.observers.push(J),this.observerSlots.push(J.sources.length-1)):(this.observers=[J],this.observerSlots=[J.sources.length-1])}return this.value}function kr(e,t,n){if(It)return e.pending===dt&&It.push(e),e.pending=t,t;if(e.comparator&&e.comparator(e.value,t))return t;let r=!1;return e.value=t,e.observers&&e.observers.length&&Cr(()=>{for(let o=0;o<e.observers.length;o+=1){const l=e.observers[o];r&&jt.disposed.has(l),(r&&!l.tState||!r&&!l.state)&&(l.pure?se.push(l):xe.push(l),l.observers&&Ho(l)),r||(l.state=Ne)}if(se.length>1e6)throw se=[],new Error},!1),t}function He(e){if(!e.fn)return;Sr(e);const t=K,n=J,r=wr;J=K=e,Kl(e,e.value,r),J=n,K=t}function Kl(e,t,n){let r;try{r=e.fn(t)}catch(o){qo(o)}(!e.updatedAt||e.updatedAt<=n)&&(e.observers&&e.observers.length?kr(e,r):e.value=r,e.updatedAt=n)}function mt(e,t,n,r=Ne,o){const l={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:K,context:null,pure:n};return K===null||K!==jo&&(K.owned?K.owned.push(l):K.owned=[l]),l}function Dt(e){const t=jt;if(e.state===0||t)return;if(e.state===sn||t)return dn(e);if(e.suspense&&z(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<wr);)(e.state||t)&&n.push(e);for(let r=n.length-1;r>=0;r--)if(e=n[r],e.state===Ne||t)He(e);else if(e.state===sn||t){const o=se;se=null,dn(e,n[0]),se=o}}function Cr(e,t){if(se)return e();let n=!1;t||(se=[]),xe?n=!0:xe=[],wr++;try{return e()}catch(r){qo(r)}finally{Xl(n)}}function Xl(e){se&&(Wo(se),se=null),!e&&(xe.length?Je(()=>{Mo(xe),xe=null}):xe=null)}function Wo(e){for(let t=0;t<e.length;t++)Dt(e[t])}function Yl(e){let t,n=0;for(t=0;t<e.length;t++){const o=e[t];o.user?e[n++]=o:Dt(o)}const r=e.length;for(t=0;t<n;t++)Dt(e[t]);for(t=r;t<e.length;t++)Dt(e[t])}function dn(e,t){const n=jt;e.state=0;for(let r=0;r<e.sources.length;r+=1){const o=e.sources[r];o.sources&&(o.state===Ne||n?o!==t&&Dt(o):(o.state===sn||n)&&dn(o,t))}}function Ho(e){const t=jt;for(let n=0;n<e.observers.length;n+=1){const r=e.observers[n];(!r.state||t)&&(r.state=sn,r.pure?se.push(r):xe.push(r),r.observers&&Ho(r))}}function Sr(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),o=n.observers;if(o&&o.length){const l=o.pop(),i=n.observerSlots.pop();r<o.length&&(l.sourceSlots[i]=r,o[r]=l,n.observerSlots[r]=i)}}if(e.owned){for(t=0;t<e.owned.length;t++)Sr(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function qo(e){const t=Ue&&Er(K,Ue);if(!t)throw e;t.forEach(n=>n(e))}function Er(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:Er(e.owner,t):void 0}function er(e){if(typeof e=="function"&&!e.length)return er(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=er(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function Jl(e){return function(n){let r;return cn(()=>r=z(()=>(K.context={[e]:n.value},$r(()=>n.children)))),r}}const tr=Symbol("fallback");function un(e){for(let t=0;t<e.length;t++)e[t]()}function Ql(e,t,n={}){let r=[],o=[],l=[],i=0,a=t.length>1?[]:null;return G(()=>un(l)),()=>{let s=e()||[],c,u;return z(()=>{let h=s.length,m,v,b,w,k,N,I,E,y;if(h===0)i!==0&&(un(l),l=[],r=[],o=[],i=0,a&&(a=[])),n.fallback&&(r=[tr],o[0]=Se(S=>(l[0]=S,n.fallback())),i=1);else if(i===0){for(o=new Array(h),u=0;u<h;u++)r[u]=s[u],o[u]=Se(f);i=h}else{for(b=new Array(h),w=new Array(h),a&&(k=new Array(h)),N=0,I=Math.min(i,h);N<I&&r[N]===s[N];N++);for(I=i-1,E=h-1;I>=N&&E>=N&&r[I]===s[E];I--,E--)b[E]=o[I],w[E]=l[I],a&&(k[E]=a[I]);for(m=new Map,v=new Array(E+1),u=E;u>=N;u--)y=s[u],c=m.get(y),v[u]=c===void 0?-1:c,m.set(y,u);for(c=N;c<=I;c++)y=r[c],u=m.get(y),u!==void 0&&u!==-1?(b[u]=o[c],w[u]=l[c],a&&(k[u]=a[c]),u=v[u],m.set(y,u)):l[c]();for(u=N;u<h;u++)u in b?(o[u]=b[u],l[u]=w[u],a&&(a[u]=k[u],a[u](u))):o[u]=Se(f);o=o.slice(0,i=h),r=s.slice(0)}return o});function f(h){if(l[u]=h,a){const[m,v]=C(u);return a[u]=v,t(s[u],m)}return t(s[u])}}}function Zl(e,t,n={}){let r=[],o=[],l=[],i=[],a=0,s;return G(()=>un(l)),()=>{const c=e()||[];return z(()=>{if(c.length===0)return a!==0&&(un(l),l=[],r=[],o=[],a=0,i=[]),n.fallback&&(r=[tr],o[0]=Se(f=>(l[0]=f,n.fallback())),a=1),o;for(r[0]===tr&&(l[0](),l=[],r=[],o=[],a=0),s=0;s<c.length;s++)s<r.length&&r[s]!==c[s]?i[s](()=>c[s]):s>=r.length&&(o[s]=Se(u));for(;s<r.length;s++)l[s]();return a=i.length=l.length=c.length,r=c.slice(0),o=o.slice(0,a)});function u(f){l[s]=f;const[h,m]=C(c[s]);return i[s]=m,t(h,s)}}}function d(e,t){return z(()=>e(t))}function Xt(){return!0}const Go={get(e,t,n){return t===Ye?n:e.get(t)},has(e,t){return e.has(t)},set:Xt,deleteProperty:Xt,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:Xt,deleteProperty:Xt}},ownKeys(e){return e.keys()}};function jn(e){return typeof e=="function"?e():e}function Le(...e){return new Proxy({get(t){for(let n=e.length-1;n>=0;n--){const r=jn(e[n])[t];if(r!==void 0)return r}},has(t){for(let n=e.length-1;n>=0;n--)if(t in jn(e[n]))return!0;return!1},keys(){const t=[];for(let n=0;n<e.length;n++)t.push(...Object.keys(jn(e[n])));return[...new Set(t)]}},Go)}function ei(e,...t){const n=new Set(t.flat()),r=Object.getOwnPropertyDescriptors(e),o=t.map(l=>{const i={};for(let a=0;a<l.length;a++){const s=l[a];Object.defineProperty(i,s,r[s]?r[s]:{get(){return e[s]},set(){return!0}})}return i});return o.push(new Proxy({get(l){return n.has(l)?void 0:e[l]},has(l){return n.has(l)?!1:l in e},keys(){return Object.keys(e).filter(l=>!n.has(l))}},Go)),o}function ti(e){let t,n;const r=o=>{if(t){const i=t();if(i)return i(o)}else{const[i]=Zn(()=>(n||(n=e())).then(a=>a.default),{globalRefetch:!1});t=i}let l;return T(()=>(l=t())&&z(()=>l(o)))};return r.preload=()=>n||((n=e()).then(o=>t=()=>o.default),n),r}let ni=0;function Ve(){return`cl-${ni++}`}function W(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(Ql(()=>e.each,e.children,t||void 0))}function Jr(e){const t="fallback"in e&&{fallback:()=>e.fallback};return T(Zl(()=>e.each,e.children,t||void 0))}function ri(e){let t=!1;const n=$r(()=>e.children),r=T(()=>{let o=n();Array.isArray(o)||(o=[o]);for(let l=0;l<o.length;l++){const i=o[l].when;if(i)return[l,i,o[l]]}return[-1]},void 0,{equals:(o,l)=>o[0]===l[0]&&(t?o[1]===l[1]:!o[1]==!l[1])&&o[2]===l[2]});return T(()=>{const[o,l,i]=r();if(o<0)return e.fallback;const a=i.children;return(t=typeof a=="function"&&a.length>0)?z(()=>a(l)):a})}function Bn(e){return e}let Yt;function oi(e){let t;const[n,r]=C(t);Yt||(Yt=new Set),Yt.add(r),G(()=>Yt.delete(r));let o;return T(()=>{if((o=n())!=null){const l=e.fallback;return typeof l=="function"&&l.length?z(()=>l(o,()=>r(null))):l}return ql(r),e.children})}const Qr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";function Zr(e,t){if(!e)throw new Error(t)}const li=(()=>{let e=0;const t=[];return(n,r)=>{const o=n===e;e=n;const l=new Array(8);for(let a=7;a>=0;a--)l[a]=Qr.charAt(n%64),n=Math.floor(n/64);Zr(n===0,"Cannot push at time == 0");let i=l.join("");if(o){let a;for(a=11;a>=0&&t[a]===63;a--)t[a]=0;t[a]++}else{const a=new Uint8Array(12);r.readBytes(a);for(let s=0;s<12;s++)t[s]=a[s]%64}for(let a=0;a<12;a++)i+=Qr.charAt(t[a]);return Zr(i.length===20,"nextPushId: Length should be 20."),i}})(),eo=Symbol("raw");function ii(e){return(t,...n)=>{const r=[];return t.forEach((l,i)=>{if(r.push({raw:l}),i<n.length){const a=n[i];typeof a=="object"&&eo in a?r.push({raw:a[eo]}):r.push({val:a})}}),r.map(l=>"raw"in l?l.raw:e(l.val)).join("")}}const ai=ii(e=>encodeURIComponent(e));function Tf(e){let t="";for(const[n,r]of Object.entries(e))r!=null&&(t&&(t+="&"),t+=ai`${n}=${r}`);return t}function si(e){return e.replace(/[^a-zA-Z0-9. ]/giu,t=>"&#"+t.codePointAt(0)+";")}function de(e){throw console.log("not never:",e),new Error("Expected never")}function to(e,t,n,r){const o={...e},l=[...t];for(const i of n)if(typeof i=="string"){if(l.shift()!==i)return null}else{const a=Object.entries(i);if(!a[0]||a.length!==1)throw new Error("bad bit object");const[s,c]=a[0];if(c==="any"){const u=l.shift();if(u==null)return null;o[s]=u}else if(c==="rest")o[s]=l.splice(0);else if(c==="optional")o[s]=l.shift()??null;else if(Array.isArray(c)||"forEach"in c){const u=l.shift()??null;if(!c.includes(u))return null;o[s]=u}else if(c.kind==="starts-with"){const u=l.shift();if(u==null||!u.startsWith(c.text))return null;o[s]=u.replace(c.text,"")}}return r.assert_end&&l.length!==0?null:{opts:o,path:l}}function Ko(e){const t=[],n={with(r,o){const l=Ko(!1);o(l),t.push((i,a)=>{const s=to(i,a,r,{assert_end:!1});return s?l.parseSub(s.opts,s.path):null})},route(r,o){t.push((l,i)=>{const a=to(l,i,r,{assert_end:!0});return a?o(a.opts):null})},catchall(r){t.push((o,l)=>r(o))},parse(r){if(!e)throw new Error("not root, ParentOpts \u2260 BaseParentOpts");let o;try{o=new URL(r,new URL("https://example/"))}catch{return null}const l=o.pathname.split("/").filter(a=>a),i={query:Object.fromEntries(o.searchParams),path:o.pathname};return n.parseSub(i,l)},parseSub(r,o){for(const l of t){const i=l(r,o);if(i!=null)return i}return null}};return n}function Of(){return Ko(!0)}function Xo(e,t){const n=t[e.kind]??t.unsupported??(()=>{throw new Error("condition "+e.kind+" was not handled and no unsupported branch")});return()=>n(e)}function vt(e,t){return Xo(e,t)()}function ci(e){const[t,...n]=e.split("?"),r=n.join("?"),[o,...l]=r.split("#");return[t??"",new URLSearchParams(o),l.join("#")]}function fn(e,t){const[n,r,o]=ci(e);for(const[l,i]of Object.entries(t))i!=null?r.set(l,i):r.delete(l);return n+"?"+r.toString()+(o!==""?"#"+o:"")}try{self["workbox:window:6.5.1"]&&_()}catch{}function nr(e,t){return new Promise(function(n){var r=new MessageChannel;r.port1.onmessage=function(o){n(o.data)},e.postMessage(t,[r.port2])})}function di(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function no(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ui(e,t){var n;if(typeof Symbol>"u"||e[Symbol.iterator]==null){if(Array.isArray(e)||(n=function(o,l){if(o){if(typeof o=="string")return no(o,l);var i=Object.prototype.toString.call(o).slice(8,-1);return i==="Object"&&o.constructor&&(i=o.constructor.name),i==="Map"||i==="Set"?Array.from(o):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?no(o,l):void 0}}(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(n=e[Symbol.iterator]()).next.bind(n)}try{self["workbox:core:6.5.1"]&&_()}catch{}var Fn=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})};function Un(e,t){var n=location.href;return new URL(e,n).href===new URL(t,n).href}var St=function(e,t){this.type=e,Object.assign(this,t)};function Jt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function fi(){}var hi={type:"SKIP_WAITING"};function ro(e,t){if(!t)return e&&e.then?e.then(fi):Promise.resolve()}var gi=function(e){var t,n;function r(a,s){var c,u;return s===void 0&&(s={}),(c=e.call(this)||this).nn={},c.tn=0,c.rn=new Fn,c.en=new Fn,c.on=new Fn,c.un=0,c.an=new Set,c.cn=function(){var f=c.fn,h=f.installing;c.tn>0||!Un(h.scriptURL,c.sn.toString())||performance.now()>c.un+6e4?(c.vn=h,f.removeEventListener("updatefound",c.cn)):(c.hn=h,c.an.add(h),c.rn.resolve(h)),++c.tn,h.addEventListener("statechange",c.ln)},c.ln=function(f){var h=c.fn,m=f.target,v=m.state,b=m===c.vn,w={sw:m,isExternal:b,originalEvent:f};!b&&c.mn&&(w.isUpdate=!0),c.dispatchEvent(new St(v,w)),v==="installed"?c.wn=self.setTimeout(function(){v==="installed"&&h.waiting===m&&c.dispatchEvent(new St("waiting",w))},200):v==="activating"&&(clearTimeout(c.wn),b||c.en.resolve(m))},c.dn=function(f){var h=c.hn,m=h!==navigator.serviceWorker.controller;c.dispatchEvent(new St("controlling",{isExternal:m,originalEvent:f,sw:h,isUpdate:c.mn})),m||c.on.resolve(h)},c.gn=(u=function(f){var h=f.data,m=f.ports,v=f.source;return Jt(c.getSW(),function(){c.an.has(v)&&c.dispatchEvent(new St("message",{data:h,originalEvent:f,ports:m,sw:v}))})},function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];try{return Promise.resolve(u.apply(this,f))}catch(m){return Promise.reject(m)}}),c.sn=a,c.nn=s,navigator.serviceWorker.addEventListener("message",c.gn),c}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o,l,i=r.prototype;return i.register=function(a){var s=(a===void 0?{}:a).immediate,c=s!==void 0&&s;try{var u=this;return function(f,h){var m=f();return m&&m.then?m.then(h):h(m)}(function(){if(!c&&document.readyState!=="complete")return ro(new Promise(function(f){return window.addEventListener("load",f)}))},function(){return u.mn=Boolean(navigator.serviceWorker.controller),u.yn=u.pn(),Jt(u.bn(),function(f){u.fn=f,u.yn&&(u.hn=u.yn,u.en.resolve(u.yn),u.on.resolve(u.yn),u.yn.addEventListener("statechange",u.ln,{once:!0}));var h=u.fn.waiting;return h&&Un(h.scriptURL,u.sn.toString())&&(u.hn=h,Promise.resolve().then(function(){u.dispatchEvent(new St("waiting",{sw:h,wasWaitingBeforeRegister:!0}))}).then(function(){})),u.hn&&(u.rn.resolve(u.hn),u.an.add(u.hn)),u.fn.addEventListener("updatefound",u.cn),navigator.serviceWorker.addEventListener("controllerchange",u.dn),u.fn})})}catch(f){return Promise.reject(f)}},i.update=function(){try{return this.fn?ro(this.fn.update()):void 0}catch(a){return Promise.reject(a)}},i.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},i.messageSW=function(a){try{return Jt(this.getSW(),function(s){return nr(s,a)})}catch(s){return Promise.reject(s)}},i.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&nr(this.fn.waiting,hi)},i.pn=function(){var a=navigator.serviceWorker.controller;return a&&Un(a.scriptURL,this.sn.toString())?a:void 0},i.bn=function(){try{var a=this;return function(s,c){try{var u=s()}catch(f){return c(f)}return u&&u.then?u.then(void 0,c):u}(function(){return Jt(navigator.serviceWorker.register(a.sn,a.nn),function(s){return a.un=performance.now(),s})},function(s){throw s})}catch(s){return Promise.reject(s)}},o=r,(l=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&di(o.prototype,l),r}(function(){function e(){this.Pn=new Map}var t=e.prototype;return t.addEventListener=function(n,r){this.Sn(n).add(r)},t.removeEventListener=function(n,r){this.Sn(n).delete(r)},t.dispatchEvent=function(n){n.target=this;for(var r,o=ui(this.Sn(n.type));!(r=o()).done;)(0,r.value)(n)},t.Sn=function(n){return this.Pn.has(n)||this.Pn.set(n,new Set),this.Pn.get(n)},e}());function mi(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisterError:l}=e;let i,a;const s=async(c=!0)=>{c&&i?.addEventListener("controlling",u=>{u.isUpdate&&window.location.reload()}),a&&a.waiting&&await nr(a.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){i=new gi("/sw.js",{scope:"/",type:"classic"}),i.addEventListener("activated",c=>{c.isUpdate||r?.()});{const c=()=>{n?.()};i.addEventListener("waiting",c),i.addEventListener("externalwaiting",c)}i.register({immediate:t}).then(c=>{a=c,o?.(c)}).catch(c=>{l?.(c)})}return s}const vi={version:`92363c5
`,log:[{hash:"92363c5",hash_full:"92363c5b25146b634d0fba09c60a9bd170ac3424",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1659064926000",commit_title:"fixes a bug where reddit text formatting is completely broken",commit_body:`fixes a bug where reddit text formatting is completely broken
`},{hash:"5d41e8f",hash_full:"5d41e8fb5b5f618ec48889cd9775285634f4e7d3",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658962698000",commit_title:"fix yarn lockfile",commit_body:`fix yarn lockfile
`},{hash:"1f73e0e",hash_full:"1f73e0ed32078cc6b268fc9ec86ee79d7dacd77a",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658962429000",commit_title:"delete stale code & fix lint for release",commit_body:`delete stale code & fix lint for release
`},{hash:"ef7beb7",hash_full:"ef7beb7c6f6a9f2f6ec9cb587a386a8e15ce7621",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658961934000",commit_title:"ready update -N0l8jcINFK5F9MkDcyT for release",commit_body:`ready update -N0l8jcINFK5F9MkDcyT for release
`},{hash:"75a44cd",hash_full:"75a44cd4007cf21c90516b8d8386f13455263ae8",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658960811000",commit_title:"get mastodon at least kinda working before releasing an update",commit_body:`get mastodon at least kinda working before releasing an update
`},{hash:"39b1fb2",hash_full:"39b1fb2930452cfb70095e3b5927d49699e46394",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658960465000",commit_title:"sketchy  'view on reddit.com' links for page1 and page2",commit_body:`sketchy  'view on reddit.com' links for page1 and page2
`},{hash:"538b093",hash_full:"538b0934e4237e3564ee3fbd427286b8ad39f99b",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1658430134000",commit_title:"remove unused code",commit_body:`remove unused code
`},{hash:"be9a541",hash_full:"be9a541c634e7ca93c4b8e2711a6bce11aba184e",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1657557975000",commit_title:"[threadclient-ui-web] act and delete actions although they do nothing right now.",commit_body:`[threadclient-ui-web] act and delete actions
although they do nothing right now.
`},{hash:"513cd7f",hash_full:"513cd7f20377d34d1c89d15fc4977fe9c6309243",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1656564015000",commit_title:".",commit_body:`.
`},{hash:"b594560",hash_full:"b594560e5c0f904c4439de0f7302de8f3d104817",author_name:"pfg",author_email:"pfg@pfg.pw",date:"1656366060000",commit_title:"more todo items that will never get completed",commit_body:`more todo items that will never get completed
`}],build_time:1659065208798,build_mode:"production"},_i=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"],pi=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline",..._i]),bi=new Set(["innerHTML","textContent","innerText","children"]),yi={className:"class",htmlFor:"for"},oo={class:"className",formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly"},wi=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),xi=new Set(["altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","tref","tspan","use","view","vkern"]),$i={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function R(e,t){return T(e,void 0,t?void 0:{equals:t})}function ki(e,t,n){let r=n.length,o=t.length,l=r,i=0,a=0,s=t[o-1].nextSibling,c=null;for(;i<o||a<l;){if(t[i]===n[a]){i++,a++;continue}for(;t[o-1]===n[l-1];)o--,l--;if(o===i){const u=l<r?a?n[a-1].nextSibling:n[l-a]:s;for(;a<l;)e.insertBefore(n[a++],u)}else if(l===a)for(;i<o;)(!c||!c.has(t[i]))&&t[i].remove(),i++;else if(t[i]===n[l-1]&&n[a]===t[o-1]){const u=t[--o].nextSibling;e.insertBefore(n[a++],t[i++].nextSibling),e.insertBefore(n[--l],u),t[o]=n[l]}else{if(!c){c=new Map;let f=a;for(;f<l;)c.set(n[f],f++)}const u=c.get(t[i]);if(u!=null)if(a<u&&u<l){let f=i,h=1,m;for(;++f<o&&f<l&&!((m=c.get(t[f]))==null||m!==u+h);)h++;if(h>u-a){const v=t[i];for(;a<u;)e.insertBefore(n[a++],v)}else e.replaceChild(n[a++],t[i++])}else i++;else t[i++].remove()}}}const lo="_$DX_DELEGATE";function _t(e,t,n){let r;return Se(o=>{r=o,t===document?e():g(t,e(),t.firstChild?null:void 0,n)}),()=>{r(),t.textContent=""}}function p(e,t,n){const r=document.createElement("template");r.innerHTML=e;let o=r.content.firstChild;return n&&(o=o.firstChild),o}function ce(e,t=window.document){const n=t[lo]||(t[lo]=new Set);for(let r=0,o=e.length;r<o;r++){const l=e[r];n.has(l)||(n.add(l),t.addEventListener(l,Pi))}}function B(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function Ci(e,t,n,r){r==null?e.removeAttributeNS(t,n):e.setAttributeNS(t,n,r)}function Si(e,t,n,r){r?Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n:Array.isArray(n)?e.addEventListener(t,o=>n[0](n[1],o)):e.addEventListener(t,n)}function Ei(e,t,n={}){const r=Object.keys(t||{}),o=Object.keys(n);let l,i;for(l=0,i=o.length;l<i;l++){const a=o[l];!a||a==="undefined"||t[a]||(io(e,a,!1),delete n[a])}for(l=0,i=r.length;l<i;l++){const a=r[l],s=!!t[a];!a||a==="undefined"||n[a]===s||!s||(io(e,a,!0),n[a]=s)}return n}function En(e,t,n={}){const r=e.style,o=typeof n=="string";if(t==null&&o||typeof t=="string")return r.cssText=t;o&&(r.cssText=void 0,n={}),t||(t={});let l,i;for(i in n)t[i]==null&&r.removeProperty(i),delete n[i];for(i in t)l=t[i],l!==n[i]&&(r.setProperty(i,l),n[i]=l);return n}function Yo(e,t,n,r){typeof t=="function"?$(o=>so(e,t(),o,n,r)):so(e,t,void 0,n,r)}function g(e,t,n,r){if(n!==void 0&&!r&&(r=[]),typeof t!="function")return ut(e,t,r,n);$(o=>ut(e,t(),o,n),r)}function Ni(e,t,n,r,o={},l=!1){t||(t={});for(const i in o)if(!(i in t)){if(i==="children")continue;ao(e,i,null,o[i],n,l)}for(const i in t){if(i==="children"){r||ut(e,t.children);continue}const a=t[i];o[i]=ao(e,i,a,o[i],n,l)}}function Li(e){return e.toLowerCase().replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function io(e,t,n){const r=t.trim().split(/\s+/);for(let o=0,l=r.length;o<l;o++)e.classList.toggle(r[o],n)}function ao(e,t,n,r,o,l){let i,a,s;if(t==="style")return En(e,n,r);if(t==="classList")return Ei(e,n,r);if(n===r)return r;if(t==="ref")l||n(e);else if(t.slice(0,3)==="on:")e.addEventListener(t.slice(3),n);else if(t.slice(0,10)==="oncapture:")e.addEventListener(t.slice(10),n,!0);else if(t.slice(0,2)==="on"){const c=t.slice(2).toLowerCase(),u=wi.has(c);Si(e,c,n,u),u&&ce([c])}else if((s=bi.has(t))||!o&&(oo[t]||(a=pi.has(t)))||(i=e.nodeName.includes("-")))i&&!a&&!s?e[Li(t)]=n:e[oo[t]||t]=n;else{const c=o&&t.indexOf(":")>-1&&$i[t.split(":")[0]];c?Ci(e,c,t,n):B(e,yi[t]||t,n)}return n}function Pi(e){const t=`$$${e.type}`;let n=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==n&&Object.defineProperty(e,"target",{configurable:!0,value:n}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return n||document}});n!==null;){const r=n[t];if(r&&!n.disabled){const o=n[`${t}Data`];if(o!==void 0?r(o,e):r(e),e.cancelBubble)return}n=n.host&&n.host!==n&&n.host instanceof Node?n.host:n.parentNode}}function so(e,t,n={},r,o){return t||(t={}),!o&&"children"in t&&$(()=>n.children=ut(e,t.children,n.children)),t.ref&&t.ref(e),$(()=>Ni(e,t,r,!0,n,!0)),n}function ut(e,t,n,r,o){for(;typeof n=="function";)n=n();if(t===n)return n;const l=typeof t,i=r!==void 0;if(e=i&&n[0]&&n[0].parentNode||e,l==="string"||l==="number")if(l==="number"&&(t=t.toString()),i){let a=n[0];a&&a.nodeType===3?a.data=t:a=document.createTextNode(t),n=ot(e,n,r,a)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t;else if(t==null||l==="boolean")n=ot(e,n,r);else{if(l==="function")return $(()=>{let a=t();for(;typeof a=="function";)a=a();n=ut(e,a,n,r)}),()=>n;if(Array.isArray(t)){const a=[];if(rr(a,t,o))return $(()=>n=ut(e,a,n,r,!0)),()=>n;if(a.length===0){if(n=ot(e,n,r),i)return n}else Array.isArray(n)?n.length===0?co(e,a,r):ki(e,n,a):(n&&ot(e),co(e,a));n=a}else if(t instanceof Node){if(Array.isArray(n)){if(i)return n=ot(e,n,r,t);ot(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function rr(e,t,n){let r=!1;for(let o=0,l=t.length;o<l;o++){let i=t[o],a;if(i instanceof Node)e.push(i);else if(!(i==null||i===!0||i===!1))if(Array.isArray(i))r=rr(e,i)||r;else if((a=typeof i)=="string")e.push(document.createTextNode(i));else if(a==="function")if(n){for(;typeof i=="function";)i=i();r=rr(e,Array.isArray(i)?i:[i])||r}else e.push(i),r=!0;else e.push(document.createTextNode(i.toString()))}return r}function co(e,t,n){for(let r=0,o=t.length;r<o;r++)e.insertBefore(t[r],n)}function ot(e,t,n,r){if(n===void 0)return e.textContent="";const o=r||document.createTextNode("");if(t.length){let l=!1;for(let i=t.length-1;i>=0;i--){const a=t[i];if(o!==a){const s=a.parentNode===e;!l&&!i?s?e.replaceChild(o,a):e.insertBefore(o,n):s&&a.remove()}else l=!0}}else e.insertBefore(o,n);return[o]}const Ti="http://www.w3.org/2000/svg";function Jo(e,t=!1){return t?document.createElementNS(Ti,e):document.createElement(e)}function Oi(e){const{useShadow:t}=e,n=document.createTextNode(""),r=e.mount||document.body;function o(){return()=>e.children}if(r instanceof HTMLHeadElement){const[l,i]=C(!1),a=()=>i(!0);Se(s=>g(r,()=>l()?s():o()(),null)),G(()=>{a()})}else{const l=Jo(e.isSVG?"g":"div",e.isSVG),i=t&&l.attachShadow?l.attachShadow({mode:"open"}):l;Object.defineProperty(l,"host",{get(){return n.parentNode}}),g(i,o()),r.appendChild(l),e.ref&&e.ref(l),G(()=>r.removeChild(l))}return n}function Bt(e){const[t,n]=ei(e,["component"]);return T(()=>{const r=t.component;switch(typeof r){case"function":return z(()=>r(n));case"string":const o=xi.has(r),l=Jo(r,o);return Yo(l,n,o),l}})}const Ri=p("<div><div></div></div>"),Ai=p("<div aria-hidden></div>");function Ii(e){let t;const n=(o,l,i)=>{if(l.bottom<0||l.right<0||l.left>o[0]||l.top>o[1])return;let a=l.top,s=l.left,c=l.width,u=l.height;if(c<8){const f=8-c;s-=f,c+=f*2}if(u<8){const f=8-u;a-=f,u+=f*2}Se(f=>{const h=i/10%360|0,m=1e3,v=(()=>{const b=Ri.cloneNode(!0),w=b.firstChild;return(k=>{Sn(()=>{k.animate([{opacity:100},{opacity:0}],{duration:m}).finished.then(()=>{f()})})})(b),b.style.setProperty("position","fixed"),b.style.setProperty("top",a+"px"),b.style.setProperty("left",s+"px"),b.style.setProperty("width",c+"px"),b.style.setProperty("height",u+"px"),b.style.setProperty("z-index","2147483647"),w.style.setProperty("width","100%"),w.style.setProperty("height","100%"),w.style.setProperty("box-sizing","border-box"),w.style.setProperty("border","1px solid hsl("+h+", 100%, 50%)"),b})();t.appendChild(v),G(()=>v.remove())})},r=(o,l,i)=>{if(l instanceof Element)n(o,l.getBoundingClientRect(),i);else if(l instanceof Text){const a=document.createRange();a.selectNode(l),n(o,a.getBoundingClientRect(),i)}else l instanceof Comment||console.log("EBADNODE",l)};return F(()=>{const o=new MutationObserver(l=>{const i=new Set,a=c=>{c.forEach(u=>{i.add(u),a(u.childNodes)})};for(const c of l)c.type==="attributes"?i.add(c.target):c.type==="childList"?a(c.addedNodes):c.type==="characterData"&&i.add(c.target);const s=[window.innerWidth,window.innerHeight];i.forEach(c=>r(s,c,Date.now()))});o.observe(e.observe_root,{attributes:!0,childList:!0,subtree:!0,characterData:!0}),G(()=>o.disconnect())}),(()=>{const o=Ai.cloneNode(!0),l=t;return typeof l=="function"?l(o):t=o,o.style.setProperty("pointer-events","none"),o})()}const Nr=Symbol("store-raw"),hn=Symbol("store-node"),Di=Symbol("store-name");function Qo(e,t){let n=e[Ye];if(!n){Object.defineProperty(e,Ye,{value:n=new Proxy(e,Mi)});const r=Object.keys(e),o=Object.getOwnPropertyDescriptors(e);for(let l=0,i=r.length;l<i;l++){const a=r[l];if(o[a].get){const s=o[a].get.bind(n);Object.defineProperty(e,a,{get:s})}}}return n}function Pe(e){return e!=null&&typeof e=="object"&&(e[Ye]||!e.__proto__||e.__proto__===Object.prototype||Array.isArray(e))}function ft(e,t=new Set){let n,r,o,l;if(n=e!=null&&e[Nr])return n;if(!Pe(e)||t.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):t.add(e);for(let i=0,a=e.length;i<a;i++)o=e[i],(r=ft(o,t))!==o&&(e[i]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):t.add(e);const i=Object.keys(e),a=Object.getOwnPropertyDescriptors(e);for(let s=0,c=i.length;s<c;s++)l=i[s],!a[l].get&&(o=e[l],(r=ft(o,t))!==o&&(e[l]=r))}return e}function gn(e){let t=e[hn];return t||Object.defineProperty(e,hn,{value:t={}}),t}function Vi(e,t){const n=Reflect.getOwnPropertyDescriptor(e,t);return!n||n.get||!n.configurable||t===Ye||t===hn||t===Di||(delete n.value,delete n.writable,n.get=()=>e[Ye][t]),n}function zi(e){if(Bo()){const t=gn(e);(t._||(t._=or()))()}return Reflect.ownKeys(e)}function or(){const[e,t]=C(void 0,{equals:!1,internal:!0});return e.$=t,e}const Mi={get(e,t,n){if(t===Nr)return e;if(t===Ye)return n;const r=e[t];if(t===hn||t==="__proto__")return r;const o=Pe(r);if(Bo()&&(typeof r!="function"||e.hasOwnProperty(t))){let l,i;o&&(l=gn(r))&&(i=l._||(l._=or()),i()),l=gn(e),i=l[t]||(l[t]=or()),i()}return o?Qo(r):r},set(){return!0},deleteProperty(){return!0},ownKeys:zi,getOwnPropertyDescriptor:Vi};function _e(e,t,n){if(e[t]===n)return;const r=Array.isArray(e),o=e.length,l=n===void 0,i=r||l===t in e;l?delete e[t]:e[t]=n;let a=gn(e),s;(s=a[t])&&s.$(),r&&e.length!==o&&(s=a.length)&&s.$(),i&&(s=a._)&&s.$()}function ji(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r+=1){const o=n[r];_e(e,o,t[o])}}function Ot(e,t,n=[]){let r,o=e;if(t.length>1){r=t.shift();const i=typeof r,a=Array.isArray(e);if(Array.isArray(r)){for(let s=0;s<r.length;s++)Ot(e,[r[s]].concat(t),n);return}else if(a&&i==="function"){for(let s=0;s<e.length;s++)r(e[s],s)&&Ot(e,[s].concat(t),n);return}else if(a&&i==="object"){const{from:s=0,to:c=e.length-1,by:u=1}=r;for(let f=s;f<=c;f+=u)Ot(e,[f].concat(t),n);return}else if(t.length>1){Ot(e[r],t,[r].concat(n));return}o=e[r],n=[r].concat(n)}let l=t[0];typeof l=="function"&&(l=l(o,n),l===o)||r===void 0&&l==null||(l=ft(l),r===void 0||Pe(o)&&Pe(l)&&!Array.isArray(l)?ji(o,l):_e(e,r,l))}function Nn(e,t){const n=ft(e||{}),r=Qo(n);function o(...l){Je(()=>Ot(n,l))}return[r,o]}function lt(e,t,n,r,o){const l=t[n];if(e===l)return;if(!Pe(e)||!Pe(l)||o&&e[o]!==l[o]){e!==l&&_e(t,n,e);return}if(Array.isArray(e)){if(e.length&&l.length&&(!r||o&&e[0][o]!=null)){let s,c,u,f,h,m,v,b;for(u=0,f=Math.min(l.length,e.length);u<f&&(l[u]===e[u]||o&&l[u][o]===e[u][o]);u++)lt(e[u],l,u,r,o);const w=new Array(e.length),k=new Map;for(f=l.length-1,h=e.length-1;f>=u&&h>=u&&(l[f]===e[h]||o&&l[f][o]===e[h][o]);f--,h--)w[h]=l[f];if(u>h||u>f){for(c=u;c<=h;c++)_e(l,c,e[c]);for(;c<e.length;c++)_e(l,c,w[c]),lt(e[c],l,c,r,o);l.length>e.length&&_e(l,"length",e.length);return}for(v=new Array(h+1),c=h;c>=u;c--)m=e[c],b=o?m[o]:m,s=k.get(b),v[c]=s===void 0?-1:s,k.set(b,c);for(s=u;s<=f;s++)m=l[s],b=o?m[o]:m,c=k.get(b),c!==void 0&&c!==-1&&(w[c]=l[s],c=v[c],k.set(b,c));for(c=u;c<e.length;c++)c in w?(_e(l,c,w[c]),lt(e[c],l,c,r,o)):_e(l,c,e[c])}else for(let s=0,c=e.length;s<c;s++)lt(e[s],l,s,r,o);l.length>e.length&&_e(l,"length",e.length);return}const i=Object.keys(e);for(let s=0,c=i.length;s<c;s++)lt(e[i[s]],l,i[s],r,o);const a=Object.keys(l);for(let s=0,c=a.length;s<c;s++)e[a[s]]===void 0&&_e(l,a[s],void 0)}function De(e,t={}){const{merge:n,key:r="id"}=t,o=ft(e);return l=>!Pe(l)||!Pe(o)?o:(lt(o,{state:l},"state",n,r),l)}const Zo={get(e,t){if(t===Nr)return e;const n=e[t];return Pe(n)?new Proxy(n,Zo):n},set(e,t,n){return _e(e,t,ft(n)),!0},deleteProperty(e,t){return _e(e,t,void 0),!0}};function Bi(e){return t=>(Pe(t)&&e(new Proxy(t,Zo)),t)}function Lr(e,t){const[n,r]=Nn({data:null}),o=Hl(()=>{o(()=>r("data",De(e(),{merge:t.merge,key:t.key})))});return o(()=>{r("data",De(e()))}),n}const Fi=p("<time></time>");function ne(e){return T(()=>{const t=Xo(e.item,"fallback"in e?{...e.children,unsupported:e.fallback}:e.children);return z(()=>t())})}function x(e){const t=T(()=>"if"in e?e.if??!1:!0);return T(()=>t()&&("when"in e?e.when!=null:!0)?"when"in e?(()=>{const n=e.children;return z(()=>n(e.when))})():e.children:e.fallback)}function Pr(e,t){if(document.getSelection()?.isCollapsed===!1)return!1;let r=e;for(;r&&r!==t;){if(r instanceof HTMLElement&&(r.nodeName==="A"||r.nodeName==="BUTTON"||r.nodeName==="VIDEO"||r.nodeName==="AUDIO"||r.nodeName==="INPUT"||r.nodeName==="TEXTAREA"||r.nodeName==="IFRAME"||r.classList.contains("resizable-iframe")||r.classList.contains("handles-clicks")))return!1;r=r.parentNode}return!0}function Wn(e,t){if(!t.endsWith("s"))throw new Error("!s");return e===1?e+t.substring(0,t.length-1):e+t}function Ui(e,t,n={}){const r=t-e;if(r<0)return[n.short??!1?"later":"in the future "+new Date(e).toISOString(),-r];if(r<60*1e3)return[n.short??!1?"now":"just now",60*1e3-r];let o=60*1e3,l=60;if(r<l*o){const a=r/o|0;return[n.short??!1?a+"m":Wn(a," minutes")+" ago",o-(r-a*o)]}if(o*=l,l=24,r<l*o){const a=r/o|0;return[n.short??!1?a+"h":Wn(a," hours")+" ago",o-(r-a*o)]}if(o*=l,l=30,r<l*o){const a=r/o|0;return[n.short??!1?a+"d":Wn(a," days")+" ago",o-(r-a*o)]}const i=new Date(e).getFullYear();return i===new Date(t).getFullYear()?[n.short??!1?new Date(e).toLocaleString(void 0,{month:"short"}):"in "+new Date(e).toLocaleString(void 0,{month:"long"}),-1]:[n.short??!1?""+i:"in "+i,-1]}function tl(e,t={}){const[n,r]=C(Date.now());return T(()=>{const l=Ui(e,n(),t);if(l[1]>0){const i=setTimeout(()=>r(Date.now()),Math.min(l[1]+10,2147483647));G(()=>clearTimeout(i))}return l[0]})}function nl(e){return(()=>{const t=Fi.cloneNode(!0);return g(t,()=>tl(e.start)),$(n=>{const r=new Date(e.start).toString(),o=""+new Date(e.start);return r!==n._v$&&B(t,"datetime",n._v$=r),o!==n._v$2&&B(t,"title",n._v$2=o),n},{_v$:void 0,_v$2:void 0}),t})()}function rl(e){const[t,n]=C(localStorage.getItem(e)),r=o=>{o.key===e&&n(o.newValue)};return window.addEventListener("storage",r),G(()=>window.removeEventListener("storage",r)),[t,o=>{o==null?localStorage.removeItem(e):localStorage.setItem(e,o),n(o)}]}function Wi(e,t){return t==null||typeof t!="object"?!1:t.key===e.sym}function Hi(e,t){const n=$r(e);return T(()=>{let r=n();return Array.isArray(r)||(r=[r]),r.filter(o=>o).map(t)})}function Ln(){const e=Symbol(""+Math.random()),r=Object.assign(o=>({key:e,value:o,toString(){throw new Error("TypesafeChild not allowed in DOM")}}),{useChildren:o=>Hi(o,l=>{if(!Wi(r,l))throw console.log("Ebad_tsch_child",r,l),new Error("bad tsch child");return l.value}),sym:e});return r}const qi="modulepreload",uo={},Gi="/",ee=function(t,n){return!n||n.length===0?t():Promise.all(n.map(r=>{if(r=`${Gi}${r}`,r in uo)return;uo[r]=!0;const o=r.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${l}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":qi,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((a,s)=>{i.addEventListener("load",a),i.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>t())},je={symbolLink(e){return Symbol(e)},createSymbolLinkToError(e,t,n){const r=je.symbolLink("immediate error value");return e[r]={error:t},r},createSymbolLinkToValue(e,t){const n=je.symbolLink("immediate value");return e[n]={data:t},n},stringLink(e){return e},fillLink(e,t,n){return e[t]={data:n},t},fillLinkOnce(e,t,n){return e[t]==null&&je.fillLink(e,t,n()),t},prefilledVerticalLoader(e,t,n){return n!==void 0&&je.fillLink(e,t,n),{kind:"vertical_loader",key:t,temp_parent:je.createSymbolLinkToError(e,"vertical loader claimed to be prefilled",n),load_count:null,request:je.createSymbolLinkToError(e,"vertical loader claimed to be prefilled @2",n),client_id:"@E@UNNECESSARY",autoload:!1}},prefilledHorizontalLoader(e,t,n){return n!==void 0&&je.fillLink(e,t,n),{kind:"horizontal_loader",key:t,load_count:null,request:je.createSymbolLinkToError(e,"horizontal loader claimed to be prefilled",n),client_id:"@E@UNNECESSARY",autoload:!1}}};function Te(e,t){const n=e,r=n[t];return r?Object.hasOwnProperty.call(n,t)?"error"in r?{error:r.error,value:null}:{value:r.data,error:null}:{error:"[read]Link found but not in hasOwnProperty: "+t.toString(),value:null}:null}function Ki(e,t,n){return{...t,kind:e,...n?{children:n}:{}}}const q={kind:Ki,p:(...e)=>q.kind("paragraph",{},e),hn:(e,...t)=>q.kind("heading",{level:e},t),h1:(...e)=>q.hn(1,...e),h2:(...e)=>q.hn(2,...e),ul:(...e)=>q.kind("list",{ordered:!1},e),ol:(...e)=>q.kind("list",{ordered:!0},e),li:(...e)=>q.kind("list_item",{},e),ili:(...e)=>q.kind("tight_list_item",{},e),blockquote:(...e)=>q.kind("blockquote",{},e),txt:(e,t={})=>q.kind("text",{text:e,styles:t}),link:(e,t,n,...r)=>q.kind("link",{url:t,client_id:e.id,...n},r),pre:(e,t)=>q.kind("code_block",{text:e,lang:t}),error:(e,t)=>q.kind("error",{text:e,value:t}),br:()=>q.kind("br",{}),flair:e=>q.kind("flair",{flair:e}),table:(e,...t)=>q.kind("table",{headings:e},t),th:(e,...t)=>({align:e,children:t}),td:(...e)=>({children:e}),timeAgo:e=>q.kind("time_ago",{start:e}),hr:()=>q.kind("horizontal_line",{}),code:e=>q.kind("code",{text:e}),spoiler:(...e)=>q.kind("spoiler",{},e)};function Xi(e){const t="https://v.redd.it/"+e;return{kind:"video",sources:[{url:t+"/DASHPlaylist.mpd"},{url:t+"/HLSPlaylist.m3u8"}],preview:[{url:t+"/DASH_96.mp4",type:"video/mp4"},{url:t+"/DASH_96",type:"video/mp4"}]}}function fo(e,t){const n=e.split(".");return n.pop(),n.push(t),n.join(".")}function ho(e){return{kind:"video",source:Xi(e),gifv:!1}}const Yi={image:({url:e,link:t,path:n,next:r})=>(e?n.endsWith(".gif")&&e.searchParams.get("format")==="mp4":!1)?{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}}:(e?.hostname??"")==="i.imgur.com"&&n.endsWith(".gif")||n.endsWith(".gifv")?{kind:"video",gifv:!0,source:{kind:"video",sources:[{url:fo(t,"webm"),quality:"Highest"},{url:fo(t,"mp4"),quality:"Highest"},{url:t,quality:"Highest"}]}}:(e?.hostname??"")==="i.redd.it"||n.endsWith(".png")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".gif")||n.endsWith(".webp")||(e?.hostname??"")==="pbs.twimg.com"?{kind:"captioned_image",url:t,w:null,h:null}:n.endsWith(".mp4")||n.endsWith(".webm")?{kind:"video",gifv:!1,source:{kind:"video",sources:[{url:t,quality:"Highest"}]}}:n.endsWith(".mp3")?{kind:"audio",url:t}:r(),vreddit:({url:e,link:t,path:n,next:r})=>{if(t.startsWith("https://v.redd.it/"))return ho(t.replace("https://v.redd.it/",""));if(e&&(e.host==="reddit.com"||e.host.endsWith(".reddit.com")&&e.pathname.startsWith("/link"))){const o=n.split("/");if(o.shift(),o[0]==="link"&&o[2]==="video"&&o[4]==="player")return ho(o[3]??"")}return r()},gfycat:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="gfycat.com"||e.host.endsWith(".gfycat.com"))&&e.pathname.split("/").length===2)return{kind:"gfycatv1",id:e.pathname.replace("/","").split("-")[0].split(".")[0].toLowerCase(),host:"gfycat.com"};if(e&&(e.host==="redgifs.com"||e.host.endsWith(".redgifs.com"))&&e.pathname.split("/").length===3&&e.pathname.startsWith("/watch/")){const o=e.pathname.replace("/watch/","").split("-")[0].split(".")[0].toLowerCase();return{kind:"gfycatv2",id:o,host:"redgifs.com"}}return r()},youtube:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="www.youtube.com"||e.host==="youtube.com"||e.host==="m.youtube.com")&&e.pathname==="/watch"){const o=e.searchParams.get("v");if(o!=null)return{kind:"youtube",id:o,search:e.searchParams.toString()}}if(e&&e.host==="youtu.be"&&e.pathname.split("/").length===2){const o=e.pathname.split("/")[1]??"no_id";return{kind:"youtube",id:o,search:e.searchParams.toString()}}return r()},vocaroo:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="vocaroo.com"||e.host==="www.vocaroo.com"||e.host==="voca.ro")){const o=e.pathname.split("/").filter(l=>l);if(o.length===1&&o[0]!=null&&o[0]!=="")return{kind:"audio",url:"https://media.vocaroo.com/mp3/"+o[0]}}return r()},giphy:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="giphy.com"||e.host==="www.giphy.com")){const o=e.pathname.split("/").filter(l=>l);if(o.length===3&&o[0]==="gifs"&&o[2]==="fullscreen"){const l=o[1].split("-"),i=l[l.length-1];return{kind:"video",source:{kind:"video",sources:[{url:"https://media4.giphy.com/media/"+i+"/giphy.mp4",quality:"Highest"}]},gifv:!0}}}return r()},imgur:({url:e,link:t,path:n,next:r})=>{if(e&&(e.host==="www.imgur.com"||e.host==="imgur.com"||e.host==="m.imgur.com")){const o=e.pathname.split("/").filter(a=>a),l=o[1],i=o[0]==="gallery"?"gallery":o[0]==="a"?"album":void 0;if(i!==void 0&&o.length===2)return{kind:"imgur",imgur_id:l,imgur_kind:i};if(o.length===1&&(o[0]??"").length>4)return{kind:"captioned_image",url:"https://i.imgur.com/"+o[0]+".jpg",w:null,h:null}}return r()},twitch:({url:e,link:t,path:n,next:r})=>{if(e&&e.host==="clips.twitch.tv"&&e.pathname.split("/").filter(o=>o).length===1){const o=e.pathname.split("/").filter(l=>l)[0];if(o!=null)return{kind:"twitch_clip",slug:o}}return r()},soundcloud:({url:e,link:t,path:n,next:r})=>e&&(e.host==="soundcloud.com"||e.host.endsWith(".soundcloud.com"))?{kind:"oembed",client_id:"n/a",url:"https://soundcloud.com/oembed?format=json&url="+encodeURIComponent(t)}:r(),tiktok:({url:e,link:t,path:n,next:r})=>e&&(e.host==="tiktok.com"||e.host.endsWith(".tiktok.com"))?{kind:"oembed",client_id:"n/a",url:"https://www.tiktok.com/oembed?url="+encodeURIComponent(t)}:r()};function pt(e,t){let n;try{n=new URL(e)}catch{}const r=n,o=r?.pathname??e,l=Object.values(Yi),i=s=>{const c=l[s];return c?c({url:r,link:e,path:o,next:()=>i(s+1)}):a()},a=()=>t.suggested_embed!=null?{kind:"reddit_suggested_embed",suggested_embed:t.suggested_embed}:null;return i(0)??void 0}async function Ji(e,t){const n=await fetch("https://api."+e+"/v2/gifs/"+t).then(a=>a.json());if(console.log("gfy response",n),"errorMessage"in n)throw new Error("Gfycat error: "+n.errorMessage+"; logged="+n.logged+"; reported="+n.reported);if("message"in n)throw new Error("Gfycat error: "+n.message+"; logged="+n.logged+"; reported="+n.reported);const{gif:r,user:o}=n,l="https://www."+e,i={kind:"video",aspect:r.width/r.height,gifv:!1,source:{kind:"video",sources:[{url:r.urls.hd,quality:"HD"},{url:r.urls.sd,quality:"SD"}],thumbnail:r.urls.thumbnail}};return{kind:"post",parent:null,replies:null,url:"https://www."+e+"/watch/"+t,client_id:l,content:{kind:"post",title:null,thumbnail:{kind:"image",url:r.urls.thumbnail},flair:r.tags.map(a=>({content_warning:!1,elems:[{kind:"text",text:a,styles:{}}]})),info:{creation_date:r.createDate*1e3},author:o?{name:o.name,color_hash:o.username,link:o.url,client_id:l,pfp:o.profileImageUrl!=null?{url:o.profileImageUrl,hover:o.profileImageUrl}:void 0}:void 0,body:i,collapsible:{default_collapsed:!1},actions:{vote:{kind:"counter",client_id:l,unique_id:"like_"+t,time:Date.now(),neutral_icon:"heart",special:void 0,increment:{icon:"heart",color:"pink",label:"Like",undo_label:"Unlike"},decrement:null,count_excl_you:r.likes,you:void 0,actions:{error:"gfycat liking is not supported"}},other:[{kind:"link",text:r.views+" Views",url:"https://www."+e+"/watch/"+t,client_id:l}]}},internal_data:n}}const Qi={reddit:()=>ee(()=>import("./reddit.c64611e8.js"),["assets/reddit.c64611e8.js","assets/base.50b98d34.js"]).then(e=>e.client),mastodon:()=>ee(()=>import("./mastodon.2b50ec08.js"),["assets/mastodon.2b50ec08.js","assets/base.50b98d34.js"]).then(e=>e.client),shell:()=>ee(()=>import("./shell_client.c4f97520.js"),[]).then(e=>e.client)};async function Pn(e){const t=e.toLowerCase(),n=Qi[t];if(!!n){if(ct[t]||(ct[t]=await n()),ct[t].id!==t)throw new Error("client has incorrect id");return ct[t]}}function Ce(e){return ct[e]??void 0}function Zi(e,t){return"status_msg"in e?{kind:"richtext",content:[q.p(q.error("Could not preview oembed",e))]}:e.url!=null?{kind:"link_preview",client_id:t,thumb:(e.embed_url??"")||e.image||void 0,click:e.embed_url??""?{kind:"captioned_image",url:e.embed_url??"",w:null,h:null}:{kind:"link",client_id:t,url:e.url,embed_html:(e.html??"")||void 0},click_enabled:!!((e.embed_url??"")||(e.html??"")),title:e.title,description:e.description,url:e.url}:{kind:"reddit_suggested_embed",suggested_embed:e.html??"ERROR"}}const ea={orange:"text-orange-600 dark:text-orange-400",indigo:"text-indigo-500 dark:text-indigo-400",blue:"text-blue-600 dark:text-blue-500",green:"text-green-600 dark:text-green-500",white:"text-gray-300 dark:text-black",yellow:"text-yellow-600 dark:text-yellow-300",pink:"text-pink-500 dark:text-pink-300"};function Tn(e){return e==null?"":ea[e]}const ta={blue:["bg-blue-700","bg-blue-500"],green:["bg-green-700","bg-green-500"]};function na(e,t){return e==null?"":ta[e]?.[+t]??"bg-red-500"}const ra=p('<button class="text-zinc-400 light:text-slate-600 text-sm px-2 hover:underline">Code</button>');function ol(e){const t=Z();return d(x,{get if(){return t.dev.showLogButtons()==="on"},get children(){const n=ra.cloneNode(!0);return n.$$click=()=>console.log({...e}),n}})}ce(["click"]);const oa=p("<i></i>");function Oe(e){return(()=>{const t=oa.cloneNode(!0);return $(n=>{const r=e.class,o=e.label??void 0,l=e.label==null;return r!==n._v$&&(t.className=n._v$=r),o!==n._v$2&&B(t,"aria-label",n._v$2=o),l!==n._v$3&&B(t,"aria-hidden",n._v$3=l),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()}function Xe(e){return d(Oe,{get class(){return e.class+" "+e.tag+" "+(e.filled?"fas":"far")},get label(){return e.label}})}const go={comments:[!0,"fa-comment"],creation_time:[!0,"fa-clock"],edit_time:[!0,"fa-edit","fa-pencil"],up_arrow:[!1,"fa-arrow-up"],down_arrow:[!1,"fa-arrow-down"],controversiality:[!0,"fa-smile"],pinned:[!1,"fa-thumbtack"],bookmark:[!0,"fa-bookmark"],envelope:[!0,"fa-envelope"],envelope_open:[!0,"fa-envelope-open"],star:[!0,"fa-star"],join:[!0,"fa-plus-square"],heart:[!0,"fa-heart"],code:[!1,"fa-code"],link:[!1,"fa-link"],eye:[!0,"fa-eye"],reply:[!1,"fa-reply"],chevron_up:[!1,"fa-chevron-up"],chevron_down:[!1,"fa-chevron-down"],ellipsis:[!1,"fa-ellipsis"],external:[!1,"fa-arrow-up-right-from-square"],trash:[!1,"fa-trash"]};function bt(e){return d(Xe,{get class(){return e.class},get tag(){return go[e.icon][1]},get filled(){return go[e.icon][0]?e.bold:!0},get label(){return e.label}})}const la=p("<button></button>"),ia=p('<div class="flex flex-col items-center gap-2px text-slate-700 dark:text-zinc-100"></div>');function Tr(e){const t=T(()=>{const n=dl(e().client_id+"_"+e().unique_id,{count:e().count_excl_you,you:e().you,time:e().time});G(()=>{n.cleanup()});const{state:r,onupdate:o}=n.associated_data,l=n.associated_data,[i,a]=C({...r});return o(()=>a({...r})),[i,s=>{Object.assign(l.state,s),l.emit()}]});return[()=>t()[0](),n=>t()[1](n)]}async function aa(e,t,n){if("error"in n.actions)throw await new Promise(o=>setTimeout(o,500)),new Error("counter is error: "+n.actions.error);const r=n.actions[e??"reset"];if(r==null)throw new Error("action "+e+" requested when it is not available.");await t.act(r)}async function ll(e,t,n,r){n({...t,loading:!0,your_vote:e});try{const o=await Pn(r.client_id);if(!o)throw new Error("missing client");await aa(e,o,r),n({...t,loading:!1,your_vote:e})}catch(o){n({...t}),console.log(o),alert("Error while voting: "+o)}}function sa(e){return(()=>{const t=la.cloneNode(!0);return t.$$click=()=>{e.onClick()},t.style.setProperty("font-size","15px"),t.style.setProperty("width","15px"),t.style.setProperty("height","15px"),g(t,()=>e.children),$(n=>{const r=e.class,o=e.loading,l=e.pressed;return r!==n._v$&&(t.className=n._v$=r),o!==n._v$2&&(t.disabled=n._v$2=o),l!==n._v$3&&B(t,"aria-pressed",n._v$3=l),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()}function mo(e){const[t,n]=Tr(()=>e.counter),r=()=>t().your_vote===e.mode;return d(sa,{get class(){return Tn(r()?e.counter[e.mode].color:null)},get loading(){return t().loading},get pressed(){return r()},onClick:()=>{ll(r()?void 0:e.mode,t(),n,e.counter)},get children(){return d(bt,{get icon(){return r()?e.counter[e.mode].icon:e.counter.neutral_icon??e.counter[e.mode].icon},get label(){return e.counter[e.mode][r()?"undo_label":"label"]},get bold(){return r()}})}})}function ca(e){return(()=>{const t=ia.cloneNode(!0);return g(t,d(mo,{get counter(){return e.counter},mode:"increment"}),null),g(t,d(x,{get if(){return e.counter.decrement!=null},get children(){return d(mo,{get counter(){return e.counter},mode:"decrement"})}}),null),t})()}ce(["click"]);//! flattens higherarchical page2 structure to a flat array
function il(e){return{kind:"flat_loader",load_count:e.load_count,request:e.request,client_id:e.client_id,autoload:e.autoload}}function lr(e){return e.kind==="post"&&e.content.kind==="special"?{...e,content:e.content.fallback}:e}function Or(e,t){if(e.kind==="post"){const n=e.collapsible;return n===!1?{default_collapsed:!1,user_controllable:!1}:{default_collapsed:n.default_collapsed,user_controllable:t.is_pivot||t.displayed_in==="tree"}}else return{default_collapsed:!1,user_controllable:!1}}function da(e,t){return e.kind==="flat_post"?{...Or(e.post.content,t),collapse_link:e.link}:{default_collapsed:!1,user_controllable:!1}}function ze(e,t,n){return z(()=>{const r=e.map.get(t);if(r==null){if(!n)throw console.error("Eaccessing cstate",e,{id:t}),new Error("accessing cstate before it has been created");const[o,l]=C(0),[i,a]=C(n.default),s={hovering:o,setHovering:l,collapsed:i,setCollapsed:a};return e.map.set(t,s),s}return r})}function ua(e){return[d(x,{get if(){return e.post.info?.pinned===!0},get children(){return d(Ge,{icon:"pinned",value:["none",-1e3],color:"green",text:"Pinned"})}}),d(x,{get when(){return e.post.actions?.vote},children:t=>{const[n]=Tr(()=>t),r=()=>n().pt_count;return[d(Ge,Le(()=>{const o=r(),l=n();return{value:o==="hidden"?["hidden",-1e3]:o==="none"?["none",-1e3]:["number",o+{increment:1,decrement:-1,none:0}[l.your_vote??"none"]],icon:{none:t.neutral_icon??t.increment.icon,increment:t.increment.icon,decrement:t.decrement?.icon??t.increment.icon}[l.your_vote??"none"],color:{none:null,increment:t.increment.color,decrement:t.decrement?.color??t.increment.color}[l.your_vote??"none"],text:"Points",disabled:l.loading}})),d(x,{get when(){return t.percent},children:o=>d(Ge,{icon:"controversiality",value:["percent",o],color:null,text:"Controversiality"})})]}}),d(x,{get when(){return e.post.info?.comments},children:t=>d(Ge,{icon:"comments",value:["number",t],color:null,text:"Comments"})}),d(x,{get when(){return e.post.info?.creation_date},children:t=>d(Ge,{icon:"creation_time",value:["timeago",t],color:null,text:"Posted"})}),d(x,{get when(){return e.post.info?.edited},children:t=>d(Ge,{icon:"edit_time",get value(){return t.date==null?["none",-1e3]:["timeago",t.date]},color:null,text:"Edited"})})]}const Ge=Ln();function fa(e){return Ge.useChildren(()=>d(ua,{get post(){return e()}}))}function vo(e){return d(Me,Le(()=>{const{action:t,state:n,setState:r,direction:o,client_id:l}=e,i=n.your_vote;return{icon:t[o].icon,color:i===o?t[o].color:null,text:i===o?t[o].undo_label:t[o].label,onClick:n.loading?"disabled":()=>{ll(i===o?void 0:o,n,r,t)},client_id:l}}))}function Hn(e){return d(ne,{get item(){return e.action},fallback:t=>d(Me,{icon:"code",color:null,get text(){return"TODO "+t.kind},onClick:"disabled",client_id:"*UNUSED*"}),children:{counter:t=>{const[n,r]=Tr(()=>t);return[d(vo,Le(()=>({action:t,state:n(),setState:r,direction:"increment",client_id:e.opts.client_id}))),d(x,{get if(){return t.decrement!=null},get children(){return d(vo,Le(()=>({action:t,state:n(),setState:r,direction:"decrement",client_id:e.opts.client_id})))}})]},link:t=>d(Me,{get icon(){return t.icon??"link"},color:null,get text(){return t.text},get onClick(){return{url:t.url}},get client_id(){return t.client_id}}),act:t=>d(Me,{get icon(){return t.icon??"ellipsis"},color:null,get text(){return t.text},onClick:()=>{alert("TODO act")},get client_id(){return t.client_id}}),delete:t=>d(Me,{icon:"trash",color:null,text:"Delete",onClick:()=>{alert("TODO make the thing that tracks requests so we can use it here")},get client_id(){return t.client_id}})}})}function ha(e){return[R((()=>{const t=R(()=>!!(e.opts.collapse_data&&e.opts.flat_frame!=null&&Or(e.post,e.opts.flat_frame).user_controllable&&!e.opts.flat_frame.is_pivot),!0);return()=>t()?d(Me,Le(()=>{const n=ze(e.opts.collapse_data,e.opts.flat_frame.collapse.id),r=n.collapsed();return{icon:r?"chevron_down":"chevron_up",color:null,text:r?"Uncollapse":"Collapse",onClick:()=>n.setCollapsed(o=>!o),client_id:e.opts.client_id}})):null})()),R((()=>{const t=R(()=>e.opts.frame?.url!=null,!0);return()=>t()?d(Me,{icon:"link",color:null,get text(){return R(()=>e.post.info?.comments!=null,!0)()?e.post.info.comments.toLocaleString()+" comment"+(e.post.info.comments===1?"":"s"):"Comments"},get onClick(){return{url:e.opts.frame.url}},get client_id(){return e.opts.client_id}}):null})()),d(x,{get when(){return e.post.actions?.vote},children:t=>d(Hn,{action:t,get opts(){return e.opts}})}),d(x,{get when(){return e.opts.frame?.replies?.reply},children:t=>d(Me,{icon:"reply",color:null,text:"Reply",onClick:()=>alert("TODO"),get client_id(){return e.opts.client_id}})}),d(W,{get each(){return e.post.actions?.other??[]},children:t=>d(Hn,{action:t,get opts(){return e.opts}})}),d(x,{get when(){return e.post.actions?.code},children:t=>d(Hn,{action:t,get opts(){return e.opts}})})]}const Me=Ln();function ga(e,t){return Me.useChildren(()=>d(ha,{get post(){return e()},get opts(){return t()}}))}function ir(e){if(e.kind==="array"){const n=e.body.filter(r=>r&&r.kind!=="none")[0];return n!=null?ir(n):null}if(e.kind==="text"||e.kind==="richtext")return{kind:"icon",icon:"text"};if(e.kind==="captioned_image")return null;if(e.kind==="none")return null;if(e.kind==="video")return{kind:"icon",icon:"video"};if(e.kind==="gallery")return{kind:"gallery",count:e.images.length};if(e.kind==="link"){const t=pt(e.url,{});return t!=null?ir(t):{kind:"icon",icon:"link"}}else return{kind:"icon",icon:"other"}}const ma=p("<span></span>"),va=p("<div>[<!>]</div>"),_a=p('<div class="text-gray-500 flex flex-wrap gap-2 <sm:text-xs"></div>');function al(e){return e<1e4?""+e:e<1e5?(e/1e3).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"k":e<1e6?(e/1e3|0)+"k":e<1e8?(e/1e6).toFixed(2).match(/^-?\d+(?:\.\d{0,1})?/)?.[0]+"m":(e/1e6|0)+"m"}function sl(e){if(e[0]==="none")return["",""];if(e[0]==="percent")return[" "+e[1].toLocaleString(void 0,{style:"percent"})," "+e[1].toLocaleString(void 0,{style:"percent"})];if(e[0]==="timeago")return[" "+tl(e[1],{short:!0})()," "+new Date(e[1]).toLocaleString()];if(e[0]==="number")return[" "+al(e[1])," "+e[1].toLocaleString()];if(e[0]==="hidden")return[" \u2014"," Hidden"];de(e[0])}function pa(e){const t=T(()=>sl(e.item.value)),n=()=>e.item.text+(e.item.value[0]==="none"?"":":");return(()=>{const r=ma.cloneNode(!0);return g(r,(()=>{const o=R(()=>!0,!0);return()=>o()?d(bt,{get icon(){return e.item.icon},get bold(){return e.item.color!=null},get label(){return n()}}):[]})(),null),g(r,()=>t()[0],null),g(r,(()=>{const o=R(()=>!0,!0);return()=>o()?[]:[R(()=>e.item.value[0]==="none"?"":" "),R(()=>e.item.text)]})(),null),$(o=>{const l=U(Tn(e.item.color),e.item.disabled??!1?"opacity-50":""),i=n()+t()[1];return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&B(r,"title",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),r})()}function On(e){const t=fa(()=>e.post),n=Z();return(()=>{const r=_a.cloneNode(!0);return g(r,d(W,{get each(){return t()},children:o=>d(pa,{item:o})}),null),g(r,d(ol,{data:e}),null),g(r,d(x,{get if(){return n.dev.showLogButtons()==="on"},get children(){const o=va.cloneNode(!0),l=o.firstChild,i=l.nextSibling;return i.nextSibling,g(o,()=>(e.opts.id??"null").toString(),i),o}}),null),r})()}function cl(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Rn(e,t){if(t.startsWith("/")&&e&&(t="/"+e+t),t.startsWith("mailto:"))return{kind:"mailto",title:t.replace("mailto:","")};let n=!1;if(t.startsWith("raw!")&&(t=t.replace("raw!",""),n=!0),!t.startsWith("http")&&!t.startsWith("/"))return{kind:"error",title:t};let r;try{r=new URL(t)}catch{r=void 0}return r&&!n&&(r.host==="reddit.com"||r.host.endsWith(".reddit.com"))&&(r.host==="mod.reddit.com"?t="/reddit/mod"+r.pathname+r.search+r.hash:t="/reddit"+r.pathname+r.search+r.hash),r&&!n&&r.host==="redd.it"&&(t="/reddit/comments"+r.pathname+r.search+r.hash),t.startsWith("/")?{kind:"link",url:t.replace("/","#"),external:!1}:{kind:"link",url:t,external:!0}}const ba=Ku(async()=>{const e=new TextEncoder,t=new TextDecoder,n=await(await ee(()=>import("./snudown.69d6942c.js"),[])).default({env:{__assert_fail:(r,o,l,i)=>{throw console.log(r,o,l,i),new Error("assert failed")},__stack_chk_fail:()=>{throw new Error("stack overflow")},debugprints:(r,o)=>{console.log("print text:",t.decode(new Uint8Array(n.memory.buffer,r,o)))},debugprinti:r=>{console.log("print int:",r)},debugprintc:r=>{console.log("print char:",String.fromCodePoint(r))},debugpanic:(r,o)=>{throw new Error("Panic: "+t.decode(new Uint8Array(n.memory.buffer,r,o)))}}});return{renderMd(r){try{const o=e.encode(r),l=n.allocString(o.byteLength);new Uint8Array(n.memory.buffer,l,o.byteLength).set(o);const a=n.markdownToHTML(l,o.byteLength),s=n.strlen(a),c=new Uint8Array(n.memory.buffer,a,s),u=t.decode(c);return n.freeText(l,o.byteLength),n.freeText(a,s),u}catch(o){const l=o;return console.log(l.toString()+`
`+l.stack),si("Error "+l.toString()+`
`+l.stack)}}}});async function ya(e){const t=e.content;if(e.markdown_format==="reddit"){const[n,r]=await Promise.all([ba(),ee(()=>import("./html_to_richtext.2dc3e025.js"),[])]),o=n.renderMd(t);return{kind:"richtext",content:r.parseContentHTML(o,e.client_id)}}else{if(e.markdown_format==="none")return{kind:"richtext",content:[q.p(q.txt(t))]};if(e.markdown_format==="reddit_html"){const n=await ee(()=>import("./html_to_richtext.2dc3e025.js"),[]);return console.log(t),{kind:"richtext",content:n.parseContentHTML(t,e.client_id)}}else de(e.markdown_format)}}async function wa(e){function t(c,u,f){return{extensions:{persistedQuery:{sha256Hash:u,version:1}},operationName:c,variables:f}}const n=await fetch("https://gql.twitch.tv/gql",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Client-Id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify([t("VideoAccessToken_Clip","36b89d2507fce29e5ca551df756d27c1cfe079e2609642b4390aa4c35796eb11",{slug:e}),t("ClipsChatCard","94c1c7d97d860722a5b7ef3c3b3de3783b37fc32d69bcccc8ea0cda372cf1f01",{slug:e}),t("ClipsBroadcasterInfo","ce258d9536360736605b42db697b3636e750fdb14ff0a7da8c7225bdc2c07e8a",{slug:e}),t("ClipsTitle","f6cca7f2fdfbfc2cecea0c88452500dae569191e58a265f97711f8f2a838f5b4",{slug:e}),t("ClipsCurator","769e99d9ac3f68e53c63dd902807cc9fbea63dace36c81643d776bcb120902e2",{slug:e}),t("ClipsFullVideoButton","d519a5a70419d97a3523be18fe6be81eeb93429e0a41c3baa9441fc3b1dffebf",{slug:e})])}).then(c=>c.json());console.log(n);const[r,o,l,i,a,s]=n;return r.data.clip?{kind:"video",source:{kind:"video",sources:r.data.clip.videoQualities.map(c=>({url:c.sourceURL+"?sig="+encodeURIComponent(r.data.clip.playbackAccessToken.signature)+"&token="+encodeURIComponent(r.data.clip.playbackAccessToken.value),quality:c.quality+"p"}))},caption:i.data.clip.title,gifv:!1}:{kind:"richtext",content:[q.p(q.txt("The clip could not be found."))]}}function dl(e,t){const n=e??`${Math.random()}`,r=on.get(n)??{state:{loading:!1,pt_count:t.count,your_vote:t.you},handlers:new Set,users:0,update_time:t.time};on.has(n)||on.set(n,r),r.update_time<t.time&&(r.state.pt_count=t.count,r.state.your_vote=t.you);const o={state:r.state,emit(){[...r.handlers].forEach(i=>{i()})},onupdate(i){const a=()=>{i()};r.handlers.add(a),l.on("cleanup",()=>{r.handlers.delete(a)})}},l=O(o);return r.users++,l.on("cleanup",()=>{r.users--}),l}function xa(e){if(e.pt_count==="hidden"||e.pt_count==="none")return{text:"\u2014",raw:"[score hidden]"};const t=e.pt_count+(e.your_vote==="increment"?1:e.your_vote==="decrement"?-1:0);return{text:al(t),raw:t.toLocaleString()}}const _o=p("<a></a>"),$a=p("<span></span>"),ka=p("<button></button>");function X(e){const t=Lr(()=>typeof e.action!="object"?{kind:"button"}:Rn(e.action.client_id,e.action.url),{key:null,merge:!0}),n=()=>t.data,r=Z(),o=l=>{const i=n();if(e.beforeClick?.(l),!(i.kind==="link"&&i.external&&typeof e.action=="object"&&!e.action.onClick)&&(l.stopPropagation(),!l.defaultPrevented&&l.button===0&&!cl(l))){if(l.preventDefault(),typeof e.action!="object")return e.action==="TODO"?alert("TODO"):e.action(l);if(e.action.onClick)return e.action.onClick(l);const a=i.kind==="link"?i:null;if(a==null)return alert("E_LINK_HREF_EXPECT_NAVIGATE");Qe({path:a.url,page:e.action.page?.(),mode:e.action.mode})}};return d(ne,{get item(){return n()},children:{error:l=>(()=>{const i=_o.cloneNode(!0);return(a=>e.btnref?.(a))(i),i.$$click=o,g(i,()=>e.children),$(a=>{const s=e.class+" error",c=l.title;return s!==a._v$&&(i.className=a._v$=s),c!==a._v$2&&B(i,"title",a._v$2=c),a},{_v$:void 0,_v$2:void 0}),i})(),mailto:l=>(()=>{const i=$a.cloneNode(!0);return i.$$click=o,(a=>e.btnref?.(a))(i),g(i,()=>e.children),$(()=>B(i,"title",l.title)),i})(),link:l=>(()=>{const i=_o.cloneNode(!0);return(a=>e.btnref?.(a))(i),i.$$click=o,Yo(i,()=>l.external?r.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"}:{},!1,!0),g(i,()=>e.children),$(a=>{const s=e.class,c=l.url;return s!==a._v$3&&(i.className=a._v$3=s),c!==a._v$4&&B(i,"href",a._v$4=c),a},{_v$3:void 0,_v$4:void 0}),i})(),button:()=>(()=>{const l=ka.cloneNode(!0);return(i=>e.btnref?.(i))(l),l.$$click=o,g(l,()=>e.children),$(i=>{const a=e.class,s=e.disabled;return a!==i._v$5&&(l.className=i._v$5=a),s!==i._v$6&&(l.disabled=i._v$6=s),i},{_v$5:void 0,_v$6:void 0}),l})()}})}ce(["click"]);const Ca=p("<span></span>");function ve(e,t){const n=O(),r=_t(()=>{const[o,l]=C(n.visible);return n.on("hide",()=>l(!1)),n.on("show",()=>l(!0)),d(bf,{visible:o,get children(){return z(()=>t())}})},e);return n.on("cleanup",()=>r()),n}function $e(e){const t=Vn();return(()=>{const n=Ca.cloneNode(!0);return(r=>{F(()=>{const o=O(),l=e.getValue(o).adto(r);F(()=>{o.setVisible(t())}),G(()=>{o.cleanup(),l.remove()})})})(n),n})()}const Sa=p("<tc:children><div></div></tc:children>"),Ea=p("<tc:fallback><div></div></tc:fallback>"),Na=p("<tc:show-animate></tc:show-animate>");let An=!1;document.addEventListener("keydown",e=>{e.key==="Shift"&&(An=!0)},{capture:!0});document.addEventListener("keyup",e=>{e.key==="Shift"&&(An=!1)},{capture:!0});document.addEventListener("focus",e=>{An=!1});function Rr(){const e=Z();return z(()=>e.motion()==="reduce")?0:z(()=>An&&e.animationDevMode()==="shift_slow"?3:e.animationTime())}function ul(e,t,n,r,o){const l=o?.mode??"height",i=()=>{const a=e.getBoundingClientRect(),s=kn.getBoundingClientRect(),c=()=>5+Math.max(0,s.bottom,window.visualViewport.offsetTop),u=()=>window.visualViewport.offsetTop+window.visualViewport.height;console.log("ANIMATE!",a.top,a.bottom,c(),u());let f=0;if(a.top<c()&&a.bottom>c()){const E=document.documentElement.scrollTop;e.scrollIntoView(),document.documentElement.scrollTop-=c();const y=document.documentElement.scrollTop;f=E-y}const h=n();if(t.motion()==="reduce"||t.animationTime()===0||a.top>u()||a.bottom<c()){r(h,!1,!1);return}const m=Math.min(a.bottom,u())-a.top-f,v=document.documentElement.scrollTop;r(h,!1,!0);const b=e.getBoundingClientRect(),w=Math.min(b.bottom,u())-b.top;if(w===m){r(h,!1,!1);return}r(h,!0,!0);const k=e.getBoundingClientRect(),N=(E,y)=>l==="height"?{height:E+"px",overflow:"hidden"}:{clipPath:"inset(0 0 "+(y-E)+"px 0px)"},I=e.animate([N(m,k.height),N(w,k.height)],{duration:Rr()*1e3,easing:"ease-in-out"});e.scrollTop=f,document.documentElement.scrollTop=v,e.scrollTop=f,I.onfinish=()=>r(n(),!1,!1),I.oncancel=()=>r(n(),!1,!1)};F(xr([n],()=>{setTimeout(()=>i(),0)},{defer:!0}))}function ar(e){const t=Z(),[n,r]=C({main:e.if,animating:!1});return(()=>{const o=Na.cloneNode(!0);return(l=>{ul(l,t,()=>e.if,(i,a,s)=>{r({main:i||a,animating:s})},{mode:e.mode}),F(()=>{l.style.display=n().main||e.fallback!=null?"block":"none"})})(o),o._$owner=Fo(),g(o,d(x,{get if(){return n().main||n().animating},get children(){const l=Sa.cloneNode(!0),i=l.firstChild;return(a=>{F(()=>{e.if===!0?a.removeAttribute("inert"):a.setAttribute("inert","true")})})(l),g(i,()=>e.children),$(()=>l.className=n().animating&&!n().main?"hidden":"flex-col"),l}}),null),g(o,d(x,{get if(){return!n().main||n().animating},get children(){const l=Ea.cloneNode(!0),i=l.firstChild;return(a=>{F(()=>{e.if===!0?a.setAttribute("inert","true"):a.removeAttribute("inert")})})(l),g(i,()=>e.fallback),$(()=>l.className=n().animating&&n().main?"hidden":"flex-col"),l}}),null),o})()}const La=At("(hover: hover)",!0,!1);function fl(e){const[t,n]=C(!1),[r,o]=C(!1),l=T(()=>e.clickable&&(r()||La()&&t()));return R(()=>z(()=>e.children(l,i=>{i.addEventListener("mouseenter",()=>{n(!0)}),i.addEventListener("mouseout",a=>{console.log("MOUSEOUT");let s=a.relatedTarget;for(;s;){if(s===i){n(!0);return}if(s instanceof HTMLElement&&s.classList.contains("@TAKES-HOVER@")){n(!1);return}s=s.parentNode}n(!1)}),i.addEventListener("mouseleave",()=>{n(!1)}),i.addEventListener("animationstart",a=>{a.target===a.currentTarget&&o(!0)}),i.addEventListener("animationcancel",a=>{a.target===a.currentTarget&&o(!1)})},()=>e.clickable?" js-detect-active @TAKES-HOVER@ handles-clicks ":"")))}function he(e){return e.startsWith("/")?e:(localStorage.getItem("--use-mock")??"")+e}const Et=p("<div></div>"),Pa=p('<div class="flex-1"><div></div></div>'),Ta=p('<div class="w-12 h-12 sm:w-16 sm:h-16 mr-4 rounded-md bg-slate-100 dark:bg-zinc-800 block"><img class="w-full h-full object-cover rounded-md" alt=""></div>'),Oa=p('<div><div class="max-lines max-lines-2"></div></div>'),Ra=p('<div class="max-lines max-lines-1 break-all font-light text-slate-800 dark:text-zinc-500 select-none"></div>'),Aa=p('<div class="inline-block"></div>');function hl(e){const t=Z(),n=T(()=>{const i=pt(e.link.url,{});if(!i)return;const[a,s]=C(!1);return{visible:a,toggleVisible:()=>s(c=>!c),body:i}}),r=T(()=>{const i=Rn(e.link.client_id,e.link.url);return i.kind==="link"?{link:i.url,external:i.external}:{link:"error",external:!0}}),[o,l]=C({open:!1,temporary:!1});return d(x,{get if(){return r().link!=="error"},get children(){return d(fl,{clickable:!0,children:(i,a,s)=>(()=>{const c=Et.cloneNode(!0),u=a;return typeof u=="function"?u(c):a=c,g(c,d(X,{get action(){return{url:e.link.url,client_id:e.link.client_id,onClick:n()?()=>{n().toggleVisible()}:void 0}},get class(){return U("p-2 px-4","flex flex-row flex-wrap items-center","bg-slate-300 dark:bg-zinc-900","rounded-xl","hover:bg-slate-200 hover:dark:bg-zinc-700 hover:shadow transition",o().open?"rounded-b-none":"")},get children(){return[d(x,{get when(){return e.link.thumbnail},children:f=>(()=>{const h=Ta.cloneNode(!0),m=h.firstChild;return $(()=>B(m,"src",he(f))),h})()}),(()=>{const f=Pa.cloneNode(!0),h=f.firstChild;return g(h,d(x,{get when(){return n()},children:m=>R(()=>m.visible()?"\u25BE ":"\u25B8 ")}),null),g(h,()=>e.link.title,null),g(f,d(x,{get if(){return!o().open||o().temporary},get when(){return e.link.summary},children:m=>(()=>{const v=Oa.cloneNode(!0),b=v.firstChild;return g(b,m),$(()=>v.style.setProperty("display",o().open?"none":"block")),v})()}),null),g(f,d(x,{get if(){return!o().open||o().temporary},get children(){const m=Et.cloneNode(!0);return g(m,d(po,{get url(){return r().link},get external(){return r().external}})),$(()=>m.style.setProperty("display",o().open?"none":"block")),m}}),null),$(()=>h.className="max-lines max-lines-1 select-none "+(e.link.summary!=null?"font-bold":"")),f})()]}}),null),g(c,d(x,{get when(){return n()},children:f=>[(()=>{const h=Et.cloneNode(!0);return(m=>ul(m,t,f.visible,(v,b,w)=>{l({open:v||b,temporary:w})}))(h),g(h,d(x,{get if(){return o().open||o().temporary},get children(){const m=Et.cloneNode(!0);return g(m,d(ae,{get body(){return f.body},autoplay:!0})),$(()=>m.style.setProperty("display",o().open?"block":"none")),m}})),h})(),d(x,{get if(){return o().open||o().temporary},get children(){const h=Et.cloneNode(!0);return g(h,d(X,{get action(){return{client_id:e.link.client_id,url:e.link.url}},get class(){return U("p-2 px-4","block","bg-slate-300 dark:bg-zinc-900","rounded-xl rounded-t-none","hactive:dark:bg-zinc-700 dark:hactive:shadow transition")},get children(){return d(po,{get url(){return r().link},get external(){return r().external}})}})),$(()=>h.style.setProperty("display",o().open?"block":"none")),h}})]}),null),$(()=>c.className=s()),c})()})}})}function po(e){return(()=>{const t=Ra.cloneNode(!0);return g(t,d(x,{get if(){return e.external},get children(){return[d(Ia,{})," "]}}),null),g(t,()=>e.url,null),t})()}function Ia(){return(()=>{const e=Aa.cloneNode(!0);return g(e,d(Oe,{class:"fa-solid fa-arrow-up-right-from-square",label:"External"})),e})()}function bo({h:e,s:t,l:n,a:r=1}){if(t===0){const[u,f,h]=[n,n,n].map(m=>Math.round(m*255));return{r:u,g:h,b:f,a:r}}const o=(1-Math.abs(2*n-1))*t,l=o*(1-Math.abs(e/60%2-1)),i=n-o/2,[a,s,c]=(e<60?[o,l,0]:e<120?[l,o,0]:e<180?[0,o,l]:e<240?[0,l,o]:e<300?[l,0,o]:[o,0,l]).map(u=>Math.round((u+i)*255));return{r:a,g:s,b:c,a:r}}function mn(e){const{r:t,g:n,b:r,a:o}=e;return o!=null&&o<1?`rgba(${qe(t)}, ${qe(n)}, ${qe(r)}, ${qe(o,2)})`:`rgb(${qe(t)}, ${qe(n)}, ${qe(r)})`}function qe(e,t=0){const n=e.toFixed(t);if(t===0)return n;const r=n.indexOf(".");if(r>=0){const o=n.match(/0+$/);if(o)return o.index===r+1?n.substring(0,r):n.substring(0,o.index)}return n}function Da(e){let t=1779033703^e.length;for(let n=0;n<e.length;n++)t=Math.imul(t^e.charCodeAt(n),3432918353),t=t<<13|t>>>19;return function(){return t=Math.imul(t^t>>>16,2246822507),t=Math.imul(t^t>>>13,3266489909),(t^=t>>>16)>>>0}}function Va(e,t,n,r){return function(){e>>>=0,t>>>=0,n>>>=0,r>>>=0;let o=e+t|0;return e=t^t>>>9,t=n+(n<<3)|0,n=n<<21|n>>>11,r=r+1|0,o=o+r|0,n=n+o|0,(o>>>0)/4294967296}}function gl(e){const t=Da(e);return Va(t(),t(),t(),t())}function ml(e){const t=e()*360,n=e()*.5+.5,r=e(),o={h:t,s:n,l:r*.3+.2,a:1},l={...o,l:1-(r*.4+.1)};return[bo(o),bo(l)]}const za=p("<span></span>");function Ma(e){const t=T(()=>{if(!e.allow_preview)return;const n=pt(e.href,{});if(!n)return;const[r,o]=C(!1);return{visible:r,setVisible:o,body:n}});return[d(be,{get style(){return t()?"previewable":"normal"},get action(){return{url:e.href,client_id:e.client_id,onClick:t()?()=>{const n=t();n.setVisible(!n.visible())}:void 0}},get children(){return[R(()=>e.children),d(x,{get when(){return t()},children:n=>[" ",R(()=>n.visible()?"\u25BE":"\u25B8")]})]}}),d(x,{get when(){return t()},children:n=>d(ar,{get if(){return n.visible()},get children(){return d(ae,{autoplay:!0,get body(){return n.body}})}})})]}function be(e){return d(X,{get action(){return e.action},get class(){return oe[e.style]+" outline-default"},get children(){return e.children}})}function Ar(e){const t=()=>{const[n,r]=ml(gl(e.color_hash.toLowerCase()));return{"--light-color":mn(n),"--dark-color":mn(r)}};return(()=>{const n=za.cloneNode(!0);return g(n,d(be,{style:"userlink",get action(){return{url:e.href,client_id:e.client_id}},get children(){return e.children}})),$(r=>En(n,t(),r)),n})()}const ja=p("<span></span>"),Ba=p('<span class="whitespace-pre-wrap"></span>'),Fa=p("<br>"),Ua=p('<button class="absolute top-0 left-0 bottom-0 right-0 w-full h-full rounded bg-spoiler-color hover:bg-spoiler-color-hover cursor-pointer" title="Click to reveal spoiler"></button>'),Wa=p('<span class="relative bg-spoiler-color-hover rounded"><span></span></span>'),Ha=p('<img class="w-4 h-4 object-contain inline-block">'),qa=p('<code class="bg-slate-200 dark:bg-zinc-700 p-1 rounded"></code>'),Ga=p("<p></p>"),Ka=p('<h1 class="text-3xl font-black"></h1>'),Xa=p('<h2 class="text-2xl font-bold"></h2>'),Ya=p('<h3 class="text-xl font-semibold"></h3>'),Ja=p('<h4 class="text-lg font-medium"></h4>'),Qa=p('<h5 class="text-base text-slate-500 dark:text-zinc-400 font-normal"></h5>'),Za=p('<h6 class="text-sm text-slate-500 dark:text-zinc-400 font-normal underline"></h6>'),es=p('<div class="py-2"><hr class="w-full border-t-2 border-slate-500 dark:border-zinc-400 rounded"></div>'),ts=p('<blockquote class="border-l-2 border-slate-500 dark:border-zinc-400 pl-3"></blockquote>'),ns=p('<li class="flex flex-row gap-2 items-baseline"><div></div><div class="flex-1"></div></li>'),vn=p("<div></div>"),rs=p('<ol class="list-none"></ol>'),os=p('<ul class="list-none"></ul>'),ls=p("<table><thead><tr></tr></thead><tbody></tbody></table>"),is=p("<th></th>"),as=p("<tr></tr>"),ss=p("<td></td>"),cs=p('<select class="block"><option value="null">None</option></select>'),ds=p('<pre tabindex="0"></pre>'),us=p("<button> </button>"),fs=p("<option></option>"),hs=p('<code class="!whitespace-pre-wrap"></code>'),gs={link:"normal","pill-empty":"pill-empty"};function ms(e){const t=()=>(e.rts.style??"link")==="link",n=Z();return(()=>{const r=ja.cloneNode(!0);return g(r,d(ri,{get children(){return[d(Bn,{get when(){return e.rts.is_user_link!=null&&e.rts.is_user_link},children:o=>d(Ar,{get client_id(){return e.rts.client_id},color_hash:o,get href(){return e.rts.url},get children(){return d(ke,{get spans(){return e.rts.children}})}})}),d(Bn,{get when(){return R(()=>e.rts.is_user_link==null,!0)()&&t()},get children(){return d(Ma,{get client_id(){return e.rts.client_id},get href(){return e.rts.url},get allow_preview(){return n.linkHelpers()==="hide"},get children(){return d(ke,{get spans(){return e.rts.children}})}})}}),d(Bn,{get when(){return R(()=>e.rts.is_user_link==null,!0)()&&!t()},get children(){return d(be,{get action(){return{client_id:e.rts.client_id,url:e.rts.url}},get style(){return gs[e.rts.style??"link"]},get children(){return d(ke,{get spans(){return e.rts.children}})}})}})]}})),$(()=>B(r,"title",e.rts.title)),r})()}function vs(e){return d(ne,{get item(){return e.span},children:{text:t=>(()=>{const n=Ba.cloneNode(!0);return g(n,()=>t.text),$(r=>{const o=t.styles.strong,l=t.styles.emphasis,i=t.styles.strikethrough,a=t.styles.superscript,s=t.styles.superscript;return o!==r._v$&&n.classList.toggle("font-bold",r._v$=o),l!==r._v$2&&n.classList.toggle("italic",r._v$2=l),i!==r._v$3&&n.classList.toggle("line-through",r._v$3=i),a!==r._v$4&&n.classList.toggle("align-top",r._v$4=a),s!==r._v$5&&n.classList.toggle("text-xs",r._v$5=s),r},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),n})(),link:t=>d(ms,{rts:t}),br:()=>Fa.cloneNode(!0),spoiler:t=>{const[n,r]=C(!1);return(()=>{const o=Wa.cloneNode(!0),l=o.firstChild;return g(o,d(x,{get if(){return!n()},get children(){const i=Ua.cloneNode(!0);return i.$$click=()=>r(!0),i}}),l),g(l,d(ke,{get spans(){return t.children}})),$(()=>l.className=U("rounded","transition-opacity","bg-spoiler-color-revealed",n()?"":"opacity-0 invisible")),o})()},emoji:t=>{let n;const[r,o]=C(0);let l=null;const i=()=>{if(n==null)return()=>{};if(t.hover==null)return()=>{};const a=n.getBoundingClientRect(),s=el("div").styl({position:"fixed",top:a.top+a.height+"px",left:a.left+a.width/2-t.hover.w/2+"px",width:t.hover.w+"px","z-index":"100000000"}).adch(el("img").attr({src:he(t.hover.url),width:`${t.hover.w}`,height:`${t.hover.h}`})).adch(el("div").adch(el("div").atxt(t.name).clss("font-bold")).adch(el("div").atxt(t.hover.description)).clss("mt-2 bg-slate-100 dark:bg-zinc-800 border border-b-0 border-r-0 border-slate-500 shadow-md dark:border-zinc-500 rounded-md p-2"));return document.body.appendChild(s),s.animate([{transform:"scale(0.5)",transformOrigin:"top center",opacity:"0.0"},{transform:"scale(1.0)",transformOrigin:"top center",opacity:"1.0"}],{duration:100,iterations:1,easing:"ease-out"}),()=>{s.animate([{transform:"scale(1.0)",transformOrigin:"top center",opacity:"1.0"},{transform:"scale(0.5)",transformOrigin:"top center",opacity:"0.0"}],{duration:100,iterations:1,easing:"ease-in"}).finished.then(()=>{s.remove()}).catch(()=>{s.remove()})}};return F(()=>{r()===2?l==null&&(l=i()):(l?.(),l=null)}),(()=>{const a=Ha.cloneNode(!0);a.addEventListener("mouseleave",()=>o(0)),a.addEventListener("mouseenter",()=>{o(1),setTimeout(()=>r()===1&&o(2),500)});const s=n;return typeof s=="function"?s(a):n=a,$(c=>{const u=he(t.url),f=t.name;return u!==c._v$6&&B(a,"src",c._v$6=u),f!==c._v$7&&B(a,"title",c._v$7=f),c},{_v$6:void 0,_v$7:void 0}),a})()},flair:t=>d(We,{get flairs(){return[t.flair]}}),time_ago:t=>d(nl,{get start(){return t.start}}),error:t=>d($e,{getValue:n=>H("error").atxt(t.text).onev("click",r=>{console.log(t.value)})}),code:t=>(()=>{const n=qa.cloneNode(!0);return g(n,()=>t.text),n})()}})}function ke(e){return d(W,{get each(){return e.spans},children:t=>d(vs,{span:t})})}function _s(e){return d(ne,{get item(){return e.paragraph},children:{paragraph:t=>(()=>{const n=Ga.cloneNode(!0);return g(n,d(ke,{get spans(){return t.children}})),n})(),body:t=>d(ae,{get body(){return t.body},autoplay:!1}),heading:t=>{const n=()=>d(ke,{get spans(){return t.children}});return t.level===1?(()=>{const r=Ka.cloneNode(!0);return g(r,n),r})():t.level===2?(()=>{const r=Xa.cloneNode(!0);return g(r,n),r})():t.level===3?(()=>{const r=Ya.cloneNode(!0);return g(r,n),r})():t.level===4?(()=>{const r=Ja.cloneNode(!0);return g(r,n),r})():t.level===5?(()=>{const r=Qa.cloneNode(!0);return g(r,n),r})():(()=>{const r=Za.cloneNode(!0);return g(r,n),r})()},horizontal_line:()=>es.cloneNode(!0),blockquote:t=>(()=>{const n=ts.cloneNode(!0);return g(n,d(_n,{get content(){return t.children}})),n})(),list:t=>{const n=T(()=>t.children.every(o=>o.kind==="tight_list_item"||o.children.length===1)),r=()=>d(W,{get each(){return t.children},children:(o,l)=>(()=>{const i=ns.cloneNode(!0),a=i.firstChild,s=a.nextSibling;return g(a,(()=>{const c=R(()=>!!t.ordered,!0);return()=>c()?`${l()+1}. `:"- "})()),g(s,d(ne,{item:o,children:{list_item:c=>d(_n,{get content(){return c.children},get tight(){return n()}}),tight_list_item:c=>(()=>{const u=vn.cloneNode(!0);return g(u,d(ke,{get spans(){return c.children}})),$(()=>u.classList.toggle("my-2",!n())),u})()}})),i})()});return t.ordered?(()=>{const o=rs.cloneNode(!0);return g(o,r),o})():(()=>{const o=os.cloneNode(!0);return g(o,r),o})()},code_block:t=>d(ys,{get text(){return t.text},get default_language(){return t.lang??null}}),table:t=>(()=>{const n=ls.cloneNode(!0),r=n.firstChild,o=r.firstChild,l=r.nextSibling;return g(o,d(W,{get each(){return t.headings},children:i=>(()=>{const a=is.cloneNode(!0);return g(a,d(ke,{get spans(){return i.children}})),$(()=>a.className=yo[i.align??"none"]),a})()})),g(l,d(W,{get each(){return t.children},children:i=>(()=>{const a=as.cloneNode(!0);return g(a,d(W,{each:i,children:(s,c)=>(()=>{const u=ss.cloneNode(!0);return g(u,d(ke,{get spans(){return s.children}})),$(()=>u.className=yo[t.headings[c()]?.align??"none"]),u})()})),a})()})),n})()}})}const yo={left:"text-left",center:"text-center",right:"text-right",none:""},[Rt,ps]=C(void 0);let qn=!1;function bs(){(!Rt()||qn)&&(qn=!0,Promise.all([ee(()=>import("./prismjs.16945276.js").then(function(e){return e.p}),["assets/prismjs.16945276.js","assets/_commonjsHelpers.2cf1d77b.js"]),z(()=>Z().colorScheme())==="dark"?ee(()=>Promise.resolve({}),["assets/prism-atom-dark.f4615035.css"]):ee(()=>Promise.resolve({}),["assets/prism-duotone-light.c9c5c0db.css"])]).then(([e])=>ps(e)).catch(e=>{alert("error loading syntax highlighter"),qn=!1,console.log(e)}))}function ys(e){const[t,n]=C(e.default_language);F(()=>n(e.default_language));const[r,o]=C(null),l=()=>e.text.length<1e4,[i,a]=C(!1);return F(()=>{(t()!=null||i())&&bs()}),F(()=>{if(!l())return;let s=!0;G(()=>s=!1),o(null),Rt()&&t()!=null&&Rt().highlight(e.text,t()??"plaintext").then(c=>{s&&(o(c),c==null&&console.log("syn hl language not supported",t()))}).catch(c=>{console.log(c),alert("error highlighting")})}),(()=>{const s=ds.cloneNode(!0);return g(s,d(x,{get if(){return l()},get children(){const c=vn.cloneNode(!0);return g(c,d(x,{get if(){return R(()=>!!Rt(),!0)()&&i()},get fallback(){return(()=>{const u=us.cloneNode(!0),f=u.firstChild;return u.$$click=()=>{a(h=>!h)},g(u,()=>t()??"None",f),g(u,()=>i()?"\u25B4":"\u25BE",null),$(()=>u.className=U(["font-sans"])),u})()},get children(){const u=cs.cloneNode(!0);return u.firstChild,u.$$input=f=>{const h=f.currentTarget.value;n(h==="null"?null:h)},g(u,d(W,{get each(){return Rt().listLanguages().sort((f,h)=>f.localeCompare(h))},children:f=>(()=>{const h=fs.cloneNode(!0);return h.value=f,g(h,f),h})()}),null),u}})),$(()=>c.className=U(["absolute","top-0 right-0","transition-opacity","opacity-0","group-hover:opacity-100","group-focus:opacity-100","focus:opacity-100","bg-slate-400 dark:bg-zinc-600 text-slate-100 dark:text-zinc-100 rounded-md","p-2 px-3"])),c}}),null),g(s,d(x,{get when(){return r()},get fallback(){return(()=>{const c=hs.cloneNode(!0);return g(c,()=>e.text),c})()},children:c=>(()=>{const u=vn.cloneNode(!0);return u.innerHTML=c,u})()}),null),$(()=>s.className=U(["!bg-slate-200 !dark:bg-zinc-700 p-2 !rounded-md text-slate-900 dark:text-zinc-100","relative","group","outline-default","language-"+(t()??"none"),"!whitespace-pre-wrap"])),s})()}function _n(e){const t=Z();return(()=>{const n=vn.cloneNode(!0);return g(n,d(W,{get each(){return e.content},children:r=>[d(_s,{paragraph:r}),d(x,{get if(){return t.linkHelpers()==="show"},get children(){return d(W,{get each(){return xs(r)},children:o=>d(hl,{link:o})})}})]})),$(()=>n.className=e.tight??!1?"":"space-y-2"),n})()}function ws(e){return d(_n,{get content(){return e.content}})}function xs(e){return vt(e,{paragraph:t=>it(t.children),body:()=>[],heading:t=>it(t.children),horizontal_line:()=>[],blockquote:()=>[],list:t=>t.children.flatMap(n=>n.kind==="tight_list_item"?it(n.children):[]),code_block:()=>[],table:t=>[...t.headings.flatMap(n=>it(n.children)),...t.children.flatMap(n=>n.flatMap(r=>it(r.children)))]})}function it(e){return e.flatMap(t=>vt(t,{link:n=>[{title:Vt(n.children),url:n.url,client_id:n.client_id}],error:()=>[],text:()=>[],br:()=>[],spoiler:n=>it(n.children),emoji:()=>[],flair:()=>[],time_ago:()=>[],code:()=>[]}))}function sr(e){return e.map(t=>vt(t,{paragraph:n=>Vt(n.children),body:n=>wn(n.body),heading:n=>Vt(n.children),horizontal_line:n=>"---",blockquote:n=>sr(n.children),list:n=>n.children.map((r,o)=>{const l=n.ordered?""+o+". ":"\u2022 ";if(r.kind==="tight_list_item")return l+Vt(r.children);if(r.kind==="list_item")return l+sr(r.children);de(r)}).join(`
`),code_block:n=>n.text,table:()=>"[table]"})).join(`
`)}function Vt(e){return e.map(t=>vt(t,{link:n=>Vt(n.children),error:n=>"[error]",text:n=>n.text,br:()=>`
`,spoiler:n=>"[spoiler]",emoji:n=>":"+n.name+":",flair:()=>"[flair]",time_ago:()=>"[time ago]",code:n=>n.text})).join("")}ce(["click","input"]);const wo=p("<span></span>");function xo([e,t,n]){const r=[e,t,n].map(o=>{const l=o/255;return l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4)});return r[0]*.2126+r[1]*.7152+r[2]*.0722}function $s(e,t){const n=xo(e),r=xo(t),o=Math.max(n,r),l=Math.min(n,r);return(o+.05)/(l+.05)}function Gn(e){const t=e.replace("#","");if(t.length!==6)return null;const n=parseInt(t,16);if(isNaN(n))return null;const r=n>>16&255,o=n>>8&255,l=n&255;return[r,o,l]}function $o(e){return`#${e.map(t=>t.toString(16).padStart(2,"0")).join("")}`}function ko(e,t,n){const r=Gn(e??"")??Gn(t);let o=[-1/0,[0,0,0]];for(const l of n){const i=Gn(l),a=$s(r,i);a>o[0]&&(o=[a,i])}return{bg:$o(r),text:$o(o[1])}}function ks(e){const t=["#FFFFFF","#000000"],n=ko(e,"#94A3B8",t),r=ko(e,"#52525B",t);return{"--flair-bg-dark":r.bg,"--flair-text-dark":r.text,"--flair-bg-light":n.bg,"--flair-text-light":n.text}}function We(e){return(()=>{const t=wo.cloneNode(!0);return g(t,d(W,{get each(){return e.flairs},children:(n,r)=>{const o=T(()=>ks(n.color));return[R(()=>(e.pre_space??!1)||r()!==0?" ":""),(()=>{const l=wo.cloneNode(!0);return g(l,d(ke,{get spans(){return n.elems}})),$(i=>{const a=n.system!=null?{none:"",op:"text-blue-500",cake:"text-gray-500",admin:"text-red-500",moderator:"text-green-500",approved:"text-green-500",error:"text-red-500"}[n.system]:"rounded-full px-2 bg-$flair-bg-light dark:bg-$flair-bg-dark text-$flair-text-light dark:text-$flair-text-dark",s=o();return a!==i._v$&&(l.className=i._v$=a),i._v$2=En(l,s,i._v$2),i},{_v$:void 0,_v$2:void 0}),l})()]}})),t})()}const me=Ln();function vl(e){const t=Re();return T(()=>{const n=Te(t.content(),e.replies.key);return n==null?me(il(e.replies)):n.error!=null?d(me,{kind:"error",get msg(){return n.error}}):d(W,{get each(){return n.value??[]},children:r=>T(()=>{if(typeof r=="object")return d(vl,{replies:r});const o=Te(t.content(),r);if(o==null)return d(me,{kind:"error",get msg(){return"e-link-bad: "+r.toString()}});if(o.error!=null)return d(me,{kind:"error",get msg(){return o.error}});{const l=o.value;return d(me,{kind:"flat_post",post:l,link:r})}})})})}function _l(e){return d(x,{get when(){return e.replies},children:t=>d(vl,{get replies(){return t.loader}})})}function Zt(e){const t=Re();return T(()=>{const n=e.post;if(n==null)return[];const r=Te(t.content(),n);return r==null?d(me,{kind:"error",get msg(){return"[flat]link not found: "+n.toString()}}):r.error!=null?d(me,{kind:"error",get msg(){return r.error}}):[R(()=>T(()=>{const o=r.value.parent;if(!o)return[];const{loader:l}=o,i=Te(t.content(),l.key);return i?i.error!=null?[d(Zt,{get post(){return l.temp_parent}}),d(me,{kind:"error",get msg(){return i.error}})]:d(Zt,{get post(){return i.value==null?null:l.key}}):[d(Zt,{get post(){return l.temp_parent}}),R(()=>me(il(l)))]})),d(me,{kind:"flat_post",link:n,get post(){return r.value}})]})}const ge=Ln();function cr(e){return me.useChildren(()=>d(_l,{get replies(){return e()}}))}function Cs(e){return me.useChildren(()=>d(Zt,{get post(){return e()}}))}function Ss(e){return d(ge,{kind:"todo",get note(){return e.msg},get data(){return e.obj}})}function pl(e,t,n,r){const o=da(t,r),l=o.user_controllable?ze(e,o.collapse_link,{default:o.default_collapsed}).collapsed():o.default_collapsed,i=o.user_controllable?{id:o.collapse_link,threaded:!1,collapsed:l}:null;return{indent:r.threaded?n.map((a,s,c)=>s===c.length-1?{...a,threaded:!0}:a):n,collapse:i}}function en(e){return d(ge,{kind:"post",get content(){return e.tree_item},get indent(){return e.tii.indent},get collapse(){return e.tii.collapse},get first_in_wrapper(){return e.opts.first_in_wrapper},get last_in_wrapper(){return e.last},get is_pivot(){return e.opts.is_pivot},get at_or_above_pivot(){return e.opts.at_or_above_pivot},get threaded(){return e.opts.threaded},get depth(){return e.opts.depth},get displayed_in(){return e.opts.displayed_in}})}function Es(e){const t=fe(wt);return d(en,{get tree_item(){return e.tree_item},get opts(){return e.opts},get tii(){return pl(t,e.tree_item,e.parent_indent,e.opts)},get last(){return e.last}})}function Ir(e){const t=fe(Ml)??(()=>!0),n=fe(wt),r=T(()=>pl(n,e.tree_item,e.parent_indent,e.rpo));return T(()=>{if(e.tree_item.kind!=="flat_post")return d(en,{get tree_item(){return e.tree_item},get opts(){return e.rpo},get tii(){return r()},get last(){return e.last}});const o=lr(e.tree_item.post);if(!(e.rpo.displayed_in==="tree"))return d(en,{get tree_item(){return e.tree_item},get opts(){return e.rpo},get tii(){return r()},get last(){return e.last}});const i=cr(()=>o.replies),a=T(()=>i()),s=T(()=>{if(!t())return!1;const u=a();if(u.length!==1)return!1;if(e.rpo.threaded)return!0;const h=u[0];return!(h.kind!=="flat_post"||cr(()=>h.post.replies)().length!==1)}),c=()=>!!(s()&&e.rpo.threaded||!(r().collapse?.collapsed??!1));return[d(en,{get tree_item(){return e.tree_item},get opts(){return e.rpo},get tii(){return r()},get last(){return c()&&a().length>0?!1:e.last}}),d(x,{get if(){return c()},get children(){return d(W,{get each(){return a()},children:(u,f)=>d(Ir,{tree_item:u,get parent_indent(){return(()=>{const h=r(),m=h.indent.map(v=>v.threaded?{...v,threaded:!1}:v);return e.rpo.threaded&&s()?m:[...m,...h.collapse?[h.collapse]:[]]})()},get rpo(){return{is_pivot:!1,at_or_above_pivot:!1,first_in_wrapper:!1,threaded:s(),get depth(){return e.rpo.depth+1},displayed_in:o.replies.display}},last:!1})})}}),d(x,{get if(){return R(()=>!!(e.last&&c()),!0)()&&a().length>0},get children(){return d(ge,{kind:"wrapper_end"})}})]})}function Co(e){const t=cr(()=>e.replies);return[d(x,{get if(){return e.replies?.reply!=null},get children(){return d(Ss,{msg:"(add reply)",get obj(){return e.replies}})}}),d(W,{get each(){return t()},children:n=>[d(ge,{kind:"wrapper_start"}),d(Ir,{tree_item:n,parent_indent:[],get rpo(){return{first_in_wrapper:!0,is_pivot:!1,at_or_above_pivot:!1,threaded:!1,depth:0,displayed_in:e.replies.display}},last:!0})]})]}function Ns(e){const t=Re(),n=T(()=>{const i=Te(t.content(),e());if(i==null||i.error!=null)throw new Error("ebadpivot");return i.value}),r=Cs(()=>e()),o=ge.useChildren(()=>{const i=n();return[d(W,{get each(){return r()},children:a=>[d(ge,{kind:"wrapper_start"}),d(Es,{tree_item:a,parent_indent:[],get opts(){return{first_in_wrapper:!0,at_or_above_pivot:!0,is_pivot:a.kind==="flat_post"&&a.link===e(),threaded:!1,depth:0,displayed_in:"repivot_list"}},last:!0})]}),R((()=>{const a=R(()=>i.content.kind==="post",!0);return()=>a()?d(ge,{kind:"repivot_list_fullscreen_button",get client_id(){return i.client_id},page:()=>({pivot:e(),content:t.content()}),get href(){return fn(i.url??"@ENO",{"--tc-view":"reader"})},name:"Reader"}):null})()),R((()=>{const a=R(()=>!!i.replies,!0);return()=>a()?[R(()=>ge({kind:"horizontal_line"})),R((()=>{const s=R(()=>i.replies.sort_options!=null,!0);return()=>s()?d(ge,{kind:"sort_buttons",get sort_buttons(){return i.replies.sort_options},get client_id(){return i.client_id}}):null})()),R((()=>{const s=R(()=>i.replies.display==="repivot_list",!0);return()=>s()?d(ge,{kind:"repivot_list_fullscreen_button",get client_id(){return i.client_id},page:()=>({pivot:e(),content:t.content()}),get href(){return fn(i.url??"@ENO",{"--tc-view":"fullscreen"})},name:"Fullscreen"}):null})()),R((()=>{const s=R(()=>i.replies.reply!=null,!0);return()=>s()?d(ge,{kind:"todo",note:"TODO reply button",get data(){return i.replies}}):null})()),d(Co,{get replies(){return i.replies}})]:null})())]}),l=ge.useChildren(()=>{for(const i of[...r()].reverse()){if(i.kind!=="flat_post")continue;const a=lr(i.post);if(a.kind==="post"&&a.content.kind==="page"){const s=a.content;return d(Co,{get replies(){return s.wrap_page.sidebar}})}}return[]});return{header:void 0,get title(){for(const i of[...r()].reverse()){if(i.kind!=="flat_post")continue;const a=lr(i.post);if(a.kind==="post"&&a.content.kind==="post"&&a.content.title!=null)return a.content.title.text}return"*ERROR_NO_TITLE*"},get url(){return n().url},get body(){return o()},get sidebar(){return l()}}}const Ls=p('<video class="object-contain w-full h-full"><span></span></video>'),Ps=p('<div class="handles-clicks relative"><div class="w-full h-full relative overflow-hidden"><button><span class="items-center justify-center flex"><div></div></span></button><div><div class="h-1 w-full relative bg-rgray-100 bg-opacity-50"><div class="absolute h-full bg-rgray-700"></div></div></div><div><div><div class="absolute h-full bg-rgray-700"></div></div><div class="flex flex-wrap items-center transform transition-transform origin-bottom"><button class="block"></button><div></div><div class="flex-grow"></div><button class="block"></button><button class="block"></button><button class="block"></button></div></div></div><div class="flex"></div><div class="flex">Quality: </div><div class="absolute pointer-events-none transition-opacity"><div></div></div></div>'),Ts=p("<div><p>Error! </p></div>"),So=p('<div class="absolute h-full bg-rgray-500 bg-opacity-75"></div>'),Os=p('<div class="absolute h-full bg-rgray-900 bg-opacity-50"></div>'),Rs=p("<button>\xD7</button>"),As=p("<button></button>"),Is=p("<video></video>"),Ds=p("<source>"),Vs=p("<div></div>"),zs=p("<div>Caption: </div>");function Nt(e){const t=e/60/60|0,n=(e/60|0)%60,r=(e|0)%60;return(t?t.toString().padStart(2,"0")+":":"")+n.toString().padStart(t?2:1,"0")+":"+r.toString().padStart(2,"0")}let Eo=!1;async function Ms(e){if(window.muxjs||(window.muxjs=(await ee(()=>import("./index.8f0c9c01.js").then(function(t){return t.i}),["assets/index.8f0c9c01.js","assets/_commonjsHelpers.2cf1d77b.js"])).default),!Eo){if(e.polyfill.installAll(),!e.Player.isBrowserSupported())throw new Error("Shaka player is not supported");Eo=!0}}function Dr(e){let t,n;const r=async()=>{if(n)return n;const{default:l}=await ee(()=>import("./shaka-player.compiled.0fb9461d.js").then(function(i){return i.s}),["assets/shaka-player.compiled.0fb9461d.js","assets/_commonjsHelpers.2cf1d77b.js"]);return await Ms(l),n=new l.Player,console.log(n.getConfiguration()),n.addEventListener("error",i=>{console.log("Error!",i),e.setState("error_overlay","An error occured. Check console.")}),n};Sn(()=>{e.videoRef({play:()=>void t.play(),pause:()=>t.pause(),setPlaybackRate:i=>{t.playbackRate=i,o()},seek:i=>{n&&n.isLive()?t.currentTime=i+n.seekRange().start:t.currentTime=i,o()},reload:()=>{l(t.currentTime)},goToLive(){n&&n.isLive()&&n.goToLive()},video_el:t}),F(xr([()=>e.source],()=>{l(0)},{defer:!0}));const l=i=>{(async()=>{console.log("Reloading Video",i);let a=new Error("No sources");for(const s of e.sources)try{if(n&&await n.detach(),t.src="",t.onerror=()=>{},t.onload=()=>{},t.onloadedmetadata=()=>{},s.url.endsWith(".m3u8")||s.url.endsWith(".mpd")){const c=await r();e.setState("playing","loading"),await c.attach(t),console.log("trying to load",s.url),await c.load(s.url,i),c.isLive()&&c.goToLive()}else await new Promise((c,u)=>{t.onerror=f=>{console.log(f),a=new Error("error "+f),e.setState("errored_sources",h=>({...h,[s.i]:!0})),u(a)},t.onload=()=>{c()},t.onloadedmetadata=()=>{t.currentTime=i},t.src=s.url,t.load()});return}catch(c){a=c,e.setState("errored_sources",u=>({...u,[s.i]:!0}))}throw a})().then(()=>{console.log("Player loaded")}).catch(a=>{console.log(a),e.setState("error_overlay",a.stack??a.toString())})};l(0),G(()=>{n&&n.destroy().then(()=>{console.log("player destroyed")}).catch(i=>{console.log("error destroying player",i)})})});const o=()=>{const l=[];for(let i=0;i<t.buffered.length;i++)l.push({start:t.buffered.start(i),end:t.buffered.end(i)});e.setState(Bi(i=>{if(console.log(n?.seekRange()),n&&n.isLive()){const a=n.seekRange();i.current_time=t.currentTime-a.start,i.max_time=a.end-a.start,i.live={start:n.getPresentationStartTimeAsDate().getTime(),current:n.getPlayheadTimeAsDate().getTime()},i.buffered=l.map(s=>({start:s.start-a.start,end:s.end-a.start}))}else i.current_time=t.currentTime,i.max_time=t.duration,i.live=null,i.buffered=l;i.playing=t.paused||t.ended?!1:t.readyState<t.HAVE_FUTURE_DATA?"loading":!0,i.quality=t.videoWidth===0?null:{w:t.videoWidth,h:t.videoHeight},t.playbackRate!==0&&(i.playback_rate=t.playbackRate)})),t.error?e.setState("error_overlay",t.error.message):t.networkState===t.NETWORK_NO_SOURCE?e.setState("error_overlay","Video could not be loaded."):e.setState("error_overlay",null)};return(()=>{const l=Ls.cloneNode(!0),i=l.firstChild;l.addEventListener("emptied",()=>{o()}),l.addEventListener("loadeddata",()=>{o()}),l.addEventListener("durationchange",()=>{o()}),l.addEventListener("loadedmetadata",()=>{o()}),l.addEventListener("stalled",()=>{o()}),l.addEventListener("waiting",()=>{o()}),l.addEventListener("pause",()=>{o()}),l.addEventListener("timeupdate",()=>{o()}),l.addEventListener("canplaythrough",()=>{o()}),l.addEventListener("progress",()=>{o()}),l.addEventListener("volumechange",()=>{o()}),l.addEventListener("ratechange",()=>{o()}),l.addEventListener("playing",()=>{o()}),l.addEventListener("play",()=>{o()});const a=t;return typeof a=="function"?a(l):t=l,l.addEventListener("error",s=>{o()},!0),g(i,()=>e.video.alt??"Your device does not support video, and alt text was not supplied."),$(s=>{const c=e.show_controls,u=e.autoplay,f=e.video.gifv,h=e.source.thumbnail;return c!==s._v$&&(l.controls=s._v$=c),u!==s._v$2&&(l.autoplay=s._v$2=u),f!==s._v$3&&(l.loop=s._v$3=f),h!==s._v$4&&B(l,"poster",s._v$4=h),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),l})()}function js(e){const t=e-Date.now();if(t<=0)return()=>!0;if(t>=Number.MAX_SAFE_INTEGER)return()=>!1;const[n,r]=C(!1),o=setTimeout(()=>{r(!0)},t);return G(()=>clearTimeout(o)),n}function Vr(e,t){const n=e(),r=t.map((o,l)=>({...o,i:l}));return[...r.filter(o=>o.i>=n),...r.filter(o=>o.i<n).reverse()]}function Bs(e){const[t,n]=C(0);let r;const[o,l]=Nn({max_time:0,current_time:0,quality:null,buffered:[],playing:"loading",error_overlay:null,errored_sources:{},playback_rate:1,live:null}),[i,a]=C(null),[s,c]=C(0),u=Z(),f=()=>u.customVideoControls()==="custom"||!!o.live,h=T(()=>!(!f()||js(s()+1e3)())),m=T(()=>Vr(t,e.source.sources)),v=()=>{const E=new Map;for(const[y,S]of e.source.sources.entries())o.errored_sources[y]!==!0&&E.set(S.quality??"Unknown",{index:y});return[...E.entries()].map(([y,S])=>({name:y,...S}))},b=Vn();F(()=>{b()||r.pause()});const w=()=>f()&&(o.playing!==!0||h());let k;const[N,I]=C(!1);return(()=>{const E=Ps.cloneNode(!0),y=E.firstChild,S=y.firstChild,P=S.firstChild,M=P.firstChild,j=S.nextSibling,Q=j.firstChild,Ae=Q.firstChild,ue=j.nextSibling,le=ue.firstChild,Ft=le.firstChild,zn=le.nextSibling,Ze=zn.firstChild,et=Ze.nextSibling,Mn=et.nextSibling,xt=Mn.nextSibling,tt=xt.nextSibling,Ut=tt.nextSibling,$t=y.nextSibling,nt=$t.nextSibling;nt.firstChild;const rt=nt.nextSibling,Wt=rt.firstChild,Ht=k;return typeof Ht=="function"?Ht(E):k=E,y.addEventListener("blur",()=>{c(0)}),y.addEventListener("focus",()=>{c(Date.now())}),y.addEventListener("mouseleave",()=>{c(0)}),y.$$mousemove=()=>{c(Date.now())},y.addEventListener("mouseenter",()=>{c(Date.now())}),g(y,d(Dr,{state:o,setState:l,videoRef:L=>r=L,get video(){return e.video},get source(){return e.source},get sources(){return m()},get autoplay(){return e.autoplay},get show_controls(){return!f()}}),S),g(y,d(x,{get when(){return o.error_overlay},children:L=>(()=>{const A=Ts.cloneNode(!0),D=A.firstChild;return D.firstChild,g(D,L,null),$(V=>{const Y=U("absolute top-0 left-0 bottom-0 right-0 p-4 bg-rgray-900 bg-opacity-75"),re=f()?"block":"none";return Y!==V._v$16&&(A.className=V._v$16=Y),re!==V._v$17&&A.style.setProperty("display",V._v$17=re),V},{_v$16:void 0,_v$17:void 0}),A})()}),S),S.$$click=()=>{o.playing===!1?(r.play(),c(0)):r.pause()},g(M,d(Tt,{size:"icon-sm",get icon(){return o.playing===!1?{class:"icon-play-button",label:"Play"}:o.playing===!0?{class:"icon-play-pause",label:"Pause"}:{class:"icon-spinner-alt",label:"Loading"}}})),g(Q,d(Jr,{get each(){return o.buffered},children:(L,A)=>(()=>{const D=So.cloneNode(!0);return $(V=>{const Y=(L().end-L().start)/o.max_time*100+"%",re=L().start/o.max_time*100+"%";return Y!==V._v$18&&D.style.setProperty("width",V._v$18=Y),re!==V._v$19&&D.style.setProperty("left",V._v$19=re),V},{_v$18:void 0,_v$19:void 0}),D})()}),Ae),le.$$mouseup=L=>{const A=L.currentTarget.getBoundingClientRect(),D=(L.clientX-A.left)/A.width;r.seek(D*o.max_time)},le.addEventListener("mouseleave",()=>{a(null)}),le.$$mousemove=L=>{const A=L.currentTarget.getBoundingClientRect(),D=k.getBoundingClientRect();a({seeking:!1,percent:(L.clientX-A.left)/A.width,preview:[L.clientX-D.left,D.bottom-A.top]})},g(le,d(Jr,{get each(){return o.buffered},children:(L,A)=>(()=>{const D=So.cloneNode(!0);return $(V=>{const Y=(L().end-L().start)/o.max_time*100+"%",re=L().start/o.max_time*100+"%";return Y!==V._v$20&&D.style.setProperty("width",V._v$20=Y),re!==V._v$21&&D.style.setProperty("left",V._v$21=re),V},{_v$20:void 0,_v$21:void 0}),D})()}),Ft),g(le,d(x,{get when(){return i()},children:L=>(()=>{const A=Os.cloneNode(!0);return $(()=>A.style.setProperty("width",L.percent*100+"%")),A})()}),null),Ze.$$click=()=>{o.playing===!1?r.play():r.pause()},g(Ze,d(Tt,{size:"icon-sm",get icon(){return o.playing===!1?{class:"icon-play-button",label:"Play"}:o.playing===!0?{class:"icon-play-pause",label:"Pause"}:{class:"icon-loadbar",label:"Loading"}}})),et.$$click=()=>{o.live&&r.goToLive()},g(et,(()=>{const L=R(()=>!!o.live,!0);return()=>L()?(()=>{const A=R(()=>o.current_time+2>o.max_time,!0);return()=>A()?Nt((Date.now()-o.live.current)/1e3)+" delay":Nt((o.live.current-o.live.start)/1e3)+" / Live"})():Nt(o.current_time)+" / "+Nt(o.max_time)})()),xt.$$click=()=>{alert("TODO")},g(xt,d(Tt,{size:"icon-sm",icon:{class:"icon-inpicture",label:"Picture in Picture"}})),tt.$$click=()=>{alert("TODO")},g(tt,d(Tt,{size:"icon-sm",icon:{class:"icon-software-download",label:"Download Video"}})),Ut.$$click=()=>{if(document.fullscreenElement){document.exitFullscreen().then(L=>{I(!1)}).catch(L=>{I(!1)});return}k.requestFullscreen().then(L=>{I(!0)}).catch(L=>{I(!1)})},g(Ut,d(Tt,{size:"icon-sm",get icon(){return N()?{class:"icon-shape-square",label:"Exit Fullscreen"}:{class:"icon-square",label:"Enter Fullscreen"}}})),g($t,d(W,{each:[.25,.5,.75,1,1.25,1.5,1.75,2],children:L=>(()=>{const A=Rs.cloneNode(!0),D=A.firstChild;return A.$$click=()=>r.setPlaybackRate(L),g(A,L,D),$(V=>{const Y=oe["outlined-button"],re=o.playback_rate===L;return Y!==V._v$22&&(A.className=V._v$22=Y),re!==V._v$23&&(A.disabled=V._v$23=re),V},{_v$22:void 0,_v$23:void 0}),A})()})),g(nt,()=>o.quality==null?"Loading":o.quality.w+"\xD7"+o.quality.h,null),g(nt,d(W,{get each(){return v()},children:(L,A)=>(()=>{const D=As.cloneNode(!0);return D.$$click=()=>{n(L.index),r.reload()},g(D,()=>L.name),$(V=>{const Y=oe["outlined-button"],re=t()===A();return Y!==V._v$24&&(D.className=V._v$24=Y),re!==V._v$25&&(D.disabled=V._v$25=re),V},{_v$24:void 0,_v$25:void 0}),D})()}),null),(L=>{F(()=>{const A=i();A&&(L.style.bottom=A.preview[1]+"px",L.style.left=A.preview[0]+"px",L.style.visibility="visible"),L.style.opacity=A?"1":"0"})})(rt),rt.addEventListener("transitionend",L=>{L.target===L.currentTarget&&(i()||(L.currentTarget.style.visibility="hidden"))}),g(rt,d(x,{get when(){return e.source.preview},children:L=>(()=>{const A=Is.cloneNode(!0);return(D=>{F(()=>{const V=i(),Y=D.duration;V&&Y&&(D.currentTime=V.percent*Y)})})(A),g(A,d(W,{each:L,children:D=>(()=>{const V=Ds.cloneNode(!0);return $(()=>B(V,"src",D.url)),V})()})),A})()}),Wt),(L=>{F(()=>{const A=i();A&&(L.textContent=Nt(A.percent*o.max_time))})})(Wt),$(L=>{const A=N()?"":"min(100%, 800px)",D=N()?"":"min(90vh, 500px)",V=o.quality?o.quality.w+" / "+o.quality.h:e.video.aspect!=null?""+e.video.aspect:"16 / 9",Y=U("block absolute top-0 left-0 bottom-0 right-0 w-full h-full","transform transition group",f()?"":"hidden",w()?"cursor-default":"cursor-none"),re=U("block transform transition","bg-rwhite dark:bg-rblack bg-opacity-40 dark:bg-opacity-40 hover:bg-opacity-80","rounded-full","group-focus-visible-outline-default","cursor-pointer",o.playing!==!0?"scale-200 opacity-100":"scale-0 opacity-0"),qt=U("absolute left-0 right-0 bottom-0","flex flex-col","bg-rgray-900 bg-opacity-25","transform transition-transform origin-top",h()?"scale-y-0":"scale-y-100"),kt=o.current_time/o.max_time*100+"%",Gt=U("absolute left-0 right-0 bottom-0","flex flex-col","bg-rgray-900 bg-opacity-25","transform transition-transform origin-bottom",h()?"scale-y-100":"scale-y-0"),Ct=U("w-full h-2","relative","bg-rgray-100 bg-opacity-50","transform transition-transform origin-bottom",i()!=null?"scale-y-150":""),Kr=o.current_time/o.max_time*100+"%",Xr=U(o.live?"hover:cursor-pointer":"");return A!==L._v$5&&y.style.setProperty("max-width",L._v$5=A),D!==L._v$6&&y.style.setProperty("max-height",L._v$6=D),V!==L._v$7&&y.style.setProperty("aspect-ratio",L._v$7=V),Y!==L._v$8&&(S.className=L._v$8=Y),re!==L._v$9&&(M.className=L._v$9=re),qt!==L._v$10&&(j.className=L._v$10=qt),kt!==L._v$11&&Ae.style.setProperty("width",L._v$11=kt),Gt!==L._v$12&&(ue.className=L._v$12=Gt),Ct!==L._v$13&&(le.className=L._v$13=Ct),Kr!==L._v$14&&Ft.style.setProperty("width",L._v$14=Kr),Xr!==L._v$15&&(et.className=L._v$15=Xr),L},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0,_v$13:void 0,_v$14:void 0,_v$15:void 0}),E})()}function Fs(e){return(()=>{const t=Vs.cloneNode(!0);return g(t,d(x,{get when(){return e.video.caption},children:n=>(()=>{const r=zs.cloneNode(!0);return r.firstChild,g(r,n,null),r})()}),null),g(t,d(ne,{get item(){return e.video.source},children:{video:n=>d(Bs,{get video(){return e.video},source:n,get autoplay(){return e.autoplay}}),img:n=>d($e,{getValue:r=>{const o=el("div");return Ol(n.url,{alt:e.video.alt}).adto(o),o}})}}),null),t})()}ce(["mousemove","click","mouseup"]);var Us=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",NativeVideoElement:Dr,getVideoSources:Vr,default:Fs});const Ws=p('<div class="py-3 text-center"><div></div></div>'),Hs=p('<div class="h-screen relative"><div class="absolute inset-0 w-full h-full pb-12 pointer-events-none"><div class="flex h-full"><div class="flex-1 flex flex-col drop-shadow-md"><div class="flex-1"></div><div class="p-4 pointer-events-auto bg-hex-000000 bg-opacity-50 max-h-50% overflow-y-scroll"></div></div><div class="w-14 flex flex-col drop-shadow-md"><div class="flex-1"></div><div class="w-full pointer-events-auto bg-hex-000000 bg-opacity-50 max-h-full overflow-y-scroll"></div></div></div></div></div>'),qs=p(`<div><style>
        .hideSvgSoThatItSupportsFirefox {
            border: 0;
            clip: rect(0 0 0 0);
            height: 1px;
            margin: -1px;
            overflow: hidden;
            padding: 0;
            position: absolute;
            width: 1px;
        }
    </style><svg class="hideSvgSoThatItSupportsFirefox"><filter id="sharpBlur"><feGaussianBlur stdDeviation="2"></feGaussianBlur><feColorMatrix type="matrix" values="1 0 0 0 0, 0 1 0 0 0, 0 0 1 0 0, 0 0 0 9 0"></feColorMatrix><feComposite in2="SourceGraphic" operator="in"></feComposite></filter></svg></div>`),Gs=p('<div class="w-full h-full relative"><div class="absolute inset-0 w-full h-full overflow-hidden"><canvas width="20" height="20" class="w-full h-full"></canvas></div><img class="relative block w-full h-full object-contain"></div>'),Ks=p("<div>Image <!> / </div>"),In=p("<div></div>"),Xs=p('<div><div class="w-full h-full px-8"><div class="flex h-full gap-4"><div class="shrink-0 w-4"></div></div></div></div>'),Ys=p("<div>TODO </div>"),Js=p("<div>External Link. TODO click to open</div>"),Qs=p('<div class="w-full h-full"></div>'),Zs=p('<div class="relative w-full h-full"><div class="absolute top-0 left-0 bottom-0 right-0"><canvas width="100" height="100" class="w-full h-full"></canvas></div><div class="absolute top-0 left-0 bottom-0 right-0"></div></div>'),ec=p('<button class="block w-full h-full p-4"><div class="text-lg">Content Warning:</div><div class="text-xl"></div><div class="text-base">Tap to view.</div></button>'),tc=p('<div class="">By u/author on r/subreddit</div>'),nc=p('<div class=""></div>'),rc=p('<div class="font-bold"></div>'),oc=p('<div class="w-full h-full">E;ERROR;</div>'),lc=p('<div class="w-full h-full">TODO loader</div>');function Qt(e){return(()=>{const t=Ws.cloneNode(!0),n=t.firstChild;return g(t,d(bt,{class:"text-[2rem]",get icon(){return e.icon},bold:!1,get label(){return e.label}}),n),g(n,()=>sl(e.text)[0]),t})()}function ic(e){return(()=>{const t=Hs.cloneNode(!0),n=t.firstChild,r=n.firstChild,o=r.firstChild,l=o.firstChild,i=l.nextSibling,a=o.nextSibling,s=a.firstChild,c=s.nextSibling;return g(t,()=>e.children,n),g(i,()=>e.title),g(c,()=>e.sidebar),$(()=>n.style.setProperty("display",e.showUI?"":"none")),t})()}document.body.appendChild(qs.cloneNode(!0));function ac(e){let t;const n=()=>he(e.url);return(()=>{const r=Gs.cloneNode(!0),o=r.firstChild,l=o.firstChild,i=o.nextSibling,a=t;return typeof a=="function"?a(l):t=l,i.addEventListener("load",s=>{const c=t.getContext("2d");!c||(c.drawImage(s.currentTarget,0,0,t.width,t.height),c.globalCompositeOperation="copy",c.filter="url(#sharpBlur)",c.drawImage(t,0,0))}),i.$$click=()=>e.toggleUI(),$(s=>{const c=e.color??"",u=n();return c!==s._v$&&r.style.setProperty("background-color",s._v$=c),u!==s._v$2&&B(i,"src",s._v$2=u),s},{_v$:void 0,_v$2:void 0}),r})()}function sc(e,t){let n=0,r=!1;return{now:()=>{if(r)return;const o=Date.now(),l=n;if(n=o,o>l+e)return t();r=!0,setTimeout(()=>{r=!1,t()},Math.max(0,l+e-o))}}}function cc(e){const t=fe(zr),[n,r]=C(0),o=[],l=T(()=>{const i=n();return(o[i]??=C([]))[0]()});return tn([(()=>{const i=Ks.cloneNode(!0),a=i.firstChild,s=a.nextSibling;return s.nextSibling,g(i,()=>n()+1,s),g(i,()=>e.gallery.images.length,null),i})(),d(W,{get each(){return l()},children:i=>(()=>{const a=In.cloneNode(!0);return g(a,i),a})()})]),(()=>{const i=Xs.cloneNode(!0),a=i.firstChild,s=a.firstChild,c=s.firstChild;return(u=>{const f=sc(250,()=>{const h=u.scrollLeft+u.offsetWidth/2,m=u.scrollWidth,v=e.gallery.images.length,w=h/m*v;r(Math.max(0,Math.min(v-1,w|0)))});u.addEventListener("scroll",h=>{h.target===h.currentTarget&&f.now()},{passive:!0}),Sn(()=>{f.now()})})(i),g(s,d(W,{get each(){return e.gallery.images},children:(u,f)=>d(bl,{class:"w-full snap-center shrink-0 h-full py-8",get children(){return d(Mr.Provider,{value:h=>{const m=[h];F(()=>{const v=f(),b=o[v]??=C([]),w=z(()=>b[0]());w.push(m),G(()=>{const k=w.indexOf(m);k!==-1&&w.splice(k,1)})})},get children(){return d(pn,{get body(){return u.body},toggleUI:()=>{alert("TODO rewrite toggleUI")}})}})}})}),c),$(()=>i.className="h-full w-full overflow-hidden "+(t()?"":"overflow-x-scroll snap-x snap-mandatory")),i})()}function pn(e){return d(ne,{get item(){return e.body},fallback:t=>(()=>{const n=Ys.cloneNode(!0);return n.firstChild,g(n,()=>t.kind,null),n})(),children:{captioned_image:t=>(tn(R(()=>t.caption)),d(ac,{get url(){return t.url},get alt(){return t.alt},get toggleUI(){return e.toggleUI}})),gallery:t=>d(cc,{gallery:t}),link:t=>(tn(d(X,{class:"underline",get action(){return{url:t.url,client_id:t.client_id}},get children(){return t.url}})),d(x,{get when(){return pt(t.url,{suggested_embed:t.embed_html})},get fallback(){return Js.cloneNode(!0)},children:n=>d(pn,{body:n,get toggleUI(){return e.toggleUI}})})),video:t=>(tn(R(()=>t.caption)),(()=>{const n=Qs.cloneNode(!0);return g(n,d(ne,{get item(){return t.source},children:{video:r=>d(uc,{video:t,source:r}),img:r=>d(pn,{get body(){return{kind:"captioned_image",url:r.url,w:null,h:null}},get toggleUI(){return e.toggleUI}})}})),n})())}})}function dc(e,t){let n=!1,r=null;F(()=>{n=e(),z(()=>o())});function o(){r==null&&(r=requestAnimationFrame(()=>{r=null,t(),n&&o()}))}return G(()=>{n=!1,r!=null&&cancelAnimationFrame(r)}),{update:()=>o()}}function uc(e){const[t,n]=C(0),r=T(()=>Vr(t,e.source.sources));let o,l;const[i,a]=Nn({max_time:0,current_time:0,quality:null,buffered:[],playing:"loading",error_overlay:null,errored_sources:{},playback_rate:1,live:null}),s=dc(()=>i.playing===!0,()=>{const c=o.getContext("2d");!c||(l!=null&&c.drawImage(l.video_el,0,0,o.width,o.height),c.globalCompositeOperation="copy",c.filter="url(#sharpBlur)",c.drawImage(o,0,0))});return F(()=>{i.max_time,i.current_time,i.quality,i.buffered,i.playing,i.error_overlay,i.errored_sources,i.playback_rate,i.live,s.update()}),(()=>{const c=Zs.cloneNode(!0),u=c.firstChild,f=u.firstChild,h=u.nextSibling,m=o;return typeof m=="function"?m(f):o=f,(v=>{new IntersectionObserver(b=>{b.forEach(w=>{w.target===v&&(w.isIntersecting?l.play():l.pause())})},{threshold:.5}).observe(v)})(h),g(h,d(Dr,{state:i,setState:a,videoRef:v=>{l=v,l.video_el.addEventListener("click",b=>{b.preventDefault(),b.stopPropagation(),i.playing===!1?l.play():l.pause()})},get video(){return e.video},get source(){return e.source},get sources(){return r()},autoplay:!1,show_controls:!1})),c})()}function fc(e){return(()=>{const t=ec.cloneNode(!0),n=t.firstChild,r=n.nextSibling;return t.$$click=()=>e.onConfirm(),g(r,d(We,{get flairs(){return e.cws}})),t})()}function tn(e){fe(Mr)(e)}function hc(e){const[t,n]=C(!!(e.content.flair??[]).find(l=>l.content_warning)),r=fe(zr),o=document.createElement("div");return d(ic,{get title(){return[d(x,{get when(){return e.content.title},children:l=>(()=>{const i=rc.cloneNode(!0);return g(i,()=>l.text),i})()}),(()=>{const l=In.cloneNode(!0);return g(l,d(We,{get flairs(){return e.content.flair??[]}})),l})(),o,tc.cloneNode(!0),(()=>{const l=nc.cloneNode(!0);return g(l,d(On,{get post(){return e.content},get opts(){return e.opts}})),l})()]},get sidebar(){return[d(x,{get when(){return e.content.actions?.vote},children:l=>[d(X,{class:"block w-full",action:"TODO",get children(){return d(Qt,{get icon(){return l.increment.icon},get label(){return l.increment.label},text:["number",-1]})}}),d(X,{class:"block w-full",action:"TODO",get children(){return d(x,{get when(){return l.decrement},children:i=>d(Qt,{get icon(){return i.icon},get label(){return i.label},get text(){return l.percent==null?["none",0]:["percent",l.percent]}})})}})]}),d(x,{get when(){return e.opts.frame?.url},children:l=>d(X,{class:"block w-full",get action(){return{url:l,client_id:e.opts.client_id}},get children(){return d(Qt,{icon:"comments",label:"Comments",get text(){return e.content.info?.comments!=null?["number",e.content.info?.comments]:["none",0]}})}})}),d(X,{class:"block w-full",action:"TODO",get children(){return d(Qt,{icon:"ellipsis",label:"More",text:["none",0]})}})]},get showUI(){return!r()},get children(){return d(x,{get if(){return!t()},get fallback(){return d(fc,{onConfirm:()=>n(!1),get cws(){return(e.content.flair??[]).filter(l=>l.content_warning)}})},get children(){return d(Mr.Provider,{value:l=>{const i=o,a=document.createElement("div");i.appendChild(a),G(()=>a.remove()),_t(()=>l,a)},get children(){return d(pn,{get body(){return e.content.body},toggleUI:()=>{}})}})}})}})}const zr=we(null),Mr=we();function gc(e){const t=document.createElement("style");t.textContent=`
        body {
            margin-bottom: 0 !important;
        }
    `,G(()=>{t.remove()}),document.body.appendChild(t);const n=Re(),r=T(()=>{const s=Te(n.content(),e.pivot);if(s==null||s.error!=null)throw new Error("rve");const c=s.value;if(c.kind!=="post")throw new Error("rve2");if(c.replies==null)throw new Error("rve3");return{replies:c.replies,pivot:c}}),o=me.useChildren(()=>d(wt.Provider,{value:{map:new Map},get children(){return d(_l,{get replies(){return r().replies}})}})),[l,i]=C(!1),a=s=>{visualViewport.scale>1.0001?i(!0):i(!1)};return visualViewport.addEventListener("resize",a),G(()=>visualViewport.removeEventListener("resize",a)),d(zr.Provider,{value:l,get children(){return[(()=>{const s=In.cloneNode(!0);return s.style.setProperty("touch-action","auto"),g(s,d(W,{get each(){return o()},children:c=>d(bl,{class:"snap-center w-full h-full",get children(){return d(ne,{item:c,children:{error:u=>(()=>{const f=oc.cloneNode(!0);return f.firstChild,g(f,()=>u.msg,null),f})(),flat_loader:u=>lc.cloneNode(!0),flat_post:u=>d(ne,{get item(){return u.post.content},fallback:f=>["E;TODO;",R(()=>f.kind)],children:{post:f=>d(hc,{content:f,get opts(){return{client_id:u.post.client_id,frame:u.post,flat_frame:null,id:u.link}}})}})}})}})})),$(()=>s.className="bg-hex-000 h-screen overflow-hidden snap-mandatory text-zinc-100 space-y-8 "+(l()?"":"snap-y overflow-y-scroll")),s})(),d(X,{class:"fixed top-0 left-0 bg-hex-000000 bg-opacity-50 p-4",get action(){return{url:fn(r().pivot.url??"ENO",{"--tc-view":void 0}),client_id:r().pivot.client_id,mode:"replace",page:()=>({content:n.content(),pivot:e.pivot})}},get children(){return d(Oe,{class:"fa-solid fa-down-left-and-up-right-to-center text-base",label:"Exit Fullscreen"})}})]}})}function bl(e){const[t,n]=C(!1);let r=!1,o,l,i;return Sn(()=>{const a=new IntersectionObserver(s=>{s.forEach(c=>{if(c.target===l){c.isIntersecting&&(r=!0,o!=null&&cancelIdleCallback(o),setTimeout(()=>{n(r)},300));return}else if(c.target!==i)return;"requestIdleCallback"in window||(window.requestIdleCallback=u=>u()),"cancelIdleCallback"in window||(window.cancelIdleCallback=()=>{}),console.log("INTERSECTIONOBSERVER CB",s),c.isIntersecting?(r=!0,o!=null&&cancelIdleCallback(o),o=requestIdleCallback(()=>{o=void 0,n(r)})):(r=!1,o!=null&&cancelIdleCallback(o),o=requestIdleCallback(()=>{o=void 0,n(r)}))})},{root:document.documentElement,threshold:0});a.observe(l),a.observe(i)}),(()=>{const a=In.cloneNode(!0);return(s=>{l=s})(a),g(a,d(Bt,{component:"intersection-observer",class:"absolute top-0 left-0 bottom-0 right-0 transform scale-150 pointer-events-none",ref(s){const c=i;typeof c=="function"?c(s):i=s}}),null),g(a,d(x,{get if(){return t()},fallback:"\u2026 loading",get children(){return e.children}}),null),$(s=>{const c="snap-center w-full h-full relative "+e.class,u=""+t();return c!==s._v$3&&(a.className=s._v$3=c),u!==s._v$4&&B(a,"data-visible",s._v$4=u),s},{_v$3:void 0,_v$4:void 0}),a})()}ce(["click"]);function yl(e){return typeof e.onClick=="string"?{url:e.onClick,client_id:e.client_id}:"url"in e.onClick?{url:e.onClick.url,client_id:e.client_id}:typeof e.onClick=="function"?e.onClick:"TODO"}function wl(e){return e.onClick==="disabled"}const mc=p('<button class="pl-2 pr-1"></button>'),vc=p('<div tabindex="0"></div>'),_c=p('<div><div tabindex="0"></div><div tabindex="0"></div><div class="bg-gray-100 p-1 rounded-lg"></div><div tabindex="0"></div></div>'),[pc,bc]=C(Symbol());function yc(){bc(Symbol())}function wc(e){const[t,n]=C({rect:new DOMRect(0,0,0,0),scroll:[0,0]}),[r,o]=C(!1),[l,i]=C(!1),a=c=>{o(u=>{const f=typeof c=="boolean"?c:c(u);return u!==f&&i(!0),f})};F(xr(pc,()=>{a(!1)},{defer:!0}));let s;return[(()=>{const c=mc.cloneNode(!0);return c.$$click=u=>{const f=u.target.getBoundingClientRect();n({rect:f,scroll:[window.scrollX,window.scrollY],closing:!1}),a(h=>!h)},(u=>s=u)(c),g(c,d(Oe,{class:"fa-solid fa-ellipsis",label:"More"})),c})(),d(x,{get if(){return r()||l()},get children(){return(()=>{let c,u;const[f,h]=C(!1);F(()=>{const v=b=>{let w=b.target;for(;w;){if(w===s||w===c)return;w=w.parentElement}a(!1)};document.addEventListener("click",v,{capture:!0,passive:!1}),G(()=>document.removeEventListener("click",v,{capture:!0}))});const m=document.createElement("div");return pe.appendChild(m),G(()=>{m.remove()}),[(()=>{const v=vc.cloneNode(!0);return v.addEventListener("focus",()=>u.focus()),v})(),d(Oi,{mount:m,get children(){const v=_c.cloneNode(!0),b=v.firstChild,w=b.nextSibling,k=w.nextSibling,N=k.nextSibling;(E=>{c=E,E.style.transformOrigin="top right";const y=()=>{const M=Rr()/2;E.style.transition=M+"s opacity, "+M+"s transform"},S=()=>{E.style.transform="scale(0.95)",E.style.opacity="0",y(),E.style.transitionTimingFunction="ease-in"},P=()=>{E.style.transform="",E.style.opacity="",y(),E.style.transitionTimingFunction="ease-out"};S(),F(()=>{const M=r();E.offsetHeight,M?P():S()}),F(()=>{f()?E.style.outline="1px dotted var(--outline-color)":E.style.outline=""})})(v),v.addEventListener("transitionend",E=>{E.target===E.currentTarget&&i(!1)}),v.style.setProperty("--dbtn-max-width","24rem"),v.style.setProperty("--dbtn-padding","1rem"),v.style.setProperty("--dbtn-left","max(calc(var(--dbtn-target-pos) - var(--dbtn-max-width)),calc(0px + var(--dbtn-padding)))"),v.style.setProperty("left","var(--dbtn-left)"),v.style.setProperty("right","calc(100vw - min(calc(var(--dbtn-left) + var(--dbtn-max-width)),100vw - var(--dbtn-padding)))"),v.style.setProperty("z-index","1000000000"),b.addEventListener("focus",()=>{s.focus()}),w.$$focusout=()=>{h(!1)},w.$$focusin=()=>{h(!0)};const I=u;return typeof I=="function"?I(w):u=w,g(k,()=>e.children),N.addEventListener("focus",()=>{a(!1),s.focus()}),$(E=>{const y=U("absolute"),S=t().rect.bottom+t().scroll[1]+"px",P=t().rect.right+"px";return y!==E._v$&&(v.className=E._v$=y),S!==E._v$2&&v.style.setProperty("top",E._v$2=S),P!==E._v$3&&v.style.setProperty("--dbtn-target-pos",E._v$3=P),E},{_v$:void 0,_v$2:void 0,_v$3:void 0}),v}})]})()}})]}ce(["click","focusin","focusout"]);const xc=p("<div></div>"),$c=p('<span class="ml-2"></span>');function kc(e){return d(X,{beforeClick:()=>{yc()},get action(){return e.action},get class(){return U("w-full block p-2 text-left hover:bg-gray-200","focus-visible:bg-gray-200 rounded-lg",e.url!=null?"hover:underline":"")},get disabled(){return e.disabled},get children(){const t=xc.cloneNode(!0);return g(t,d(x,{get when(){return e.icon},children:n=>[n,$c.cloneNode(!0)]}),null),g(t,()=>e.children,null),$(()=>t.className="w-full "+e.class),t}})}function Cc(e){return d(kc,{get icon(){return d(bt,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}})},get class(){return U(e.action.color==null?"":"font-bold",Tn(e.action.color))},get action(){return yl(e.action)},get disabled(){return wl(e.action)},get children(){return e.action.text}})}function Sc(e){return d(X,{get btnref(){return e.btnref},get class(){return U("py-1 px-2 rounded-md","text-gray-600","hover:text-black","bg-gray-200 border-b-1 border-gray-500","dark:border-t-1 dark:border-b-0 dark:bg-white dark:border-gray-400",typeof e.action=="object"?"hover:underline":"","outline-default")},get action(){return e.action},get disabled(){return e.disabled},get children(){return e.children}})}const Ec=p("<span> </span>");function Nc(e){return d(Sc,{get action(){return yl(e.action)},get disabled(){return wl(e.action)},get children(){const t=Ec.cloneNode(!0),n=t.firstChild;return g(t,d(bt,{get icon(){return e.action.icon},get label(){return e.action.text},get bold(){return e.action.color!=null}}),n),g(t,()=>e.action.text,null),$(()=>t.className=e.action.color==null?void 0:"font-bold "+Tn(e.action.color)),t}})}const Lc=p("<div></div>"),Pc=p('<button aria-label="Collapse"></button>');function Tc(e){const t=window;t.__tc_object_map??=new Map;let n=t.__tc_object_map.get(e);return n==null&&(n=t.__tc_object_map.size,t.__tc_object_map.set(e,n)),"#"+n+"#"+e.toString()}function Kn(e,t){return"tc-collapse-button@"+t+":"+Tc(e)}function bn(e){let t=!1;G(()=>{if(!e.id||!e.cstates)return;const o=ze(e.cstates,e.id);t&&o.setHovering(l=>l-1),t=!1});const n=()=>e.mode==="reveal_only",r=()=>e.mode!=="fake";return(()=>{const o=Pc.cloneNode(!0);return o.addEventListener("mouseleave",()=>{if(!e.id||!e.cstates)return;const l=ze(e.cstates,e.id);t&&l.setHovering(i=>i-1),t=!1}),o.$$mouseover=()=>{if(!e.id||!e.cstates)return;const l=ze(e.cstates,e.id);t||l.setHovering(i=>i+1),t=!0},o.$$click=l=>{let i;e.id==null?r()?i=l.currentTarget:i=null:i=document.getElementById(Kn(e.id,n()));let a=!1;const s=kn.getBoundingClientRect(),c=()=>5+Math.max(0,s.bottom,window.visualViewport.offsetTop);i&&(a=i.getBoundingClientRect().top<c()),e.onClick();let u;e.id==null?r()?u=l.currentTarget:u=null:u=document.getElementById(Kn(e.id,!n())),u&&a&&(u.scrollIntoView(),document.documentElement.scrollTop-=c()),u?.focus()},B(o,"draggable",!0),g(o,d(x,{get if(){return!n()},get fallback(){return d(Xe,{class:"mx-auto text-xs text-gray-600 dark:text-blue-400",tag:"fa-circle-plus",filled:!0,label:null})},get children(){const l=Lc.cloneNode(!0);return $(()=>l.className=U("w-3px mx-auto h-full",e.cstates&&e.id&&ze(e.cstates,e.id).hovering()>0?"bg-slate-500 dark:bg-zinc-600":"bg-slate-300 dark:bg-zinc-700","group-hover:bg-slate-500 dark:group-hover:bg-zinc-600")),l}})),$(l=>{const i=r()&&e.id!=null?Kn(e.id,n()):void 0,a=U("w-15px box-border cursor-pointer min-h-13px","z-1 static outline-default group",e.class??"",e.threaded??!1?"threaded-new":""),s=n(),c=r()?void 0:"-1",u=r()?void 0:!0;return i!==l._v$&&B(o,"id",l._v$=i),a!==l._v$2&&(o.className=l._v$2=a),s!==l._v$3&&B(o,"aria-pressed",l._v$3=s),c!==l._v$4&&B(o,"tabindex",l._v$4=c),u!==l._v$5&&B(o,"aria-hidden",l._v$5=u),l},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),o})()}ce(["click","mouseover"]);const No=p("<div></div>"),Lt={Container(e){return(()=>{const t=No.cloneNode(!0);return g(t,()=>e.children),$(()=>t.className=U("flex flex-wrap",{top:"items-start",center:"items-center",bottom:"items-end",baseline:"items-baseline"}[e.vertical],e.dir==="right"?"justify-end":"",e.gap==="2"?"gap-2":"")),t})()},Child(e){return(()=>{const t=No.cloneNode(!0);return g(t,()=>e.children),$(()=>t.className=U({top:"self-start",center:"self-center",bottom:"self-end",none:""}[e.vertical??"none"],e.fullwidth??!1?"flex-1":"")),t})()}},Oc=p("<button>code</button>"),Rc=p("<div></div>"),Ac=p('<div class="m-3 p-3 shadow-md sm:rounded-xl <sm:mx-0 bg-slate-100 dark:bg-zinc-800"></div>'),Ic=p('<div class="bg-slate-300 dark:bg-zinc-900 p-2 rounded-xl"><div class="rounded-md bg-slate-100 dark:bg-zinc-800 p-3"></div></div>');function xl(e){return d(ne,{get item(){return e.content},children:{post:t=>d(yn,{content:t,get opts(){return e.opts},get hovering(){return e.hovering},get whole_object_clickable(){return e.whole_object_clickable}}),page:()=>"TODO page",legacy:t=>d($e,{getValue:n=>{const r=el("div").clss("-mt-10px -ml-10px"),o=el("div").clss("post text-sm").adto(r),l=Ce(t.client_id);return qr(l,t.thread,o,{clickable:!0}).defer(n),r}}),client:()=>"TODO client",special:t=>d(yn,{get content(){return t.fallback},get opts(){return e.opts}})}})}function jr(e){const t=n=>["TODO support. also in the parent list these should probably"," ","be one of those navbars with bits like ClientName ",">"," PageName ",">"," \u2026"," ",(()=>{const r=Oc.cloneNode(!0);return r.$$click=()=>console.log(n),r})()];return(()=>{const n=Rc.cloneNode(!0);return g(n,d(gt,{get data(){return[e.listing,e.opts]},get children(){return d(ne,{get item(){return e.listing},children:{page:r=>t(r),client:r=>t(r),post:r=>d(yn,{content:r,get opts(){return e.opts}}),special:r=>d(yn,{get content(){return r.fallback},get opts(){return e.opts}}),legacy:r=>d($e,{getValue:o=>{const l=Ce(r.client_id);return Ke(l,r.thread,{clickable:!0}).defer(o)}})}})}})),n})()}function Rf(e){return(()=>{const t=Ac.cloneNode(!0);return g(t,()=>e.children),t})()}function Br(e){return(()=>{const t=Ic.cloneNode(!0),n=t.firstChild;return g(n,()=>e.children),t})()}ce(["click"]);const Dc=p('<div class="absolute top-0 left-0 w-full h-full"></div>'),Vc=p("<div><div></div></div>");function zc(e){const[t,n]=C(null),r=T(()=>t()!=null),[o,l]=C(!1),i=T(()=>r()||o());let a=0;F(()=>{const u=t();u!=null&&(a=u)});let s,c=[];return G(()=>{c.forEach(u=>u())}),(()=>{const u=Vc.cloneNode(!0),f=u.firstChild;u.$$pointerdown=m=>{const v=m.pointerId;if(m.pointerType==="mouse"||(c.forEach(P=>P()),document.getSelection()?.isCollapsed===!1))return;if(CSS.supports("-webkit-touch-callout: none")){const P=window.innerWidth,M=m.clientX;if(Math.min(Math.abs(M),Math.abs(P-M))<50)return}let w=!1;m.preventDefault(),s.style.transition="";const k=()=>{const P=t()!==0&&t()!=null;s.style.transition="0.1s transform",P&&s.offsetWidth,Je(()=>{P&&l(!0),n(null)}),S()},N=P=>{if(P.pointerId!==v)return;const M=P.clientX-m.clientX,j=P.clientY-m.clientY;(w||Math.abs(M)>10&&Math.abs(j)<Math.abs(M))&&(w=!0,n(M))},I=P=>{P.pointerId===v&&(e.onRelease(t()??0),k())},E=P=>{P.pointerId===v&&k()},y=()=>{S()};document.addEventListener("pointermove",N),document.addEventListener("pointerup",I),document.addEventListener("pointercancel",E),document.addEventListener("selectionchange",y);const S=()=>{c=c.filter(P=>P!==S),document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",I),document.removeEventListener("pointercancel",E),document.removeEventListener("selectionchange",y)};c.push(S)},u.style.setProperty("width","100%"),u.style.setProperty("touch-action","pan-y pinch-zoom"),u.style.setProperty("position","relative"),g(u,d(x,{get if(){return i()},get children(){const m=Dc.cloneNode(!0);return g(m,()=>z(()=>e.background(()=>t()??a))),m}}),f),f.addEventListener("transitionend",m=>{m.target===m.currentTarget&&l(!1)});const h=s;return typeof h=="function"?h(f):s=f,g(f,()=>e.children),$(m=>{const v=i()?"hidden":"unset",b=(()=>{const w=t();return w!=null?"translateX("+w+"px)":""})();return v!==m._v$&&u.style.setProperty("overflow-x",m._v$=v),b!==m._v$2&&f.style.setProperty("transform",m._v$2=b),m},{_v$:void 0,_v$2:void 0}),u})()}ce(["pointerdown"]);const Mc=p('<div><div class="absolute w-100px h-full flex items-center justify-center"><div></div></div></div>');function jc(e){return{background:t=>{const n=T(()=>t()<0?e.right_stop:e.left_stop),r=T(()=>t()<0),o=T(()=>Math.abs(t())>100);return(()=>{const l=Mc.cloneNode(!0),i=l.firstChild,a=i.firstChild;return g(a,d(bt,{get icon(){return n().icon},get bold(){return o()},label:null})),$(s=>{const c=na(n().color,o())+" w-full h-full relative",u={...r()?{right:"-100px"}:{left:"-100px"},transform:"translateX("+t()+"px)"},f=o()?"bounceanim":"";return c!==s._v$&&(l.className=s._v$=c),s._v$2=En(i,u,s._v$2),f!==s._v$3&&(a.className=s._v$3=f),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),l})()},onRelease:t=>{t<-100&&e.right_stop.onActivate(),t>100&&e.left_stop.onActivate()}}}const Bc=p("<div></div>"),Fc=p('<img class="block w-full h-full">'),Uc=p('<div class="mt-4"></div>'),Wc=p('<div class="pb-2 sm:rounded-b-lg bg-slate-100 dark:bg-zinc-800"></div>'),Hc=p('<div class="mt-4 mb-4 rounded-lg bg-slate-100 dark:bg-zinc-800"><menu class="p-2 flex flex-row flex-wrap gap-2 dark:text-zinc-400"></menu></div>'),qc=p("<li></li>"),Gc=p('<hr class="my-2 border-t-2">'),Kc=p("<div>TODO: <!> <button>code</button></div>"),Xc=p('<div class="text-red-500">Error: <!> <button>code</button></div>'),Yc=p("<div><div></div></div>"),Jc=p('<div class="pt-2"></div>'),Qc=p('<div><div class="relative flex flex-row gap-1"><div class="flex-1"></div></div></div>'),Zc=p('<div class="py-1"><div class="text-red-500">!ERROR!</div> </div>'),ed=p('<div class="py-1"><button class="text-blue-500 hover:underline"></button></div>'),td=p('<p class="text-red-600 dark:text-red-500">Error loading; </p>'),Lo=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-blue-500","bg-purple-500"];function nd(e){return Lo[e%Lo.length]}function Po(e){return(()=>{const t=Bc.cloneNode(!0);return g(t,()=>e.children),$(()=>t.className="block overflow-hidden "+(e.loader_or_post.first_in_wrapper?"sm:rounded-t-lg ":"")+(e.loader_or_post.last_in_wrapper?"sm:rounded-b-lg ":"")),t})()}const rd={"FullscreenImage@-N0D1IW1oTVxv8LLf7Ed":e=>d(Po,{get loader_or_post(){return e.loader_or_post},get children(){return d(X,{get action(){return{url:e.data.link_url??"E:",client_id:e.post.client_id}},class:"block w-full",get children(){const t=Fc.cloneNode(!0);return $(n=>{const r=he(e.data.url),o=e.data.w,l=e.data.h;return r!==n._v$&&B(t,"src",n._v$=r),o!==n._v$2&&B(t,"width",n._v$2=o),l!==n._v$3&&B(t,"height",n._v$3=l),n},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t}})}}),"FullscreenEmbed@-N0D96jIL-HGWHWbWKn1":e=>d(Po,{get loader_or_post(){return e.loader_or_post},get children(){return d(ae,{get body(){return e.data},autoplay:!1})}})};function dr(e){return d(gt,{get data(){return e.item},get children(){return d(od,{get item(){return e.item},get collapse_data(){return e.collapse_data}})}})}function od(e){return d(ne,{get item(){return e.item},children:{wrapper_start:()=>Uc.cloneNode(!0),wrapper_end:()=>Wc.cloneNode(!0),repivot_list_fullscreen_button:t=>d(X,{class:"bg-slate-100 dark:bg-zinc-800 p-2 rounded-md",get action(){return{url:t.href,client_id:t.client_id,page:t.page,mode:"replace"}},get children(){return[d(Oe,{class:"fa-solid fa-up-right-and-down-left-from-center",label:null})," ",R(()=>t.name)]}}),sort_buttons:t=>(()=>{const n=Hc.cloneNode(!0),r=n.firstChild;return g(r,d(W,{get each(){return t.sort_buttons},children:o=>(()=>{const l=qc.cloneNode(!0);return l.style.setProperty("display","contents"),g(l,d(X,{class:"px-1 border-b-2 border-transparent dark:hover:text-zinc-50",get action(){return vt(o,{url:i=>({url:i.url,client_id:t.client_id,mode:"replace"}),post:i=>()=>alert("TODO post: "+i.name),more:()=>()=>alert("TODO more")})},get children(){return[R(()=>o.name),R(()=>o.kind==="more"?" \u25BE":"")]}})),l})()})),n})(),post:t=>d(id,{get collapse_data(){return e.collapse_data},loader_or_post:t}),horizontal_line:()=>(()=>{const t=Gc.cloneNode(!0);return t.style.setProperty("border-top-color","var(--collapse-line-color)"),t})(),todo:t=>(()=>{const n=Kc.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return g(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})(),error:t=>(()=>{const n=Xc.cloneNode(!0),r=n.firstChild,o=r.nextSibling,l=o.nextSibling,i=l.nextSibling;return g(n,()=>t.note,o),i.$$click=()=>console.log(t.data),n})()}})}function ld(e){return d(x,{get if(){return!$n.sm()},get fallback(){return d(x,{get if(){return e.loader_or_post.indent.length>0},get children(){const t=Yc.cloneNode(!0),n=t.firstChild;return $(r=>{const o=(e.loader_or_post.indent.length-3)*.25+"rem",l=U("w-1","mr-1","pl-0.5",e.loader_or_post.first_in_wrapper?"":"pt-2"),i=U("w-full h-full",nd(e.loader_or_post.depth-1),"rounded-md",e.loader_or_post.threaded?"threaded-new threaded-new-ltsm":"");return o!==r._v$4&&t.style.setProperty("margin-left",r._v$4=o),l!==r._v$5&&(t.className=r._v$5=l),i!==r._v$6&&(n.className=r._v$6=i),r},{_v$4:void 0,_v$5:void 0,_v$6:void 0}),t}})},get children(){return d(W,{get each(){return e.loader_or_post.indent},children:t=>d(bn,{mode:"fake",onClick:()=>{ze(e.collapse_data,t.id).setCollapsed(r=>!r)},get cstates(){return e.collapse_data},get threaded(){return t.threaded},get id(){return t.id}})})}})}function id(e){const t=T(()=>{const n=e.loader_or_post.content;if(n.kind!=="flat_post"||n.post.content.kind!=="special")return null;const r=n.post.content,o=rd[r.tag_uuid];return o==null?null:()=>o({get data(){return r.not_typesafe_data},get collapse_data(){return e.collapse_data},get loader_or_post(){return e.loader_or_post},get post(){return n.post}})});return T(()=>{const n=t();return n?z(()=>n()):d(sd,{get collapse_data(){return e.collapse_data},get loader_or_post(){return e.loader_or_post}})})}function $l(e,t){if(t.kind==="flat_post"&&!(t.post.disallow_pivot??!1))return{pivot:t.link,content:e.content()}}function ad(e,t,n){const r=t.content;if(r.kind!=="flat_post")return alert("EONCLICK-ON-NON-POST");const o="/"+r.post.client_id+r.post.url;n.ctrlKey||n.metaKey||n.altKey?window.open(o):Qe({path:o,page:$l(e,r)})}function sd(e){const t=()=>e.loader_or_post.is_pivot,n=()=>{if(t())return!1;const a=e.loader_or_post;return!(a.content.kind!=="flat_post"||a.displayed_in!=="repivot_list"||a.content.post.url==null)},r=Re(),o=a=>{const s=e.loader_or_post;return ad(r,s,a)},[l,i]=C(!1);return d(zc,Le(()=>jc({left_stop:{icon:"bookmark",color:"green",onActivate:()=>{alert("TODO")}},right_stop:{icon:"chevron_up",color:"blue",onActivate:()=>{if(!e.loader_or_post.collapse)return alert("TODO e;not-collapsible");ze(e.collapse_data,e.loader_or_post.collapse.id).setCollapsed(s=>!s)}}}),{get children(){return d(fl,{get clickable(){return n()},children:(a,s,c)=>(()=>{const u=Qc.cloneNode(!0),f=u.firstChild,h=f.firstChild;u.addEventListener("mouseleave",()=>i(!1)),u.addEventListener("mouseenter",()=>i(!0)),u.$$click=v=>{!n()||!Pr(v.target,v.currentTarget)||(v.stopPropagation(),o(v))},u.addEventListener("keypress",v=>{!n()||v.code==="Enter"&&(v.stopPropagation(),o(v))});const m=s;return typeof m=="function"?m(u):s=u,g(f,d(ld,{get loader_or_post(){return e.loader_or_post},get collapse_data(){return e.collapse_data}}),h),g(h,d(x,{get if(){return!e.loader_or_post.first_in_wrapper},get children(){return Jc.cloneNode(!0)}}),null),g(h,d(cd,{get loader_or_post(){return e.loader_or_post},get collapse_data(){return e.collapse_data},get hovering(){return l()},get whole_object_clickable(){return n()}}),null),$(v=>{const b=c()+" px-2 "+(a()?`
                    bg-slate-200 dark:bg-zinc-700
                        shadow-md z-1
                    `:"bg-slate-100 dark:bg-zinc-800")+" "+(e.loader_or_post.is_pivot?"@@IS_PIVOT@@ ":"")+(n()?`
                    cursor-pointer outline-default
                    relative
                `:"")+(e.loader_or_post.first_in_wrapper?`
                    pt-2 sm:rounded-t-lg
                `:"")+(e.loader_or_post.last_in_wrapper?`
                    pb-2 sm:rounded-b-lg
                `:""),w=n()?0:-1;return b!==v._v$7&&(u.className=v._v$7=b),w!==v._v$8&&B(u,"tabindex",v._v$8=w),v},{_v$7:void 0,_v$8:void 0}),u})()})}}))}function cd(e){return d(ne,{get item(){return e.loader_or_post.content},children:{error:t=>(()=>{const n=Zc.cloneNode(!0);return n.firstChild.nextSibling,g(n,()=>t.msg,null),n})(),flat_post:t=>d(xl,{get content(){return t.post.content},get opts(){return{frame:t.post,client_id:t.post.client_id,collapse_data:e.collapse_data,flat_frame:e.loader_or_post,id:t.link}},get hovering(){return e.hovering},get whole_object_clickable(){return e.whole_object_clickable}}),flat_loader:t=>{const[n,r]=C(!1),[o,l]=C(null),i=Re(),a=()=>{if(n())return;r(!0);const s=i.pgin();(async()=>{o()!=null&&await new Promise(f=>setTimeout(f,200));const c=Te(i.content(),t.request);if(c==null)throw new Error("e-request-null: "+t.request.toString());if(c.error!=null)throw new Error(c.error);return await(await Pn(t.client_id)).loader(c.value)})().then(c=>{Je(()=>{r(!1),l(null),console.log("adding content",c.content,e.loader_or_post),i.addContent(s,c.content)})}).catch(c=>{console.log("Error loading; ",c),Je(()=>{r(!1),l(c.toString())})})};return(()=>{const s=ed.cloneNode(!0),c=s.firstChild;return c.$$click=a,g(c,(()=>{const u=R(()=>!!n(),!0);return()=>u()?"Loading\u2026":(o()!=null?"Retry Load":"Load More")+(t.load_count!=null?" ("+t.load_count+")":"")})()),g(s,d(ol,{data:e}),null),g(s,d(x,{get when(){return o()},children:u=>(()=>{const f=td.cloneNode(!0);return f.firstChild,g(f,u,null),f})()}),null),$(()=>c.disabled=n()),s})()}}})}ce(["click"]);const dd=p('<img loading="lazy" alt="" class="w-8 h-8 object-center inline-block rounded-full">'),ud=p("<div><span></span></div>"),fd=p('<div class="flex flex-col items-center mr-1 gap-2 sm:pr-1"><div></div></div>'),hd=p('<div class="mt-2"></div>'),gd=p('<div class="text-sm"><div class="mt-2"></div><div class="flex flex-wrap gap-2"></div></div>'),md=p('<div class="flex flex-row"><div class="flex-1"><div><section></section></div></div></div>'),vd=p("<article></article>"),_d=p('<div class="flex flex-col items-center mr-1 gap-2 sm:pr-1"></div>'),pd=p('<div class="flex flex-row"><div class="flex-1"></div></div>'),bd=p('<button class="text-slate-500 dark:text-zinc-600 text-xs"></button>'),yd=p("<button>Show Anyway</button>"),wd=p('<div role="heading"></div>'),To=p("<div></div>"),xd=p("<div><div><div><div></div></div></div></div>"),$d=p('<img alt="">'),kd=p('<div><div class="whitespace-normal max-lines max-lines-1"></div></div>');function kl(e){const[t,n]=C(e.src_url),[r,o]=C(!1);return(()=>{const l=dd.cloneNode(!0);return l.addEventListener("mouseleave",()=>{n(e.src_url)}),l.addEventListener("mouseenter",()=>{n(e.hover_src_url)}),(i=>{new IntersectionObserver(a=>{a.forEach(s=>{s.target===i&&s.isIntersecting&&o(!0)})},{rootMargin:"100%",threshold:0}).observe(i)})(l),$(()=>B(l,"src",r()?he(t()):"")),l})()}function Cd(e){const t=T(()=>ir(e.body));return R((()=>{const n=R(()=>t()!=null,!0);return()=>n()?(()=>{const r=ud.cloneNode(!0),o=r.firstChild;return g(o,d(ne,{get item(){return t()},children:{icon:l=>d(Xe,{get tag(){return{text:"fa-file-lines",video:"fa-circle-play",link:"fa-arrow-up-right-from-square",other:"fa-asterisk"}[l.icon]},get filled(){return l.icon==="other"||l.icon==="link"},get label(){return{text:"Text",video:"Video",link:"Link",other:""}[l.icon]}}),gallery:l=>R(()=>l.count)}})),$(()=>r.className=U("absolute bottom-1 right-1","text-xs sm:text-base w-6 h-6 sm:w-8 sm:h-8 p-1 bg-slate-300 dark:bg-zinc-700","rounded-md","flex items-center justify-center")),r})():null})())}function yn(e){const t=T(()=>Or(e.content,e.opts.flat_frame??{is_pivot:!1,displayed_in:"tree"}),void 0,{equals:(u,f)=>JSON.stringify(u)===JSON.stringify(f)}),n=()=>e.opts.flat_frame?.is_pivot??!1,[r,o]=e.opts.collapse_data&&e.opts.id&&e.opts.flat_frame?(()=>{const u=e.opts.flat_frame,f=C(!0);if(u.is_pivot)return C(!0);const h=t();if(!h.user_controllable)return C(!h.default_collapsed);const m=ze(e.opts.collapse_data,e.opts.id),v=b=>!m.setCollapsed(w=>!(typeof b=="boolean"?b:b(!w)));return[T(()=>u.is_pivot?f[0]():!m.collapsed()),b=>u.is_pivot?f[1](b):v(b)]})():C(z(n)?!0:!z(()=>t()).default_collapsed),[l,i]=C(!!(e.content.flair??[]).find(u=>u.content_warning)),a=Vl(),s=()=>{if(!!e.opts.flat_frame&&!!a)return $l(a,e.opts.flat_frame.content)},c=ga(()=>e.content,()=>e.opts);return(()=>{const u=vd.cloneNode(!0);return g(u,d(ar,{get mode(){return e.opts.collapse_data?"clip":"height"},get if(){return r()},get fallback(){return(()=>{const f=pd.cloneNode(!0),h=f.firstChild;return g(f,d(x,{get if(){return R(()=>!!(t().user_controllable&&e.content.thumbnail==null),!0)()&&!$n.sm()},get children(){const m=_d.cloneNode(!0);return g(m,d(bn,{class:"flex-1",mode:"reveal_only",onClick:()=>{o(v=>!v)},get cstates(){return e.opts.collapse_data},get id(){return e.opts.flat_frame?.collapse?.id??void 0}})),m}}),h),g(h,d(Oo,{get content(){return e.content},get opts(){return e.opts},visible:!1,setVisible:o,get contentWarning(){return l()},get collapseInfo(){return t()},get actions(){return c()},getPage:s,get hovering(){return e.hovering},get whole_object_clickable(){return e.whole_object_clickable}})),f})()},get children(){const f=md.cloneNode(!0),h=f.firstChild,m=h.firstChild,v=m.firstChild;return g(f,d(x,{get if(){return R(()=>!!t().user_controllable,!0)()&&!$n.sm()},get children(){const b=fd.cloneNode(!0),w=b.firstChild;return g(w,d(x,{get when(){return e.content.actions?.vote},get fallback(){return(()=>{const k=bd.cloneNode(!0);return k.$$click=()=>{o(N=>!N)},g(k,d(Oe,{class:"fa-solid fa-circle-chevron-up",label:"Collapse"})),k})()},children:k=>d(ca,{counter:k})})),g(b,d(bn,{class:"flex-1",mode:"collapse_only",onClick:()=>{o(k=>!k)},get cstates(){return e.opts.collapse_data},get id(){return e.opts.flat_frame?.collapse?.id??void 0}}),null),b}}),h),g(h,d(Oo,{get content(){return e.content},get opts(){return e.opts},visible:!0,setVisible:o,get contentWarning(){return l()},get collapseInfo(){return t()},get actions(){return c()},getPage:s,get hovering(){return e.hovering},get whole_object_clickable(){return e.whole_object_clickable}}),m),g(v,d(x,{if:!0,get children(){return[d(x,{if:!0,get children(){return hd.cloneNode(!0)}}),d(ar,{get if(){return!l()},get fallback(){return["Content Warning:"," ",d(We,{get flairs(){return(e.content.flair??[]).filter(b=>b.content_warning)}})," ",(()=>{const b=yd.cloneNode(!0);return b.$$click=()=>i(!1),$(()=>b.className=oe["pill-filled"]),b})()]},get children(){return d(ae,{get body(){return e.content.body},autoplay:!1})}})]}})),g(m,d(x,{get if(){return n()},get children(){const b=gd.cloneNode(!0),w=b.firstChild,k=w.nextSibling;return g(b,d(On,{get post(){return e.content},get opts(){return e.opts}}),w),g(k,d(W,{get each(){return c()},children:N=>d(Nc,{action:N})})),b}}),null),$(()=>v.className=n()?"py-4":""),f}})),$(()=>u.className=U(n()?["text-base p-2"]:"text-sm")),u})()}function Oo(e){const t=()=>e.opts.flat_frame?.is_pivot??!1,n=()=>e.whole_object_clickable===!0?!1:!e.visible||e.opts.frame?.url!=null&&!t(),r=()=>!!e.content.thumbnail&&!e.visible,o=Z();return d(Lt.Container,{dir:"right",vertical:"center",get children(){return[d(x,{get if(){return!e.visible},get when(){return e.content.thumbnail},children:l=>d(Lt.Child,{get children(){return d(X,{get action(){return{url:e.opts.frame?.url??"ENOHREF",client_id:e.opts.frame?.client_id??"ENOCLIENTID",page:e.getPage,onClick:e.collapseInfo.user_controllable?()=>{e.setVisible(i=>!i)}:void 0}},get class(){return U("w-12 h-12 sm:w-16 sm:h-16 mr-4 rounded-md bg-slate-100 dark:bg-zinc-800",e.contentWarning&&l.kind==="image"?"thumbnail-content-warning":"","block","relative")},get children(){return[d(ne,{item:l,children:{image:i=>(()=>{const a=$d.cloneNode(!0);return $(s=>{const c=he(i.url),u=U("w-full h-full object-cover rounded-md");return c!==s._v$4&&B(a,"src",s._v$4=c),u!==s._v$5&&(a.className=s._v$5=u),s},{_v$4:void 0,_v$5:void 0}),a})(),default:i=>["TODO ",R(()=>i.kind)]}}),d(Cd,{get body(){return e.content.body}})]}})}})}),d(Lt.Child,{fullwidth:!0,get children(){const l=xd.cloneNode(!0),i=l.firstChild,a=i.firstChild,s=a.firstChild;return l.$$click=c=>{if(!n()||!Pr(c.target,c.currentTarget))return;c.stopPropagation();const u="/"+e.opts.client_id+e.opts.frame?.url;if(c.ctrlKey||c.metaKey||c.altKey){if(e.opts.frame?.url==null)return;window.open(u)}else{if(e.collapseInfo.user_controllable&&!e.visible){e.setVisible(()=>!0);return}if(e.opts.frame?.url==null)return;Qe({path:u,page:e.getPage()})}},g(a,d(x,{get if(){return e.content.title!=null||e.content.flair!=null},get children(){const c=wd.cloneNode(!0);return g(c,d(x,{get when(){return e.content.title},children:u=>d(x,{get if(){return!t()},get when(){return e.opts.frame?.url},get fallback(){return u.text},children:f=>d(X,{get action(){return{url:f,client_id:e.opts.client_id,page:e.getPage}},class:"hover:underline",get children(){return u.text}})})}),null),g(c,d(We,{pre_space:!0,get flairs(){return e.content.flair??[]}}),null),$(()=>c.className=U("text-black",t()&&e.visible?"text-3xl sm:text-2xl":"text-base")),c}}),s),g(s,d(x,{get when(){return e.content.author},children:c=>[d(x,{get if(){return R(()=>!!e.visible,!0)()&&o.authorPfp()==="on"},get when(){return c.pfp},fallback:"By ",children:u=>[d(kl,{get src_url(){return u.url},get hover_src_url(){return u.hover}})," "]}),d(Ar,{get client_id(){return c.client_id},get href(){return c.link},get color_hash(){return c.color_hash},get children(){return c.name}})," "]}),null),g(s,d(x,{get if(){return e.visible},get children(){return d(x,{get when(){return e.content.author},children:c=>d(x,{get when(){return c.flair},children:u=>[d(We,{flairs:u})," "]})})}}),null),g(s,d(x,{get when(){return e.content.info?.in},children:c=>[" in ",d(be,{get action(){return{url:c.link,client_id:c.client_id}},style:"previewable",get children(){return c.name}})," "]}),null),g(a,d(x,{get if(){return!t()||!e.visible},get children(){const c=To.cloneNode(!0);return g(c,d(On,{get post(){return e.content},get opts(){return e.opts}})),c}}),null),g(a,d(Lt.Child,{fullwidth:!0,get children(){return d(x,{get if(){return!(e.visible||r())},get children(){return d(x,{get if(){return!e.collapseInfo.default_collapsed},get children(){return(()=>{const c=kd.cloneNode(!0),u=c.firstChild;return g(u,()=>"\u201C"+(()=>{const f=wn(e.content.body);return f.length>500?f.substring(0,500)+"\u2026":f})()+"\u201D"),c})()}})}})}}),null),$(c=>{const u=n()?" hover-outline":"",f=U("text-gray-500","text-sm",e.visible||r()?"":"filter grayscale text-$collapsed-header-color italic"),h=U(["flex",e.content.thumbnail?"flex-col":["flex-row flex-wrap gap-2 items-baseline"]]);return u!==c._v$&&(l.className=c._v$=u),f!==c._v$2&&(i.className=c._v$2=f),h!==c._v$3&&(a.className=c._v$3=h),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),l}}),d(x,{get if(){return e.visible||r()},get children(){return d(Lt.Child,{get children(){const l=To.cloneNode(!0);return g(l,d(wc,{get children(){return d(W,{get each(){return e.actions},children:i=>d(Cc,{action:i})})}})),$(()=>l.className=e.hovering==null||e.hovering?"":"can-hover:opacity-0 can-hover:focus-within:opacity-100"),l}})}})]}})}ce(["click"]);const Sd=p('<div class="w-full min-h-screen bg-white"><div class="max-w-2xl mx-auto h-full p-4 text-base"><div class="pt-4"></div></div></div>'),Ed=p('<span role="heading" class="block text-4xl font-black"></span>');function Nd(e){const t=Re(),n=T(()=>{const o=Te(t.content(),e.pivot);if(o==null||o.error!=null)throw new Error("rve");const l=o.value;if(l.kind==="post"&&l.content.kind==="post")return{v:l,content:l.content};throw new Error("eunsupported")}),r=Z();return(()=>{const o=Sd.cloneNode(!0),l=o.firstChild,i=l.firstChild;return g(l,d(X,{class:"fixed top-0 left-0 bg-hex-000000 bg-opacity-50 p-4",get action(){return{mode:"replace",client_id:n().v.client_id,page:()=>({content:t.content(),pivot:e.pivot}),url:fn(n().v.url??"ENO",{"--tc-view":void 0})}},get children(){return d(Oe,{class:"fa-solid fa-down-left-and-up-right-to-center text-base",label:"Exit Reader"})}}),i),g(l,d(x,{get when(){return n().content.title},children:a=>(()=>{const s=Ed.cloneNode(!0);return g(s,()=>a.text),s})()}),null),g(l,d(x,{get when(){return n().content.author},children:a=>[d(x,{get if(){return r.authorPfp()==="on"},get when(){return a.pfp},fallback:"By ",children:s=>[d(kl,{get src_url(){return s.url},get hover_src_url(){return s.hover}})," "]}),d(Ar,{get client_id(){return a.client_id},get href(){return a.link},get color_hash(){return a.color_hash},get children(){return a.name}})," "]}),null),g(l,d(x,{get when(){return n().content.author},children:a=>d(x,{get when(){return a.flair},children:s=>[d(We,{flairs:s})," "]})}),null),g(l,d(x,{get when(){return n().content.info?.in},children:a=>[" in ",d(be,{get action(){return{url:a.link,client_id:a.client_id}},style:"previewable",get children(){return a.name}})," "]}),null),g(l,d(On,{get post(){return n().content},get opts(){return{client_id:n().v.client_id,frame:n().v,id:e.pivot,flat_frame:null}}}),null),g(l,d(ae,{get body(){return n().content.body},autoplay:!0}),null),o})()}function Dn(e,t){let n={},r=Object.keys(e);for(let o=0,l=r.length;o<l;o+=1){let i=r[o];t.includes(i)||Object.defineProperty(n,i,{get(){return e[i]},enumerable:!0})}return n}function ur(e,t,n){if(t)return[t,n];let[r,o]=C(e);return[r,l=>{o(()=>l),n(l)}]}function Ld(e={}){let t="CONTROLLED"in e?e.CONTROLLED:"isOpen"in e,[n,r]=ur(!!e.defaultOpen,t?()=>!!e.isOpen:void 0,o=>{var l;return(l=e.onChange)==null?void 0:l.call(e,o)});return{isOpen(){return n()},setState(o){e.disabled||r(o)},disabled(){return!!e.disabled}}}var Pd=we();function Td(e){return typeof e=="function"&&e.length>0}function Od(e){let t=Ld(e);return d(Pd.Provider,{value:t,get children(){return(()=>{let n=e.children;return Td(n)?n(t):n})()}})}function Rd(e){var t,n;let[r,o]=C();if(e.multiple){let s="CONTROLLED"in e?e.CONTROLLED:"value"in e,[c,u]=ur((t=e.defaultValue)!=null?t:[],s?()=>{var f;return(f=e.value)!=null?f:[]}:void 0,f=>{var h;return(h=e.onChange)==null?void 0:h.call(e,f??[])});return{isSelected(f){return new Set(c()).has(f)},select(f){let h=new Set(z(c));e.toggleable&&h.has(f)?h.delete(f):h.add(f),u([...h])},hasSelected(){return c().length>0},disabled(){return!!e.disabled},hasActive(){return!!r()},isActive(f){let h=r();return h?Object.is(f,h.value):!1},focus(f){return o({value:f})},blur(){return o(void 0)}}}let l="CONTROLLED"in e?e.CONTROLLED:"value"in e,[i,a]=ur((n=e.defaultValue)!=null?n:void 0,l?()=>e.value:void 0,s=>{var c;return(c=e.onChange)==null?void 0:c.call(e,s)});return{isSelected(s){return Object.is(s,i())},select(s){e.toggleable&&Object.is(z(i),s)?a(void 0):a(s)},hasSelected(){return i()!=null},disabled(){return!!e.disabled},hasActive(){return!!r()},isActive(s){let c=r();return c?Object.is(s,c.value):!1},focus(s){return o({value:s})},blur(){return o(void 0)}}}var Cl=we();function Ad(e){return typeof e=="function"&&e.length>0}function Sl(e){let t=Rd(e);return d(Cl.Provider,{value:t,get children(){return(()=>{let n=e.children;return Ad(n)?n(t):n})()}})}function El(){let e=fe(Cl);if(e)return e;throw new Error("`useHeadlessSelectChild` must be used within HeadlessSelectRoot.")}function Id(e,t){let n=El(),r=()=>t?.()||n.disabled();return{isSelected(){return n.isSelected(e())},isActive(){return n.isActive(e())},select(){r()||n.select(e())},focus(){r()||n.focus(e())},blur(){!r()&&this.isActive()&&n.blur()},disabled:r}}function Dd(e){return typeof e=="function"&&e.length>0}var Vd=we();function zd(e){let t=Id(()=>e.value,()=>!!e.disabled);return d(Vd.Provider,{value:t,get children(){return(()=>{let n=e.children;return Dd(n)?n(t):n})()}})}function Md(e){return typeof e=="function"}function Nl(e,t){return n=>{"ref"in e&&(Md(e.ref)?e.ref(n):e.ref=n),t(n)}}function jd(e){return e.children}function Bd(e,t,n){return e.querySelectorAll(`[data-sh-${t}="${n}"]`)}var Fd="radio";function Ro(e,t){return Bd(e,Fd,t)}var Fr=we();function Ud(e){let t=fe(Fr);if(t)return t;throw new Error(`<${e}> must be used inside a <RadioGroup> or <RadioGroupOption>`)}var Ll=we();function Wd(e){let t=fe(Ll);if(t)return t;throw new Error(`<${e}> must be used inside a <RadioGroup>`)}function Hd(e){var t;let n=Ve(),r=Ve(),o=Ve(),l;function i(c){c.focus()}function a(c){if(l instanceof HTMLElement){let u=Ro(l,n);for(let f=0,h=u.length;f<h;f+=1)if(c===u[f]){f===h-1?i(u[0]):i(u[f+1]);break}}}function s(c){if(l instanceof HTMLElement){let u=Ro(l,n);for(let f=0,h=u.length;f<h;f+=1)if(c===u[f]){i(f===0?u[h-1]:u[f-1]);break}}}return d(Ll.Provider,{value:{ownerID:n,setChecked:i,setNextChecked:a,setPrevChecked:s},get children(){return d(Fr.Provider,{value:{descriptionID:r,labelID:o},get children(){return d(Bt,Le({get component(){return(t=e.as)!=null?t:"div"}},()=>Dn(e,["as","children","value","disabled","onChange","ref","defaultValue"]),{role:"radiogroup","aria-labelledby":o,"aria-describedby":r,get["aria-disabled"](){return e.disabled},get["data-sh-disabled"](){return e.disabled},get disabled(){return e.disabled},ref(c){const u=Nl(e,f=>{l=f});typeof u=="function"&&u(c)},"data-sh-radiogroup":n,get children(){return d(Sl,{CONTROLLED:"value"in e,get defaultValue(){return e.defaultValue},get value(){return e.value},get disabled(){return e.disabled},get onChange(){return e.onChange},get children(){return e.children}})}}))}})}})}function qd(e){var t;let n=Wd("RadioGroupOption"),r=El(),o=Ve(),l=Ve(),[i,a]=C();return F(()=>{let s=i();if(s instanceof HTMLElement){let c=m=>{if(!(r.disabled()||e.disabled))switch(m.key){case"ArrowLeft":case"ArrowUp":m.preventDefault(),n.setPrevChecked(s);break;case"ArrowRight":case"ArrowDown":m.preventDefault(),n.setNextChecked(s);break;case" ":case"Enter":s.tagName==="BUTTON"&&m.preventDefault(),n.setChecked(s);break}},u=()=>{r.disabled()||e.disabled||r.select(e.value)},f=()=>{r.disabled()||e.disabled||(r.focus(e.value),r.select(e.value))},h=()=>{r.disabled()||e.disabled||r.blur()};s.addEventListener("keydown",c),s.addEventListener("click",u),s.addEventListener("focus",f),s.addEventListener("blur",h),G(()=>{s.removeEventListener("keydown",c),s.removeEventListener("click",u),s.removeEventListener("focus",f),s.removeEventListener("blur",h)})}}),d(Fr.Provider,{value:{descriptionID:o,labelID:l},get children(){return d(Bt,Le({get component(){return(t=e.as)!=null?t:"div"}},()=>Dn(e,["as","children","value","disabled","ref"]),{ref(s){const c=Nl(e,u=>{a(()=>u)});typeof c=="function"&&c(s)},role:"radio",get disabled(){return e.disabled},get tabindex(){return r.isSelected(e.value)?0:-1},get["aria-disabled"](){return e.disabled},get["aria-checked"](){return r.isSelected(e.value)},"aria-labelledby":l,"aria-describedby":o,get["data-sh-radio"](){return n.ownerID},get["data-sh-checked"](){return r.isSelected(e.value)},get["data-sh-disabled"](){return e.disabled},get children(){return d(zd,{get value(){return e.value},get disabled(){return e.disabled},get children(){return e.children}})}}))}})}function Gd(e){var t;let n=Ud("RadioGroupLabel");return d(Bt,Le({get component(){return(t=e.as)!=null?t:"label"}},()=>Dn(e,["as"]),{get id(){return n.labelID},get children(){return e.children}}))}var Kd=we();function Xd(e){var t;let[n,r]=C(!1),o=Ve(),l=Ve(),i=Ve(),a=Ve();return d(Kd.Provider,{get value(){return{horizontal:e.horizontal,multiple:e.multiple,ownerID:o,labelID:l,buttonID:i,optionsID:a,get hovering(){return n()},set hovering(s){r(s)}}},get children(){return d(Bt,Le({get component(){return(t=e.as)!=null?t:jd}},()=>Dn(e,["as","children","defaultOpen","disabled","horizontal","isOpen","multiple","onDisclosureChange","onSelectChange","toggleable","value","defaultValue"]),{"aria-labelledby":l,"data-sh-listbox":o,get disabled(){return e.disabled},get["aria-disabled"](){return e.disabled},get["data-sh-disabled"](){return e.disabled},get children(){return d(Sl,{CONTROLLED:"value"in e,get multiple(){return e.multiple},get toggleable(){return e.toggleable},get defaultValue(){return e.defaultValue},get value(){return e.value},get disabled(){return e.disabled},get onChange(){return e.onSelectChange},get children(){return d(Od,{CONTROLLED:"isOpen"in e,get isOpen(){return e.isOpen},get defaultOpen(){return e.defaultOpen},get disabled(){return e.disabled},get onChange(){return e.onDisclosureChange},get children(){return e.children}})}})}}))}})}const Yd=p('<label><input type="checkbox"> Show my signature on this post</label>'),Jd=p(`<div><textarea class="
                block w-full rounded-t-lg resize-y
                bg-transparent border-2 border-b-0 border-slate-200 dark:border-zinc-700 p-2
            " rows="4"></textarea><div class="bg-slate-200 dark:bg-zinc-700 rounded-b-lg p-2 flex flex-col gap-2"><div class="flex flex-wrap gap-2"><button>Reply</button><button>Cancel</button></div></div></div>`),Qd=p('<pre class="error"><code>There was an error! </code></pre>'),Zd=p("<button>Hide error</button>");function Pl(e){const t=Z(),[n,r]=rl("comment-draft-"+e.action.client_id+"-"+e.action.key),[o,l]=C(!0),i=()=>{const b=n()??"",w=t.signature();return o()&&w.trim()?b+(b.trim()?`

`:"")+w:b},a=()=>i().trim()==="",[s,c]=C(!1),[u,f]=C(void 0),h=Lr(()=>Ce(e.action.client_id).previewReply(i(),e.action.reply_info),{key:null,merge:!0}),m=()=>{c(!0),Ce(e.action.client_id).sendReply(i(),e.action.reply_info,e.action.mode).then(w=>{console.log("Got response",w),r(null),e.onAddReply({kind:"post",internal_data:w.raw_value,content:w.kind==="thread"?{kind:"legacy",thread:w,client_id:e.action.client_id}:{kind:"post",title:{text:"Error"},body:{kind:"richtext",content:[q.p(q.error("Unsupported 'load more'",w))]},collapsible:!1},parent:null,replies:null,url:null,client_id:e.action.client_id})}).catch(w=>{c(!1);const k=w;console.log("Got error",k),f(k.toString()+`
`+k.stack)})},v=()=>{e.onCancel()};return(()=>{const b=Jd.cloneNode(!0),w=b.firstChild,k=w.nextSibling,N=k.firstChild,I=N.firstChild,E=I.nextSibling;return w.$$input=y=>{r(y.currentTarget.value)},g(k,d(x,{get if(){return!!t.signature().trim()},get children(){const y=Yd.cloneNode(!0),S=y.firstChild;return S.$$input=P=>{l(P.currentTarget.checked)},$(()=>S.checked=o()),y}}),N),I.$$click=m,E.$$click=v,g(b,d(x,{get when(){return u()},children:y=>[(()=>{const S=Qd.cloneNode(!0),P=S.firstChild;return P.firstChild,g(P,y,null),S})(),(()=>{const S=Zd.cloneNode(!0);return S.$$click=()=>f(void 0),S})()]}),null),g(b,d(x,{get if(){return!a()},get when(){return h.data},children:y=>(console.log("Value changed",y),d(Br,{get children(){return d(jr,{listing:y,get opts(){return{frame:null,client_id:e.action.client_id,flat_frame:null,id:null}}})}}))}),null),$(y=>{const S=s(),P=n()??"",M=(a()?"bg-slate-400 dark:bg-zinc-100":"bg-blue-400")+" rounded-md text-slate-900 py-1 px-3",j=a()||s(),Q=s();return S!==y._v$&&(w.disabled=y._v$=S),P!==y._v$2&&(w.value=y._v$2=P),M!==y._v$3&&(I.className=y._v$3=M),j!==y._v$4&&(I.disabled=y._v$4=j),Q!==y._v$5&&(E.disabled=y._v$5=Q),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),b})()}ce(["input","click"]);function eu(e){const t={get value(){return e()}},[n,r]=C(z(()=>t.value)),o=Yr(e),l=Yr(n),[i,a]=C(null);return F(s=>{const c=s,u=i(),f=z(()=>t.value);return c!=null&&u!=null&&u!==c&&z(()=>{const h=c.getBoundingClientRect(),m=u.getBoundingClientRect(),v=h.x-m.x,b=h.y-m.y,w=h.width/m.width,k=h.height/m.height;u.animate([{transform:["translate("+v+"px, "+b+"px)","scale("+w+", "+k+")"].join(" "),transformOrigin:"top left"},{transformOrigin:"top left"}],{duration:Rr()/2*1e3,easing:"ease-out"})}),r(()=>f),u},null),{if:s=>o(s)||l(s),ref:s=>a(s)}}const tu=p('<div class="flex flex-row flex-wrap gap-1 rounded-md bg-slate-400 dark:bg-zinc-700 p-1 shadow-inner"></div>'),nu=p(`<div class="
                                absolute top-0 left-0 w-full h-full
                                rounded-md bg-slate-100 dark:bg-zinc-500 shadow
                                group-focus-visible-outline-default
                            "></div>`);function fr(e){const t=T(l=>{const i=new Map;for(const s of e.choices)i.set(s[0],l?.fwd.get(s[0])??Cn());const a=new Map([...i.entries()].map(s=>[s[1],s[0]]));return{fwd:i,rev:a}},void 0),n=l=>t().fwd.get(l),r=T(()=>n(e.value)),o=eu(()=>r());return d(Hd,{get value(){return r()},onChange:l=>(e.setValue(l!=null?t().rev.get(l):void 0),l),get children(){const l=tu.cloneNode(!0);return g(l,d(W,{get each(){return e.choices},children:i=>d(qd,{get value(){return n(i[0])},class:"block relative px-2 group select-none cursor-pointer",get children(){return[d(x,{get if(){return o.if(n(i[0]))},get children(){const a=nu.cloneNode(!0),s=o.ref;return typeof s=="function"?s(a):o.ref=a,a}}),d(Gd,{class:"cursor-pointer relative z-1",get children(){return i[1]}})]}})})),l}})}const ru=p('<div class="h-full"><div class="text-sm font-bold uppercase text-slate-900 dark:text-zinc-100" role="heading"></div><p class="text-base text-slate-500 dark:text-zinc-300"></p></div>'),ou=p('<span class="text-slate-900 dark:text-zinc-100"></span>'),lu=p(`<div class="
                        absolute inset-0
                        bg-gradient-to-br from-blue-400 to-blue-600
                        opacity-0 group-hover:opacity-100
                        transform -translate-y-3 group-hover:translate-y-0
                        transition duration-100
                    "></div>`),iu=p('<div class="relative p-4">Open ThreadClient</div>'),au=p(`<div class="
                        absolute inset-0
                        border-4 border-slate-300 dark:border-zinc-600
                        rounded-lg
                    "></div>`),su=p('<div class="relative p-4"></div>'),cu=p(`<div class="min-h-screen overflow-x-hidden bg-slate-300 dark:bg-zinc-900 text-slate-900 dark:text-zinc-100"><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-4 pb-0"><div class="flex flex-wrap justify-end items-center"><div></div><div class="flex-1"></div></div></div><div class="mx-auto max-w-3xl p-8"><span role="heading" class="text-3xl font-bold">ThreadClient</span><div class="text-2xl font-light text-slate-500 dark:text-zinc-400">A new client for <div class="inline-block relative"></div></div></div><div class="mx-auto max-w-3xl pt-0 p-8 flex flex-wrap gap-4"></div></div><div class="
            bg-slate-300 dark:bg-zinc-900
            bg-graph-slate-350 dark:bg-graph-zinc-800
            bg-fixed
            text-slate-900 dark:text-zinc-100
        "><div class="mx-auto max-w-3xl p-8"></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Link Previews</span><p>Preview links directly inline. ThreadClient supports previewing from many of the most popular sources.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Repivoting</span><p>When reading deep in comment threads, press the top part of the comment next to the username to just see replies to that comment.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Swipe Actions</span><p>Swipe comments to collapse them or repivot or something. Might be configurable eventually.</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"><div class="relative"><div class="
                                absolute left-0 h-full w-full sm:rounded-xl
                                bg-slate-100 dark:bg-zinc-800 shadow-md
                            "></div><div class="relative p-4">put this in a phone ui and use a flag to force enable treating pointer as touch within this frame. and maybe even change the cursor to look like a touch</div></div></div></div></div><div class="mx-auto max-w-3xl p-8"><div class="grid sm:grid-cols-2 gap-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Preview Before Posting</span><p>Preview your comments as they will show up to others before posting them. We're also working on a full richtext editor but that's not out yet</p></div><div class="h-max shadow-md -mx-8 sm:mx-0"><div class="relative"><div class="
                                absolute left-0 h-full w-full sm:rounded-xl
                                bg-slate-100 dark:bg-zinc-800 shadow-md
                            "></div><div class="relative p-4"></div></div></div></div></div></div><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Reddit Feature Coverage</span><p>ThreadClient supports viewing most content on Reddit and creating some. If there's a Reddit feature that's missing that you use, ask for it <!>.</p></div></div></div><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Performance</span><ul class="list-disc"><li>Buttons react instantly, unlike on new.reddit [TODO; FIX COLLAPSE BUTTON PERF REGRESSION]</li><li>Going back a page reacts instantly, unlike on old.reddit [TODO; FIX PAGE2 NAVIGATION PERFORMANCE REGRESSION]</li></ul></div></div></div><div class="
            bg-slate-300 dark:bg-zinc-900
            bg-topography-slate-350 dark:bg-topography-zinc-800
            bg-fixed
            text-slate-900 dark:text-zinc-100
        "><div class="mx-auto max-w-3xl p-8"><div class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">More Features</div><div class="pb-4"></div><div class="grid sm:grid-cols-3 gap-4"></div></div></div><div class="bg-slate-100 dark:bg-zinc-800 text-slate-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8"><div class="text-lg"><span class="text-sm font-bold uppercase text-slate-500 dark:text-zinc-400" role="heading">Extension (TODO)</span><ul class="list-disc"><li>Automatically redirect to ThreadClient when you click a Reddit link</li><li>(TODO) Show if you have any new chat messages directly in ThreadClient</li><li>(TODO) Support uploading images and galleries when you create a post</li></ul></div></div></div><div class="bg-slate-600 text-slate-100 dark:bg-zinc-900 dark:text-zinc-100"><div class="mx-auto max-w-3xl p-8">ThreadClient. github link</div></div></div>`),du=p(`<div class="grid sm:grid-cols-2 sm:grid-flow-col-dense gap-x-8 gap-y-4"><div class="hidden sm:block sm:col-start-1"></div><div class="sm:col-start-1 text-lg"><span class="
                            text-sm font-bold uppercase
                            text-slate-500 dark:text-zinc-400
                        " role="heading">Unthreaded Replies</span><p>It often gets difficult to read long comment chains because of the increased indentation. ThreadClient automatically unthreads these chains.</p></div><div class="sm:col-start-2 flex flex-row justify-center"></div><div class="sm:col-start-2 h-max shadow-md -mx-8 sm:mx-0"></div></div>`);function Xn(e){return zl(Ml,()=>e.options?.allow_threading??!0,()=>{const t=fe(wt),n=Re(),r=ge.useChildren(()=>d(Ir,{get tree_item(){return(()=>{const o=Te(n.content(),e.post);if(o==null||o.error!=null)throw new Error("e;bad;;"+o);return{kind:"flat_post",link:e.post,post:o.value}})()},parent_indent:[],rpo:{first_in_wrapper:!0,is_pivot:!1,at_or_above_pivot:!1,threaded:!1,depth:0,displayed_in:"tree"},last:!0}));return d(W,{get each(){return r()},children:o=>d(dr,{item:o,collapse_data:t})})})}function Be(e){const t=Re();return d(X,{get action(){return{url:e.link,client_id:"shell",page:()=>{if(!!t.content()[e.link])return{content:t.content(),pivot:e.link}}}},class:`
        dark:border-t-1 dark:border-zinc-500
        block rounded-xl
        bg-slate-200 dark:bg-zinc-700
        p-4 text-left
        hover:bg-slate-100 hover:dark:bg-zinc-600 hover:shadow-md
    `,get children(){const n=ru.cloneNode(!0),r=n.firstChild,o=r.nextSibling;return g(r,()=>e.title),g(o,()=>e.description),n}})}function uu(){const[e,t]=C("reddit"),n=Z();return(()=>{const r=cu.cloneNode(!0),o=r.firstChild,l=o.firstChild,i=l.firstChild,a=i.firstChild;a.nextSibling;const s=l.nextSibling,c=s.firstChild,u=c.nextSibling,f=u.firstChild,h=f.nextSibling,m=s.nextSibling,v=o.nextSibling,b=v.firstChild,w=b.nextSibling,k=w.firstChild,N=k.firstChild,I=N.nextSibling,E=w.nextSibling,y=E.firstChild,S=y.firstChild,P=S.nextSibling,M=E.nextSibling,j=M.nextSibling,Q=j.firstChild,Ae=Q.firstChild,ue=Ae.nextSibling,le=ue.firstChild,Ft=le.firstChild,zn=Ft.nextSibling,Ze=v.nextSibling,et=Ze.firstChild,Mn=et.firstChild,xt=Mn.firstChild,tt=xt.nextSibling,Ut=tt.firstChild,$t=Ut.nextSibling;$t.nextSibling;const nt=Ze.nextSibling,rt=nt.nextSibling,Wt=rt.firstChild,Ht=Wt.firstChild,L=Ht.nextSibling,A=L.nextSibling;return g(a,d(X,{class:"hover:underline",action:{url:"https://github.com/pfgithub/threadclient",client_id:""},get children(){return[d(Oe,{class:"fa-brands fa-github",label:null})," ","Github"]}})),g(i,d(fr,{get value(){return n.colorScheme()},setValue:D=>{const V=n.colorScheme.base()===D?void 0:D;return n.colorScheme.setOverride(V),V},get choices(){return[["light",d(Xe,{tag:"fa-sun",filled:!0,label:"Light"})],["dark",d(Xe,{tag:"fa-moon",filled:!0,label:"Dark"})]]}}),null),g(h,d(Xd,{get value(){return e()},onSelectChange:D=>t(D),get children(){return d(X,{class:`
                            border-slate-500 dark:border-zinc-400
                            border-b-2 border-dashed
                            hover:border-solid
                            hover:border-slate-900 hover:dark:border-zinc-100
                            hover:text-slate-900 hover:dark:text-zinc-100
                            transition duration-100
                            inline-block
                            outline-default
                        `,action:{url:"/client-picker",client_id:"shell"},get children(){return[(()=>{const D=ou.cloneNode(!0);return g(D,()=>e()==="reddit"?"Reddit":"Mastodon"),D})()," ",d(Xe,{class:"text-lg",tag:"fa-angle-down",filled:!0,label:null})]}})}})),g(m,d(X,{action:{url:"/",client_id:"reddit"},class:`
                    inline-block
                    relative group overflow-hidden
                    bg-gradient-to-br from-blue-500 to-blue-600
                    text-slate-100 dark:text-zinc-100
                    rounded-lg
                    <sm:flex-1
                    text-center
                `,get children(){return[lu.cloneNode(!0),iu.cloneNode(!0)]}}),null),g(m,d(X,{action:{url:"/settings",client_id:""},class:`
                    inline-block
                    relative group overflow-hidden
                    text-slate-900 dark:text-zinc-100
                    rounded-lg
                    hover:bg-slate-200 dark:hover:bg-zinc-700
                    transition
                `,get children(){return[au.cloneNode(!0),(()=>{const D=su.cloneNode(!0);return g(D,d(Xe,{tag:"fa-gear",filled:!0,label:"Settings"})),D})()]}}),null),g(b,()=>z(()=>{const[D,V]=C("on");return(()=>{const Y=du.cloneNode(!0),re=Y.firstChild,qt=re.nextSibling,kt=qt.nextSibling,Gt=kt.nextSibling;return g(kt,d(fr,{get value(){return D()},setValue:Ct=>Ct?V(Ct):void 0,get choices(){return[["off","Nest"],["on","Unthread"]]}})),g(Gt,d(Xn,{post:"/homepage/unthreading",get options(){return{allow_threading:D()==="on"}}})),Y})()})),g(I,d(Xn,{post:"/homepage/link-previews"})),g(P,d(Xn,{post:"/homepage/repivot"})),g(zn,d(Pl,{get action(){return{kind:"reply",key:"@0",text:"Reply",reply_info:{encoding_type:"reply",encoding_symbol:Symbol()},client_id:"shell",mode:"reply"}},onCancel:()=>{},onAddReply:()=>{}})),g(tt,d(X,{class:"text-blue-500 hover:underline",action:{url:"https://github.com/pfgithub/threadclient/issues/new/choose",client_id:"NA"},children:"here"}),$t),g(A,d(Be,{title:"Syntax Highlighting",icon:"fa-solid fa-code",get description(){return"ThreadClient will (!TODO!) automatically syntax highlight code blocks"},link:"/homepage/syntax-highlighting"}),null),g(A,d(Be,{title:"Braille Art Fix",icon:"fa-solid fa-image",get description(){return"ThreadClient will correctly display braille art on desktop and mobile"},link:"/homepage/braille-art-fix"}),null),g(A,d(Be,{title:"Percent Upvoted",icon:"fa-solid fa-face-smile",get description(){return"ThreadClient shows you what percentage of voters upvoted a post"},link:"/homepage/percent-upvoted"}),null),g(A,d(Be,{title:"See Markdown",icon:"fa-brands fa-markdown",get description(){return"ThreadClient can show you how someone else formatted something"},link:"/homepage/see-comment-markdown"}),null),g(A,d(Be,{title:"PWA",icon:"fa-solid fa-mobile-button",get description(){return"Add ThreadClient to your home screen to use it like an app on mobile"},link:"/homepage/pwa"}),null),g(A,d(Be,{title:"Offline Mode",icon:"fa-solid fa-wifi",get description(){return"TODO: should support an offline mode where you can save and read later"},link:"/homepage/offline-mode"}),null),g(A,d(Be,{title:"Hide Automod",icon:"fa-solid fa-circle-minus",get description(){return"TODO: automod 'don't show me again' to auto collapse"},link:"/homepage/hide-automod"}),null),g(A,d(Be,{title:"Both Sidebars",icon:"fa-solid fa-circle-minus",get description(){return"ThreadClient displays both the old.reddit and new.reddit sidebars"},link:"/homepage/both-sidebars"}),null),r})()}const fu=p('<div class="flex-1">TODO show header</div>'),hu=p("<div></div>"),gu=p('<div class="sm:max-w-4xl w-full"></div>'),mu=p('<div class="sm:max-w-320px w-full h-max"></div>'),vu=p('<div class="flex flex-col gap-4 max-w-6xl mx-auto p-4 <sm:px-0"><div class="flex flex-row gap-8 justify-center"></div></div>'),_u={"LandingPage@-N-ry9qt3N1VTG0iKMHy":()=>({url:null,title:"ThreadClient",children:d(uu,{})})};function pu(e){const t=Re(),n=T(()=>{const o=Te(t.content(),e.pivot);if(o==null||o.value==null)return null;const l=o.value;if(l.kind!=="post"||l.content.kind!=="special")return null;const i=_u[l.content.tag_uuid];return i??null}),r=T(()=>{const o=new URLSearchParams(e.query).get("--tc-view");if(o==="fullscreen")return z(()=>({url:null,title:"TODO fullscreen title",children:gc({get pivot(){return e.pivot}})}));if(o==="reader")return z(()=>({url:null,title:"TODO reader title",children:Nd({get pivot(){return e.pivot}})}));const l=n();return z(()=>zl(wt,{map:new Map},()=>l?l():bu({get pivot(){return e.pivot}})))});return{get url(){return r().url},get title(){return r().title},get children(){return r().children}}}function bu(e){const t=fe(wt),n={data:Ns(()=>e.pivot)},r=T(()=>$n.lg()&&n.data.sidebar!=null),[o,l]=C("content");return{get url(){return n.data.url},get title(){return n.data.title},children:(()=>{const i=vu.cloneNode(!0),a=i.firstChild;return g(i,d(x,{get if(){return n.data.header!=null},get children(){return fu.cloneNode(!0)}}),a),g(i,d(x,{get if(){return r()},get children(){const s=hu.cloneNode(!0);return g(s,d(fr,{get value(){return o()},setValue:c=>c?l(c):void 0,get choices(){return[["content","Content"],["sidebar","Sidebar"]]}})),$(()=>s.className="flex flex-col items-center justify-center p-1 bg-slate-100 dark:bg-zinc-800 "+(o()==="sidebar"?"sticky top-0 left-0 right-0 shadow-md z-2":"")),s}}),a),g(a,d(x,{get if(){return R(()=>!!r(),!0)()?o()==="content":!0},get children(){const s=gu.cloneNode(!0);return g(s,d(W,{get each(){return n.data.body},children:c=>d(dr,{item:c,collapse_data:t})})),s}}),null),g(a,d(x,{get if(){return R(()=>n.data.sidebar!=null,!0)()&&(r()?o()==="sidebar":!0)},get children(){const s=mu.cloneNode(!0),c=Ao;return typeof c=="function"?c(s):Ao=s,g(s,d(W,{get each(){return n.data.sidebar},children:u=>d(dr,{item:u,collapse_data:t})})),s}}),null),i})()}}function Ao(e){}function yu(e,t){return console.log("!ADDDING LAYER",e,t),{...e,content:{...e.content,...t}}}let Mt,Ur;{const[e,t]=C(null,{equals:(o,l)=>!1});let n=!1;const r=()=>{n||(n=!0,ve(ln,()=>d(gt,{data:e,get children(){return d(yf,{get pgin(){return e()},addContent:(o,l)=>{o.page=yu(o.page,l),e()===o&&t(e())},get children(){return z(()=>{const o=pu({get pivot(){return e().page.pivot},get query(){return e().query}});return F(()=>{document.title=o.title+" | ThreadClient"}),()=>o.children})}})}})))};Mt=(o,l)=>{console.log("showing page2",o.page),ln.style.display="",t(o),console.log("SHOWPAGE2 CALLED ON",o),r(),l&&(document.querySelector(".\\@\\@IS_PIVOT\\@\\@")??document.body).scrollIntoView()},Ur=()=>{ln.style.display="none"}}function Qe({path:e,page:t,mode:n}){e.startsWith("/")&&(e=e.replace("/","#")||"#/");const r={key:Cn()};console.log("Appending history state index",r,e),n==="replace"?history.replaceState(r,"",e):history.pushState(r,"",e),hr(r.key,location,t)}function hr(e,t,n){const r=t.pathname==="/"&&t.search===""&&t.hash.length>2?(()=>{try{return new URL("https://thread.pfg.pw/"+t.hash.substring(1))}catch{return t}})():t;console.log("Navigating",e,r,e,n,[...Ie.keys()]),document.title="ThreadClient",yr.forEach(u=>u(r));const o=r.pathname+r.search,l=zt;Nf(e),Ur(),[...Ie.values()].forEach(u=>{u.node.kind==="t1"&&u.node.hide()});const i=Ie.get(e);if(i){i.node.kind==="t1"?i.node.show():Mt(i.node.page2,!1);return}else{const u=[...Ie.keys()].sort();for(let f=u.length-1;f>=0;f--){const h=u[f];if(h<=l)break;const m=Ie.get(h);Ie.delete(h),m.node.kind==="t1"&&m.node.removeSelf()}}if(n){const f={page:n,query:r.search};Mt(f,!0),Ie.set(e,{node:{kind:"t2",page2:f},url:o});return}const a=O(),s=_r(r.pathname,r.search).defer(a).adto(pe);a.on("cleanup",()=>s.remove()),a.on("hide",()=>s.style.display="none"),a.on("show",()=>s.style.display="");const c={kind:"t1",removeSelf:()=>a.cleanup(),hide:()=>a.setVisible(!1),show:()=>a.setVisible(!0)};Ie.set(e,{node:c,url:o})}function wu(e){const t=document.createElement("div");document.body.appendChild(t);const n=Z();_t(()=>d(x,{get if(){return n.dev.highlightUpdates()==="on"},get children(){return d(Ii,{observe_root:e})}}),t)}const at=p("<div></div>"),xu=p("<div><div></div></div>"),$u=p('<div><div class="border p-2"><div class="font-bold"></div><div></div></div></div>'),ku=p("<button></button>"),Cu=p("<div>Loading...</div>"),Su=p("<div><div>TODO polls are currently not supported</div><ul></ul></div>"),Eu=p("<li> (<!>)</li>"),Nu=p("<div>Caption: </div>"),Lu=p("<audio></audio>"),Pu=p('<div><h1 class="text-base font-light"><svg aria-label="Mastodon" class="preview-image" viewBox="0 0 713.35878 175.8678" style="fill: currentColor;"><use href="/images/mastodon/Logotype (Full).svg#base" width="713.35878" height="175.8678"></use></svg></h1><h2 class="text-2xl font-black py-1">Select your instance</h2><div class="py-1"><label>Instance Name: <input class="border rounded-md p-1" placeholder="mastodon.social"></label><button>Go \u2192</button></div><p class="py-2">Not on mastodon? Join at </p><p class="py-2">Note that some instances may require logging in before they let you view timelines.</p></div>'),Tu=p('<iframe class="border-0 w-full"></iframe>'),Ou=p('<div><button>Retry</button><span class="text-red-500"></span></div>'),Ru=p("<button><img></button>"),Au=p("<button>Prev</button>"),Iu=p("<button>Next</button>"),Du=p("<button>Gallery</button>"),Vu=ti(()=>ee(()=>Promise.resolve().then(function(){return Us}),void 0));function ae(e){return d(gt,{get data(){return e.body},get children(){return d(zu,{get body(){return e.body},get autoplay(){return e.autoplay}})}})}function zu(e){return d(ne,{get item(){return e.body},children:{text:t=>{const[n]=Zn(()=>JSON.parse(JSON.stringify(t)),l=>ya(l)),r=T(l=>n()??l,void 0),o=Lr(r,{key:null,merge:!0});return(()=>{const l=at.cloneNode(!0);return g(l,d(x,{get when(){return o.data},get fallback(){return"Loading\u2026"},children:i=>d(ae,{body:i,autoplay:!1})})),$(()=>l.className=n.loading?"animate-loading":""),l})()},link:t=>{const n=T(()=>{const r=pt(t.url,{suggested_embed:t.embed_html});if(!!r)return{body:r}});return(()=>{const r=xu.cloneNode(!0),o=r.firstChild;return g(o,d(be,{get action(){return{client_id:t.client_id,url:t.url}},style:"normal",get children(){return t.url}})),g(r,d(x,{get when(){return n()},children:l=>d(ae,{get body(){return l.body},get autoplay(){return e.autoplay}})}),null),r})()},none:()=>[],gallery:t=>d(Bu,{get images(){return t.images}}),removed:t=>{const[n,r]=C({kind:"none"});return(()=>{const o=$u.cloneNode(!0),l=o.firstChild,i=l.firstChild,a=i.nextSibling;return g(i,()=>t.removal_message.title),g(a,()=>t.removal_message.body),g(l,d(x,{get when(){return(n().kind!=="loaded"?!0:void 0)&&t.fetch_path},children:s=>{const c=async()=>{const u=await Pn(t.client_id);let f,h=!1;if(r({kind:"loading"}),!u)throw new Error("invalid client");if(!u.fetchRemoved)throw new Error("client provided a removal fetch path but has no fetchRemoved");try{f=await u.fetchRemoved(s)}catch(m){const v=m;h=!0,console.log(v),f={kind:"text",client_id:"n/a",content:"Error! "+v.toString(),markdown_format:"none"}}console.log("Got new body:",f),r({kind:h?"error":"loaded",body:f})};return(()=>{const u=ku.cloneNode(!0);return u.$$click=()=>{c().catch(console.log)},g(u,()=>({none:"View",loading:"...",error:"Retry",loaded:"never"})[n().kind]),$(f=>{const h=oe["outlined-button"],m=n().kind==="loading"||n().kind==="loaded";return h!==f._v$&&(u.className=f._v$=h),m!==f._v$2&&(u.disabled=f._v$2=m),f},{_v$:void 0,_v$2:void 0}),u})()}}),null),g(o,d(ae,{get body(){return t.body},get autoplay(){return e.autoplay}}),null),g(o,d(ne,{get item(){return n()},children:{none:()=>[],loading:()=>Cu.cloneNode(!0),error:s=>(()=>{const c=at.cloneNode(!0);return g(c,d(ae,{get body(){return s.body},autoplay:!1})),c})(),loaded:s=>(()=>{const c=at.cloneNode(!0);return g(c,d(ae,{get body(){return s.body},autoplay:!1})),c})()}}),null),o})()},crosspost:t=>d(Br,{get children(){return d(jr,{get listing(){return{kind:"legacy",thread:t.source,client_id:t.client_id}},get opts(){return{client_id:t.client_id,frame:null,flat_frame:null,id:null}}})}}),richtext:t=>(()=>{const n=at.cloneNode(!0);return g(n,d(ws,{get content(){return t.content}})),n})(),poll:t=>(()=>{const n=Su.cloneNode(!0),r=n.firstChild,o=r.nextSibling;return g(o,d(W,{get each(){return t.choices},children:l=>(()=>{const i=Eu.cloneNode(!0),a=i.firstChild,s=a.nextSibling;return s.nextSibling,g(i,()=>l.name,a),g(i,()=>l.votes==="hidden"?"hidden":"Vote(s)",s),i})()})),n})(),captioned_image:t=>(()=>{const n=at.cloneNode(!0);return g(n,d($e,{getValue:()=>{const r=el("div");return Ol(t.url,{w:t.w??void 0,h:t.h??void 0,alt:t.alt}).adto(r),r}}),null),g(n,d(x,{get when(){return t.caption},children:r=>(()=>{const o=Nu.cloneNode(!0);return o.firstChild,g(o,r,null),o})()}),null),n})(),video:t=>d(Vu,{video:t,get autoplay(){return e.autoplay}}),audio:t=>(()=>{const n=Lu.cloneNode(!0);return(r=>{const o=Vn();F(()=>{o()||r.pause()})})(n),n.controls=!0,g(n,()=>t.alt??"Audio is not supported and alt text was not provided"),$(r=>{const o=t.url,l=e.autoplay;return o!==r._v$3&&B(n,"src",r._v$3=o),l!==r._v$4&&(n.autoplay=r._v$4=l),r},{_v$3:void 0,_v$4:void 0}),n})(),array:t=>d(W,{get each(){return t.body},children:n=>n?d(ae,{body:n,autoplay:!1}):null}),gfycatv1:t=>d($e,{getValue:n=>{const r=el("div");return Gu(t.host,t.id,{autoplay:e.autoplay}).defer(n).adto(r),r}}),gfycatv2:t=>d(Mu,{data:t}),imgur:t=>d($e,{getValue:n=>{const r=el("div");return Zu(t.imgur_kind,t.imgur_id).defer(n).adto(r),r}}),youtube:t=>d($e,{getValue:n=>{const r=el("div");return Qu(t.id,t.search,{autoplay:e.autoplay}).defer(n).adto(r),r}}),twitch_clip:t=>{const[n]=Zn(t.slug,wa);return d(x,{get when(){return n()},children:r=>d(ae,{body:r,autoplay:!1})})},reddit_suggested_embed:t=>d($e,{getValue:n=>{const r=el("div");return Ju(t.suggested_embed).defer(n).adto(r),r}}),link_preview:t=>d(hl,{get link(){return{title:t.title,url:t.url,client_id:t.client_id,summary:t.description,thumbnail:t.thumb}}}),oembed:t=>d($e,{getValue:n=>{const r=el("div");return Yu(t).defer(n).adto(r),r}}),mastodon_instance_selector:t=>{const[n,r]=C(""),o=T(()=>{const i=n();return i.trim()?i.indexOf("/")>-1?!1:i.indexOf(".")!==-1:!1}),l=()=>{!o()||Qe({path:"/"+t.client_id+"/"+n().replaceAll("/","-")})};return(()=>{const i=Pu.cloneNode(!0),a=i.firstChild,s=a.nextSibling,c=s.nextSibling,u=c.firstChild,f=u.firstChild,h=f.nextSibling,m=u.nextSibling,v=c.nextSibling;return v.firstChild,a.style.setProperty("max-width","6rem"),h.$$keydown=b=>{b.key==="Enter"&&l()},h.$$input=b=>r(b.currentTarget.value),m.$$click=()=>{l()},g(v,d(be,{action:{client_id:"",url:"https://joinmastodon.org"},style:"normal",children:"joinmastodon.org"}),null),$(b=>{const w=n(),k=!o(),N=oe[o()?"pill-filled":"pill-empty"];return w!==b._v$5&&(h.value=b._v$5=w),k!==b._v$6&&(m.disabled=b._v$6=k),N!==b._v$7&&(m.className=b._v$7=N),b},{_v$5:void 0,_v$6:void 0,_v$7:void 0}),i})()},iframe_srcdoc:t=>{const[n,r]=C(t.height_estimate);return(()=>{const o=Tu.cloneNode(!0);return o.addEventListener("load",l=>{const i=l.currentTarget;if(!i.contentWindow)return console.warn("Edisplaying iframe srcdoc with no content window");const a=i.contentWindow.document.documentElement;new ResizeObserver(c=>{for(const u of c)u.target===a&&r(u.contentRect.height)}).observe(a)}),$(l=>{const i=n(),a=t.srcdoc;return i!==l._v$8&&B(o,"height",l._v$8=i),a!==l._v$9&&B(o,"srcdoc",l._v$9=a),l},{_v$8:void 0,_v$9:void 0}),o})()}}})}function wn(e){return vt(e,{text:()=>"[text]",richtext:t=>sr(t.content),link:t=>t.url,captioned_image:()=>"[image]",video:()=>"[video]",gfycatv1:()=>"[gif]",gfycatv2:()=>"[gif]",youtube:()=>"[video]",imgur:()=>"[images]",twitch_clip:()=>"[video]",oembed:()=>"[link]",reddit_suggested_embed:()=>"[content]",audio:()=>"[audio]",gallery:()=>"[gallery]",poll:()=>"[poll]",none:()=>"",removed:t=>wn(t.body),crosspost:()=>"[crosspost]",array:t=>t.body.map(n=>n?wn(n):"").join(`
`),link_preview:t=>t.url,mastodon_instance_selector:()=>"[mastodon instance selector]",iframe_srcdoc:()=>"[iframe srcdoc]"})}function Mu(e){const[t,n]=C({kind:"loading"}),[r,o]=C(Symbol());return F(()=>{r();let l=!0;G(()=>l=!1);const i=e.data;Ji(i.host,i.id).then(a=>{!l||n({kind:"loaded",frame:a})}).catch(a=>{!l||(console.log("got error",a,a.stack),n({kind:"error",message:a.toString()}))})}),d(Br,{get children(){return d(ne,{get item(){return t()},children:{loading:()=>"loading...",loaded:({frame:l})=>d(jr,{get listing(){return l.content},get opts(){return{client_id:l.client_id,frame:l,flat_frame:null,id:null}}}),error:l=>(()=>{const i=Ou.cloneNode(!0),a=i.firstChild,s=a.nextSibling;return a.$$click=()=>{n({kind:"loading"}),o(Symbol())},g(s,()=>l.message),i})()}})}})}function ju(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top+(window.pageYOffset??document.documentElement.scrollTop),w:t.width,h:t.height}}function Bu(e){const[t,n]=Nn({kind:"overview"}),[r,o]=C({enabled:!1,index:0,loading:!1}),l=Z(),i=T(()=>e.images.every(h=>h.body.kind==="captioned_image")),a=()=>i()&&l.galleryDisplay()==="fullscreen";let s;const c=h=>{n(De({kind:"overview",fullscreen_index:h},{merge:!0}));const m=s.querySelector(".img-"+h);if(!m)return{x:0,y:0,w:0};const v=ju(m),b=e.images[h];if(b&&b.aspect!=null)if(b.aspect>1){const w=v.h;v.h=v.w*(1/b.aspect),v.y+=(w-v.h)/2}else{const w=v.w;v.w=v.h*b.aspect,v.x+=(w-v.w)/2}return v};let u;G(()=>{u&&u()});const f=Vn();return F(()=>{f()||u&&u()}),(()=>{const h=at.cloneNode(!0),m=s;return typeof m=="function"?m(h):s=h,g(h,d(ne,{item:t,children:{overview:()=>d(W,{get each(){return e.images},children:(v,b)=>(()=>{const w=Ru.cloneNode(!0),k=w.firstChild;return w.$$click=()=>{a()?(o({enabled:!0,index:b(),loading:!0}),ee(()=>import("./gallery.c7829efc.js"),["assets/gallery.c7829efc.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(N=>{o({enabled:!0,index:b(),loading:!1}),u&&u();const I=N.showGallery(e.images,b(),c,{onclose:()=>{console.log("gallery closed"),o(E=>({...E,enabled:!1}))},setIndex:E=>{o({enabled:!0,index:E,loading:!1})}});u=()=>{I.cleanup(),n(De({kind:"overview",fullscreen_index:void 0},{merge:!0}))}}).catch(N=>{console.log("Error loading gallery component",N),n(De({kind:"image",index:b()},{merge:!0}))})):n(De({kind:"image",index:b()},{merge:!0}))},$(N=>{const I=U("m-1 inline-block rounded-md bg-slate-300 dark:bg-zinc-900"),E=he(v.thumb??"error"),y=U("w-24 h-24 object-contain img-"+b(),r().enabled&&r().index===b()?r().loading?"opacity-50":"opacity-0":"");return I!==N._v$10&&(w.className=N._v$10=I),E!==N._v$11&&B(k,"src",N._v$11=E),y!==N._v$12&&(k.className=N._v$12=y),N},{_v$10:void 0,_v$11:void 0,_v$12:void 0}),w})()}),image:v=>[(()=>{const b=Au.cloneNode(!0);return b.$$click=()=>n(De({kind:"image",index:v.index-1},{merge:!0})),$(w=>{const k=oe["outlined-button"],N=v.index<=0;return k!==w._v$13&&(b.className=w._v$13=k),N!==w._v$14&&(b.disabled=w._v$14=N),w},{_v$13:void 0,_v$14:void 0}),b})(),R(()=>v.index+1),"/",R(()=>e.images.length),(()=>{const b=Iu.cloneNode(!0);return b.$$click=()=>n(De({kind:"image",index:v.index+1},{merge:!0})),$(w=>{const k=oe["outlined-button"],N=v.index>=e.images.length-1;return k!==w._v$15&&(b.className=w._v$15=k),N!==w._v$16&&(b.disabled=w._v$16=N),w},{_v$15:void 0,_v$16:void 0}),b})(),(()=>{const b=Du.cloneNode(!0);return b.$$click=()=>n(De({kind:"overview"},{merge:!0})),$(()=>b.className=oe["outlined-button"]),b})(),d(ae,{get body(){return e.images[v.index].body},autoplay:!0})]}})),h})()}ce(["click","input","keydown"]);const Fu=p('<div class="flex justify-center flex-row"><div class="w-full max-w-prose"><div class="bg-white p-5 sm:m-5 sm:p-10 shadow sm:rounded-xl"><header><h1 class="text-3xl sm:text-5xl font-black">ThreadClient</h1><h2 class="text-base font-light text-gray-800 dark:text-gray-400">A client for Reddit and Mastodon</h2></header><div class="mt-10"></div><main><p>Try for </p><p>Try for </p></main><div class="mt-10"></div><footer><p class="text-gray-800 dark:text-gray-400"> \xB7 <!> \xB7 </p></footer><div class="mt-2"></div></div></div></div>');function Uu(e){return(()=>{const t=Fu.cloneNode(!0),n=t.firstChild,r=n.firstChild,o=r.firstChild,l=o.nextSibling,i=l.nextSibling,a=i.firstChild;a.firstChild;const s=a.nextSibling;s.firstChild;const c=i.nextSibling,u=c.nextSibling,f=u.firstChild,h=f.firstChild,m=h.nextSibling;return m.nextSibling,g(a,d(be,{action:{client_id:"reddit",url:"/"},style:"normal",children:"Reddit"}),null),g(s,d(be,{action:{client_id:"mastodon",url:"/"},style:"normal",children:"Mastodon"}),null),g(f,d(be,{action:{client_id:"",url:"/settings"},style:"action-button",children:"Settings"}),h),g(f,d(be,{action:{client_id:"",url:"https://github.com/pfgithub/threadclient"},style:"action-button",children:"Github"}),m),g(f,d(be,{action:{client_id:"",url:"https://github.com/pfgithub/threadclient/blob/main/privacy.md"},style:"action-button",children:"Privacy"}),null),t})()}const Wu=p('<ul class="ml-10"></ul>'),Hu=p('<main class="client-wrapper"><div class="display-comments-view"></div></main>');function te(e,t,n,r={}){const o=Rn(e,t);if(o.kind==="error")return el("a").clss(...gr(n),"error").attr({title:o.title}).clss("error").onev("click",l=>{l.stopPropagation(),alert(t)});if(o.kind==="mailto")return el("span").attr({title:o.title});if(o.kind==="link"){const l=o.url,i=Z(),a=el("a").clss(...gr(n)).attr({href:l}).attr(i.links()==="new_tab"?{target:"_blank",rel:"noopener noreferrer"}:{rel:"noopener noreferrer"});return(l.startsWith("/")||l.startsWith("#")||r.onclick)&&(a.onclick=s=>{if(s.stopPropagation(),!s.defaultPrevented&&s.button===0&&!cl(s)){if(s.preventDefault(),r.onclick)return r.onclick();Qe({path:l})}}),a}else de(o)}function qu(e,t,n){const r=n.get("t")??n.get("start")??void 0,o=el("iframe").attr({allow:"fullscreen",src:"https://www.youtube.com/embed/"+e+"?version=3&enablejsapi=1&playerapiid=ytplayer"+(t.autoplay?"&autoplay=1":"")+(r!=null?"&start="+r.replace("s",""):"")});return{node:el("div").clss("resizable-iframe").styl({width:"640px",height:"360px"}).adch(o),onhide:()=>{o.contentWindow?.postMessage(JSON.stringify({event:"command",func:"pauseVideo",args:""}),"*")}}}function Yn(e){return["inline-block mx-1 px-1 text-base border-b-2 transition-colors",e?"border-gray-900":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900"].join(" ")}function Gu(e,t,n){const r=el("div"),o=O(r),l=yt().adto(r);return fetch("https://api."+e+"/v1/gfycats/"+t).then(i=>i.json()).then(i=>{if(console.log("gfylike response:",i),l.remove(),r.adch(el("div").adch(H("code-button").atxt("code").onev("click",f=>{f.stopPropagation(),console.log(i)}))),"message"in i){el("div").clss("error").adto(r).atxt("Error: "+i.message);return}if("errorMessage"in i){el("div").clss("error").adto(r).atxt("Error: "+i.errorMessage);return}const{gfyItem:a}=i;a.title!=null&&r.adch(el("div").atxt("Title: "+a.title)),a.description!=null&&r.adch(el("div").atxt("Description: "+a.description));const s=[...a.mp4Url!=null?[{url:a.mp4Url,type:"video/mp4",quality:"Highest"}]:[],...a.webmUrl!=null?[{url:a.webmUrl,type:"video/webm",quality:"Highest"}]:[],...a.content_urls.webm?[{url:a.content_urls.webm.url,quality:"Highest"}]:[],...a.content_urls.mp4?[{url:a.content_urls.mp4.url,quality:"Highest"},{url:a.content_urls.mp4.url.replace(".mp4","-mobile.mp4"),quality:"Mobile"}]:[],...a.content_urls.mobile?[{url:a.content_urls.mobile.url,quality:"Mobile"}]:[],...a.mobileUrl!=null?[{url:a.mobileUrl,quality:"Mobile"}]:[]],c=a.content_urls,u=c.max5mbGif??c.max2mbGif??c.max1mbGif;ye({kind:"video",aspect:a.width/a.height,gifv:!1,source:s.length>0?{kind:"video",sources:s}:u!=null?{kind:"img",url:u.url}:{kind:"img",url:(()=>{throw console.log("Bad gfy image in",a),new Error("Bad gfy image")})()}},{autoplay:n.autoplay}).defer(o).adto(r)}).catch(i=>{const a=i;console.log(a),l.parentNode&&l.remove(),r.adch(el("div").clss("error").atxt("Error loading gfycat : "+a.toString()))}),o}function st(e){const t=el("span");return _t(()=>d(We,{flairs:e}),t),t}function Pt(e){const t=el("span"),n=O(t);return ve(t,()=>d(nl,{start:e})).defer(n),n}function Ku(e){let t;return async()=>{if(!t){t=[];let r;try{r=await e()}catch(l){throw console.log("failed to load",l),alert("failed to load dynamic load object. check console."),l}const o=t;t={loaded:r},o.forEach(l=>l())}if("loaded"in t)return t.loaded;const n=t;return await new Promise(r=>n.push(r)),t.loaded}}function ye(e,t){try{return Xu(e,t)}catch(n){const r=n;console.log(r);const o=el("div");return el("div").clss("error").adto(o).atxt("Got error: "+r.toString()),el("code").adto(el("pre").adto(o)).atxt(r.stack??"no stack"),O(o)}}function Xu(e,t){const n=el("div"),r=O(n),o=el("div").adto(n);return ve(o,()=>d(ae,{body:e,get autoplay(){return t.autoplay}})).defer(r),r}function Yu(e){const t=el("div"),n=O(t);return ht("url"in e?fetch(e.url,{headers:{Accept:"application/json"}}).then(r=>r.json()):(async()=>e.card)(),r=>{console.log("oembed resp",r);const o=el("div"),l=O(o);return ye(Zi(r,e.client_id),{autoplay:!1}).defer(n).adto(o),l}).defer(n).adto(t),n}function Ju(e){try{const t=el("template");t.innerHTML=e;const n=t.content.childNodes[0];if(!n)throw new Error("missing iframe");const r=n instanceof HTMLIFrameElement?{src:n.src,allow:n.allow,allowfullsreen:""}:{srcdoc:e},o=el("div").clss("resizable-iframe");let l;const i=()=>{l||(l=el("iframe").attr(r).adto(o))};i();const a=O(o);return a.on("hide",()=>{l&&(l.remove(),l=void 0)}),a.on("show",()=>i()),a}catch(t){const n=t;console.log(n);const r=el("div");return r.adch(el("p").atxt("Error adding suggestedembed: "+n.toString()).clss("error")),r.adch(el("pre").adch(el("code").atxt(e))),O(r)}}function Qu(e,t,n){const r=new URLSearchParams(t),o=el("div"),l=qu(e,{autoplay:n.autoplay},r);l.node.adto(o);const i=O(o);return i.on("hide",()=>l.onhide?.()),i.on("show",()=>l.onshow?.()),i}function Zu(e,t){const n=el("div"),r=O(n),o=yt().adto(n);return fetch("https://api.imgur.com/3/"+e+"/"+t,{headers:{Authorization:"Client-ID 6ccf617dc7a8830",Accept:"application/json"}}).then(l=>l.json()).then(l=>{const i=l;if(console.log("imgur result",i),i.success){const a={kind:"gallery",images:("images"in i.data?i.data.images:[i.data]).map(s=>{const c=s.animated&&s.mp4!=null?{kind:"video",source:{kind:"video",sources:[{url:s.mp4,quality:s.width+"\xD7"+s.height}]},aspect:s.width/s.height,gifv:s.looping,caption:s.description}:{kind:"captioned_image",caption:s.description,url:s.link,w:s.width,h:s.height};return{thumb:"https://i.imgur.com/"+s.id+"t.jpg",aspect:s.width/s.height,body:c}})};ye(a,{autoplay:!1}).defer(r).adto(n),o.remove()}else console.log(i),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur: "+(location.hostname==="localhost"?"Imgur does not work on localhost. Follow the instructions in CONTRIBUTING.md to fix. Imgur said: "+i.data.error:i.data.error)))}).catch(l=>{console.log(l),o.parentNode&&o.remove(),n.adch(el("div").clss("error").atxt("Error loading imgur : "+l.toString()))}),r}function Wr(e){const t=el("button").clss("block").adch(e);return t.onclick=n=>{n.preventDefault(),n.stopPropagation(),t.disabled=!0,ee(()=>import("./gallery.c7829efc.js"),["assets/gallery.c7829efc.js","assets/gallery.ba89e886.css","assets/_commonjsHelpers.2cf1d77b.js"]).then(r=>{const o=e.naturalWidth/e.naturalHeight,l=O();t.style.opacity="0",r.showGallery([{thumb:e.src,aspect:o,body:{kind:"captioned_image",w:e.naturalWidth,h:e.naturalHeight,url:e.src}}],0,()=>{const i=t.getBoundingClientRect();return{x:i.left,y:i.top+(window.pageYOffset??document.documentElement.scrollTop),w:i.height*o}},{onclose:()=>{t.disabled=!1,t.style.opacity="1"},setIndex:()=>{}}).defer(l)}).catch(r=>{console.log(r),t.disabled=!1,alert(r.toString())})},t}function Tl(e,t){const n=el("img").clss("image-loading").attr({src:he(e),width:t.w!=null?`${t.w}`:void 0,height:t.h!=null?`${t.h}`:void 0,alt:t.alt,title:t.alt});return n.onload=()=>n.classList.remove("image-loading"),n.onerror=()=>n.classList.remove("image-loading"),n}function Ol(e,t){return Wr(Tl(e,t).clss("preview-image"))}function ef(e,t){const n=O();ye(e.bio,{autoplay:!1}).defer(n).adto(t);const r=el("div").adto(t);for(const o of e.actions)r.atxt(" "),Ee(o,r,{value_for_code_btn:e}).defer(n);return r.atxt(" "),H("code-button").adto(r).atxt("Code").onev("click",o=>{o.stopPropagation(),console.log(e)}),n}function tf(e,t,n){{let r="none";const o=H("action-button").atxt(e.text).adto(t),l=O();let i;l.on("cleanup",()=>{i&&i.cleanup()}),l.on("hide",()=>{i&&i.setParentVisible(!1)}),l.on("show",()=>{i&&i.setParentVisible(!0)});const a=()=>{if(r==="none"){if(i){const s=i.associated_data;i.cleanup(),s.remove(),i=void 0}o.disabled=!1}else if(!i){const s=el("div").adto(t);i=O(s),ve(s,()=>d(Pl,{action:e,onCancel:()=>{r="none",a()},onAddReply:c=>{if(c.kind!=="post")throw new Error("TODO delete this code so we don't have to deal with this case");console.log("Got response",c),r="none",a();const u=el("div").adto(t);ve(u,()=>(()=>{const f=Wu.cloneNode(!0);return g(f,d(xl,{get content(){return c.content},get opts(){return{frame:c,client_id:c.client_id,flat_frame:null,id:null}}})),f})()).defer(l)}})).defer(i)}};return o.onev("click",s=>{s.stopPropagation(),r==="none"&&(r="some"),a()}),a(),l}}function Ee(e,t,n){if(e.kind==="link")return te(e.client_id,e.url,"action-button").atxt(e.text).adto(t),O();if(e.kind==="reply"){const r=O();return tf(e,t).defer(r),r}else if(e.kind==="counter"){const r=O();return Al(e,t,{parens:!0}).defer(r),r}else if(e.kind==="delete"){const r=el("span").adto(t),o=el("span").adto(t),l=el("span").adto(t),i=el("span").adto(t),a=el("span").adto(t),s=H("action-button").atxt("Delete").adto(r);o.atxt("Are you sure? ");const c=H("unsafe-action-button").atxt("Delete").adto(o);o.atxt(" / ");const u=H("safe-action-button").atxt("Cancel").adto(o);a.atxt("Deleting\u2026"),l.atxt("Deleted!");const f=h=>{r.style.display=h==="none"?"":"none",o.style.display=h==="confirm"?"":"none",l.style.display=h==="deleted"?"":"none",a.style.display=h==="load"?"":"none",i.style.display=typeof h!="string"?"":"none",typeof h!="string"&&(r.style.display="",i.innerHTML="",i.adch(el("span").clss("error").atxt(h.error)))};return f("none"),s.onev("click",h=>{h.stopPropagation(),f("confirm")}),c.onev("click",h=>{h.stopPropagation(),f("load"),Ce(e.client_id).act(e.data).then(m=>{f("deleted")}).catch(m=>{console.log("Got error:",m),f({error:m.toString()})})}),u.onev("click",h=>{h.stopPropagation(),f("none")}),O()}else if(e.kind==="report"){const r=Ce(e.client_id),o=O();let l;const i=H("action-button").atxt("Report").adto(t).onev("click",a=>{if(a.stopPropagation(),!l)i.setAttribute("class",oe["action-button-active"]),l=nf(r,e.data),l.associated_data.adto(t);else{i.setAttribute("class",oe["action-button"]);const s=l.associated_data;l.cleanup(),s.remove(),l=void 0}});return o}else if(e.kind==="login"){const r=Ce(e.client_id),o=el("span").adto(t),l=O(),i=e.data,a=H("action-button").atxt("Log In").adto(o).onev("click",s=>{s.stopPropagation(),a.textContent="\u2026",a.disabled=!0,r.getLoginURL(i).then(c=>{o.innerHTML="",te(r.id,c,"pill-filled").atxt("Log In").adto(o)}).catch(c=>{a.textContent="Retry",o.atxt("Error:"+c),console.log(c),a.disabled=!1})});return l}else if(e.kind==="act"){const r=Ce(e.client_id),o=el("span").adto(t),l=H("action-button").atxt(e.text).adto(o).onev("click",i=>{i.stopPropagation(),l.disabled=!0,l.textContent="\u2026",r.act(e.action).then(()=>{l.remove(),txt("\u2713").adto(o)}).catch(a=>{console.log("got error: "+a),l.disabled=!1,o.adch(el("span").clss("error").atxt(a.toString()))})});return O()}else{if(e.kind==="flair")return O();if(e.kind==="code"){const r=O();let o;const l=H("action-button").atxt("Code").adto(t).onev("click",i=>{if(i.stopPropagation(),console.log(n.value_for_code_btn),!o)l.setAttribute("class",oe["action-button-active"]),o=ye(e.body,{autoplay:!0}),o.associated_data.adto(t);else{l.setAttribute("class",oe["action-button"]);const a=o.associated_data;o.cleanup(),a.remove(),o=void 0}});return r}else de(e)}}function Rl(e,t,n){const r=el("details").clss("report-item"),o=O(r);r.adch(el("summary").attr({draggable:"true"}).atxt(t.title));const l=el("div").clss("report-content").adto(r);switch(t.description&&ye(t.description,{autoplay:!1}).defer(o).adto(l),t.report.kind){case"submit":case"textarea":{const i=t.report.kind==="textarea"?el("textarea").adto(el("div").adto(l)):void 0;let a="none";const s=H("pill-filled").adto(l),c=txt("\u2026").adto(s),u=el("div").adto(l),f=()=>{a==="none"?(c.nodeValue="Send Report",s.disabled=!1):a==="load"?(c.nodeValue="\u2026",s.disabled=!0):(c.nodeValue="Retry",s.disabled=!1,u.adch(el("div").clss("error").atxt("Error: "+a.error)))};f();const h=t.report.data;s.onev("click",m=>{m.stopPropagation(),a="load",f(),e.sendReport(h,i?.value).then(v=>{n(v)}).catch(v=>{console.log(v),a={error:v.toString()},f()})})}break;case"link":te(e.id,t.report.url,"normal").atxt(t.report.text).adto(l);break;case"more":{const i=el("div").adto(l);for(const a of t.report.screens)Rl(e,a,n).defer(o).adto(i)}break;default:de(t.report)}return o}function nf(e,t){const n=el("div").clss("report-screen text-sm"),r=O(n);if(!e.fetchReportScreen)return n.atxt("Missing fetchreportscreen?"),n.clss("error"),console.log(e),r;const o=yt().adto(n);return e.fetchReportScreen(t).then(l=>{o.remove();const i=O(),a=r.addChild(i);for(const s of l)Rl(e,s,c=>{a.cleanup(),n.innerHTML="",n.atxt("Report sent!"),console.log("Completed report",c);const u=Hr().adto(n);u.adch(el("div").atxt(c.title)),ye(c.body,{autoplay:!1}).defer(r).adto(u),console.log(u,n,n.childNodes)}).defer(i).adto(n)}).catch(l=>{console.log("error loading report screen",l),n.adch(el("div").clss("error").atxt("Error loading: "+l.toString())),o.remove()}),r}function Al(e,t,n){const r=e.count_excl_you!=="none",o=el("span").clss("counter").adto(t),l=H("action-button").adto(o).clss("counter-increment-btn").attr({"aria-label":"Up"}),i=el("span").adto(l),a=txt("").adto(i),s=txt("\u2026").adto(i),c=el("span").adto(o.atxt(" ")).clss("counter-count"),u=txt("\u2026").adto(c),f=e.percent==null?txt("\u2014% upvoted"):txt(e.percent.toLocaleString(void 0,{style:"percent"})+" upvoted");let h;const m=O({percent_voted_txt:f,votecount:c}),{state:v,emit:b,onupdate:w}=dl(e.unique_id,{count:e.count_excl_you,you:e.you,time:e.time}).defer(m);w(()=>{const{text:N,raw:I}=xa(v);s.nodeValue={increment:e.increment.undo_label,decrement:e.decrement?.undo_label??"ERR",none:e.increment.label}[v.your_vote??"none"],u.nodeValue=n.parens?"("+N+")":N,r||(u.nodeValue=""),c.title=I,o.classList.remove("counted-increment","counted-decrement","counted-reset"),o.classList.add("counted-"+(v.your_vote??"reset")),o.classList.toggle("counted-loading",v.loading),l.disabled=v.loading,h&&(h.disabled=v.loading),l.setAttribute("class","counter-increment-btn "+oe[v.your_vote==="increment"?e.incremented_style??"action-button":e.style??"action-button"]),h&&h.setAttribute("class","counter-decrement-btn "+oe[v.your_vote==="decrement"?e.decremented_style??"action-button":e.style??"action-button"]),l.setAttribute("aria-pressed",v.your_vote==="increment"?"true":"false"),h&&h.setAttribute("aria-pressed",v.your_vote==="decrement"?"true":"false")}),b();const k=N=>{if("error"in e.actions)return alert("Error: "+e.actions.error);const I=Ce(e.client_id),E=v.your_vote;v.your_vote=N,v.loading=!0,b();const y=e.actions[N??"reset"];if(y==null)throw new Error("downvote label available but downvote action not provided");I.act(y).then(()=>{v.your_vote=N,v.loading=!1,b()}).catch(S=>{v.your_vote=E,v.loading=!1,b(),console.log(S),alert("Got error: "+S)})};return e.decrement!=null&&(a.nodeValue="\u2BC5 ",o.atxt(" "),h=H("action-button").adch(el("span").atxt("\u2BC6")).attr({"aria-label":"Down"}).adto(o).onev("click",N=>{N.stopPropagation(),v.your_vote==="decrement"?k(void 0):k("decrement")}).clss("counter-decrement-btn")),l.onev("click",N=>{N.stopPropagation(),v.your_vote==="increment"?k(void 0):k("increment")}),m}function nn(e,t,n){const[r,o]=ml(gl(n.toLowerCase()));return te(e,t,"userlink").styl({"--light-color":mn(r),"--dark-color":mn(o)})}function rf(e){let t=e;const n=[];return{get value(){return t},set value(r){t=r,n.forEach(o=>o())},watch(r){const o=O(),l=()=>{r()};return n.push(l),o.on("cleanup",()=>n.splice(n.indexOf(l),1)),o}}}function Jn(e,t,n){const r=O(t);for(const o of e)o.watch(()=>n(t)).defer(r);return n(t),r}function xn(e){const t=el("div"),n=O(t),r=el("div").adto(t),o=a=>{const s=el("div");for(const c of a)c.action.kind==="link"?te(c.action.client_id,c.action.url,"none").clss("text-gray-600 dark:text-gray-400 hover:text-gray-900").adto(s).atxt(c.text):c.action.kind==="menu"?H("none").adto(s).atxt(c.text+" \u25B8").onev("click",u=>{u.stopPropagation(),u.preventDefault(),alert("TODO submenus")}).adto(s):c.action.kind==="show-line-two"?H("none").adto(s).atxt(c.text).onev("click",u=>{u.stopPropagation(),u.preventDefault(),alert("TODO submenu show-line-two")}).adto(s):de(c.action);return s};let l;n.on("cleanup",()=>{l&&(l.cleanup(),l=void 0)});const i=rf(e.find(a=>a.selected));i.watch(()=>{l&&(l.cleanup(),l.associated_data.remove(),l=void 0)});for(const a of e){if(a.action.kind==="menu"){const s=txt("\u2026");let c=!1,u;const f=a.action.children;n.on("hide",()=>{console.log("open menu was asked to be hidden"),c=!1,h()});const h=()=>{if(s.nodeValue=c?"\u25B4":"\u25BE",b.attr({"aria-expanded":c?"true":"false"}),c){if(!u){u=o(f).clss("absolute z-10 flex flex-col shadow bg-gray-100 p-3 rounded w-max max-w-7xl").adto(pe);const w=m.getBoundingClientRect();u.styl({left:w.left+"px",top:w.bottom+(window.pageYOffset??document.documentElement.scrollTop)+"px"})}}else u&&(u.remove(),u=void 0)},m=el("span").adto(r),v=w=>{if(c){console.log("Got event: ",w.target);let k=w.target;for(;k;){if(k===m||u&&k===u)return;k=k.parentElement}c=!1,h()}};document.addEventListener("click",v,{capture:!0}),n.on("cleanup",()=>document.removeEventListener("click",v,{capture:!0}));const b=H("none").attr({"aria-haspopup":"true"}).atxt(a.text).atxt(" ").adch(s).adto(m).onev("click",w=>{w.preventDefault(),w.stopPropagation(),c=!c,h()});Jn([i],0,()=>{b.setAttribute("class",Yn(a===i.value))}).defer(n),h()}else if(a.action.kind==="link"){const s=te(a.action.client_id,a.action.url,"none").atxt(a.text).adto(r);Jn([i],0,()=>{s.setAttribute("class",Yn(a===i.value))}).defer(n)}else if(a.action.kind==="show-line-two"){const s=a.action,c=H("none").atxt(a.text).adto(r);Jn([i],0,()=>{if(c.setAttribute("class",Yn(a===i.value)),a===i.value){if(l)throw new Error("already existing menu_l2");l=xn(s.children),l.defer(n),l.associated_data.clss("mt-2").adto(t)}}).defer(n),c.onev("click",u=>{u.stopPropagation(),i.value=a})}else de(a.action);txt(" ").adto(r)}return n}function of(e,t){const n=O();if(t.clss("subreddit-banner"),e.banner){const s="absolute top-0 left-0 right-0 w-full max-h-full",c="w-full min-h-270px object-cover object-center sm:object-top",u="absolute left-0 right-0 bottom-0 header-gradient ";e.banner.kind==="image"?(Wr(el("img").clss(c).attr({src:he(e.banner.desktop)})).clss(s).adto(t).adch(el("div").clss(u+"top-150px")),el("div").clss("h-150px").adto(t)):e.banner.kind==="color"?el("div").adch(el("div").clss(c+" h-full").styl({"background-color":e.banner.color})).clss(s).adto(t).adch(el("div").clss(u+" top-0")):de(e.banner)}const r=el("div").clss("subreddit-banner-content").adto(t);e.icon&&el("img").clss("sub-icon-img drop-shadow").attr({alt:"",src:he(e.icon.url)}).adto(r);const o=el("div").clss("subreddit-title-area").adto(r);e.name.display!=null&&el("h1").atxt(e.name.display).clss("text-lg").adto(o),el("h2").atxt(e.name.link_name).clss("text-gray-500").adto(o);const l=el("div").clss("sub-subscribe-area").adto(r);if(e.subscribe){const s=el("div").adto(l);Ee(e.subscribe,s,{value_for_code_btn:e}).defer(n)}e.body&&ye(e.body,{autoplay:!1}).defer(n).adto(l);const i=el("div").clss("relative").adto(t);e.menu&&xn(e.menu).defer(n).adto(el("div").clss("my-3").adto(i));const a=el("div").adto(i);if(e.more_actions)for(const s of e.more_actions)Ee(s,a,{value_for_code_btn:e}).defer(n);return H("action-button").atxt("Code").adto(a).onev("click",s=>{s.stopPropagation(),console.log(e)}),n}function lf(e,t,n){const r=O();n.clss("widget");const o=el("div").adto(n);txt(t.title).adto(el("div").adto(o).clss("widget-header font-bold text-base mb-2 text-gray-500"));const l=el("div").clss("widget-content").adto(o);if(t.actions_top){const a=el("div").clss("widget-actions-top").adto(l);for(const s of t.actions_top)Ee(s,a,{value_for_code_btn:t}).defer(r)}const i=t.widget_content;if(i.kind==="list"){const a=el("ul").clss("widget-list list-disc").adto(l);for(const s of i.items){const c=el("li").adto(a);let u;if(s.click.kind==="body"){c.clss("list-none");const h=el("details").adto(c);u=el("summary").attr({draggable:"true"}).adto(h),ye(s.click.body,{autoplay:!1}).defer(r).adto(h)}else c.clss("ml-4"),u=c;s.icon!=null&&el("div").adto(u).clss("widget-list-icon").styl({"--background-image-url":"url("+s.icon+")"});let f;if(s.name.kind==="text"?f=txt(s.name.text):s.name.kind==="flair"?(f=el("span"),st([s.name.flair]).adto(f)):s.name.kind==="username"?f=txt(s.name.username):s.name.kind==="image"?f=el("img").clss("w-fill h-auto").attr({src:he(s.name.src),alt:s.name.alt,width:`${s.name.w}`,height:`${s.name.h}`}):de(s.name),s.click.kind==="link"?s.name.kind==="username"?nn(e.id,s.click.url,s.name.username).atxt(s.name.username).adto(u):te(e.id,s.click.url,"normal").adch(f).adto(u):el("span").adch(f).adto(u),s.action){const h=el("span").adto(u).atxt(" ");Ee(s.action,h,{value_for_code_btn:s}).defer(r)}}}else if(i.kind==="community-details")el("p").atxt(i.description).adto(l);else if(i.kind==="body")ye(i.body,{autoplay:!1}).defer(r).adto(l);else if(i.kind==="iframe"){const a=el("div");n.replaceChild(a,o),n.clss("widget-fullscreen-content");const s=el("iframe").adto(a).styl({width:"312px"}).attr({width:"312",height:i.height,srcdoc:i.srcdoc});s.onload=()=>{if(!s.contentWindow)return console.log("no content window");s.style.height=s.contentWindow.document.body.scrollHeight+20+"px"}}else if(i.kind==="image"){const a=el("div");n.clss("widget-fullscreen-content"),n.replaceChild(a,o);const s=Tl(i.src,{w:i.width,h:i.height}).clss("w-full h-auto");i.link_url!=null?te(e.id,i.link_url,"none").adch(s).adto(a):Wr(s).adto(a)}else de(i);if(t.actions_bottom){const a=el("div").clss("widget-actions-bottom").adto(l);for(const s of t.actions_bottom)Ee(s,a,{value_for_code_btn:t}).defer(r)}return el("div").adto(l).adch(H("code-button").atxt("Code").onev("click",a=>{a.stopPropagation(),console.log(t)})),r}function Ke(e,t,n){const r=Hr(),o=O(r);try{if(t.kind==="user-profile")return ef(t,r).defer(o),o;if(t.kind==="bio")return of(t,r).defer(o),o;if(t.kind==="widget")return lf(e,t,r).defer(o),o;if(t.kind==="thread")return qr(e,t,r,n).defer(o),o;de(t)}catch(l){return o.cleanup(),console.log("Got error",l),r.innerHTML="",r.adch(el("pre").adch(el("code").atxt(l.toString()+`

`+l.stack))),r.adch(H("code-button").atxt("Code").onev("click",i=>{i.stopPropagation(),console.log(t)})),O(r)}}function Hr(){return el("div").clss("post text-sm")}function qr(e,t,n,r){let o,l,i,a,s,c,u;r.clickable&&t.link.startsWith("/")&&n.clss("hover-outline").attr({tabindex:"0"}).onev("click",y=>{if(!Pr(y.target,n))return;y.stopPropagation();const S="/"+e.id+t.link;y.ctrlKey||y.metaKey||y.altKey?window.open(S):Qe({path:S})});const h=O({addChildren:void 0});if(t.layout==="reddit-post"){o=el("div").adto(n).clss("post-voting"),l=el("button").adto(n).clss("post-thumbnail");const y=el("div").adto(n).clss("post-titles");i=el("div").adto(n).clss("post-preview"),a=el("div").adto(n).clss("post-replies"),s=el("div").adto(y).clss("post-content-title text-base"),c=el("div").adto(y).clss("post-content-subminfo"),u=el("div").adto(y).clss("post-content-buttons")}else t.layout==="reddit-comment"||t.layout==="mastodon-post"?(o=el("div").adto(n).clss("post-voting"),s=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),c=el("div").adto(n).clss("post-content-subminfo text-xs"),i=el("div").adto(n).clss("post-preview"),u=el("div").adto(n).clss("post-content-buttons text-xs"),a=el("div").adto(n).clss("post-replies")):t.layout==="error"?(o=el("div").adto(n).clss("post-voting"),s=el("div").adto(n).clss("post-content-title"),l=el("button").adto(n).clss("post-thumbnail"),c=el("div").adto(n).clss("post-content-subminfo"),i=el("div").adto(n).clss("post-preview"),u=el("div").adto(n).clss("post-content-buttons"),a=el("div").adto(n).clss("post-replies")):de(t.layout);if(t.thumbnail||l.clss("no-thumbnail"),t.layout==="reddit-comment"||t.layout==="mastodon-post"){const[y,S]=C(t.default_collapsed);F(()=>{console.log("@ORDER-EFFECT");const j=y();n.classList.toggle("comment-collapsed",j),h.setVisible(!j)});const P=el("div").clss("collapse-btn !px-0");n.insertBefore(P,n.childNodes[0]??null);const M=ve(P,()=>d(bn,{class:"h-full",get mode(){return y()?"reveal_only":"collapse_only"},onClick:()=>{console.log("@ORDER-ONCLICK-1"),S(j=>!j),console.log("@ORDER-ONCLICK-2")}}));h.addChild(M)}n.clss("layout-"+t.layout),(t.layout==="reddit-comment"||t.layout==="mastodon-post")&&n.clss("layout-commentlike"),t.flair&&(s.adch(st(t.flair.filter(y=>y.content_warning))),s.atxt(" ")),t.title&&(r.clickable?s.adch(te(e.id,t.link,"none").clss("hover:underline").atxt(t.title.text)):s.adch(txt(t.title.text))),t.flair&&(s.atxt(" "),s.adch(st(t.flair.filter(y=>!y.content_warning))));let m=(t.flair??[]).filter(y=>y.content_warning),v=null;if(t.layout==="reddit-post"&&t.info)t.info.time!==!1&&(c.adch(Pt(t.info.time).defer(h)),c.atxt(" ")),t.info.author&&c.atxt("by ").adch(nn(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&c.adch(st(t.info.author.flair)),t.info.in&&c.atxt(" in ").adch(te(e.id,t.info.in.link,"normal").atxt(t.info.in.name)),t.info.edited!==!1&&(c.hasChildNodes()&&c.atxt(", "),c.atxt("Edited ").adch(Pt(t.info.edited).defer(h))),t.info.pinned&&(c.hasChildNodes()&&c.atxt(", "),c.adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")));else if((t.layout==="reddit-comment"||t.layout==="mastodon-post")&&t.info){if(t.layout==="reddit-comment"&&t.info.author?.pfp){const y=el("img").attr({src:he(t.info.author.pfp.url)}).adto(c).clss("w-8 h-8 object-center inline-block rounded-full cfg-reddit-pfp");y.title="Disable in settings (thread.pfg.pw/settings)",c.atxt(" ")}if(t.info.author&&c.adch(nn(e.id,t.info.author.link,t.info.author.color_hash).atxt(t.info.author.name)),t.info.author?.flair&&c.adch(st(t.info.author.flair)),t.layout==="mastodon-post"&&t.info.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp").styl({"--url":"url("+JSON.stringify(t.info.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.author.pfp.hover)+")"}).adto(o)),v=document.createComment("").adto(c),t.info.time!==!1){const y=el("span").adch(Pt(t.info.time).defer(h));c.atxt(" ").adch(y)}t.info.edited!==!1&&c.atxt(", Edited ").adch(Pt(t.info.edited).defer(h)),t.info.pinned&&c.atxt(", ").adch(el("span").clss("text-green-600 dark:text-green-500").atxt("Pinned")),t.info.reblogged_by&&(c.atxt(" \u2190 Boosted by "),t.info.reblogged_by.author&&c.adch(nn(e.id,t.info.reblogged_by.author.link,t.info.reblogged_by.author.color_hash).atxt(t.info.reblogged_by.author.name)),t.info.reblogged_by.time!==!1&&c.atxt(" at ").adch(Pt(t.info.reblogged_by.time).defer(h)),t.layout==="mastodon-post"&&t.info.reblogged_by.author?.pfp&&(n.clss("spacefiller-pfp"),el("div").clss("pfp","pfp-reblog").styl({"--url":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.url)+")","--url-hover":"url("+JSON.stringify(t.info.reblogged_by.author.pfp.hover)+")"}).adto(o)))}{if(t.thumbnail)if(t.thumbnail.kind==="image")l.adch(el("img").attr({src:he(t.thumbnail.url),alt:""})),m.length&&l.clss("thumbnail-content-warning");else if(t.thumbnail.kind==="default"){const P={self:"self",default:"default",image:"image",spoiler:"spoiler",nsfw:"nsfw",account:"account",error:"error"}[t.thumbnail.thumb];l.adch(el("div").clss("thumbnail-builtin","thumbnail-"+P))}else de(t.thumbnail);const y=(P,M)=>{const j=el("div").clss("post-body"),Q=O(j);if(m.length){const Ae=m,ue=el("div").adto(j);return ue.atxt("Content Warning"+(Ae.length===1?"":"s")+": "),ue.adch(st(Ae)),ue.atxt(" "),H("pill-filled").adto(ue).atxt("Show Content").onev("click",le=>{le.stopPropagation(),ue.remove(),m=[],l.classList.remove("thumbnail-content-warning"),ye(P,{...M}).defer(Q).adto(j)}),Q}return ye(P,{...M}).defer(Q).adto(j),Q},S=P=>P.kind==="none"?!0:P.kind==="array"?P.body.every(M=>M==null?!0:S(M)):!1;if(S(t.body))i.remove();else if(t.display_mode.body==="collapsed"){const P=H("outlined-button").adto(u),M=txt("\u2026").adto(P);let j;h.on("cleanup",()=>{j&&j.cleanup()}),h.on("hide",()=>{j&&j.setVisible(!1)}),h.on("show",()=>{j&&j.setVisible(!0)});let Q=t.display_mode.body_default==="open";const Ae=!Q,ue=()=>{Q&&!j?(j=y(t.body,{autoplay:Ae}),j.associated_data.adto(i)):!Q&&j&&(j.cleanup(),j.associated_data.remove(),j=void 0),M.nodeValue=Q?"Hide":"Show"};ue(),P.onev("click",le=>{le.stopPropagation(),Q=!Q,ue()}),l.onev("click",le=>{le.stopPropagation(),Q=!Q,ue()})}else y(t.body,{autoplay:!1}).defer(h).adto(i)}let b=!1;for(const y of t.actions)if(y.kind==="counter"&&y.special==="reddit-points"){n.clss("spacefiller-redditpoints");const S=Al(y,o,{parens:!1}).defer(h);if(t.layout==="reddit-comment")c.insertBefore(txt(" "),v),c.insertBefore(S.votecount,v),c.insertBefore(txt(" points"),v);else if(t.layout==="reddit-post"){c.atxt(", "),S.percent_voted_txt.adto(c),o.clss("desktop-only"),u.atxt(" ");const P=el("div").clss("mobile-only").adto(u);Ee(y,P,{value_for_code_btn:t}).defer(h)}}else y.kind==="code"&&(b=!0),u.atxt(" "),Ee(y,u,{value_for_code_btn:t}).defer(h);o.childNodes.length===0&&o.remove(),t.actions.length===0&&(u.atxt(" "),te(e.id,t.link,"action-button").atxt("View").adto(u)),b||(u.atxt(" "),H("code-button").onev("click",y=>{y.stopPropagation(),console.log(t)}).atxt("Code").adto(u));const w=el("ul").clss("replies").styl({margin:"0"}).adto(a),k=t.replies?.length===1&&t.replies[0].replies?.length===1;let N;const I=y=>{if(k&&y.length>1){if(!N)throw new Error("threaded comment has no lastElemAddChildren");N(y);return}y.forEach(S=>E(S))},E=y=>{const S=el("li").adto(w);if(k&&S.clss("relative threaded"),y.kind==="load_more"){mr(e,y,I,()=>S.remove()).adto(S);return}let P;k&&y.replies?.length===1&&(P=y.replies[0],y.replies=[]),S.clss("comment");const M=Hr();N=qr(e,y,M,{clickable:r.clickable}).defer(h).addChildren,M.adto(S),P&&E(P)};return t.replies&&(t.display_mode.comments==="collapsed"||I(t.replies)),h.associated_data.addChildren=I,h}const oe={none:"",normal:"text-blue-600 dark:text-blue-500 underline",previewable:"text-blue-600 dark:text-blue-500 hover:underline","action-button":"p-1 rounded hover:bg-gray-200","action-button-active":"p-1 rounded bg-gray-200 hover:bg-gray-300","save-button-saved":"text-green-600 dark:text-green-500 hover:underline","safe-action-button":"text-blue-600 dark:text-blue-500 hover:underline","unsafe-action-button":"text-red-600 dark:text-red-500 hover:underline","code-button":"text-gray-600 dark:text-gray-500 hover:underline","load-more":"text-blue-600 dark:text-blue-500 hover:underline text-base",userlink:"text-$light-color dark:text-$dark-color hover:underline","pill-empty":"text-sm border-2 border-black text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-transparent":"text-sm border-2 border-transparent text-black hover:text-white hover:bg-black p-1 px-3 rounded-full transition-colors","pill-filled":"text-sm border-2 border-black bg-black text-white hover:text-black hover:bg-transparent p-1 px-3 rounded-full transition-colors","outlined-button":"border border-gray-600 dark:border-gray-500 px-2",error:"text-red-600 dark:text-red-500 hover:underline"},gr=e=>[oe[e]];function H(e){return el("button").clss(...gr(e)).attr({draggable:"true"})}function yt(){return el("div").clss("lds-ripple").adch(el("div")).adch(el("div"))}function mr(e,t,n,r){const o=el("div"),l=()=>te(e.id,t.url,"load-more",{onclick:()=>{const a=el("div").adto(o);a.adch(el("span").atxt("Loading\u2026")),a.adch(yt()),i.remove(),i=a;const s=i;e.loadMore(t.load_more).then(c=>{s.remove(),n(c),r()}).catch(c=>{console.log("error loading more:",c),s.parentNode&&s.remove(),i=el("span").atxt("Error. ").adch(l().atxt("\u{1F5D8} Retry")).adto(o)})}});let i=l().atxt(t.count!=null?"Load "+t.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more");return o.atxt(" "),H("code-button").onev("click",a=>{a.stopPropagation(),console.log(t)}).atxt("Code").adto(o),o}function af(e,t,n,r){const o=el("div"),l=s=>te(e.id,s.url,"load-more",{onclick:()=>{const c=el("div").adto(o);c.adch(el("span").atxt("Loading\u2026")),c.adch(yt()),a&&a.remove(),a=c,e.loadMoreUnmounted(s.load_more_unmounted).then(u=>{a&&a.remove(),n(u.children),u.next?i(u.next):r()}).catch(u=>{console.log("error loading more:",u),a&&a.parentNode!=null&&a.remove(),a=el("span").atxt("Error. ").adch(l(s).atxt("\u{1F5D8} Retry")).adto(o)})}}),i=s=>{a=el("div").adch(l(s).atxt(s.count!=null?"Load "+s.count+" More\u2026":"Load More\u2026").adto(o).clss("load-more")).atxt(" ").adch(H("code-button").onev("click",c=>{c.stopPropagation(),console.log(s)}).atxt("Code")).adto(o)};let a;return i(t),o}function rn(e,t){let n=e.visible;e.on("hide",()=>n=!1),e.on("show",()=>{n=!0,document.title=r(o)});const r=i=>i+" | "+t+" | ThreadClient";let o="\u2026";const l={setTitle(i){o=i,n&&(document.title=r(i))}};return l.setTitle("\u2026"),l}function sf(e,t){const n=te(e.id,t.url,"action-button"),r=O(n),o=el("span").adto(n),l=txt("\u2026 ").adto(o);return o.atxt(t.name),e.hydrateInbox(t.hydrate).then(i=>{i.messages.kind==="zero"?l.nodeValue="":i.messages.kind==="exact"?l.nodeValue=i.messages.value+" ":i.messages.kind==="minimum"&&(l.nodeValue=i.messages.min+"+ "),i.messages.kind!=="zero"&&o.classList.add({green:"text-green-500",orange:"text-orange-500"}[t.active_color])}).catch(i=>{l.nodeValue="\uFFFD "}),r}const Fe=()=>el("div").clss("object-wrapper-csshack","m-3 p-3 shadow-md sm:rounded-xl <sm:mx-0","bg-slate-100 dark:bg-zinc-800");function Il(e,t,n,r){const o=O();r.setTitle(t.title),n.classList.add("display-"+t.display_style);const l=el("div").adto(n).clss("navbar-area");for(const c of t.navbar.actions)Ee(c,l,{value_for_code_btn:t}).defer(o),txt(" ").adto(l);const i=[{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Report Issue"},{kind:"link",client_id:"n/a",url:"https://github.com/pfgithub/threadclient/issues/new",text:"Feature Request"}];for(const c of i)Ee(c,l,{value_for_code_btn:t}).defer(o),l.atxt(" ");H("code-button").atxt("Code").adto(l).onev("click",()=>console.log(t)),txt(" ").adto(l);for(const c of t.navbar.inboxes)sf(e,c).defer(o).adto(l),txt(" ").adto(l);const a=el("div").adto(n).clss("header-area"),s=el("div").adto(n).clss("content-area");if(t.sidebar){H("pill-filled").adto(n).clss("sidebar-toggle-mobile","my-1").atxt("Toggle Sidebar").onev("click",u=>{u.stopPropagation(),c.classList.toggle("sidebar-visible-mobile")});const c=el("div").adto(n).clss("sidebar-area");for(const u of t.sidebar)Ke(e,u,{clickable:!1}).defer(o).adto(Fe().adto(c))}if(t.body.kind==="listing"){Ke(e,t.body.header,{clickable:!1}).defer(o).adto(Fe().adto(a)),t.body.menu&&xn(t.body.menu).defer(o).adto(Fe().adto(s));const c=el("div").adto(s),u=h=>{for(const m of h)f(m)},f=h=>{if(h.parents.length===0){el("div").clss("error").atxt("unmounted.parents.length === 0").adto(Fe().adto(c));return}const m=Fe().adto(c);for(const v of h.parents)if(v.kind==="load_more"){const b=el("div").adto(m);te(e.id,v.url,"load-more").atxt("Load More").adto(b),b.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"))}else Ke(e,v,{clickable:!0}).defer(o).adto(m);if(h.replies.length>0){let v;const b=H("previewable").adto(m).atxt("Replies \u25B8").onev("click",w=>{if(w.stopPropagation(),v)v.cleanup(),v.associated_data.remove(),v=void 0,b.textContent="Replies \u25B8";else{b.textContent="Replies \u25BE";const k=el("div").adto(m),N=O(k);v=N;const I=y=>{for(const S of y)E(S)},E=y=>{if(y.kind==="load_more"){const S=mr(e,y,I,()=>S.remove());S.adto(k);return}Ke(e,y,{clickable:!1}).defer(N).adto(k)};I(h.replies)}})}};if(u(t.body.items),t.body.next){const h=af(e,t.body.next,u,()=>h.remove());h.adto(s)}}else if(t.body.kind==="one"){const c=Fe().adto(a);for(const h of t.body.item.parents){if(h.kind==="load_more"){const v=c;te(e.id,h.url,"load-more").atxt("Load More").adto(v),v.adch(txt(" ")).adch(el("span").clss("error text-sm").atxt("TODO load more here"));continue}const m=h===t.body.item.parents[t.body.item.parents.length-1];Ke(e,h,{clickable:!m}).defer(o).adto(c)}t.body.item.menu&&xn(t.body.item.menu).defer(o).adto(Fe().adto(s));const u=h=>{for(const m of h)f(m)},f=h=>{if(h.kind==="load_more"){const m=mr(e,h,u,()=>m.remove());m.adto(s).clss("top-level-load-more");return}Ke(e,h,{clickable:!1}).defer(o).adto(Fe().adto(s))};u(t.body.item.replies),t.body.item.replies.length===0&&el("div").atxt("*There are no replies*").adto(s)}else de(t.body);return o}function cf(e){const[t,...n]=e.split("?"),r=t,o=n.join("?"),[l,...i]=o.split("#"),a=l!==""?"?"+l:"",s=i.join("#"),c=s!==""?"#"+s:"";return{path:r,search:a,hash:c}}function df(e,t){const n=el("div").clss("client-wrapper"),r=O(n),o=el("div").adto(n);o.classList.add("client-main-frame");const l=el("div").adto(o);l.classList.add("display-loading"),l.adch(yt());const i=rn(r,e.id);return i.setTitle("Loading "+e.id+"\u2026"),(async()=>{if(!e.getThread||e.getPage&&Z().pageVersion()==="2"||t.includes("--tc-view=")){const a=await e.getPage(t),s=cf(t),c={page:a,query:s.search};l.remove(),r.visible&&Mt(c,!0),r.on("hide",()=>Ur()),r.on("show",()=>Mt(c,!1))}else{const a=await e.getThread(t);l.remove(),Il(e,a,o,i).defer(r)}})().catch(a=>{console.log(a,a.stack??"*no stack*"),l.parentNode&&l.remove(),el("div").atxt("Error! "+a+", check console.").clss("error").adto(o)}),r}function vr(e){const t=document.createElement("div"),n=O(t);return t.appendChild(document.createTextNode(e)),n}function uf(e,t,n){const r=document.createElement("div"),o=O(r);return r.atxt("\u2026"),(async()=>{r.innerHTML="",r.atxt("Logging In\u2026");try{await e.login(t,n)}catch(l){console.log(l),r.innerHTML="",r.adch(el("div").clss("error").atxt("Login error! "+l.toString()));return}r.innerHTML="",r.atxt("Logged In! You may now close this page.")})().catch(l=>{console.log(l),alert("Unexpected error "+l.toString())}),o}function ff(){const e=el("div"),t=O(e);return ve(e,()=>d(Uu,{})).defer(t),t}function hf(){return ht(ee(()=>import("./settings.fe077f08.js"),[]),({default:e})=>{const t=el("div"),n=O(t);return ve(t,()=>d(e,{})).defer(n),n})}function gf(){return ht(ee(()=>import("./ui_testing.b02577c6.js"),[]),({default:e})=>{const t=el("div"),n=O(t);return ve(t,()=>d(e,{})).defer(n),n})}function mf(){const e=el("div"),t=O(e);return te("","/reddit","normal").atxt("Reddit").adto(e),e.atxt(" \xB7 "),te("","/mastodon","normal").atxt("Mastodon").adto(e),e.atxt(" \xB7 "),te("","/settings","normal").atxt("Settings").adto(e),e.atxt(" \xB7 "),te("","/","normal").atxt("Home").adto(e),t}function O(e){const t=e,n={};let r=!0,o=!0,l=!0;const i=()=>{const f=r&&o;f!==l&&(l=f,c(f?"show":"hide"),s.forEach(h=>h.setParentVisible(f)))};let a=!0;const s=new Set,c=f=>{const h=n[f];!h||h.forEach(m=>m())},u={on(f,h){n[f]??=[],n[f].push(h)},setVisible(f){if(!a)return console.log("hideshow called on a deleted object");r!==f&&(r=f,i())},setParentVisible(f){if(!a)return console.log("hideshow called on a deleted object");o!==f&&(o=f,i())},get visible(){return r},cleanup(){a=!1,s.forEach(f=>f.cleanup()),c("cleanup")},emit:c,addChild(f){return s.add(f),{cleanup:()=>{f.cleanup(),s.delete(f)}}},get associated_data(){return t},defer(f){return f.addChild(u),t}};return u}function Qn(e,t){const n=Ce(e);return n?t(n):ht(Pn(e),r=>r?t(r):vr("404. Client "+e+" not found."))}function ht(e,t){const n=el("div").adto(pe),r=O(n),o=el("div").adto(n);return el("span").atxt("Fetching client\u2026").adto(o),e.then(l=>{t(l).defer(r).adto(n),o.remove()}).catch(l=>{console.log("error rendering",l),n.adch(el("span").clss("error").atxt("Got error! Check console! "+l.toString()))}),r}function _r(e,t){console.log("RENDERPATH",e,t);const n=(e+t).substring(1);if(n.toLowerCase().startsWith("http://")||n.toLowerCase().startsWith("https://")){let i;try{i=new URL(n)}catch{return vr("Invalid URL: "+n)}if(i.hostname==="thread.pfg.pw")return _r(i.pathname,i.search);const a=Rn("null",i.toString());if(a.kind==="link"&&!a.external){const[c,...u]=a.url.split("?");return _r(c.replace("#",""),"?"+u.join("?"))}const s=pt(n,{});if(s){const c=el("div"),u=O(c);return ve(c,()=>d(ae,{body:s,autoplay:!1})).defer(u),u}return vr("Unsupported Link: "+n)}const r=e.split("/").filter(i=>i),o=r.shift();if(console.log(r),o==null)return ff();if(o==="pwa_start")return mf();if(o==="settings")return hf();if(o==="ui_testing")return gf();function l(){const[i,a]=C("loading\u2026");return(async()=>{const{client:s}=await ee(()=>import("./mastodon.2b50ec08.js"),["assets/mastodon.2b50ec08.js","assets/base.50b98d34.js"]),{stringify:c}=await ee(()=>import("./main.724a0124.js").then(function(f){return f.m}),["assets/main.724a0124.js","assets/_commonjsHelpers.2cf1d77b.js"]),u=await s.getPage("/"+r.join("/")+t);a(c(u))})().catch(s=>{console.log("err;",s),a(s.toString()+`
`+s.stack)}),(()=>{const s=Hu.cloneNode(!0),c=s.firstChild;return g(c,d(_n,{get content(){return[q.pre(i(),"json")]}})),s})()}if(o==="temp0"){const i=el("div"),a=O(i);return ve(i,()=>d(l,{})).defer(a),a}return o==="login"?Qn(r[0]??"ENOCLIENT",i=>uf(i,r,new URLSearchParams(t))):o==="saved"?Qn("reddit",i=>{const a=el("div").clss("client-wrapper"),s=O(a),c=el("div").adto(a);c.classList.add("client-main-frame");const u=rn(s,i.id);return u.setTitle("Loading "+i.id+"\u2026"),Il(i,JSON.parse(localStorage.getItem("saved-post")??"{}"),c,u),s}):o==="@term"?ht(ee(()=>import("./TermApp.23f0dbd0.js"),[]),i=>{const a=el("div"),s=O(a);rn(s,"term").setTitle(o);const[u,f]=C(void 0,{equals:()=>!1});return ve(a,()=>d(gt,{data:"",get children(){return T(()=>(u(),d(i.default,{reloadSelf:()=>{f(void 0)}})))}})).defer(s),s}):o==="@inui"?ht(ee(()=>import("./InUI.1f4a7cba.js"),[]),i=>{const a=el("div"),s=O(a);rn(s,"inui").setTitle(o);const[u,f]=C(void 0,{equals:()=>!1});return ve(a,()=>d(gt,{data:"",get children(){return T(()=>(u(),d(i.default,{reloadSelf:()=>{f(void 0)}})))}})).defer(s),s}):Qn(o,i=>df(i,"/"+r.join("/")+t))}const vf=p("<style>.cfg-reddit-pfp {display: none;}</style>"),_f=p('<div class="block"><div class="w-22px h-22px flex items-center justify-center"><i></i></div></div>'),pf=p("<div><pre><code> </code></pre><button>Code</button> / <button>Retry</button></div>"),pr=we();function bf(e){const t=fe(pr),n=T(()=>{const r=t?.visible()??!0,o=e.visible();return r?o:!1});return d(pr.Provider,{value:{visible:n},get children(){return e.children}})}function Vn(){return fe(pr)?.visible??(()=>!0)}const Dl=we();function yf(e){return d(Dl.Provider,{get value(){return{pgin:()=>e.pgin,content:()=>e.pgin.page.content,addContent:e.addContent}},get children(){return e.children}})}function Vl(){return fe(Dl)}function Re(){const e=Vl();if(!e)throw new Error("no page root context here.");return e}const wt=we();function zl(e,t,n){let r;return cn(()=>{r={v:z(()=>(Fo().context={[e.id]:t},n()))}}),r.v}const Ml=we();function ie(e,t,n){const r=()=>{const c=localStorage.getItem(e)??void 0;return n.deserialize?n.deserialize(c):c},[o,l]=C(r()),i=()=>{l(r())};return window.addEventListener("storage",i),Object.assign(()=>o()??t(),{base:t,override:o,setOverride:c=>{c==null?localStorage.removeItem(e):localStorage.setItem(e,n.serialize?n.serialize(c):c),i()}})}function At(e,t,n){const r=window.matchMedia(e),[o,l]=C(r.matches?t:n),i=()=>{l(()=>r.matches?t:n)};return r.addEventListener("change",i),G(()=>{r.removeEventListener("change",i)}),o}const wf=Se(()=>{const e={colorScheme:ie("color-scheme",At("(prefers-color-scheme: dark)","dark","light"),{}),authorPfp:ie("pfp-cfg",()=>"on",{}),updateNotifications:ie("update_notices",()=>"on",{}),customVideoControls:ie("custom_video_controls",()=>"browser",{}),pageVersion:ie("page_version",()=>"1",{}),linkHelpers:ie("link_helpers",At("(pointer: coarse)","show","hide"),{}),galleryDisplay:ie("gallery_display",()=>"fullscreen",{}),motion:ie("motion",At("(prefers-reduced-motion: reduce)","reduce","full"),{}),animationTime:ie("animation_time",()=>.2,{serialize:r=>JSON.stringify(r),deserialize:r=>r!=null&&r!==""?JSON.parse(r):void 0}),animationDevMode:ie("animation_dev_mode",()=>"none",{}),signature:ie("signature",()=>"",{}),links:ie("links",()=>"new_tab",{}),changelog:ie("changelog",()=>"show",{}),dev:{showLogButtons:ie("dev.show-log-buttons",()=>"off",{}),highlightUpdates:ie("dev.highlight-updates",()=>"off",{}),mockRequests:ie("--use-mock",()=>null,{})}},t=T(()=>e.colorScheme()==="dark");F(()=>{const r=`* {
            transition: none !important;
        }`,o=el("style").atxt(r).adto(document.head);document.documentElement.classList.toggle("dark",t()),document.documentElement.offsetHeight,o.remove()});const n=At("(hover: hover)",!0,!1);return F(()=>{document.documentElement.classList.toggle("atmedia-hover-hover",n())}),e});_t(()=>d(x,{get if(){return Z().authorPfp()==="off"},get children(){return vf.cloneNode(!0)}}),el("div").adto(document.head));function Z(){return wf}const[Io,xf]=C(window.innerWidth);window.addEventListener("resize",()=>{xf(window.innerWidth)});const $n=Se(e=>({sm:T(()=>Io()<640),lg:T(()=>Io()<1024)}));function U(...e){return e.flat().join(" ")}function Tt(e){return(()=>{const t=_f.cloneNode(!0),n=t.firstChild,r=n.firstChild;return $(o=>{const l=e.icon.class+" "+e.size,i=e.icon.label;return l!==o._v$&&(r.className=o._v$=l),i!==o._v$2&&B(r,"aria-label",o._v$2=i),o},{_v$:void 0,_v$2:void 0}),t})()}function gt(e){const[t,n]=C(!0);return d(oi,{fallback:(r,o)=>(console.log(r),(()=>{const l=pf.cloneNode(!0),i=l.firstChild,a=i.firstChild,s=a.firstChild,c=i.nextSibling,u=c.nextSibling,f=u.nextSibling;return c.$$click=()=>console.log(r,e.data),f.$$click=()=>{n(!1),setTimeout(()=>n(!0),200),o()},$(h=>{const m=r instanceof Error?r.toString()+`

`+r.stack:"Something went wrong",v=oe["outlined-button"],b=oe["outlined-button"];return m!==h._v$3&&(s.data=h._v$3=m),v!==h._v$4&&(c.className=h._v$4=v),b!==h._v$5&&(f.className=h._v$5=b),h},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),l})()),get children(){return d(x,{get if(){return t()},get fallback(){return"Retrying..."},get children(){return e.children}})}})}ce(["click"]);const $f=p('<div class="bg-indigo-600"><div class="mx-auto max-w-7xl py-3 px-3 sm:px-6 lg:px-8"><div class="flex flex-wrap items-center justify-between"><div class="flex w-0 flex-1 items-center"><span class="flex rounded-lg bg-indigo-800 p-2"></span><p class="ml-3 truncate font-medium text-rwhite">ThreadClient was updated</p></div><div class="order-3 mt-2 w-full flex-shrink-0 sm:order-2 sm:mt-0 sm:w-auto"></div><div class="order-2 flex-shrink-0 sm:order-3 sm:ml-3"></div></div></div></div>'),Gr="-N0l8jcINFK5F9MkDcyT";function kf(){return localStorage.getItem("seen-page1")==="true"}const[jl,br]=rl("tc-latest-viewed-changelog-version");function Cf(){const e=jl();return e==null?(console.warn("E_NO_LS_VERSION_IN_CHECK_UPDATED"),!1):Gr>e}function Do(){br(Gr)}function Sf(e){z(()=>jl())==null&&(kf()?br("\0"):br(Gr));const t=Z();_t(()=>d(x,{get if(){return R(()=>t.changelog()==="show",!0)()&&Cf()},get children(){return d(Ef,{})}}),e)}function Ef(){return(()=>{const e=$f.cloneNode(!0),t=e.firstChild,n=t.firstChild,r=n.firstChild,o=r.firstChild,l=r.nextSibling,i=l.nextSibling;return g(o,d(Oe,{class:"fa-solid fa-bullhorn",label:"Update"})),g(l,d(X,{action:{url:"/changelog",client_id:"shell"},class:`
                flex items-center justify-center
                rounded-md border border-transparent
                bg-rwhite px-4 py-2 text-sm font-medium text-indigo-600 shadow-sm
                hover:bg-indigo-50
            `,beforeClick:()=>Do(),children:"Show Changelog"})),g(i,d(X,{class:`
                -mr-1 flex rounded-md p-2 hover:bg-indigo-500
                focus:outline-none focus:ring-2 focus:ring-rwhite sm:-mr-2
            `,action:()=>Do(),get children(){return d(Oe,{class:"fa-solid fa-x",label:"Close"})}})),e})()}let pe,on,Bl,kn,Ie,zt,ct,yr,ln;function Cn(){return li(Date.now(),{readBytes:e=>crypto.getRandomValues(e)})}function Nf(e){zt=e}function Vo(){if(location.hash===""){const e=new URL(location.origin+"/#"+(location.pathname.replace("/","")+location.search+location.hash||"/"));history.replaceState(history.state,"",e)}}function Lf(){const e=document.createElement("div").adto(document.body);if(pe=document.createElement("threadclient"),document.body.appendChild(pe),on=new Map,Vo(),window.onpopstate=o=>{Vo(),console.log("onpopstate. ev:",o.state);const l=o.state,i=l?.key??Cn();if(i!==l?.key){const a={key:i};history.replaceState(a,"",location.href)}hr(i,location,void 0)},ct={},Ie=new Map,yr=[],zt=Cn(),el("div").adto(pe),navigator.standalone||window.matchMedia("(display-mode: standalone)").matches){const o=el("nav").clss("navbar","bg-slate-100 dark:bg-zinc-800","transition-opacity").adto(pe);kn=o;const l=["px-2"];el("button").adto(o).attr({"aria-label":"Back"}).atxt("\u2190").clss(...l).onev("click",h=>{h.stopPropagation(),history.back()}),el("button").adto(o).attr({"aria-label":"Forward"}).atxt("\u2192").clss(...l).onev("click",h=>{h.stopPropagation(),history.forward()});const i=el("input").attr({"aria-label":"URL"}).adto(o).clss("bg-transparent text-center border border-gray-600 dark:border-gray-500"),a=el("button").attr({"aria-label":"Go"}).clss(...l).atxt("\u23CE").adto(o),s=el("button").attr({"aria-label":"Reload"}).clss(...l).atxt("\u{1F5D8}").adto(o),c=()=>Qe({path:"/"+i.value.replace(/^\//,"")});a.onclick=()=>c(),i.onkeydown=h=>h.key==="Enter"?c():0,s.onclick=()=>alert("TODO refresh"),yr.push(h=>{h.pathname.toLowerCase().startsWith("/http://")||h.pathname.toLowerCase().startsWith("/https://")?i.value=(h.pathname+h.search).substr(1):i.value=h.pathname+h.search});let u=window.scrollY,f=0;document.addEventListener("scroll",h=>{const m=window.scrollY,v=m-u;u=m;const b=Math.max(0,Math.min(100,m));f+=v,f>b&&(f=b),f<0&&(f=0);let w=f;m<0&&(w=-m),o.style.setProperty("--mobile-transform","translateY("+-w+"px)")},{passive:!1})}else kn=el("nav").adto(pe);console.log("ThreadClient built on "+vi.build_time),ln=el("div").adto(pe);const t={key:zt};history.replaceState(t,"ThreadClient",location.pathname+location.search+location.hash),hr(zt,location,void 0);let n=100;const r=()=>{document.head.querySelector(".darkreader")?.remove(),n*=2,setTimeout(()=>r(),n)};setTimeout(()=>r(),0),Bl=el("div").adto(pe).clss("alert-area"),wu(pe),Sf(e)}const[Af,Fl]=C(!1),[If,Pf]=C(!1),Ul=mi({onNeedRefresh(){if(console.log("An update to ThreadClient is available"),Pf(!0),Z().updateNotifications()==="on"){const t=el("div").clss("alert").adto(Bl);el("div").clss("alert-body").adto(t).atxt("An update to ThreadClient is available."),H("pill-empty").atxt("Ignore").adto(t).onev("click",n=>{n.stopPropagation(),t.remove()}),t.atxt(" "),H("pill-empty").atxt("Update (Refresh)").adto(t).onev("click",n=>{n.stopPropagation(),Ul(!0)})}},onOfflineReady(){console.log("Ready for offline use."),Fl(!0)}});console.log("updateSW",Ul);navigator.serviceWorker!=null&&navigator.serviceWorker.getRegistrations().then(e=>{e.every(t=>t.active)&&e.length!==0&&Fl(!0)}).catch(e=>console.log("Error checking sw registrations",e));console.log("ROUTER.TS WAS RELOADED.",!1);Lf();export{fn as A,je as B,Br as C,G as D,Sn as E,W as F,z as G,gl as H,B as I,rl as J,vt as K,be as L,ci as M,Xi as N,ai as O,_n as R,ar as S,fr as T,ee as _,d as a,jr as b,C as c,X as d,q as e,$ as f,F as g,O as h,g as i,Rf as j,Af as k,Ul as l,R as m,x as n,Z as o,ce as p,oe as q,pe as r,ve as s,p as t,If as u,vi as v,$e as w,Tf as x,de as y,Of as z};
